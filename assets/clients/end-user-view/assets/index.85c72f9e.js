(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function kh(e,t){const r=Object.create(null),n=e.split(",");for(let a=0;a<n.length;a++)r[n[a]]=!0;return t?a=>!!r[a.toLowerCase()]:a=>!!r[a]}const QC="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",XC=kh(QC);function P0(e){return!!e||e===""}function Eh(e){if(it(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],a=ur(n)?tI(n):Eh(n);if(a)for(const i in a)t[i]=a[i]}return t}else{if(ur(e))return e;if(Wt(e))return e}}const ZC=/;(?![^(]*\))/g,eI=/:(.+)/;function tI(e){const t={};return e.split(ZC).forEach(r=>{if(r){const n=r.split(eI);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function Vn(e){let t="";if(ur(e))t=e;else if(it(e))for(let r=0;r<e.length;r++){const n=Vn(e[r]);n&&(t+=n+" ")}else if(Wt(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const Yt=e=>ur(e)?e:e==null?"":it(e)||Wt(e)&&(e.toString===L0||!lt(e.toString))?JSON.stringify(e,M0,2):String(e),M0=(e,t)=>t&&t.__v_isRef?M0(e,t.value):Js(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,a])=>(r[`${n} =>`]=a,r),{})}:x0(t)?{[`Set(${t.size})`]:[...t.values()]}:Wt(t)&&!it(t)&&!j0(t)?String(t):t,jt={},Ks=[],Pn=()=>{},rI=()=>!1,nI=/^on[^a-z]/,Yc=e=>nI.test(e),Ch=e=>e.startsWith("onUpdate:"),Sr=Object.assign,Ih=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},aI=Object.prototype.hasOwnProperty,mt=(e,t)=>aI.call(e,t),it=Array.isArray,Js=e=>Qc(e)==="[object Map]",x0=e=>Qc(e)==="[object Set]",lt=e=>typeof e=="function",ur=e=>typeof e=="string",Rh=e=>typeof e=="symbol",Wt=e=>e!==null&&typeof e=="object",N0=e=>Wt(e)&&lt(e.then)&&lt(e.catch),L0=Object.prototype.toString,Qc=e=>L0.call(e),iI=e=>Qc(e).slice(8,-1),j0=e=>Qc(e)==="[object Object]",Ah=e=>ur(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,sc=kh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Xc=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},sI=/-(\w)/g,Yn=Xc(e=>e.replace(sI,(t,r)=>r?r.toUpperCase():"")),oI=/\B([A-Z])/g,as=Xc(e=>e.replace(oI,"-$1").toLowerCase()),Zc=Xc(e=>e.charAt(0).toUpperCase()+e.slice(1)),ad=Xc(e=>e?`on${Zc(e)}`:""),ku=(e,t)=>!Object.is(e,t),oc=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},bc=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},Yp=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Lg;const uI=()=>Lg||(Lg=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Gr;class U0{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&Gr&&(this.parent=Gr,this.index=(Gr.scopes||(Gr.scopes=[])).push(this)-1)}run(t){if(this.active){const r=Gr;try{return Gr=this,t()}finally{Gr=r}}}on(){Gr=this}off(){Gr=this.parent}stop(t){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(this.parent&&!t){const a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.active=!1}}}function F0(e){return new U0(e)}function lI(e,t=Gr){t&&t.active&&t.effects.push(e)}function cI(){return Gr}function fI(e){Gr&&Gr.cleanups.push(e)}const Oh=e=>{const t=new Set(e);return t.w=0,t.n=0,t},D0=e=>(e.w&oi)>0,B0=e=>(e.n&oi)>0,dI=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=oi},pI=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const a=t[n];D0(a)&&!B0(a)?a.delete(e):t[r++]=a,a.w&=~oi,a.n&=~oi}t.length=r}},Qp=new WeakMap;let uu=0,oi=1;const Xp=30;let En;const Ki=Symbol(""),Zp=Symbol("");class Ph{constructor(t,r=null,n){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,lI(this,n)}run(){if(!this.active)return this.fn();let t=En,r=ei;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=En,En=this,ei=!0,oi=1<<++uu,uu<=Xp?dI(this):jg(this),this.fn()}finally{uu<=Xp&&pI(this),oi=1<<--uu,En=this.parent,ei=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){En===this?this.deferStop=!0:this.active&&(jg(this),this.onStop&&this.onStop(),this.active=!1)}}function jg(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let ei=!0;const q0=[];function mo(){q0.push(ei),ei=!1}function bo(){const e=q0.pop();ei=e===void 0?!0:e}function Jr(e,t,r){if(ei&&En){let n=Qp.get(e);n||Qp.set(e,n=new Map);let a=n.get(r);a||n.set(r,a=Oh()),H0(a)}}function H0(e,t){let r=!1;uu<=Xp?B0(e)||(e.n|=oi,r=!D0(e)):r=!e.has(En),r&&(e.add(En),En.deps.push(e))}function ga(e,t,r,n,a,i){const s=Qp.get(e);if(!s)return;let o=[];if(t==="clear")o=[...s.values()];else if(r==="length"&&it(e))s.forEach((u,l)=>{(l==="length"||l>=n)&&o.push(u)});else switch(r!==void 0&&o.push(s.get(r)),t){case"add":it(e)?Ah(r)&&o.push(s.get("length")):(o.push(s.get(Ki)),Js(e)&&o.push(s.get(Zp)));break;case"delete":it(e)||(o.push(s.get(Ki)),Js(e)&&o.push(s.get(Zp)));break;case"set":Js(e)&&o.push(s.get(Ki));break}if(o.length===1)o[0]&&ev(o[0]);else{const u=[];for(const l of o)l&&u.push(...l);ev(Oh(u))}}function ev(e,t){const r=it(e)?e:[...e];for(const n of r)n.computed&&Ug(n);for(const n of r)n.computed||Ug(n)}function Ug(e,t){(e!==En||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const vI=kh("__proto__,__v_isRef,__isVue"),W0=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Rh)),hI=Mh(),yI=Mh(!1,!0),gI=Mh(!0),Fg=mI();function mI(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const n=bt(this);for(let i=0,s=this.length;i<s;i++)Jr(n,"get",i+"");const a=n[t](...r);return a===-1||a===!1?n[t](...r.map(bt)):a}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){mo();const n=bt(this)[t].apply(this,r);return bo(),n}}),e}function Mh(e=!1,t=!1){return function(n,a,i){if(a==="__v_isReactive")return!e;if(a==="__v_isReadonly")return e;if(a==="__v_isShallow")return t;if(a==="__v_raw"&&i===(e?t?xI:J0:t?K0:V0).get(n))return n;const s=it(n);if(!e&&s&&mt(Fg,a))return Reflect.get(Fg,a,i);const o=Reflect.get(n,a,i);return(Rh(a)?W0.has(a):vI(a))||(e||Jr(n,"get",a),t)?o:Qt(o)?s&&Ah(a)?o:o.value:Wt(o)?e?Y0(o):is(o):o}}const bI=G0(),wI=G0(!0);function G0(e=!1){return function(r,n,a,i){let s=r[n];if(io(s)&&Qt(s)&&!Qt(a))return!1;if(!e&&(!wc(a)&&!io(a)&&(s=bt(s),a=bt(a)),!it(r)&&Qt(s)&&!Qt(a)))return s.value=a,!0;const o=it(r)&&Ah(n)?Number(n)<r.length:mt(r,n),u=Reflect.set(r,n,a,i);return r===bt(i)&&(o?ku(a,s)&&ga(r,"set",n,a):ga(r,"add",n,a)),u}}function _I(e,t){const r=mt(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&r&&ga(e,"delete",t,void 0),n}function SI(e,t){const r=Reflect.has(e,t);return(!Rh(t)||!W0.has(t))&&Jr(e,"has",t),r}function $I(e){return Jr(e,"iterate",it(e)?"length":Ki),Reflect.ownKeys(e)}const z0={get:hI,set:bI,deleteProperty:_I,has:SI,ownKeys:$I},TI={get:gI,set(e,t){return!0},deleteProperty(e,t){return!0}},kI=Sr({},z0,{get:yI,set:wI}),xh=e=>e,ef=e=>Reflect.getPrototypeOf(e);function Sl(e,t,r=!1,n=!1){e=e.__v_raw;const a=bt(e),i=bt(t);r||(t!==i&&Jr(a,"get",t),Jr(a,"get",i));const{has:s}=ef(a),o=n?xh:r?jh:Eu;if(s.call(a,t))return o(e.get(t));if(s.call(a,i))return o(e.get(i));e!==a&&e.get(t)}function $l(e,t=!1){const r=this.__v_raw,n=bt(r),a=bt(e);return t||(e!==a&&Jr(n,"has",e),Jr(n,"has",a)),e===a?r.has(e):r.has(e)||r.has(a)}function Tl(e,t=!1){return e=e.__v_raw,!t&&Jr(bt(e),"iterate",Ki),Reflect.get(e,"size",e)}function Dg(e){e=bt(e);const t=bt(this);return ef(t).has.call(t,e)||(t.add(e),ga(t,"add",e,e)),this}function Bg(e,t){t=bt(t);const r=bt(this),{has:n,get:a}=ef(r);let i=n.call(r,e);i||(e=bt(e),i=n.call(r,e));const s=a.call(r,e);return r.set(e,t),i?ku(t,s)&&ga(r,"set",e,t):ga(r,"add",e,t),this}function qg(e){const t=bt(this),{has:r,get:n}=ef(t);let a=r.call(t,e);a||(e=bt(e),a=r.call(t,e)),n&&n.call(t,e);const i=t.delete(e);return a&&ga(t,"delete",e,void 0),i}function Hg(){const e=bt(this),t=e.size!==0,r=e.clear();return t&&ga(e,"clear",void 0,void 0),r}function kl(e,t){return function(n,a){const i=this,s=i.__v_raw,o=bt(s),u=t?xh:e?jh:Eu;return!e&&Jr(o,"iterate",Ki),s.forEach((l,c)=>n.call(a,u(l),u(c),i))}}function El(e,t,r){return function(...n){const a=this.__v_raw,i=bt(a),s=Js(i),o=e==="entries"||e===Symbol.iterator&&s,u=e==="keys"&&s,l=a[e](...n),c=r?xh:t?jh:Eu;return!t&&Jr(i,"iterate",u?Zp:Ki),{next(){const{value:h,done:w}=l.next();return w?{value:h,done:w}:{value:o?[c(h[0]),c(h[1])]:c(h),done:w}},[Symbol.iterator](){return this}}}}function Ba(e){return function(...t){return e==="delete"?!1:this}}function EI(){const e={get(i){return Sl(this,i)},get size(){return Tl(this)},has:$l,add:Dg,set:Bg,delete:qg,clear:Hg,forEach:kl(!1,!1)},t={get(i){return Sl(this,i,!1,!0)},get size(){return Tl(this)},has:$l,add:Dg,set:Bg,delete:qg,clear:Hg,forEach:kl(!1,!0)},r={get(i){return Sl(this,i,!0)},get size(){return Tl(this,!0)},has(i){return $l.call(this,i,!0)},add:Ba("add"),set:Ba("set"),delete:Ba("delete"),clear:Ba("clear"),forEach:kl(!0,!1)},n={get(i){return Sl(this,i,!0,!0)},get size(){return Tl(this,!0)},has(i){return $l.call(this,i,!0)},add:Ba("add"),set:Ba("set"),delete:Ba("delete"),clear:Ba("clear"),forEach:kl(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=El(i,!1,!1),r[i]=El(i,!0,!1),t[i]=El(i,!1,!0),n[i]=El(i,!0,!0)}),[e,r,t,n]}const[CI,II,RI,AI]=EI();function Nh(e,t){const r=t?e?AI:RI:e?II:CI;return(n,a,i)=>a==="__v_isReactive"?!e:a==="__v_isReadonly"?e:a==="__v_raw"?n:Reflect.get(mt(r,a)&&a in n?r:n,a,i)}const OI={get:Nh(!1,!1)},PI={get:Nh(!1,!0)},MI={get:Nh(!0,!1)},V0=new WeakMap,K0=new WeakMap,J0=new WeakMap,xI=new WeakMap;function NI(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function LI(e){return e.__v_skip||!Object.isExtensible(e)?0:NI(iI(e))}function is(e){return io(e)?e:Lh(e,!1,z0,OI,V0)}function jI(e){return Lh(e,!1,kI,PI,K0)}function Y0(e){return Lh(e,!0,TI,MI,J0)}function Lh(e,t,r,n,a){if(!Wt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=a.get(e);if(i)return i;const s=LI(e);if(s===0)return e;const o=new Proxy(e,s===2?n:r);return a.set(e,o),o}function ti(e){return io(e)?ti(e.__v_raw):!!(e&&e.__v_isReactive)}function io(e){return!!(e&&e.__v_isReadonly)}function wc(e){return!!(e&&e.__v_isShallow)}function Q0(e){return ti(e)||io(e)}function bt(e){const t=e&&e.__v_raw;return t?bt(t):e}function so(e){return bc(e,"__v_skip",!0),e}const Eu=e=>Wt(e)?is(e):e,jh=e=>Wt(e)?Y0(e):e;function X0(e){ei&&En&&(e=bt(e),H0(e.dep||(e.dep=Oh())))}function Z0(e,t){e=bt(e),e.dep&&ev(e.dep)}function Qt(e){return!!(e&&e.__v_isRef===!0)}function vt(e){return t$(e,!1)}function e$(e){return t$(e,!0)}function t$(e,t){return Qt(e)?e:new UI(e,t)}class UI{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:bt(t),this._value=r?t:Eu(t)}get value(){return X0(this),this._value}set value(t){const r=this.__v_isShallow||wc(t)||io(t);t=r?t:bt(t),ku(t,this._rawValue)&&(this._rawValue=t,this._value=r?t:Eu(t),Z0(this))}}function Mt(e){return Qt(e)?e.value:e}const FI={get:(e,t,r)=>Mt(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const a=e[t];return Qt(a)&&!Qt(r)?(a.value=r,!0):Reflect.set(e,t,r,n)}};function r$(e){return ti(e)?e:new Proxy(e,FI)}function DI(e){const t=it(e)?new Array(e.length):{};for(const r in e)t[r]=qI(e,r);return t}class BI{constructor(t,r,n){this._object=t,this._key=r,this._defaultValue=n,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}}function qI(e,t,r){const n=e[t];return Qt(n)?n:new BI(e,t,r)}var n$;class HI{constructor(t,r,n,a){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[n$]=!1,this._dirty=!0,this.effect=new Ph(t,()=>{this._dirty||(this._dirty=!0,Z0(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!a,this.__v_isReadonly=n}get value(){const t=bt(this);return X0(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}n$="__v_isReadonly";function WI(e,t,r=!1){let n,a;const i=lt(e);return i?(n=e,a=Pn):(n=e.get,a=e.set),new HI(n,a,i||!a,r)}function ri(e,t,r,n){let a;try{a=n?e(...n):e()}catch(i){tf(i,t,r)}return a}function pn(e,t,r,n){if(lt(e)){const i=ri(e,t,r,n);return i&&N0(i)&&i.catch(s=>{tf(s,t,r)}),i}const a=[];for(let i=0;i<e.length;i++)a.push(pn(e[i],t,r,n));return a}function tf(e,t,r,n=!0){const a=t?t.vnode:null;if(t){let i=t.parent;const s=t.proxy,o=r;for(;i;){const l=i.ec;if(l){for(let c=0;c<l.length;c++)if(l[c](e,s,o)===!1)return}i=i.parent}const u=t.appContext.config.errorHandler;if(u){ri(u,null,10,[e,s,o]);return}}GI(e,r,a,n)}function GI(e,t,r,n=!0){console.error(e)}let Cu=!1,tv=!1;const wr=[];let Gn=0;const Ys=[];let la=null,Bi=0;const a$=Promise.resolve();let Uh=null;function Fh(e){const t=Uh||a$;return e?t.then(this?e.bind(this):e):t}function zI(e){let t=Gn+1,r=wr.length;for(;t<r;){const n=t+r>>>1;Iu(wr[n])<e?t=n+1:r=n}return t}function Dh(e){(!wr.length||!wr.includes(e,Cu&&e.allowRecurse?Gn+1:Gn))&&(e.id==null?wr.push(e):wr.splice(zI(e.id),0,e),i$())}function i$(){!Cu&&!tv&&(tv=!0,Uh=a$.then(o$))}function VI(e){const t=wr.indexOf(e);t>Gn&&wr.splice(t,1)}function KI(e){it(e)?Ys.push(...e):(!la||!la.includes(e,e.allowRecurse?Bi+1:Bi))&&Ys.push(e),i$()}function Wg(e,t=Cu?Gn+1:0){for(;t<wr.length;t++){const r=wr[t];r&&r.pre&&(wr.splice(t,1),t--,r())}}function s$(e){if(Ys.length){const t=[...new Set(Ys)];if(Ys.length=0,la){la.push(...t);return}for(la=t,la.sort((r,n)=>Iu(r)-Iu(n)),Bi=0;Bi<la.length;Bi++)la[Bi]();la=null,Bi=0}}const Iu=e=>e.id==null?1/0:e.id,JI=(e,t)=>{const r=Iu(e)-Iu(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function o$(e){tv=!1,Cu=!0,wr.sort(JI);const t=Pn;try{for(Gn=0;Gn<wr.length;Gn++){const r=wr[Gn];r&&r.active!==!1&&ri(r,null,14)}}finally{Gn=0,wr.length=0,s$(),Cu=!1,Uh=null,(wr.length||Ys.length)&&o$()}}function YI(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||jt;let a=r;const i=t.startsWith("update:"),s=i&&t.slice(7);if(s&&s in n){const c=`${s==="modelValue"?"model":s}Modifiers`,{number:h,trim:w}=n[c]||jt;w&&(a=r.map(b=>b.trim())),h&&(a=r.map(Yp))}let o,u=n[o=ad(t)]||n[o=ad(Yn(t))];!u&&i&&(u=n[o=ad(as(t))]),u&&pn(u,e,6,a);const l=n[o+"Once"];if(l){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,pn(l,e,6,a)}}function u$(e,t,r=!1){const n=t.emitsCache,a=n.get(e);if(a!==void 0)return a;const i=e.emits;let s={},o=!1;if(!lt(e)){const u=l=>{const c=u$(l,t,!0);c&&(o=!0,Sr(s,c))};!r&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}return!i&&!o?(Wt(e)&&n.set(e,null),null):(it(i)?i.forEach(u=>s[u]=null):Sr(s,i),Wt(e)&&n.set(e,s),s)}function rf(e,t){return!e||!Yc(t)?!1:(t=t.slice(2).replace(/Once$/,""),mt(e,t[0].toLowerCase()+t.slice(1))||mt(e,as(t))||mt(e,t))}let _r=null,nf=null;function _c(e){const t=_r;return _r=e,nf=e&&e.type.__scopeId||null,t}function QI(e){nf=e}function XI(){nf=null}function ui(e,t=_r,r){if(!t||e._n)return e;const n=(...a)=>{n._d&&tm(-1);const i=_c(t),s=e(...a);return _c(i),n._d&&tm(1),s};return n._n=!0,n._c=!0,n._d=!0,n}function id(e){const{type:t,vnode:r,proxy:n,withProxy:a,props:i,propsOptions:[s],slots:o,attrs:u,emit:l,render:c,renderCache:h,data:w,setupState:b,ctx:$,inheritAttrs:A}=e;let x,U;const B=_c(e);try{if(r.shapeFlag&4){const se=a||n;x=Hn(c.call(se,se,h,i,b,w,$)),U=u}else{const se=t;x=Hn(se.length>1?se(i,{attrs:u,slots:o,emit:l}):se(i,null)),U=t.props?u:ZI(u)}}catch(se){hu.length=0,tf(se,e,1),x=Ht(vn)}let ve=x;if(U&&A!==!1){const se=Object.keys(U),{shapeFlag:Re}=ve;se.length&&Re&7&&(s&&se.some(Ch)&&(U=eR(U,s)),ve=ci(ve,U))}return r.dirs&&(ve=ci(ve),ve.dirs=ve.dirs?ve.dirs.concat(r.dirs):r.dirs),r.transition&&(ve.transition=r.transition),x=ve,_c(B),x}const ZI=e=>{let t;for(const r in e)(r==="class"||r==="style"||Yc(r))&&((t||(t={}))[r]=e[r]);return t},eR=(e,t)=>{const r={};for(const n in e)(!Ch(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function tR(e,t,r){const{props:n,children:a,component:i}=e,{props:s,children:o,patchFlag:u}=t,l=i.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&u>=0){if(u&1024)return!0;if(u&16)return n?Gg(n,s,l):!!s;if(u&8){const c=t.dynamicProps;for(let h=0;h<c.length;h++){const w=c[h];if(s[w]!==n[w]&&!rf(l,w))return!0}}}else return(a||o)&&(!o||!o.$stable)?!0:n===s?!1:n?s?Gg(n,s,l):!0:!!s;return!1}function Gg(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let a=0;a<n.length;a++){const i=n[a];if(t[i]!==e[i]&&!rf(r,i))return!0}return!1}function rR({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const nR=e=>e.__isSuspense;function aR(e,t){t&&t.pendingBranch?it(e)?t.effects.push(...e):t.effects.push(e):KI(e)}function uc(e,t){if(sr){let r=sr.provides;const n=sr.parent&&sr.parent.provides;n===r&&(r=sr.provides=Object.create(n)),r[e]=t}}function Mn(e,t,r=!1){const n=sr||_r;if(n){const a=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(a&&e in a)return a[e];if(arguments.length>1)return r&&lt(t)?t.call(n.proxy):t}}const zg={};function Ji(e,t,r){return l$(e,t,r)}function l$(e,t,{immediate:r,deep:n,flush:a,onTrack:i,onTrigger:s}=jt){const o=sr;let u,l=!1,c=!1;if(Qt(e)?(u=()=>e.value,l=wc(e)):ti(e)?(u=()=>e,n=!0):it(e)?(c=!0,l=e.some(U=>ti(U)||wc(U)),u=()=>e.map(U=>{if(Qt(U))return U.value;if(ti(U))return zi(U);if(lt(U))return ri(U,o,2)})):lt(e)?t?u=()=>ri(e,o,2):u=()=>{if(!(o&&o.isUnmounted))return h&&h(),pn(e,o,3,[w])}:u=Pn,t&&n){const U=u;u=()=>zi(U())}let h,w=U=>{h=x.onStop=()=>{ri(U,o,4)}};if(Ou)return w=Pn,t?r&&pn(t,o,3,[u(),c?[]:void 0,w]):u(),Pn;let b=c?[]:zg;const $=()=>{if(!!x.active)if(t){const U=x.run();(n||l||(c?U.some((B,ve)=>ku(B,b[ve])):ku(U,b)))&&(h&&h(),pn(t,o,3,[U,b===zg?void 0:b,w]),b=U)}else x.run()};$.allowRecurse=!!t;let A;a==="sync"?A=$:a==="post"?A=()=>jr($,o&&o.suspense):($.pre=!0,o&&($.id=o.uid),A=()=>Dh($));const x=new Ph(u,A);return t?r?$():b=x.run():a==="post"?jr(x.run.bind(x),o&&o.suspense):x.run(),()=>{x.stop(),o&&o.scope&&Ih(o.scope.effects,x)}}function iR(e,t,r){const n=this.proxy,a=ur(e)?e.includes(".")?c$(n,e):()=>n[e]:e.bind(n,n);let i;lt(t)?i=t:(i=t.handler,r=t);const s=sr;oo(this);const o=l$(a,i.bind(n),r);return s?oo(s):Yi(),o}function c$(e,t){const r=t.split(".");return()=>{let n=e;for(let a=0;a<r.length&&n;a++)n=n[r[a]];return n}}function zi(e,t){if(!Wt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Qt(e))zi(e.value,t);else if(it(e))for(let r=0;r<e.length;r++)zi(e[r],t);else if(x0(e)||Js(e))e.forEach(r=>{zi(r,t)});else if(j0(e))for(const r in e)zi(e[r],t);return e}function sR(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return of(()=>{e.isMounted=!0}),y$(()=>{e.isUnmounting=!0}),e}const an=[Function,Array],oR={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:an,onEnter:an,onAfterEnter:an,onEnterCancelled:an,onBeforeLeave:an,onLeave:an,onAfterLeave:an,onLeaveCancelled:an,onBeforeAppear:an,onAppear:an,onAfterAppear:an,onAppearCancelled:an},setup(e,{slots:t}){const r=zh(),n=sR();let a;return()=>{const i=t.default&&d$(t.default(),!0);if(!i||!i.length)return;let s=i[0];if(i.length>1){for(const A of i)if(A.type!==vn){s=A;break}}const o=bt(e),{mode:u}=o;if(n.isLeaving)return sd(s);const l=Vg(s);if(!l)return sd(s);const c=rv(l,o,n,r);nv(l,c);const h=r.subTree,w=h&&Vg(h);let b=!1;const{getTransitionKey:$}=l.type;if($){const A=$();a===void 0?a=A:A!==a&&(a=A,b=!0)}if(w&&w.type!==vn&&(!qi(l,w)||b)){const A=rv(w,o,n,r);if(nv(w,A),u==="out-in")return n.isLeaving=!0,A.afterLeave=()=>{n.isLeaving=!1,r.update()},sd(s);u==="in-out"&&l.type!==vn&&(A.delayLeave=(x,U,B)=>{const ve=f$(n,w);ve[String(w.key)]=w,x._leaveCb=()=>{U(),x._leaveCb=void 0,delete c.delayedLeave},c.delayedLeave=B})}return s}}},uR=oR;function f$(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function rv(e,t,r,n){const{appear:a,mode:i,persisted:s=!1,onBeforeEnter:o,onEnter:u,onAfterEnter:l,onEnterCancelled:c,onBeforeLeave:h,onLeave:w,onAfterLeave:b,onLeaveCancelled:$,onBeforeAppear:A,onAppear:x,onAfterAppear:U,onAppearCancelled:B}=t,ve=String(e.key),se=f$(r,e),Re=(P,te)=>{P&&pn(P,n,9,te)},ke=(P,te)=>{const le=te[1];Re(P,te),it(P)?P.every(J=>J.length<=1)&&le():P.length<=1&&le()},de={mode:i,persisted:s,beforeEnter(P){let te=o;if(!r.isMounted)if(a)te=A||o;else return;P._leaveCb&&P._leaveCb(!0);const le=se[ve];le&&qi(e,le)&&le.el._leaveCb&&le.el._leaveCb(),Re(te,[P])},enter(P){let te=u,le=l,J=c;if(!r.isMounted)if(a)te=x||u,le=U||l,J=B||c;else return;let xe=!1;const re=P._enterCb=H=>{xe||(xe=!0,H?Re(J,[P]):Re(le,[P]),de.delayedLeave&&de.delayedLeave(),P._enterCb=void 0)};te?ke(te,[P,re]):re()},leave(P,te){const le=String(e.key);if(P._enterCb&&P._enterCb(!0),r.isUnmounting)return te();Re(h,[P]);let J=!1;const xe=P._leaveCb=re=>{J||(J=!0,te(),re?Re($,[P]):Re(b,[P]),P._leaveCb=void 0,se[le]===e&&delete se[le])};se[le]=e,w?ke(w,[P,xe]):xe()},clone(P){return rv(P,t,r,n)}};return de}function sd(e){if(af(e))return e=ci(e),e.children=null,e}function Vg(e){return af(e)?e.children?e.children[0]:void 0:e}function nv(e,t){e.shapeFlag&6&&e.component?nv(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function d$(e,t=!1,r){let n=[],a=0;for(let i=0;i<e.length;i++){let s=e[i];const o=r==null?s.key:String(r)+String(s.key!=null?s.key:i);s.type===dr?(s.patchFlag&128&&a++,n=n.concat(d$(s.children,t,o))):(t||s.type!==vn)&&n.push(o!=null?ci(s,{key:o}):s)}if(a>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}function p$(e){return lt(e)?{setup:e,name:e.name}:e}const vu=e=>!!e.type.__asyncLoader,af=e=>e.type.__isKeepAlive;function lR(e,t){v$(e,"a",t)}function cR(e,t){v$(e,"da",t)}function v$(e,t,r=sr){const n=e.__wdc||(e.__wdc=()=>{let a=r;for(;a;){if(a.isDeactivated)return;a=a.parent}return e()});if(sf(t,n,r),r){let a=r.parent;for(;a&&a.parent;)af(a.parent.vnode)&&fR(n,t,r,a),a=a.parent}}function fR(e,t,r,n){const a=sf(t,e,n,!0);Bh(()=>{Ih(n[t],a)},r)}function sf(e,t,r=sr,n=!1){if(r){const a=r[e]||(r[e]=[]),i=t.__weh||(t.__weh=(...s)=>{if(r.isUnmounted)return;mo(),oo(r);const o=pn(t,r,e,s);return Yi(),bo(),o});return n?a.unshift(i):a.push(i),i}}const ka=e=>(t,r=sr)=>(!Ou||e==="sp")&&sf(e,t,r),h$=ka("bm"),of=ka("m"),dR=ka("bu"),pR=ka("u"),y$=ka("bum"),Bh=ka("um"),vR=ka("sp"),hR=ka("rtg"),yR=ka("rtc");function gR(e,t=sr){sf("ec",e,t)}function It(e,t){const r=_r;if(r===null)return e;const n=lf(r)||r.proxy,a=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[s,o,u,l=jt]=t[i];lt(s)&&(s={mounted:s,updated:s}),s.deep&&zi(o),a.push({dir:s,instance:n,value:o,oldValue:void 0,arg:u,modifiers:l})}return e}function Ai(e,t,r,n){const a=e.dirs,i=t&&t.dirs;for(let s=0;s<a.length;s++){const o=a[s];i&&(o.oldValue=i[s].value);let u=o.dir[n];u&&(mo(),pn(u,r,8,[e.el,o,e,t]),bo())}}const g$="components";function li(e,t){return bR(g$,e,!0,t)||e}const mR=Symbol();function bR(e,t,r=!0,n=!1){const a=_r||sr;if(a){const i=a.type;if(e===g$){const o=JR(i,!1);if(o&&(o===t||o===Yn(t)||o===Zc(Yn(t))))return i}const s=Kg(a[e]||i[e],t)||Kg(a.appContext[e],t);return!s&&n?i:s}}function Kg(e,t){return e&&(e[t]||e[Yn(t)]||e[Zc(Yn(t))])}function Ru(e,t,r,n){let a;const i=r&&r[n];if(it(e)||ur(e)){a=new Array(e.length);for(let s=0,o=e.length;s<o;s++)a[s]=t(e[s],s,void 0,i&&i[s])}else if(typeof e=="number"){a=new Array(e);for(let s=0;s<e;s++)a[s]=t(s+1,s,void 0,i&&i[s])}else if(Wt(e))if(e[Symbol.iterator])a=Array.from(e,(s,o)=>t(s,o,void 0,i&&i[o]));else{const s=Object.keys(e);a=new Array(s.length);for(let o=0,u=s.length;o<u;o++){const l=s[o];a[o]=t(e[l],l,o,i&&i[o])}}else a=[];return r&&(r[n]=a),a}function wR(e,t,r={},n,a){if(_r.isCE||_r.parent&&vu(_r.parent)&&_r.parent.isCE)return Ht("slot",t==="default"?null:{name:t},n&&n());let i=e[t];i&&i._c&&(i._d=!1),st();const s=i&&m$(i(r)),o=es(dr,{key:r.key||s&&s.key||`_${t}`},s||(n?n():[]),s&&e._===1?64:-2);return!a&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),i&&i._c&&(i._d=!0),o}function m$(e){return e.some(t=>Tc(t)?!(t.type===vn||t.type===dr&&!m$(t.children)):!0)?e:null}const av=e=>e?A$(e)?lf(e)||e.proxy:av(e.parent):null,Sc=Sr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>av(e.parent),$root:e=>av(e.root),$emit:e=>e.emit,$options:e=>qh(e),$forceUpdate:e=>e.f||(e.f=()=>Dh(e.update)),$nextTick:e=>e.n||(e.n=Fh.bind(e.proxy)),$watch:e=>iR.bind(e)}),_R={get({_:e},t){const{ctx:r,setupState:n,data:a,props:i,accessCache:s,type:o,appContext:u}=e;let l;if(t[0]!=="$"){const b=s[t];if(b!==void 0)switch(b){case 1:return n[t];case 2:return a[t];case 4:return r[t];case 3:return i[t]}else{if(n!==jt&&mt(n,t))return s[t]=1,n[t];if(a!==jt&&mt(a,t))return s[t]=2,a[t];if((l=e.propsOptions[0])&&mt(l,t))return s[t]=3,i[t];if(r!==jt&&mt(r,t))return s[t]=4,r[t];iv&&(s[t]=0)}}const c=Sc[t];let h,w;if(c)return t==="$attrs"&&Jr(e,"get",t),c(e);if((h=o.__cssModules)&&(h=h[t]))return h;if(r!==jt&&mt(r,t))return s[t]=4,r[t];if(w=u.config.globalProperties,mt(w,t))return w[t]},set({_:e},t,r){const{data:n,setupState:a,ctx:i}=e;return a!==jt&&mt(a,t)?(a[t]=r,!0):n!==jt&&mt(n,t)?(n[t]=r,!0):mt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:a,propsOptions:i}},s){let o;return!!r[s]||e!==jt&&mt(e,s)||t!==jt&&mt(t,s)||(o=i[0])&&mt(o,s)||mt(n,s)||mt(Sc,s)||mt(a.config.globalProperties,s)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:mt(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let iv=!0;function SR(e){const t=qh(e),r=e.proxy,n=e.ctx;iv=!1,t.beforeCreate&&Jg(t.beforeCreate,e,"bc");const{data:a,computed:i,methods:s,watch:o,provide:u,inject:l,created:c,beforeMount:h,mounted:w,beforeUpdate:b,updated:$,activated:A,deactivated:x,beforeDestroy:U,beforeUnmount:B,destroyed:ve,unmounted:se,render:Re,renderTracked:ke,renderTriggered:de,errorCaptured:P,serverPrefetch:te,expose:le,inheritAttrs:J,components:xe,directives:re,filters:H}=t;if(l&&$R(l,n,null,e.appContext.config.unwrapInjectedRef),s)for(const me in s){const _e=s[me];lt(_e)&&(n[me]=_e.bind(r))}if(a){const me=a.call(r,r);Wt(me)&&(e.data=is(me))}if(iv=!0,i)for(const me in i){const _e=i[me],N=lt(_e)?_e.bind(r,r):lt(_e.get)?_e.get.bind(r,r):Pn,ft=!lt(_e)&&lt(_e.set)?_e.set.bind(r):Pn,dt=Bt({get:N,set:ft});Object.defineProperty(n,me,{enumerable:!0,configurable:!0,get:()=>dt.value,set:Ee=>dt.value=Ee})}if(o)for(const me in o)b$(o[me],n,r,me);if(u){const me=lt(u)?u.call(r):u;Reflect.ownKeys(me).forEach(_e=>{uc(_e,me[_e])})}c&&Jg(c,e,"c");function W(me,_e){it(_e)?_e.forEach(N=>me(N.bind(r))):_e&&me(_e.bind(r))}if(W(h$,h),W(of,w),W(dR,b),W(pR,$),W(lR,A),W(cR,x),W(gR,P),W(yR,ke),W(hR,de),W(y$,B),W(Bh,se),W(vR,te),it(le))if(le.length){const me=e.exposed||(e.exposed={});le.forEach(_e=>{Object.defineProperty(me,_e,{get:()=>r[_e],set:N=>r[_e]=N})})}else e.exposed||(e.exposed={});Re&&e.render===Pn&&(e.render=Re),J!=null&&(e.inheritAttrs=J),xe&&(e.components=xe),re&&(e.directives=re)}function $R(e,t,r=Pn,n=!1){it(e)&&(e=sv(e));for(const a in e){const i=e[a];let s;Wt(i)?"default"in i?s=Mn(i.from||a,i.default,!0):s=Mn(i.from||a):s=Mn(i),Qt(s)&&n?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):t[a]=s}}function Jg(e,t,r){pn(it(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function b$(e,t,r,n){const a=n.includes(".")?c$(r,n):()=>r[n];if(ur(e)){const i=t[e];lt(i)&&Ji(a,i)}else if(lt(e))Ji(a,e.bind(r));else if(Wt(e))if(it(e))e.forEach(i=>b$(i,t,r,n));else{const i=lt(e.handler)?e.handler.bind(r):t[e.handler];lt(i)&&Ji(a,i,e)}}function qh(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:a,optionsCache:i,config:{optionMergeStrategies:s}}=e.appContext,o=i.get(t);let u;return o?u=o:!a.length&&!r&&!n?u=t:(u={},a.length&&a.forEach(l=>$c(u,l,s,!0)),$c(u,t,s)),Wt(t)&&i.set(t,u),u}function $c(e,t,r,n=!1){const{mixins:a,extends:i}=t;i&&$c(e,i,r,!0),a&&a.forEach(s=>$c(e,s,r,!0));for(const s in t)if(!(n&&s==="expose")){const o=TR[s]||r&&r[s];e[s]=o?o(e[s],t[s]):t[s]}return e}const TR={data:Yg,props:Di,emits:Di,methods:Di,computed:Di,beforeCreate:Or,created:Or,beforeMount:Or,mounted:Or,beforeUpdate:Or,updated:Or,beforeDestroy:Or,beforeUnmount:Or,destroyed:Or,unmounted:Or,activated:Or,deactivated:Or,errorCaptured:Or,serverPrefetch:Or,components:Di,directives:Di,watch:ER,provide:Yg,inject:kR};function Yg(e,t){return t?e?function(){return Sr(lt(e)?e.call(this,this):e,lt(t)?t.call(this,this):t)}:t:e}function kR(e,t){return Di(sv(e),sv(t))}function sv(e){if(it(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Or(e,t){return e?[...new Set([].concat(e,t))]:t}function Di(e,t){return e?Sr(Sr(Object.create(null),e),t):t}function ER(e,t){if(!e)return t;if(!t)return e;const r=Sr(Object.create(null),e);for(const n in t)r[n]=Or(e[n],t[n]);return r}function CR(e,t,r,n=!1){const a={},i={};bc(i,uf,1),e.propsDefaults=Object.create(null),w$(e,t,a,i);for(const s in e.propsOptions[0])s in a||(a[s]=void 0);r?e.props=n?a:jI(a):e.type.props?e.props=a:e.props=i,e.attrs=i}function IR(e,t,r,n){const{props:a,attrs:i,vnode:{patchFlag:s}}=e,o=bt(a),[u]=e.propsOptions;let l=!1;if((n||s>0)&&!(s&16)){if(s&8){const c=e.vnode.dynamicProps;for(let h=0;h<c.length;h++){let w=c[h];if(rf(e.emitsOptions,w))continue;const b=t[w];if(u)if(mt(i,w))b!==i[w]&&(i[w]=b,l=!0);else{const $=Yn(w);a[$]=ov(u,o,$,b,e,!1)}else b!==i[w]&&(i[w]=b,l=!0)}}}else{w$(e,t,a,i)&&(l=!0);let c;for(const h in o)(!t||!mt(t,h)&&((c=as(h))===h||!mt(t,c)))&&(u?r&&(r[h]!==void 0||r[c]!==void 0)&&(a[h]=ov(u,o,h,void 0,e,!0)):delete a[h]);if(i!==o)for(const h in i)(!t||!mt(t,h)&&!0)&&(delete i[h],l=!0)}l&&ga(e,"set","$attrs")}function w$(e,t,r,n){const[a,i]=e.propsOptions;let s=!1,o;if(t)for(let u in t){if(sc(u))continue;const l=t[u];let c;a&&mt(a,c=Yn(u))?!i||!i.includes(c)?r[c]=l:(o||(o={}))[c]=l:rf(e.emitsOptions,u)||(!(u in n)||l!==n[u])&&(n[u]=l,s=!0)}if(i){const u=bt(r),l=o||jt;for(let c=0;c<i.length;c++){const h=i[c];r[h]=ov(a,u,h,l[h],e,!mt(l,h))}}return s}function ov(e,t,r,n,a,i){const s=e[r];if(s!=null){const o=mt(s,"default");if(o&&n===void 0){const u=s.default;if(s.type!==Function&&lt(u)){const{propsDefaults:l}=a;r in l?n=l[r]:(oo(a),n=l[r]=u.call(null,t),Yi())}else n=u}s[0]&&(i&&!o?n=!1:s[1]&&(n===""||n===as(r))&&(n=!0))}return n}function _$(e,t,r=!1){const n=t.propsCache,a=n.get(e);if(a)return a;const i=e.props,s={},o=[];let u=!1;if(!lt(e)){const c=h=>{u=!0;const[w,b]=_$(h,t,!0);Sr(s,w),b&&o.push(...b)};!r&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!i&&!u)return Wt(e)&&n.set(e,Ks),Ks;if(it(i))for(let c=0;c<i.length;c++){const h=Yn(i[c]);Qg(h)&&(s[h]=jt)}else if(i)for(const c in i){const h=Yn(c);if(Qg(h)){const w=i[c],b=s[h]=it(w)||lt(w)?{type:w}:w;if(b){const $=em(Boolean,b.type),A=em(String,b.type);b[0]=$>-1,b[1]=A<0||$<A,($>-1||mt(b,"default"))&&o.push(h)}}}const l=[s,o];return Wt(e)&&n.set(e,l),l}function Qg(e){return e[0]!=="$"}function Xg(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function Zg(e,t){return Xg(e)===Xg(t)}function em(e,t){return it(t)?t.findIndex(r=>Zg(r,e)):lt(t)&&Zg(t,e)?0:-1}const S$=e=>e[0]==="_"||e==="$stable",Hh=e=>it(e)?e.map(Hn):[Hn(e)],RR=(e,t,r)=>{if(t._n)return t;const n=ui((...a)=>Hh(t(...a)),r);return n._c=!1,n},$$=(e,t,r)=>{const n=e._ctx;for(const a in e){if(S$(a))continue;const i=e[a];if(lt(i))t[a]=RR(a,i,n);else if(i!=null){const s=Hh(i);t[a]=()=>s}}},T$=(e,t)=>{const r=Hh(t);e.slots.default=()=>r},AR=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=bt(t),bc(t,"_",r)):$$(t,e.slots={})}else e.slots={},t&&T$(e,t);bc(e.slots,uf,1)},OR=(e,t,r)=>{const{vnode:n,slots:a}=e;let i=!0,s=jt;if(n.shapeFlag&32){const o=t._;o?r&&o===1?i=!1:(Sr(a,t),!r&&o===1&&delete a._):(i=!t.$stable,$$(t,a)),s=t}else t&&(T$(e,t),s={default:1});if(i)for(const o in a)!S$(o)&&!(o in s)&&delete a[o]};function k$(){return{app:null,config:{isNativeTag:rI,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let PR=0;function MR(e,t){return function(n,a=null){lt(n)||(n=Object.assign({},n)),a!=null&&!Wt(a)&&(a=null);const i=k$(),s=new Set;let o=!1;const u=i.app={_uid:PR++,_component:n,_props:a,_container:null,_context:i,_instance:null,version:QR,get config(){return i.config},set config(l){},use(l,...c){return s.has(l)||(l&&lt(l.install)?(s.add(l),l.install(u,...c)):lt(l)&&(s.add(l),l(u,...c))),u},mixin(l){return i.mixins.includes(l)||i.mixins.push(l),u},component(l,c){return c?(i.components[l]=c,u):i.components[l]},directive(l,c){return c?(i.directives[l]=c,u):i.directives[l]},mount(l,c,h){if(!o){const w=Ht(n,a);return w.appContext=i,c&&t?t(w,l):e(w,l,h),o=!0,u._container=l,l.__vue_app__=u,lf(w.component)||w.component.proxy}},unmount(){o&&(e(null,u._container),delete u._container.__vue_app__)},provide(l,c){return i.provides[l]=c,u}};return u}}function uv(e,t,r,n,a=!1){if(it(e)){e.forEach((w,b)=>uv(w,t&&(it(t)?t[b]:t),r,n,a));return}if(vu(n)&&!a)return;const i=n.shapeFlag&4?lf(n.component)||n.component.proxy:n.el,s=a?null:i,{i:o,r:u}=e,l=t&&t.r,c=o.refs===jt?o.refs={}:o.refs,h=o.setupState;if(l!=null&&l!==u&&(ur(l)?(c[l]=null,mt(h,l)&&(h[l]=null)):Qt(l)&&(l.value=null)),lt(u))ri(u,o,12,[s,c]);else{const w=ur(u),b=Qt(u);if(w||b){const $=()=>{if(e.f){const A=w?c[u]:u.value;a?it(A)&&Ih(A,i):it(A)?A.includes(i)||A.push(i):w?(c[u]=[i],mt(h,u)&&(h[u]=c[u])):(u.value=[i],e.k&&(c[e.k]=u.value))}else w?(c[u]=s,mt(h,u)&&(h[u]=s)):b&&(u.value=s,e.k&&(c[e.k]=s))};s?($.id=-1,jr($,r)):$()}}}const jr=aR;function xR(e){return NR(e)}function NR(e,t){const r=uI();r.__VUE__=!0;const{insert:n,remove:a,patchProp:i,createElement:s,createText:o,createComment:u,setText:l,setElementText:c,parentNode:h,nextSibling:w,setScopeId:b=Pn,cloneNode:$,insertStaticContent:A}=e,x=(R,C,Y,pe=null,z=null,Oe=null,be=!1,we=null,Ae=!!C.dynamicChildren)=>{if(R===C)return;R&&!qi(R,C)&&(pe=he(R),Xe(R,z,Oe,!0),R=null),C.patchFlag===-2&&(Ae=!1,C.dynamicChildren=null);const{type:ee,ref:Fe,shapeFlag:Ue}=C;switch(ee){case Wh:U(R,C,Y,pe);break;case vn:B(R,C,Y,pe);break;case lc:R==null&&ve(C,Y,pe,be);break;case dr:re(R,C,Y,pe,z,Oe,be,we,Ae);break;default:Ue&1?ke(R,C,Y,pe,z,Oe,be,we,Ae):Ue&6?H(R,C,Y,pe,z,Oe,be,we,Ae):(Ue&64||Ue&128)&&ee.process(R,C,Y,pe,z,Oe,be,we,Ae,Qe)}Fe!=null&&z&&uv(Fe,R&&R.ref,Oe,C||R,!C)},U=(R,C,Y,pe)=>{if(R==null)n(C.el=o(C.children),Y,pe);else{const z=C.el=R.el;C.children!==R.children&&l(z,C.children)}},B=(R,C,Y,pe)=>{R==null?n(C.el=u(C.children||""),Y,pe):C.el=R.el},ve=(R,C,Y,pe)=>{[R.el,R.anchor]=A(R.children,C,Y,pe,R.el,R.anchor)},se=({el:R,anchor:C},Y,pe)=>{let z;for(;R&&R!==C;)z=w(R),n(R,Y,pe),R=z;n(C,Y,pe)},Re=({el:R,anchor:C})=>{let Y;for(;R&&R!==C;)Y=w(R),a(R),R=Y;a(C)},ke=(R,C,Y,pe,z,Oe,be,we,Ae)=>{be=be||C.type==="svg",R==null?de(C,Y,pe,z,Oe,be,we,Ae):le(R,C,z,Oe,be,we,Ae)},de=(R,C,Y,pe,z,Oe,be,we)=>{let Ae,ee;const{type:Fe,props:Ue,shapeFlag:Pe,transition:oe,patchFlag:F,dirs:G}=R;if(R.el&&$!==void 0&&F===-1)Ae=R.el=$(R.el);else{if(Ae=R.el=s(R.type,Oe,Ue&&Ue.is,Ue),Pe&8?c(Ae,R.children):Pe&16&&te(R.children,Ae,null,pe,z,Oe&&Fe!=="foreignObject",be,we),G&&Ai(R,null,pe,"created"),Ue){for(const ye in Ue)ye!=="value"&&!sc(ye)&&i(Ae,ye,null,Ue[ye],Oe,R.children,pe,z,Te);"value"in Ue&&i(Ae,"value",null,Ue.value),(ee=Ue.onVnodeBeforeMount)&&Bn(ee,pe,R)}P(Ae,R,R.scopeId,be,pe)}G&&Ai(R,null,pe,"beforeMount");const Q=(!z||z&&!z.pendingBranch)&&oe&&!oe.persisted;Q&&oe.beforeEnter(Ae),n(Ae,C,Y),((ee=Ue&&Ue.onVnodeMounted)||Q||G)&&jr(()=>{ee&&Bn(ee,pe,R),Q&&oe.enter(Ae),G&&Ai(R,null,pe,"mounted")},z)},P=(R,C,Y,pe,z)=>{if(Y&&b(R,Y),pe)for(let Oe=0;Oe<pe.length;Oe++)b(R,pe[Oe]);if(z){let Oe=z.subTree;if(C===Oe){const be=z.vnode;P(R,be,be.scopeId,be.slotScopeIds,z.parent)}}},te=(R,C,Y,pe,z,Oe,be,we,Ae=0)=>{for(let ee=Ae;ee<R.length;ee++){const Fe=R[ee]=we?Ka(R[ee]):Hn(R[ee]);x(null,Fe,C,Y,pe,z,Oe,be,we)}},le=(R,C,Y,pe,z,Oe,be)=>{const we=C.el=R.el;let{patchFlag:Ae,dynamicChildren:ee,dirs:Fe}=C;Ae|=R.patchFlag&16;const Ue=R.props||jt,Pe=C.props||jt;let oe;Y&&Oi(Y,!1),(oe=Pe.onVnodeBeforeUpdate)&&Bn(oe,Y,C,R),Fe&&Ai(C,R,Y,"beforeUpdate"),Y&&Oi(Y,!0);const F=z&&C.type!=="foreignObject";if(ee?J(R.dynamicChildren,ee,we,Y,pe,F,Oe):be||N(R,C,we,null,Y,pe,F,Oe,!1),Ae>0){if(Ae&16)xe(we,C,Ue,Pe,Y,pe,z);else if(Ae&2&&Ue.class!==Pe.class&&i(we,"class",null,Pe.class,z),Ae&4&&i(we,"style",Ue.style,Pe.style,z),Ae&8){const G=C.dynamicProps;for(let Q=0;Q<G.length;Q++){const ye=G[Q],Ne=Ue[ye],qe=Pe[ye];(qe!==Ne||ye==="value")&&i(we,ye,Ne,qe,z,R.children,Y,pe,Te)}}Ae&1&&R.children!==C.children&&c(we,C.children)}else!be&&ee==null&&xe(we,C,Ue,Pe,Y,pe,z);((oe=Pe.onVnodeUpdated)||Fe)&&jr(()=>{oe&&Bn(oe,Y,C,R),Fe&&Ai(C,R,Y,"updated")},pe)},J=(R,C,Y,pe,z,Oe,be)=>{for(let we=0;we<C.length;we++){const Ae=R[we],ee=C[we],Fe=Ae.el&&(Ae.type===dr||!qi(Ae,ee)||Ae.shapeFlag&70)?h(Ae.el):Y;x(Ae,ee,Fe,null,pe,z,Oe,be,!0)}},xe=(R,C,Y,pe,z,Oe,be)=>{if(Y!==pe){for(const we in pe){if(sc(we))continue;const Ae=pe[we],ee=Y[we];Ae!==ee&&we!=="value"&&i(R,we,ee,Ae,be,C.children,z,Oe,Te)}if(Y!==jt)for(const we in Y)!sc(we)&&!(we in pe)&&i(R,we,Y[we],null,be,C.children,z,Oe,Te);"value"in pe&&i(R,"value",Y.value,pe.value)}},re=(R,C,Y,pe,z,Oe,be,we,Ae)=>{const ee=C.el=R?R.el:o(""),Fe=C.anchor=R?R.anchor:o("");let{patchFlag:Ue,dynamicChildren:Pe,slotScopeIds:oe}=C;oe&&(we=we?we.concat(oe):oe),R==null?(n(ee,Y,pe),n(Fe,Y,pe),te(C.children,Y,Fe,z,Oe,be,we,Ae)):Ue>0&&Ue&64&&Pe&&R.dynamicChildren?(J(R.dynamicChildren,Pe,Y,z,Oe,be,we),(C.key!=null||z&&C===z.subTree)&&E$(R,C,!0)):N(R,C,Y,Fe,z,Oe,be,we,Ae)},H=(R,C,Y,pe,z,Oe,be,we,Ae)=>{C.slotScopeIds=we,R==null?C.shapeFlag&512?z.ctx.activate(C,Y,pe,be,Ae):ue(C,Y,pe,z,Oe,be,Ae):W(R,C,Ae)},ue=(R,C,Y,pe,z,Oe,be)=>{const we=R.component=WR(R,pe,z);if(af(R)&&(we.ctx.renderer=Qe),GR(we),we.asyncDep){if(z&&z.registerDep(we,me),!R.el){const Ae=we.subTree=Ht(vn);B(null,Ae,C,Y)}return}me(we,R,C,Y,z,Oe,be)},W=(R,C,Y)=>{const pe=C.component=R.component;if(tR(R,C,Y))if(pe.asyncDep&&!pe.asyncResolved){_e(pe,C,Y);return}else pe.next=C,VI(pe.update),pe.update();else C.el=R.el,pe.vnode=C},me=(R,C,Y,pe,z,Oe,be)=>{const we=()=>{if(R.isMounted){let{next:Fe,bu:Ue,u:Pe,parent:oe,vnode:F}=R,G=Fe,Q;Oi(R,!1),Fe?(Fe.el=F.el,_e(R,Fe,be)):Fe=F,Ue&&oc(Ue),(Q=Fe.props&&Fe.props.onVnodeBeforeUpdate)&&Bn(Q,oe,Fe,F),Oi(R,!0);const ye=id(R),Ne=R.subTree;R.subTree=ye,x(Ne,ye,h(Ne.el),he(Ne),R,z,Oe),Fe.el=ye.el,G===null&&rR(R,ye.el),Pe&&jr(Pe,z),(Q=Fe.props&&Fe.props.onVnodeUpdated)&&jr(()=>Bn(Q,oe,Fe,F),z)}else{let Fe;const{el:Ue,props:Pe}=C,{bm:oe,m:F,parent:G}=R,Q=vu(C);if(Oi(R,!1),oe&&oc(oe),!Q&&(Fe=Pe&&Pe.onVnodeBeforeMount)&&Bn(Fe,G,C),Oi(R,!0),Ue&&Ge){const ye=()=>{R.subTree=id(R),Ge(Ue,R.subTree,R,z,null)};Q?C.type.__asyncLoader().then(()=>!R.isUnmounted&&ye()):ye()}else{const ye=R.subTree=id(R);x(null,ye,Y,pe,R,z,Oe),C.el=ye.el}if(F&&jr(F,z),!Q&&(Fe=Pe&&Pe.onVnodeMounted)){const ye=C;jr(()=>Bn(Fe,G,ye),z)}(C.shapeFlag&256||G&&vu(G.vnode)&&G.vnode.shapeFlag&256)&&R.a&&jr(R.a,z),R.isMounted=!0,C=Y=pe=null}},Ae=R.effect=new Ph(we,()=>Dh(ee),R.scope),ee=R.update=()=>Ae.run();ee.id=R.uid,Oi(R,!0),ee()},_e=(R,C,Y)=>{C.component=R;const pe=R.vnode.props;R.vnode=C,R.next=null,IR(R,C.props,pe,Y),OR(R,C.children,Y),mo(),Wg(),bo()},N=(R,C,Y,pe,z,Oe,be,we,Ae=!1)=>{const ee=R&&R.children,Fe=R?R.shapeFlag:0,Ue=C.children,{patchFlag:Pe,shapeFlag:oe}=C;if(Pe>0){if(Pe&128){dt(ee,Ue,Y,pe,z,Oe,be,we,Ae);return}else if(Pe&256){ft(ee,Ue,Y,pe,z,Oe,be,we,Ae);return}}oe&8?(Fe&16&&Te(ee,z,Oe),Ue!==ee&&c(Y,Ue)):Fe&16?oe&16?dt(ee,Ue,Y,pe,z,Oe,be,we,Ae):Te(ee,z,Oe,!0):(Fe&8&&c(Y,""),oe&16&&te(Ue,Y,pe,z,Oe,be,we,Ae))},ft=(R,C,Y,pe,z,Oe,be,we,Ae)=>{R=R||Ks,C=C||Ks;const ee=R.length,Fe=C.length,Ue=Math.min(ee,Fe);let Pe;for(Pe=0;Pe<Ue;Pe++){const oe=C[Pe]=Ae?Ka(C[Pe]):Hn(C[Pe]);x(R[Pe],oe,Y,null,z,Oe,be,we,Ae)}ee>Fe?Te(R,z,Oe,!0,!1,Ue):te(C,Y,pe,z,Oe,be,we,Ae,Ue)},dt=(R,C,Y,pe,z,Oe,be,we,Ae)=>{let ee=0;const Fe=C.length;let Ue=R.length-1,Pe=Fe-1;for(;ee<=Ue&&ee<=Pe;){const oe=R[ee],F=C[ee]=Ae?Ka(C[ee]):Hn(C[ee]);if(qi(oe,F))x(oe,F,Y,null,z,Oe,be,we,Ae);else break;ee++}for(;ee<=Ue&&ee<=Pe;){const oe=R[Ue],F=C[Pe]=Ae?Ka(C[Pe]):Hn(C[Pe]);if(qi(oe,F))x(oe,F,Y,null,z,Oe,be,we,Ae);else break;Ue--,Pe--}if(ee>Ue){if(ee<=Pe){const oe=Pe+1,F=oe<Fe?C[oe].el:pe;for(;ee<=Pe;)x(null,C[ee]=Ae?Ka(C[ee]):Hn(C[ee]),Y,F,z,Oe,be,we,Ae),ee++}}else if(ee>Pe)for(;ee<=Ue;)Xe(R[ee],z,Oe,!0),ee++;else{const oe=ee,F=ee,G=new Map;for(ee=F;ee<=Pe;ee++){const Le=C[ee]=Ae?Ka(C[ee]):Hn(C[ee]);Le.key!=null&&G.set(Le.key,ee)}let Q,ye=0;const Ne=Pe-F+1;let qe=!1,ze=0;const De=new Array(Ne);for(ee=0;ee<Ne;ee++)De[ee]=0;for(ee=oe;ee<=Ue;ee++){const Le=R[ee];if(ye>=Ne){Xe(Le,z,Oe,!0);continue}let Z;if(Le.key!=null)Z=G.get(Le.key);else for(Q=F;Q<=Pe;Q++)if(De[Q-F]===0&&qi(Le,C[Q])){Z=Q;break}Z===void 0?Xe(Le,z,Oe,!0):(De[Z-F]=ee+1,Z>=ze?ze=Z:qe=!0,x(Le,C[Z],Y,null,z,Oe,be,we,Ae),ye++)}const He=qe?LR(De):Ks;for(Q=He.length-1,ee=Ne-1;ee>=0;ee--){const Le=F+ee,Z=C[Le],ae=Le+1<Fe?C[Le+1].el:pe;De[ee]===0?x(null,Z,Y,ae,z,Oe,be,we,Ae):qe&&(Q<0||ee!==He[Q]?Ee(Z,Y,ae,2):Q--)}}},Ee=(R,C,Y,pe,z=null)=>{const{el:Oe,type:be,transition:we,children:Ae,shapeFlag:ee}=R;if(ee&6){Ee(R.component.subTree,C,Y,pe);return}if(ee&128){R.suspense.move(C,Y,pe);return}if(ee&64){be.move(R,C,Y,Qe);return}if(be===dr){n(Oe,C,Y);for(let Ue=0;Ue<Ae.length;Ue++)Ee(Ae[Ue],C,Y,pe);n(R.anchor,C,Y);return}if(be===lc){se(R,C,Y);return}if(pe!==2&&ee&1&&we)if(pe===0)we.beforeEnter(Oe),n(Oe,C,Y),jr(()=>we.enter(Oe),z);else{const{leave:Ue,delayLeave:Pe,afterLeave:oe}=we,F=()=>n(Oe,C,Y),G=()=>{Ue(Oe,()=>{F(),oe&&oe()})};Pe?Pe(Oe,F,G):G()}else n(Oe,C,Y)},Xe=(R,C,Y,pe=!1,z=!1)=>{const{type:Oe,props:be,ref:we,children:Ae,dynamicChildren:ee,shapeFlag:Fe,patchFlag:Ue,dirs:Pe}=R;if(we!=null&&uv(we,null,Y,R,!0),Fe&256){C.ctx.deactivate(R);return}const oe=Fe&1&&Pe,F=!vu(R);let G;if(F&&(G=be&&be.onVnodeBeforeUnmount)&&Bn(G,C,R),Fe&6)T(R.component,Y,pe);else{if(Fe&128){R.suspense.unmount(Y,pe);return}oe&&Ai(R,null,C,"beforeUnmount"),Fe&64?R.type.remove(R,C,Y,z,Qe,pe):ee&&(Oe!==dr||Ue>0&&Ue&64)?Te(ee,C,Y,!1,!0):(Oe===dr&&Ue&384||!z&&Fe&16)&&Te(Ae,C,Y),pe&&Ye(R)}(F&&(G=be&&be.onVnodeUnmounted)||oe)&&jr(()=>{G&&Bn(G,C,R),oe&&Ai(R,null,C,"unmounted")},Y)},Ye=R=>{const{type:C,el:Y,anchor:pe,transition:z}=R;if(C===dr){D(Y,pe);return}if(C===lc){Re(R);return}const Oe=()=>{a(Y),z&&!z.persisted&&z.afterLeave&&z.afterLeave()};if(R.shapeFlag&1&&z&&!z.persisted){const{leave:be,delayLeave:we}=z,Ae=()=>be(Y,Oe);we?we(R.el,Oe,Ae):Ae()}else Oe()},D=(R,C)=>{let Y;for(;R!==C;)Y=w(R),a(R),R=Y;a(C)},T=(R,C,Y)=>{const{bum:pe,scope:z,update:Oe,subTree:be,um:we}=R;pe&&oc(pe),z.stop(),Oe&&(Oe.active=!1,Xe(be,R,C,Y)),we&&jr(we,C),jr(()=>{R.isUnmounted=!0},C),C&&C.pendingBranch&&!C.isUnmounted&&R.asyncDep&&!R.asyncResolved&&R.suspenseId===C.pendingId&&(C.deps--,C.deps===0&&C.resolve())},Te=(R,C,Y,pe=!1,z=!1,Oe=0)=>{for(let be=Oe;be<R.length;be++)Xe(R[be],C,Y,pe,z)},he=R=>R.shapeFlag&6?he(R.component.subTree):R.shapeFlag&128?R.suspense.next():w(R.anchor||R.el),Ke=(R,C,Y)=>{R==null?C._vnode&&Xe(C._vnode,null,null,!0):x(C._vnode||null,R,C,null,null,null,Y),Wg(),s$(),C._vnode=R},Qe={p:x,um:Xe,m:Ee,r:Ye,mt:ue,mc:te,pc:N,pbc:J,n:he,o:e};let Se,Ge;return t&&([Se,Ge]=t(Qe)),{render:Ke,hydrate:Se,createApp:MR(Ke,Se)}}function Oi({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function E$(e,t,r=!1){const n=e.children,a=t.children;if(it(n)&&it(a))for(let i=0;i<n.length;i++){const s=n[i];let o=a[i];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=a[i]=Ka(a[i]),o.el=s.el),r||E$(s,o))}}function LR(e){const t=e.slice(),r=[0];let n,a,i,s,o;const u=e.length;for(n=0;n<u;n++){const l=e[n];if(l!==0){if(a=r[r.length-1],e[a]<l){t[n]=a,r.push(n);continue}for(i=0,s=r.length-1;i<s;)o=i+s>>1,e[r[o]]<l?i=o+1:s=o;l<e[r[i]]&&(i>0&&(t[n]=r[i-1]),r[i]=n)}}for(i=r.length,s=r[i-1];i-- >0;)r[i]=s,s=t[s];return r}const jR=e=>e.__isTeleport,dr=Symbol(void 0),Wh=Symbol(void 0),vn=Symbol(void 0),lc=Symbol(void 0),hu=[];let In=null;function st(e=!1){hu.push(In=e?null:[])}function UR(){hu.pop(),In=hu[hu.length-1]||null}let Au=1;function tm(e){Au+=e}function C$(e){return e.dynamicChildren=Au>0?In||Ks:null,UR(),Au>0&&In&&In.push(e),e}function yt(e,t,r,n,a,i){return C$(fe(e,t,r,n,a,i,!0))}function es(e,t,r,n,a){return C$(Ht(e,t,r,n,a,!0))}function Tc(e){return e?e.__v_isVNode===!0:!1}function qi(e,t){return e.type===t.type&&e.key===t.key}const uf="__vInternal",I$=({key:e})=>e!=null?e:null,cc=({ref:e,ref_key:t,ref_for:r})=>e!=null?ur(e)||Qt(e)||lt(e)?{i:_r,r:e,k:t,f:!!r}:e:null;function fe(e,t=null,r=null,n=0,a=null,i=e===dr?0:1,s=!1,o=!1){const u={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&I$(t),ref:t&&cc(t),scopeId:nf,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:a,dynamicChildren:null,appContext:null};return o?(Gh(u,r),i&128&&e.normalize(u)):r&&(u.shapeFlag|=ur(r)?8:16),Au>0&&!s&&In&&(u.patchFlag>0||i&6)&&u.patchFlag!==32&&In.push(u),u}const Ht=FR;function FR(e,t=null,r=null,n=0,a=null,i=!1){if((!e||e===mR)&&(e=vn),Tc(e)){const o=ci(e,t,!0);return r&&Gh(o,r),Au>0&&!i&&In&&(o.shapeFlag&6?In[In.indexOf(e)]=o:In.push(o)),o.patchFlag|=-2,o}if(YR(e)&&(e=e.__vccOpts),t){t=DR(t);let{class:o,style:u}=t;o&&!ur(o)&&(t.class=Vn(o)),Wt(u)&&(Q0(u)&&!it(u)&&(u=Sr({},u)),t.style=Eh(u))}const s=ur(e)?1:nR(e)?128:jR(e)?64:Wt(e)?4:lt(e)?2:0;return fe(e,t,r,n,a,s,i,!0)}function DR(e){return e?Q0(e)||uf in e?Sr({},e):e:null}function ci(e,t,r=!1){const{props:n,ref:a,patchFlag:i,children:s}=e,o=t?BR(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:o,key:o&&I$(o),ref:t&&t.ref?r&&a?it(a)?a.concat(cc(t)):[a,cc(t)]:cc(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==dr?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ci(e.ssContent),ssFallback:e.ssFallback&&ci(e.ssFallback),el:e.el,anchor:e.anchor}}function Zt(e=" ",t=0){return Ht(Wh,null,e,t)}function R$(e,t){const r=Ht(lc,null,e);return r.staticCount=t,r}function ir(e="",t=!1){return t?(st(),es(vn,null,e)):Ht(vn,null,e)}function Hn(e){return e==null||typeof e=="boolean"?Ht(vn):it(e)?Ht(dr,null,e.slice()):typeof e=="object"?Ka(e):Ht(Wh,null,String(e))}function Ka(e){return e.el===null||e.memo?e:ci(e)}function Gh(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(it(t))r=16;else if(typeof t=="object")if(n&65){const a=t.default;a&&(a._c&&(a._d=!1),Gh(e,a()),a._c&&(a._d=!0));return}else{r=32;const a=t._;!a&&!(uf in t)?t._ctx=_r:a===3&&_r&&(_r.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else lt(t)?(t={default:t,_ctx:_r},r=32):(t=String(t),n&64?(r=16,t=[Zt(t)]):r=8);e.children=t,e.shapeFlag|=r}function BR(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const a in n)if(a==="class")t.class!==n.class&&(t.class=Vn([t.class,n.class]));else if(a==="style")t.style=Eh([t.style,n.style]);else if(Yc(a)){const i=t[a],s=n[a];s&&i!==s&&!(it(i)&&i.includes(s))&&(t[a]=i?[].concat(i,s):s)}else a!==""&&(t[a]=n[a])}return t}function Bn(e,t,r,n=null){pn(e,t,7,[r,n])}const qR=k$();let HR=0;function WR(e,t,r){const n=e.type,a=(t?t.appContext:e.appContext)||qR,i={uid:HR++,vnode:e,type:n,parent:t,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,scope:new U0(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(a.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:_$(n,a),emitsOptions:u$(n,a),emit:null,emitted:null,propsDefaults:jt,inheritAttrs:n.inheritAttrs,ctx:jt,data:jt,props:jt,attrs:jt,slots:jt,refs:jt,setupState:jt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=YI.bind(null,i),e.ce&&e.ce(i),i}let sr=null;const zh=()=>sr||_r,oo=e=>{sr=e,e.scope.on()},Yi=()=>{sr&&sr.scope.off(),sr=null};function A$(e){return e.vnode.shapeFlag&4}let Ou=!1;function GR(e,t=!1){Ou=t;const{props:r,children:n}=e.vnode,a=A$(e);CR(e,r,a,t),AR(e,n);const i=a?zR(e,t):void 0;return Ou=!1,i}function zR(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=so(new Proxy(e.ctx,_R));const{setup:n}=r;if(n){const a=e.setupContext=n.length>1?KR(e):null;oo(e),mo();const i=ri(n,e,0,[e.props,a]);if(bo(),Yi(),N0(i)){if(i.then(Yi,Yi),t)return i.then(s=>{rm(e,s,t)}).catch(s=>{tf(s,e,0)});e.asyncDep=i}else rm(e,i,t)}else O$(e,t)}function rm(e,t,r){lt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Wt(t)&&(e.setupState=r$(t)),O$(e,r)}let nm;function O$(e,t,r){const n=e.type;if(!e.render){if(!t&&nm&&!n.render){const a=n.template||qh(e).template;if(a){const{isCustomElement:i,compilerOptions:s}=e.appContext.config,{delimiters:o,compilerOptions:u}=n,l=Sr(Sr({isCustomElement:i,delimiters:o},s),u);n.render=nm(a,l)}}e.render=n.render||Pn}oo(e),mo(),SR(e),bo(),Yi()}function VR(e){return new Proxy(e.attrs,{get(t,r){return Jr(e,"get","$attrs"),t[r]}})}function KR(e){const t=n=>{e.exposed=n||{}};let r;return{get attrs(){return r||(r=VR(e))},slots:e.slots,emit:e.emit,expose:t}}function lf(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(r$(so(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in Sc)return Sc[r](e)}}))}function JR(e,t=!0){return lt(e)?e.displayName||e.name:e.name||t&&e.__name}function YR(e){return lt(e)&&"__vccOpts"in e}const Bt=(e,t)=>WI(e,t,Ou);function P$(e,t,r){const n=arguments.length;return n===2?Wt(t)&&!it(t)?Tc(t)?Ht(e,null,[t]):Ht(e,t):Ht(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Tc(r)&&(r=[r]),Ht(e,t,r))}const QR="3.2.39",XR="http://www.w3.org/2000/svg",Hi=typeof document<"u"?document:null,am=Hi&&Hi.createElement("template"),ZR={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const a=t?Hi.createElementNS(XR,e):Hi.createElement(e,r?{is:r}:void 0);return e==="select"&&n&&n.multiple!=null&&a.setAttribute("multiple",n.multiple),a},createText:e=>Hi.createTextNode(e),createComment:e=>Hi.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Hi.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,r,n,a,i){const s=r?r.previousSibling:t.lastChild;if(a&&(a===i||a.nextSibling))for(;t.insertBefore(a.cloneNode(!0),r),!(a===i||!(a=a.nextSibling)););else{am.innerHTML=n?`<svg>${e}</svg>`:e;const o=am.content;if(n){const u=o.firstChild;for(;u.firstChild;)o.appendChild(u.firstChild);o.removeChild(u)}t.insertBefore(o,r)}return[s?s.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function eA(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function tA(e,t,r){const n=e.style,a=ur(r);if(r&&!a){for(const i in r)lv(n,i,r[i]);if(t&&!ur(t))for(const i in t)r[i]==null&&lv(n,i,"")}else{const i=n.display;a?t!==r&&(n.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=i)}}const im=/\s*!important$/;function lv(e,t,r){if(it(r))r.forEach(n=>lv(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=rA(e,t);im.test(r)?e.setProperty(as(n),r.replace(im,""),"important"):e[n]=r}}const sm=["Webkit","Moz","ms"],od={};function rA(e,t){const r=od[t];if(r)return r;let n=Yn(t);if(n!=="filter"&&n in e)return od[t]=n;n=Zc(n);for(let a=0;a<sm.length;a++){const i=sm[a]+n;if(i in e)return od[t]=i}return t}const om="http://www.w3.org/1999/xlink";function nA(e,t,r,n,a){if(n&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(om,t.slice(6,t.length)):e.setAttributeNS(om,t,r);else{const i=XC(t);r==null||i&&!P0(r)?e.removeAttribute(t):e.setAttribute(t,i?"":r)}}function aA(e,t,r,n,a,i,s){if(t==="innerHTML"||t==="textContent"){n&&s(n,a,i),e[t]=r==null?"":r;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const u=r==null?"":r;(e.value!==u||e.tagName==="OPTION")&&(e.value=u),r==null&&e.removeAttribute(t);return}let o=!1;if(r===""||r==null){const u=typeof e[t];u==="boolean"?r=P0(r):r==null&&u==="string"?(r="",o=!0):u==="number"&&(r=0,o=!0)}try{e[t]=r}catch{}o&&e.removeAttribute(t)}const[M$,iA]=(()=>{let e=Date.now,t=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const r=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(r&&Number(r[1])<=53)}return[e,t]})();let cv=0;const sA=Promise.resolve(),oA=()=>{cv=0},uA=()=>cv||(sA.then(oA),cv=M$());function Fs(e,t,r,n){e.addEventListener(t,r,n)}function lA(e,t,r,n){e.removeEventListener(t,r,n)}function cA(e,t,r,n,a=null){const i=e._vei||(e._vei={}),s=i[t];if(n&&s)s.value=n;else{const[o,u]=fA(t);if(n){const l=i[t]=dA(n,a);Fs(e,o,l,u)}else s&&(lA(e,o,s,u),i[t]=void 0)}}const um=/(?:Once|Passive|Capture)$/;function fA(e){let t;if(um.test(e)){t={};let n;for(;n=e.match(um);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):as(e.slice(2)),t]}function dA(e,t){const r=n=>{const a=n.timeStamp||M$();(iA||a>=r.attached-1)&&pn(pA(n,r.value),t,5,[n])};return r.value=e,r.attached=uA(),r}function pA(e,t){if(it(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>a=>!a._stopped&&n&&n(a))}else return t}const lm=/^on[a-z]/,vA=(e,t,r,n,a=!1,i,s,o,u)=>{t==="class"?eA(e,n,a):t==="style"?tA(e,r,n):Yc(t)?Ch(t)||cA(e,t,r,n,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):hA(e,t,n,a))?aA(e,t,n,i,s,o,u):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),nA(e,t,n,a))};function hA(e,t,r,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&lm.test(t)&&lt(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||lm.test(t)&&ur(r)?!1:t in e}const yA={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};uR.props;const cm=e=>{const t=e.props["onUpdate:modelValue"]||!1;return it(t)?r=>oc(t,r):t};function gA(e){e.target.composing=!0}function fm(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const x$={created(e,{modifiers:{lazy:t,trim:r,number:n}},a){e._assign=cm(a);const i=n||a.props&&a.props.type==="number";Fs(e,t?"change":"input",s=>{if(s.target.composing)return;let o=e.value;r&&(o=o.trim()),i&&(o=Yp(o)),e._assign(o)}),r&&Fs(e,"change",()=>{e.value=e.value.trim()}),t||(Fs(e,"compositionstart",gA),Fs(e,"compositionend",fm),Fs(e,"change",fm))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:n,number:a}},i){if(e._assign=cm(i),e.composing||document.activeElement===e&&e.type!=="range"&&(r||n&&e.value.trim()===t||(a||e.type==="number")&&Yp(e.value)===t))return;const s=t==null?"":t;e.value!==s&&(e.value=s)}},mA=["ctrl","shift","alt","meta"],bA={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>mA.some(r=>e[`${r}Key`]&&!t.includes(r))},wA=(e,t)=>(r,...n)=>{for(let a=0;a<t.length;a++){const i=bA[t[a]];if(i&&i(r,t))return}return e(r,...n)},_A={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},SA=(e,t)=>r=>{if(!("key"in r))return;const n=as(r.key);if(t.some(a=>a===n||_A[a]===n))return e(r)},Lt={beforeMount(e,{value:t},{transition:r}){e._vod=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):Go(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),Go(e,!0),n.enter(e)):n.leave(e,()=>{Go(e,!1)}):Go(e,t))},beforeUnmount(e,{value:t}){Go(e,t)}};function Go(e,t){e.style.display=t?e._vod:"none"}const $A=Sr({patchProp:vA},ZR);let dm;function TA(){return dm||(dm=xR($A))}const kA=(...e)=>{const t=TA().createApp(...e),{mount:r}=t;return t.mount=n=>{const a=EA(n);if(!a)return;const i=t._component;!lt(i)&&!i.render&&!i.template&&(i.template=a.innerHTML),a.innerHTML="";const s=r(a,!1,a instanceof SVGElement);return a instanceof Element&&(a.removeAttribute("v-cloak"),a.setAttribute("data-v-app","")),s},t};function EA(e){return ur(e)?document.querySelector(e):e}var CA=!1;/*!
  * pinia v2.0.22
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let N$;const cf=e=>N$=e,L$=Symbol();function fv(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var yu;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(yu||(yu={}));function IA(){const e=F0(!0),t=e.run(()=>vt({}));let r=[],n=[];const a=so({install(i){cf(a),a._a=i,i.provide(L$,a),i.config.globalProperties.$pinia=a,n.forEach(s=>r.push(s)),n=[]},use(i){return!this._a&&!CA?n.push(i):r.push(i),this},_p:r,_a:null,_e:e,_s:new Map,state:t});return a}const j$=()=>{};function pm(e,t,r,n=j$){e.push(t);const a=()=>{const i=e.indexOf(t);i>-1&&(e.splice(i,1),n())};return!r&&zh()&&Bh(a),a}function ks(e,...t){e.slice().forEach(r=>{r(...t)})}function dv(e,t){e instanceof Map&&t instanceof Map&&t.forEach((r,n)=>e.set(n,r)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const r in t){if(!t.hasOwnProperty(r))continue;const n=t[r],a=e[r];fv(a)&&fv(n)&&e.hasOwnProperty(r)&&!Qt(n)&&!ti(n)?e[r]=dv(a,n):e[r]=n}return e}const RA=Symbol();function AA(e){return!fv(e)||!e.hasOwnProperty(RA)}const{assign:ca}=Object;function OA(e){return!!(Qt(e)&&e.effect)}function PA(e,t,r,n){const{state:a,actions:i,getters:s}=t,o=r.state.value[e];let u;function l(){o||(r.state.value[e]=a?a():{});const c=DI(r.state.value[e]);return ca(c,i,Object.keys(s||{}).reduce((h,w)=>(h[w]=so(Bt(()=>{cf(r);const b=r._s.get(e);return s[w].call(b,b)})),h),{}))}return u=U$(e,l,t,r,n,!0),u.$reset=function(){const h=a?a():{};this.$patch(w=>{ca(w,h)})},u}function U$(e,t,r={},n,a,i){let s;const o=ca({actions:{}},r),u={deep:!0};let l,c,h=so([]),w=so([]),b;const $=n.state.value[e];!i&&!$&&(n.state.value[e]={}),vt({});let A;function x(de){let P;l=c=!1,typeof de=="function"?(de(n.state.value[e]),P={type:yu.patchFunction,storeId:e,events:b}):(dv(n.state.value[e],de),P={type:yu.patchObject,payload:de,storeId:e,events:b});const te=A=Symbol();Fh().then(()=>{A===te&&(l=!0)}),c=!0,ks(h,P,n.state.value[e])}const U=j$;function B(){s.stop(),h=[],w=[],n._s.delete(e)}function ve(de,P){return function(){cf(n);const te=Array.from(arguments),le=[],J=[];function xe(ue){le.push(ue)}function re(ue){J.push(ue)}ks(w,{args:te,name:de,store:Re,after:xe,onError:re});let H;try{H=P.apply(this&&this.$id===e?this:Re,te)}catch(ue){throw ks(J,ue),ue}return H instanceof Promise?H.then(ue=>(ks(le,ue),ue)).catch(ue=>(ks(J,ue),Promise.reject(ue))):(ks(le,H),H)}}const se={_p:n,$id:e,$onAction:pm.bind(null,w),$patch:x,$reset:U,$subscribe(de,P={}){const te=pm(h,de,P.detached,()=>le()),le=s.run(()=>Ji(()=>n.state.value[e],J=>{(P.flush==="sync"?c:l)&&de({storeId:e,type:yu.direct,events:b},J)},ca({},u,P)));return te},$dispose:B},Re=is(ca({},se));n._s.set(e,Re);const ke=n._e.run(()=>(s=F0(),s.run(()=>t())));for(const de in ke){const P=ke[de];if(Qt(P)&&!OA(P)||ti(P))i||($&&AA(P)&&(Qt(P)?P.value=$[de]:dv(P,$[de])),n.state.value[e][de]=P);else if(typeof P=="function"){const te=ve(de,P);ke[de]=te,o.actions[de]=P}}return ca(Re,ke),ca(bt(Re),ke),Object.defineProperty(Re,"$state",{get:()=>n.state.value[e],set:de=>{x(P=>{ca(P,de)})}}),n._p.forEach(de=>{ca(Re,s.run(()=>de({store:Re,app:n._a,pinia:n,options:o})))}),$&&i&&r.hydrate&&r.hydrate(Re.$state,$),l=!0,c=!0,Re}function MA(e,t,r){let n,a;const i=typeof t=="function";typeof e=="string"?(n=e,a=i?r:t):(a=e,n=e.id);function s(o,u){const l=zh();return o=o||l&&Mn(L$),o&&cf(o),o=N$,o._s.has(n)||(i?U$(n,t,a,o):PA(n,a,o)),o._s.get(n)}return s.$id=n,s}/*!
  * vue-router v4.1.5
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Ds=typeof window<"u";function xA(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Rt=Object.assign;function ud(e,t){const r={};for(const n in t){const a=t[n];r[n]=xn(a)?a.map(e):e(a)}return r}const gu=()=>{},xn=Array.isArray,NA=/\/$/,LA=e=>e.replace(NA,"");function ld(e,t,r="/"){let n,a={},i="",s="";const o=t.indexOf("#");let u=t.indexOf("?");return o<u&&o>=0&&(u=-1),u>-1&&(n=t.slice(0,u),i=t.slice(u+1,o>-1?o:t.length),a=e(i)),o>-1&&(n=n||t.slice(0,o),s=t.slice(o,t.length)),n=DA(n!=null?n:t,r),{fullPath:n+(i&&"?")+i+s,path:n,query:a,hash:s}}function jA(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function vm(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function UA(e,t,r){const n=t.matched.length-1,a=r.matched.length-1;return n>-1&&n===a&&uo(t.matched[n],r.matched[a])&&F$(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function uo(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function F$(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!FA(e[r],t[r]))return!1;return!0}function FA(e,t){return xn(e)?hm(e,t):xn(t)?hm(t,e):e===t}function hm(e,t){return xn(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function DA(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/");let a=r.length-1,i,s;for(i=0;i<n.length;i++)if(s=n[i],s!==".")if(s==="..")a>1&&a--;else break;return r.slice(0,a).join("/")+"/"+n.slice(i-(i===n.length?1:0)).join("/")}var Pu;(function(e){e.pop="pop",e.push="push"})(Pu||(Pu={}));var mu;(function(e){e.back="back",e.forward="forward",e.unknown=""})(mu||(mu={}));function BA(e){if(!e)if(Ds){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),LA(e)}const qA=/^[^#]+#/;function HA(e,t){return e.replace(qA,"#")+t}function WA(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const ff=()=>({left:window.pageXOffset,top:window.pageYOffset});function GA(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),a=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!a)return;t=WA(a,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function ym(e,t){return(history.state?history.state.position-t:-1)+e}const pv=new Map;function zA(e,t){pv.set(e,t)}function VA(e){const t=pv.get(e);return pv.delete(e),t}let KA=()=>location.protocol+"//"+location.host;function D$(e,t){const{pathname:r,search:n,hash:a}=t,i=e.indexOf("#");if(i>-1){let o=a.includes(e.slice(i))?e.slice(i).length:1,u=a.slice(o);return u[0]!=="/"&&(u="/"+u),vm(u,"")}return vm(r,e)+n+a}function JA(e,t,r,n){let a=[],i=[],s=null;const o=({state:w})=>{const b=D$(e,location),$=r.value,A=t.value;let x=0;if(w){if(r.value=b,t.value=w,s&&s===$){s=null;return}x=A?w.position-A.position:0}else n(b);a.forEach(U=>{U(r.value,$,{delta:x,type:Pu.pop,direction:x?x>0?mu.forward:mu.back:mu.unknown})})};function u(){s=r.value}function l(w){a.push(w);const b=()=>{const $=a.indexOf(w);$>-1&&a.splice($,1)};return i.push(b),b}function c(){const{history:w}=window;!w.state||w.replaceState(Rt({},w.state,{scroll:ff()}),"")}function h(){for(const w of i)w();i=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",c),{pauseListeners:u,listen:l,destroy:h}}function gm(e,t,r,n=!1,a=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:a?ff():null}}function YA(e){const{history:t,location:r}=window,n={value:D$(e,r)},a={value:t.state};a.value||i(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(u,l,c){const h=e.indexOf("#"),w=h>-1?(r.host&&document.querySelector("base")?e:e.slice(h))+u:KA()+e+u;try{t[c?"replaceState":"pushState"](l,"",w),a.value=l}catch(b){console.error(b),r[c?"replace":"assign"](w)}}function s(u,l){const c=Rt({},t.state,gm(a.value.back,u,a.value.forward,!0),l,{position:a.value.position});i(u,c,!0),n.value=u}function o(u,l){const c=Rt({},a.value,t.state,{forward:u,scroll:ff()});i(c.current,c,!0);const h=Rt({},gm(n.value,u,null),{position:c.position+1},l);i(u,h,!1),n.value=u}return{location:n,state:a,push:o,replace:s}}function QA(e){e=BA(e);const t=YA(e),r=JA(e,t.state,t.location,t.replace);function n(i,s=!0){s||r.pauseListeners(),history.go(i)}const a=Rt({location:"",base:e,go:n,createHref:HA.bind(null,e)},t,r);return Object.defineProperty(a,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(a,"state",{enumerable:!0,get:()=>t.state.value}),a}function XA(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),QA(e)}function ZA(e){return typeof e=="string"||e&&typeof e=="object"}function B$(e){return typeof e=="string"||typeof e=="symbol"}const qa={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},q$=Symbol("");var mm;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(mm||(mm={}));function lo(e,t){return Rt(new Error,{type:e,[q$]:!0},t)}function sa(e,t){return e instanceof Error&&q$ in e&&(t==null||!!(e.type&t))}const bm="[^/]+?",eO={sensitive:!1,strict:!1,start:!0,end:!0},tO=/[.+*?^${}()[\]/\\]/g;function rO(e,t){const r=Rt({},eO,t),n=[];let a=r.start?"^":"";const i=[];for(const l of e){const c=l.length?[]:[90];r.strict&&!l.length&&(a+="/");for(let h=0;h<l.length;h++){const w=l[h];let b=40+(r.sensitive?.25:0);if(w.type===0)h||(a+="/"),a+=w.value.replace(tO,"\\$&"),b+=40;else if(w.type===1){const{value:$,repeatable:A,optional:x,regexp:U}=w;i.push({name:$,repeatable:A,optional:x});const B=U||bm;if(B!==bm){b+=10;try{new RegExp(`(${B})`)}catch(se){throw new Error(`Invalid custom RegExp for param "${$}" (${B}): `+se.message)}}let ve=A?`((?:${B})(?:/(?:${B}))*)`:`(${B})`;h||(ve=x&&l.length<2?`(?:/${ve})`:"/"+ve),x&&(ve+="?"),a+=ve,b+=20,x&&(b+=-8),A&&(b+=-20),B===".*"&&(b+=-50)}c.push(b)}n.push(c)}if(r.strict&&r.end){const l=n.length-1;n[l][n[l].length-1]+=.7000000000000001}r.strict||(a+="/?"),r.end?a+="$":r.strict&&(a+="(?:/|$)");const s=new RegExp(a,r.sensitive?"":"i");function o(l){const c=l.match(s),h={};if(!c)return null;for(let w=1;w<c.length;w++){const b=c[w]||"",$=i[w-1];h[$.name]=b&&$.repeatable?b.split("/"):b}return h}function u(l){let c="",h=!1;for(const w of e){(!h||!c.endsWith("/"))&&(c+="/"),h=!1;for(const b of w)if(b.type===0)c+=b.value;else if(b.type===1){const{value:$,repeatable:A,optional:x}=b,U=$ in l?l[$]:"";if(xn(U)&&!A)throw new Error(`Provided param "${$}" is an array but it is not repeatable (* or + modifiers)`);const B=xn(U)?U.join("/"):U;if(!B)if(x)w.length<2&&(c.endsWith("/")?c=c.slice(0,-1):h=!0);else throw new Error(`Missing required param "${$}"`);c+=B}}return c||"/"}return{re:s,score:n,keys:i,parse:o,stringify:u}}function nO(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function aO(e,t){let r=0;const n=e.score,a=t.score;for(;r<n.length&&r<a.length;){const i=nO(n[r],a[r]);if(i)return i;r++}if(Math.abs(a.length-n.length)===1){if(wm(n))return 1;if(wm(a))return-1}return a.length-n.length}function wm(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const iO={type:0,value:""},sO=/[a-zA-Z0-9_]/;function oO(e){if(!e)return[[]];if(e==="/")return[[iO]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(b){throw new Error(`ERR (${r})/"${l}": ${b}`)}let r=0,n=r;const a=[];let i;function s(){i&&a.push(i),i=[]}let o=0,u,l="",c="";function h(){!l||(r===0?i.push({type:0,value:l}):r===1||r===2||r===3?(i.length>1&&(u==="*"||u==="+")&&t(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:l,regexp:c,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):t("Invalid state to consume buffer"),l="")}function w(){l+=u}for(;o<e.length;){if(u=e[o++],u==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:u==="/"?(l&&h(),s()):u===":"?(h(),r=1):w();break;case 4:w(),r=n;break;case 1:u==="("?r=2:sO.test(u)?w():(h(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&o--);break;case 2:u===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+u:r=3:c+=u;break;case 3:h(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&o--,c="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${l}"`),h(),s(),a}function uO(e,t,r){const n=rO(oO(e.path),r),a=Rt(n,{record:e,parent:t,children:[],alias:[]});return t&&!a.record.aliasOf==!t.record.aliasOf&&t.children.push(a),a}function lO(e,t){const r=[],n=new Map;t=$m({strict:!1,end:!0,sensitive:!1},t);function a(c){return n.get(c)}function i(c,h,w){const b=!w,$=cO(c);$.aliasOf=w&&w.record;const A=$m(t,c),x=[$];if("alias"in c){const ve=typeof c.alias=="string"?[c.alias]:c.alias;for(const se of ve)x.push(Rt({},$,{components:w?w.record.components:$.components,path:se,aliasOf:w?w.record:$}))}let U,B;for(const ve of x){const{path:se}=ve;if(h&&se[0]!=="/"){const Re=h.record.path,ke=Re[Re.length-1]==="/"?"":"/";ve.path=h.record.path+(se&&ke+se)}if(U=uO(ve,h,A),w?w.alias.push(U):(B=B||U,B!==U&&B.alias.push(U),b&&c.name&&!Sm(U)&&s(c.name)),$.children){const Re=$.children;for(let ke=0;ke<Re.length;ke++)i(Re[ke],U,w&&w.children[ke])}w=w||U,u(U)}return B?()=>{s(B)}:gu}function s(c){if(B$(c)){const h=n.get(c);h&&(n.delete(c),r.splice(r.indexOf(h),1),h.children.forEach(s),h.alias.forEach(s))}else{const h=r.indexOf(c);h>-1&&(r.splice(h,1),c.record.name&&n.delete(c.record.name),c.children.forEach(s),c.alias.forEach(s))}}function o(){return r}function u(c){let h=0;for(;h<r.length&&aO(c,r[h])>=0&&(c.record.path!==r[h].record.path||!H$(c,r[h]));)h++;r.splice(h,0,c),c.record.name&&!Sm(c)&&n.set(c.record.name,c)}function l(c,h){let w,b={},$,A;if("name"in c&&c.name){if(w=n.get(c.name),!w)throw lo(1,{location:c});A=w.record.name,b=Rt(_m(h.params,w.keys.filter(B=>!B.optional).map(B=>B.name)),c.params&&_m(c.params,w.keys.map(B=>B.name))),$=w.stringify(b)}else if("path"in c)$=c.path,w=r.find(B=>B.re.test($)),w&&(b=w.parse($),A=w.record.name);else{if(w=h.name?n.get(h.name):r.find(B=>B.re.test(h.path)),!w)throw lo(1,{location:c,currentLocation:h});A=w.record.name,b=Rt({},h.params,c.params),$=w.stringify(b)}const x=[];let U=w;for(;U;)x.unshift(U.record),U=U.parent;return{name:A,path:$,params:b,matched:x,meta:dO(x)}}return e.forEach(c=>i(c)),{addRoute:i,resolve:l,removeRoute:s,getRoutes:o,getRecordMatcher:a}}function _m(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function cO(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:fO(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function fO(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="boolean"?r:r[n];return t}function Sm(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function dO(e){return e.reduce((t,r)=>Rt(t,r.meta),{})}function $m(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function H$(e,t){return t.children.some(r=>r===e||H$(e,r))}const W$=/#/g,pO=/&/g,vO=/\//g,hO=/=/g,yO=/\?/g,G$=/\+/g,gO=/%5B/g,mO=/%5D/g,z$=/%5E/g,bO=/%60/g,V$=/%7B/g,wO=/%7C/g,K$=/%7D/g,_O=/%20/g;function Vh(e){return encodeURI(""+e).replace(wO,"|").replace(gO,"[").replace(mO,"]")}function SO(e){return Vh(e).replace(V$,"{").replace(K$,"}").replace(z$,"^")}function vv(e){return Vh(e).replace(G$,"%2B").replace(_O,"+").replace(W$,"%23").replace(pO,"%26").replace(bO,"`").replace(V$,"{").replace(K$,"}").replace(z$,"^")}function $O(e){return vv(e).replace(hO,"%3D")}function TO(e){return Vh(e).replace(W$,"%23").replace(yO,"%3F")}function kO(e){return e==null?"":TO(e).replace(vO,"%2F")}function kc(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function EO(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<n.length;++a){const i=n[a].replace(G$," "),s=i.indexOf("="),o=kc(s<0?i:i.slice(0,s)),u=s<0?null:kc(i.slice(s+1));if(o in t){let l=t[o];xn(l)||(l=t[o]=[l]),l.push(u)}else t[o]=u}return t}function Tm(e){let t="";for(let r in e){const n=e[r];if(r=$O(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(xn(n)?n.map(i=>i&&vv(i)):[n&&vv(n)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+r,i!=null&&(t+="="+i))})}return t}function CO(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=xn(n)?n.map(a=>a==null?null:""+a):n==null?n:""+n)}return t}const IO=Symbol(""),km=Symbol(""),df=Symbol(""),Kh=Symbol(""),hv=Symbol("");function zo(){let e=[];function t(n){return e.push(n),()=>{const a=e.indexOf(n);a>-1&&e.splice(a,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function Ja(e,t,r,n,a){const i=n&&(n.enterCallbacks[a]=n.enterCallbacks[a]||[]);return()=>new Promise((s,o)=>{const u=h=>{h===!1?o(lo(4,{from:r,to:t})):h instanceof Error?o(h):ZA(h)?o(lo(2,{from:t,to:h})):(i&&n.enterCallbacks[a]===i&&typeof h=="function"&&i.push(h),s())},l=e.call(n&&n.instances[a],t,r,u);let c=Promise.resolve(l);e.length<3&&(c=c.then(u)),c.catch(h=>o(h))})}function cd(e,t,r,n){const a=[];for(const i of e)for(const s in i.components){let o=i.components[s];if(!(t!=="beforeRouteEnter"&&!i.instances[s]))if(RO(o)){const l=(o.__vccOpts||o)[t];l&&a.push(Ja(l,r,n,i,s))}else{let u=o();a.push(()=>u.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${s}" at "${i.path}"`));const c=xA(l)?l.default:l;i.components[s]=c;const w=(c.__vccOpts||c)[t];return w&&Ja(w,r,n,i,s)()}))}}return a}function RO(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Em(e){const t=Mn(df),r=Mn(Kh),n=Bt(()=>t.resolve(Mt(e.to))),a=Bt(()=>{const{matched:u}=n.value,{length:l}=u,c=u[l-1],h=r.matched;if(!c||!h.length)return-1;const w=h.findIndex(uo.bind(null,c));if(w>-1)return w;const b=Cm(u[l-2]);return l>1&&Cm(c)===b&&h[h.length-1].path!==b?h.findIndex(uo.bind(null,u[l-2])):w}),i=Bt(()=>a.value>-1&&PO(r.params,n.value.params)),s=Bt(()=>a.value>-1&&a.value===r.matched.length-1&&F$(r.params,n.value.params));function o(u={}){return OO(u)?t[Mt(e.replace)?"replace":"push"](Mt(e.to)).catch(gu):Promise.resolve()}return{route:n,href:Bt(()=>n.value.href),isActive:i,isExactActive:s,navigate:o}}const AO=p$({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Em,setup(e,{slots:t}){const r=is(Em(e)),{options:n}=Mn(df),a=Bt(()=>({[Im(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[Im(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=t.default&&t.default(r);return e.custom?i:P$("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:a.value},i)}}}),J$=AO;function OO(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function PO(e,t){for(const r in t){const n=t[r],a=e[r];if(typeof n=="string"){if(n!==a)return!1}else if(!xn(a)||a.length!==n.length||n.some((i,s)=>i!==a[s]))return!1}return!0}function Cm(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Im=(e,t,r)=>e!=null?e:t!=null?t:r,MO=p$({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=Mn(hv),a=Bt(()=>e.route||n.value),i=Mn(km,0),s=Bt(()=>{let l=Mt(i);const{matched:c}=a.value;let h;for(;(h=c[l])&&!h.components;)l++;return l}),o=Bt(()=>a.value.matched[s.value]);uc(km,Bt(()=>s.value+1)),uc(IO,o),uc(hv,a);const u=vt();return Ji(()=>[u.value,o.value,e.name],([l,c,h],[w,b,$])=>{c&&(c.instances[h]=l,b&&b!==c&&l&&l===w&&(c.leaveGuards.size||(c.leaveGuards=b.leaveGuards),c.updateGuards.size||(c.updateGuards=b.updateGuards))),l&&c&&(!b||!uo(c,b)||!w)&&(c.enterCallbacks[h]||[]).forEach(A=>A(l))},{flush:"post"}),()=>{const l=a.value,c=e.name,h=o.value,w=h&&h.components[c];if(!w)return Rm(r.default,{Component:w,route:l});const b=h.props[c],$=b?b===!0?l.params:typeof b=="function"?b(l):b:null,x=P$(w,Rt({},$,t,{onVnodeUnmounted:U=>{U.component.isUnmounted&&(h.instances[c]=null)},ref:u}));return Rm(r.default,{Component:x,route:l})||x}}});function Rm(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const Y$=MO;function xO(e){const t=lO(e.routes,e),r=e.parseQuery||EO,n=e.stringifyQuery||Tm,a=e.history,i=zo(),s=zo(),o=zo(),u=e$(qa);let l=qa;Ds&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=ud.bind(null,D=>""+D),h=ud.bind(null,kO),w=ud.bind(null,kc);function b(D,T){let Te,he;return B$(D)?(Te=t.getRecordMatcher(D),he=T):he=D,t.addRoute(he,Te)}function $(D){const T=t.getRecordMatcher(D);T&&t.removeRoute(T)}function A(){return t.getRoutes().map(D=>D.record)}function x(D){return!!t.getRecordMatcher(D)}function U(D,T){if(T=Rt({},T||u.value),typeof D=="string"){const Ge=ld(r,D,T.path),R=t.resolve({path:Ge.path},T),C=a.createHref(Ge.fullPath);return Rt(Ge,R,{params:w(R.params),hash:kc(Ge.hash),redirectedFrom:void 0,href:C})}let Te;if("path"in D)Te=Rt({},D,{path:ld(r,D.path,T.path).path});else{const Ge=Rt({},D.params);for(const R in Ge)Ge[R]==null&&delete Ge[R];Te=Rt({},D,{params:h(D.params)}),T.params=h(T.params)}const he=t.resolve(Te,T),Ke=D.hash||"";he.params=c(w(he.params));const Qe=jA(n,Rt({},D,{hash:SO(Ke),path:he.path})),Se=a.createHref(Qe);return Rt({fullPath:Qe,hash:Ke,query:n===Tm?CO(D.query):D.query||{}},he,{redirectedFrom:void 0,href:Se})}function B(D){return typeof D=="string"?ld(r,D,u.value.path):Rt({},D)}function ve(D,T){if(l!==D)return lo(8,{from:T,to:D})}function se(D){return de(D)}function Re(D){return se(Rt(B(D),{replace:!0}))}function ke(D){const T=D.matched[D.matched.length-1];if(T&&T.redirect){const{redirect:Te}=T;let he=typeof Te=="function"?Te(D):Te;return typeof he=="string"&&(he=he.includes("?")||he.includes("#")?he=B(he):{path:he},he.params={}),Rt({query:D.query,hash:D.hash,params:"path"in he?{}:D.params},he)}}function de(D,T){const Te=l=U(D),he=u.value,Ke=D.state,Qe=D.force,Se=D.replace===!0,Ge=ke(Te);if(Ge)return de(Rt(B(Ge),{state:typeof Ge=="object"?Rt({},Ke,Ge.state):Ke,force:Qe,replace:Se}),T||Te);const R=Te;R.redirectedFrom=T;let C;return!Qe&&UA(n,he,Te)&&(C=lo(16,{to:R,from:he}),ft(he,he,!0,!1)),(C?Promise.resolve(C):te(R,he)).catch(Y=>sa(Y)?sa(Y,2)?Y:N(Y):me(Y,R,he)).then(Y=>{if(Y){if(sa(Y,2))return de(Rt({replace:Se},B(Y.to),{state:typeof Y.to=="object"?Rt({},Ke,Y.to.state):Ke,force:Qe}),T||R)}else Y=J(R,he,!0,Se,Ke);return le(R,he,Y),Y})}function P(D,T){const Te=ve(D,T);return Te?Promise.reject(Te):Promise.resolve()}function te(D,T){let Te;const[he,Ke,Qe]=NO(D,T);Te=cd(he.reverse(),"beforeRouteLeave",D,T);for(const Ge of he)Ge.leaveGuards.forEach(R=>{Te.push(Ja(R,D,T))});const Se=P.bind(null,D,T);return Te.push(Se),Es(Te).then(()=>{Te=[];for(const Ge of i.list())Te.push(Ja(Ge,D,T));return Te.push(Se),Es(Te)}).then(()=>{Te=cd(Ke,"beforeRouteUpdate",D,T);for(const Ge of Ke)Ge.updateGuards.forEach(R=>{Te.push(Ja(R,D,T))});return Te.push(Se),Es(Te)}).then(()=>{Te=[];for(const Ge of D.matched)if(Ge.beforeEnter&&!T.matched.includes(Ge))if(xn(Ge.beforeEnter))for(const R of Ge.beforeEnter)Te.push(Ja(R,D,T));else Te.push(Ja(Ge.beforeEnter,D,T));return Te.push(Se),Es(Te)}).then(()=>(D.matched.forEach(Ge=>Ge.enterCallbacks={}),Te=cd(Qe,"beforeRouteEnter",D,T),Te.push(Se),Es(Te))).then(()=>{Te=[];for(const Ge of s.list())Te.push(Ja(Ge,D,T));return Te.push(Se),Es(Te)}).catch(Ge=>sa(Ge,8)?Ge:Promise.reject(Ge))}function le(D,T,Te){for(const he of o.list())he(D,T,Te)}function J(D,T,Te,he,Ke){const Qe=ve(D,T);if(Qe)return Qe;const Se=T===qa,Ge=Ds?history.state:{};Te&&(he||Se?a.replace(D.fullPath,Rt({scroll:Se&&Ge&&Ge.scroll},Ke)):a.push(D.fullPath,Ke)),u.value=D,ft(D,T,Te,Se),N()}let xe;function re(){xe||(xe=a.listen((D,T,Te)=>{if(!Ye.listening)return;const he=U(D),Ke=ke(he);if(Ke){de(Rt(Ke,{replace:!0}),he).catch(gu);return}l=he;const Qe=u.value;Ds&&zA(ym(Qe.fullPath,Te.delta),ff()),te(he,Qe).catch(Se=>sa(Se,12)?Se:sa(Se,2)?(de(Se.to,he).then(Ge=>{sa(Ge,20)&&!Te.delta&&Te.type===Pu.pop&&a.go(-1,!1)}).catch(gu),Promise.reject()):(Te.delta&&a.go(-Te.delta,!1),me(Se,he,Qe))).then(Se=>{Se=Se||J(he,Qe,!1),Se&&(Te.delta&&!sa(Se,8)?a.go(-Te.delta,!1):Te.type===Pu.pop&&sa(Se,20)&&a.go(-1,!1)),le(he,Qe,Se)}).catch(gu)}))}let H=zo(),ue=zo(),W;function me(D,T,Te){N(D);const he=ue.list();return he.length?he.forEach(Ke=>Ke(D,T,Te)):console.error(D),Promise.reject(D)}function _e(){return W&&u.value!==qa?Promise.resolve():new Promise((D,T)=>{H.add([D,T])})}function N(D){return W||(W=!D,re(),H.list().forEach(([T,Te])=>D?Te(D):T()),H.reset()),D}function ft(D,T,Te,he){const{scrollBehavior:Ke}=e;if(!Ds||!Ke)return Promise.resolve();const Qe=!Te&&VA(ym(D.fullPath,0))||(he||!Te)&&history.state&&history.state.scroll||null;return Fh().then(()=>Ke(D,T,Qe)).then(Se=>Se&&GA(Se)).catch(Se=>me(Se,D,T))}const dt=D=>a.go(D);let Ee;const Xe=new Set,Ye={currentRoute:u,listening:!0,addRoute:b,removeRoute:$,hasRoute:x,getRoutes:A,resolve:U,options:e,push:se,replace:Re,go:dt,back:()=>dt(-1),forward:()=>dt(1),beforeEach:i.add,beforeResolve:s.add,afterEach:o.add,onError:ue.add,isReady:_e,install(D){const T=this;D.component("RouterLink",J$),D.component("RouterView",Y$),D.config.globalProperties.$router=T,Object.defineProperty(D.config.globalProperties,"$route",{enumerable:!0,get:()=>Mt(u)}),Ds&&!Ee&&u.value===qa&&(Ee=!0,se(a.location).catch(Ke=>{}));const Te={};for(const Ke in qa)Te[Ke]=Bt(()=>u.value[Ke]);D.provide(df,T),D.provide(Kh,is(Te)),D.provide(hv,u);const he=D.unmount;Xe.add(D),D.unmount=function(){Xe.delete(D),Xe.size<1&&(l=qa,xe&&xe(),xe=null,u.value=qa,Ee=!1,W=!1),he()}}};return Ye}function Es(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function NO(e,t){const r=[],n=[],a=[],i=Math.max(t.matched.length,e.matched.length);for(let s=0;s<i;s++){const o=t.matched[s];o&&(e.matched.find(l=>uo(l,o))?n.push(o):r.push(o));const u=e.matched[s];u&&(t.matched.find(l=>uo(l,u))||a.push(u))}return[r,n,a]}function LO(){return Mn(df)}function jO(){return Mn(Kh)}const UO={__name:"App",setup(e){return(t,r)=>(st(),es(Mt(Y$)))}},pi=(e,t)=>{const r=e.__vccOpts||e;for(const[n,a]of t)r[n]=a;return r},FO={name:"Header",setup(){return{}}},DO={class:"container-fluid"},BO={class:"row"},qO={class:"d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom"},HO=fe("img",{class:"me-4",width:"60",height:"32",src:"https://logos-world.net/wp-content/uploads/2022/01/Safeway-Symbol.png"},null,-1),WO=fe("span",{class:"fs-4"},"Messages",-1),GO={class:"nav nav-pills"},zO={class:"nav-item"},VO=fe("i",{class:"bi-house"},null,-1),KO=fe("span",{class:"p-1"},"Home",-1);function JO(e,t,r,n,a,i){const s=li("router-link");return st(),yt("div",DO,[fe("div",BO,[fe("header",qO,[Ht(s,{class:"d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none",to:"/"},{default:ui(()=>[HO,WO]),_:1}),fe("ul",GO,[fe("li",zO,[Ht(s,{class:"btn btn-link",to:"/"},{default:ui(()=>[VO,KO]),_:1})])])])])])}const YO=pi(FO,[["render",JO]]),QO={name:"Footer"},XO={class:"footer mt-auto py-3 bg-light"},ZO=fe("div",{class:"container text-center"},[fe("img",{class:"",width:"107",height:"32",src:"https://www.twilio.com/docs/static/dist/img/559bc7cf.svg"})],-1),eP=[ZO];function tP(e,t,r,n,a,i){return st(),yt("footer",XO,eP)}const rP=pi(QO,[["render",tP]]),nP={name:"Layout",components:{Header:YO,Footer:rP}};function aP(e,t,r,n,a,i){const s=li("Header"),o=li("Footer");return st(),yt("div",null,[Ht(s),wR(e.$slots,"default"),Ht(o)])}const Q$=pi(nP,[["render",aP]]);var Am;const Wu=typeof window<"u",iP=e=>typeof e=="function",sP=e=>typeof e=="string",fd=()=>{};Wu&&((Am=window==null?void 0:window.navigator)==null?void 0:Am.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function X$(e){return typeof e=="function"?e():Mt(e)}function oP(e,t){function r(...n){e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})}return r}const Z$=e=>e();function uP(e=Z$){const t=vt(!0);function r(){t.value=!1}function n(){t.value=!0}return{isActive:t,pause:r,resume:n,eventFilter:(...i)=>{t.value&&e(...i)}}}function lP(e){return e}function cP(e){return cI()?(fI(e),!0):!1}var Om=Object.getOwnPropertySymbols,fP=Object.prototype.hasOwnProperty,dP=Object.prototype.propertyIsEnumerable,pP=(e,t)=>{var r={};for(var n in e)fP.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Om)for(var n of Om(e))t.indexOf(n)<0&&dP.call(e,n)&&(r[n]=e[n]);return r};function vP(e,t,r={}){const n=r,{eventFilter:a=Z$}=n,i=pP(n,["eventFilter"]);return Ji(e,oP(a,t),i)}var hP=Object.defineProperty,yP=Object.defineProperties,gP=Object.getOwnPropertyDescriptors,Ec=Object.getOwnPropertySymbols,e1=Object.prototype.hasOwnProperty,t1=Object.prototype.propertyIsEnumerable,Pm=(e,t,r)=>t in e?hP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,mP=(e,t)=>{for(var r in t||(t={}))e1.call(t,r)&&Pm(e,r,t[r]);if(Ec)for(var r of Ec(t))t1.call(t,r)&&Pm(e,r,t[r]);return e},bP=(e,t)=>yP(e,gP(t)),wP=(e,t)=>{var r={};for(var n in e)e1.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Ec)for(var n of Ec(e))t.indexOf(n)<0&&t1.call(e,n)&&(r[n]=e[n]);return r};function _P(e,t,r={}){const n=r,{eventFilter:a}=n,i=wP(n,["eventFilter"]),{eventFilter:s,pause:o,resume:u,isActive:l}=uP(a);return{stop:vP(e,t,bP(mP({},i),{eventFilter:s})),pause:o,resume:u,isActive:l}}function SP(e){var t;const r=X$(e);return(t=r==null?void 0:r.$el)!=null?t:r}const yv=Wu?window:void 0;Wu&&window.document;Wu&&window.navigator;Wu&&window.location;function $P(...e){let t,r,n,a;if(sP(e[0])?([r,n,a]=e,t=yv):[t,r,n,a]=e,!t)return fd;let i=fd;const s=Ji(()=>SP(t),u=>{i(),u&&(u.addEventListener(r,n,a),i=()=>{u.removeEventListener(r,n,a),i=fd})},{immediate:!0,flush:"post"}),o=()=>{s(),i()};return cP(o),o}const gv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},mv="__vueuse_ssr_handlers__";gv[mv]=gv[mv]||{};const TP=gv[mv];function kP(e,t){return TP[e]||t}function EP(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"||Array.isArray(e)?"object":Number.isNaN(e)?"any":"number"}var CP=Object.defineProperty,Mm=Object.getOwnPropertySymbols,IP=Object.prototype.hasOwnProperty,RP=Object.prototype.propertyIsEnumerable,xm=(e,t,r)=>t in e?CP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Nm=(e,t)=>{for(var r in t||(t={}))IP.call(t,r)&&xm(e,r,t[r]);if(Mm)for(var r of Mm(t))RP.call(t,r)&&xm(e,r,t[r]);return e};const AP={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}};function OP(e,t,r,n={}){var a;const{flush:i="pre",deep:s=!0,listenToStorageChanges:o=!0,writeDefaults:u=!0,mergeDefaults:l=!1,shallow:c,window:h=yv,eventFilter:w,onError:b=de=>{console.error(de)}}=n,$=(c?e$:vt)(t);if(!r)try{r=kP("getDefaultStorage",()=>{var de;return(de=yv)==null?void 0:de.localStorage})()}catch(de){b(de)}if(!r)return $;const A=X$(t),x=EP(A),U=(a=n.serializer)!=null?a:AP[x],{pause:B,resume:ve}=_P($,()=>se($.value),{flush:i,deep:s,eventFilter:w});return h&&o&&$P(h,"storage",ke),ke(),$;function se(de){try{de==null?r.removeItem(e):r.setItem(e,U.write(de))}catch(P){b(P)}}function Re(de){if(!(de&&de.key!==e)){B();try{const P=de?de.newValue:r.getItem(e);if(P==null)return u&&A!==null&&r.setItem(e,U.write(A)),A;if(!de&&l){const te=U.read(P);return iP(l)?l(te,A):x==="object"&&!Array.isArray(te)?Nm(Nm({},A),te):te}else return typeof P!="string"?P:U.read(P)}catch(P){b(P)}finally{ve()}}}function ke(de){de&&de.key!==e||($.value=Re(de))}}var Lm;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(Lm||(Lm={}));var PP=Object.defineProperty,jm=Object.getOwnPropertySymbols,MP=Object.prototype.hasOwnProperty,xP=Object.prototype.propertyIsEnumerable,Um=(e,t,r)=>t in e?PP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,NP=(e,t)=>{for(var r in t||(t={}))MP.call(t,r)&&Um(e,r,t[r]);if(jm)for(var r of jm(t))xP.call(t,r)&&Um(e,r,t[r]);return e};const LP={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};NP({linear:lP},LP);const pf=MA("end-user",{state:()=>({endUser:OP("endUser",{name:"",avatar:"",accessToken:"",supportConversation:""},localStorage,{mergeDefaults:!0})}),getters:{},actions:{async getToken(){try{let e=`/auth/token?identity=${this.endUser.name}`;const t=await fetch(e,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(t.ok){let r=await t.json();this.endUser.accessToken=r.accessToken,console.log("token value set...")}}catch(e){console.log("getToken error => ",e)}},logout(){this.endUser.name="",this.endUser.avatar="",this.endUser.accessToken="",this.endUser.supportConversation="none"}}});function bv(e,t,r,n){let a={displayName:r,avatar:n,sms:!1,chat:!1,whatsapp:!1,enduser:!1,agent:!1};switch(e){case"sms":a.sms=!0;break;case"chat":a.chat=!0;break;case"whatsapp":a.whatsapp=!0;break}switch(t){case"enduser":a.enduser=!0;break;case"agent":a.agent=!0;break}return JSON.stringify(a)}function r1(e){let t=new Date(e);return`${t.getMonth()+1}/${t.getDate()} @ ${t.getHours()}:${String(t.getMinutes()).padStart(2,"0")}`}const jP={class:"container-fluid"},UP={class:"row pb-5 mb-5"},FP={class:"col-8"},DP=fe("h2",{class:"mb-5"},"Twilio Conversations Web Chat Demo!",-1),BP=fe("div",{class:"alert alert-info mb-5 fs-5 fw-bold text-center"}," With this demo, you can experience a custom web chat client powered by Twilio Conversations. ",-1),qP=fe("div",{class:"card-header fs-2"},[fe("b",null,"Access Token")],-1),HP={class:"card-body"},WP={class:"card-title mb-5"},GP=["src"],zP={class:"card-text fs-4 mb-5"},VP={class:"mb-3"},KP=fe("label",{for:"newname",class:"form-label"},[fe("h4",null,"Enter Your Name")],-1),JP={class:"d-grid"},YP=fe("i",{class:"bi-save"},null,-1),QP=Zt(" Save Name "),XP=[YP,QP],ZP=fe("p",{class:"card-text fs-4 mb-5"}," Great, now create an access token... ",-1),eM=fe("i",{class:"bi-coin"},null,-1),tM=Zt(" Create Token "),rM=[eM,tM],nM={class:"spinner-border",role:"status"},aM=fe("span",{class:"visually-hidden"},"Loading...",-1),iM=[aM],sM={class:"card-text fs-4 mb-5"},oM=fe("i",{class:"bi-recycle"},null,-1),uM=Zt(" Refresh Token "),lM=[oM,uM],cM={class:"spinner-border",role:"status"},fM=fe("span",{class:"visually-hidden"},"Loading...",-1),dM=[fM],pM={disabled:"",class:"btn btn-info"},vM=fe("i",{class:"bi-check"},null,-1),hM=Zt(" Token Refreshed "),yM=[vM,hM],gM=fe("i",{class:"bi-eye"},null,-1),mM=Zt(" View Token "),bM=[gM,mM],wM={class:"mt-4 text-break"},_M=fe("i",{class:"bi-box-arrow-left"},null,-1),SM=Zt(" Logout "),$M=[_M,SM],TM={class:"card mb-5 text-bg-warning"},kM=fe("div",{class:"card-header fs-2"},[fe("b",null,[fe("i",{class:"bi-life-preserver"}),Zt(" Chat Support")])],-1),EM={class:"card-body"},CM=fe("i",{class:"bi-life-preserver"},null,-1),IM=Zt(" Create Chat Support Session "),RM=[CM,IM],AM={key:0,class:"d-grid mt-5 mb-5"},OM=["onClick"],PM=fe("i",{class:"bi-chat-left-dots-fill"},null,-1),MM=Zt(" Enter Chat Support "),xM=[PM,MM],NM={class:"card mb-5 text-bg-light"},LM=fe("div",{class:"card-header fs-2"},[fe("b",null,[fe("i",{class:"bi-chat-left-dots-fill"}),Zt(" Chat Channels")])],-1),jM={class:"card-body"},UM=fe("i",{class:"bi-recycle"},null,-1),FM=Zt(" Refresh Chat Channels "),DM=[UM,FM],BM={class:"table table-striped mt-4 mb-5 fs-4"},qM=fe("thead",null,[fe("tr",null,[fe("th",{class:"text-center"},"Channel Name"),fe("th",{class:"text-center"},"Date Created"),fe("th",{class:"text-center"},"\xA0")])],-1),HM={class:"text-center"},WM={class:"text-center"},GM={class:"text-center"},zM=["onClick"],VM=fe("i",{class:"bi-play-fill"},null,-1),KM=Zt(" Join and Enter "),JM=[VM,KM],YM=fe("div",{class:"col pt-5"},[fe("div",{class:"text-center"},[fe("img",{class:"img-fluid",style:{"max-width":"450px"},src:"https://twilio-cms-prod.s3.amazonaws.com/images/diagram-conversat.width-1200.format-webp.webpquality-75.webp"})])],-1),QM={__name:"Home",setup(e){const t=pf(),r=LO();vt("");const n=vt(!1),a=vt(!1);vt("notset");const i=vt(""),s=vt(!1),o=vt(!1),u=vt(!1),l=Bt(()=>t.endUser!=null&&t.endUser.supportConversation!==""&&t.endUser.supportConversation!=="none"),c=Bt(()=>t.endUser!=null&&t.endUser.accessToken!==""),h=Bt(()=>t.endUser!=null&&t.endUser.name!=="");function w(P,te){return Math.floor(Math.random()*(te-P+1)+P)}const b=vt(""),$=async()=>{t.endUser.name=b.value;let P=w(1,700);t.endUser.avatar=`https://picsum.photos/id/${P}/50`},A=async()=>{o.value=!0,await t.getToken(),o.value=!1,u.value=!0,await Re()},x=vt("Support");vt(["Support","ChatChannel"]);const U=async()=>{try{let P={conversationType:x.value,createdBy:t.endUser.name};const le=await fetch("/conversations/conversation-create",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationName:t.endUser.name+" (inbound chat)",attributes:P}})});if(le.ok){console.log("Success! Created a new conversation...");let J=await le.json();i.value=J.sid,n.value=!1,await t.getToken(),await B(),a.value=!0,t.endUser.supportConversation=J.sid}else console.log("Error! Unable to create new conversation...")}catch(P){console.log("createNewConversation error => ",P)}},B=async()=>{try{let P=bv("chat","enduser",t.endUser.name,t.endUser.avatar);(await fetch("/conversations/conversation-add-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:i.value,identity:t.endUser.name,attributes:P}})})).ok?console.log("Success! Added End User to conversation..."):console.log("Error! Unable to add End User to conversation...")}catch(P){console.log("addEndUserToConversation error => ",P)}},ve=vt([]),se=vt([]),Re=async()=>{try{se.value=[];const te=await fetch("/conversations/return-conversations",{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(te.ok){let le=await te.json();ve.value=le;for(let J=0;J<ve.value.length;J++)se.value.push(ve.value[J])}}catch(P){console.log("getConversations error => ",P)}},ke=async function(P){i.value=P,await B(),r.push({name:"conversation",params:{sid:P}})};function de(){t.logout(),s.value=!1,o.value=!1,u.value=!1}return(P,te)=>(st(),yt("div",jP,[fe("div",UP,[fe("div",FP,[DP,BP,fe("div",{class:Vn(["card mb-5",{"text-bg-success":Mt(c),"text-bg-warning":!Mt(c)}])},[qP,fe("div",HP,[It(fe("h3",WP,[fe("img",{src:Mt(t).endUser.avatar,class:"rounded float-start me-2"},null,8,GP),Zt(" "+Yt(Mt(t).endUser.name),1)],512),[[Lt,Mt(h)]]),It(fe("p",zP," In order order to enter a conversation, you need to enter a name and then create an access token. ",512),[[Lt,!Mt(h)]]),It(fe("div",null,[fe("div",VP,[KP,It(fe("input",{type:"text","onUpdate:modelValue":te[0]||(te[0]=le=>b.value=le),class:"form-control",id:"newname",placeholder:""},null,512),[[x$,b.value]])]),fe("div",JP,[fe("button",{onClick:te[1]||(te[1]=le=>$()),class:"btn btn-primary btn-lg"},XP)])],512),[[Lt,!Mt(h)]]),It(fe("div",null,[ZP,fe("button",{onClick:te[2]||(te[2]=le=>A()),class:"btn btn-primary btn-lg"},[It(fe("span",null,rM,512),[[Lt,!o.value]]),It(fe("div",nM,iM,512),[[Lt,o.value]])])],512),[[Lt,Mt(h)&&!Mt(c)]]),fe("div",null,[It(fe("p",sM," Excellent! You can now join conversations. ",512),[[Lt,u.value]]),It(fe("button",{onClick:te[3]||(te[3]=le=>A()),class:"btn btn-secondary"},[It(fe("span",null,lM,512),[[Lt,!o.value]]),It(fe("div",cM,dM,512),[[Lt,o.value]])],512),[[Lt,Mt(c)&&!u.value]]),It(fe("button",pM,yM,512),[[Lt,u.value]]),It(fe("button",{onClick:te[4]||(te[4]=le=>s.value=!s.value),class:"btn btn-light ms-2"},bM,512),[[Lt,Mt(t).endUser.accessToken!=""]])]),It(fe("p",wM,[fe("i",null,Yt(Mt(t).endUser.accessToken),1)],512),[[Lt,s.value]]),fe("p",null,[It(fe("button",{onClick:te[5]||(te[5]=le=>de()),class:"btn btn-danger float-end"},$M,512),[[Lt,Mt(c)]])])])],2),It(fe("div",TM,[kM,fe("div",EM,[It(fe("button",{onClick:te[6]||(te[6]=le=>U()),class:"btn btn-secondary btn-lg"},RM,512),[[Lt,!Mt(l)]]),Mt(l)?(st(),yt("div",AM,[Ht(Mt(J$),{to:{name:"conversation",params:{sid:Mt(t).endUser.supportConversation}},custom:""},{default:ui(({navigate:le})=>[fe("button",{class:"btn btn-lg btn-primary",onClick:le},xM,8,OM)]),_:1},8,["to"])])):ir("",!0)])],512),[[Lt,Mt(c)]]),It(fe("div",NM,[LM,fe("div",jM,[fe("p",null,[fe("button",{onClick:te[7]||(te[7]=le=>Re()),class:"btn btn-info float-end mb-4"},DM)]),fe("table",BM,[qM,fe("tbody",null,[(st(!0),yt(dr,null,Ru(se.value,le=>(st(),yt("tr",{key:le.sid},[fe("td",HM,Yt(le.friendlyName),1),fe("td",WM,Yt(Mt(r1)(le.dateCreated)),1),fe("td",GM,[fe("button",{class:"btn btn-primary",onClick:J=>ke(le.sid)},JM,8,zM)])]))),128))])])])],512),[[Lt,Mt(c)]])]),YM])]))}},XM={name:"App",components:{Layout:Q$,Home:QM}};function ZM(e,t,r,n,a,i){const s=li("Home"),o=li("Layout");return st(),es(o,null,{default:ui(()=>[Ht(s)]),_:1})}const ex=pi(XM,[["render",ZM]]);var Rn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tx(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var n1={},Cl=function(e){return e&&e.Math==Math&&e},ct=Cl(typeof globalThis=="object"&&globalThis)||Cl(typeof window=="object"&&window)||Cl(typeof self=="object"&&self)||Cl(typeof Rn=="object"&&Rn)||function(){return this}()||Function("return this")(),Xn={},nt=function(e){try{return!!e()}catch{return!0}},rx=nt,qt=!rx(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),nx=nt,Gu=!nx(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),ax=Gu,Il=Function.prototype.call,At=ax?Il.bind(Il):function(){return Il.apply(Il,arguments)},zu={},a1={}.propertyIsEnumerable,i1=Object.getOwnPropertyDescriptor,ix=i1&&!a1.call({1:2},1);zu.f=ix?function(t){var r=i1(this,t);return!!r&&r.enumerable}:a1;var ss=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},s1=Gu,o1=Function.prototype,sx=o1.bind,wv=o1.call,ox=s1&&sx.bind(wv,wv),et=s1?function(e){return e&&ox(e)}:function(e){return e&&function(){return wv.apply(e,arguments)}},u1=et,ux=u1({}.toString),lx=u1("".slice),vi=function(e){return lx(ux(e),8,-1)},cx=et,fx=nt,dx=vi,dd=Object,px=cx("".split),Vu=fx(function(){return!dd("z").propertyIsEnumerable(0)})?function(e){return dx(e)=="String"?px(e,""):dd(e)}:dd,Zn=function(e){return e==null},vx=Zn,hx=TypeError,ea=function(e){if(vx(e))throw hx("Can't call method on "+e);return e},yx=Vu,gx=ea,Yr=function(e){return yx(gx(e))},_v=typeof document=="object"&&document.all,mx=typeof _v>"u"&&_v!==void 0,l1={all:_v,IS_HTMLDDA:mx},c1=l1,bx=c1.all,Ot=c1.IS_HTMLDDA?function(e){return typeof e=="function"||e===bx}:function(e){return typeof e=="function"},Fm=Ot,f1=l1,wx=f1.all,zt=f1.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:Fm(e)||e===wx}:function(e){return typeof e=="object"?e!==null:Fm(e)},pd=ct,_x=Ot,Sx=function(e){return _x(e)?e:void 0},hn=function(e,t){return arguments.length<2?Sx(pd[e]):pd[e]&&pd[e][t]},$x=et,Ea=$x({}.isPrototypeOf),Tx=hn,os=Tx("navigator","userAgent")||"",d1=ct,vd=os,Dm=d1.process,Bm=d1.Deno,qm=Dm&&Dm.versions||Bm&&Bm.version,Hm=qm&&qm.v8,kn,Cc;Hm&&(kn=Hm.split("."),Cc=kn[0]>0&&kn[0]<4?1:+(kn[0]+kn[1]));!Cc&&vd&&(kn=vd.match(/Edge\/(\d+)/),(!kn||kn[1]>=74)&&(kn=vd.match(/Chrome\/(\d+)/),kn&&(Cc=+kn[1])));var us=Cc,Wm=us,kx=nt,wo=!!Object.getOwnPropertySymbols&&!kx(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Wm&&Wm<41}),Ex=wo,p1=Ex&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Cx=hn,Ix=Ot,Rx=Ea,Ax=p1,Ox=Object,_o=Ax?function(e){return typeof e=="symbol"}:function(e){var t=Cx("Symbol");return Ix(t)&&Rx(t.prototype,Ox(e))},Px=String,ls=function(e){try{return Px(e)}catch{return"Object"}},Mx=Ot,xx=ls,Nx=TypeError,Nn=function(e){if(Mx(e))return e;throw Nx(xx(e)+" is not a function")},Lx=Nn,jx=Zn,cs=function(e,t){var r=e[t];return jx(r)?void 0:Lx(r)},hd=At,yd=Ot,gd=zt,Ux=TypeError,Fx=function(e,t){var r,n;if(t==="string"&&yd(r=e.toString)&&!gd(n=hd(r,e))||yd(r=e.valueOf)&&!gd(n=hd(r,e))||t!=="string"&&yd(r=e.toString)&&!gd(n=hd(r,e)))return n;throw Ux("Can't convert object to primitive value")},fs={exports:{}},Dx=!1,Gm=ct,Bx=Object.defineProperty,Jh=function(e,t){try{Bx(Gm,e,{value:t,configurable:!0,writable:!0})}catch{Gm[e]=t}return t},qx=ct,Hx=Jh,zm="__core-js_shared__",Wx=qx[zm]||Hx(zm,{}),Yh=Wx,Vm=Yh;(fs.exports=function(e,t){return Vm[e]||(Vm[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.25.2",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.2/LICENSE",source:"https://github.com/zloirock/core-js"});var Gx=ea,zx=Object,$r=function(e){return zx(Gx(e))},Vx=et,Kx=$r,Jx=Vx({}.hasOwnProperty),Vt=Object.hasOwn||function(t,r){return Jx(Kx(t),r)},Yx=et,Qx=0,Xx=Math.random(),Zx=Yx(1 .toString),Ku=function(e){return"Symbol("+(e===void 0?"":e)+")_"+Zx(++Qx+Xx,36)},e2=ct,t2=fs.exports,Km=Vt,r2=Ku,Jm=wo,v1=p1,Cs=t2("wks"),Qi=e2.Symbol,Ym=Qi&&Qi.for,n2=v1?Qi:Qi&&Qi.withoutSetter||r2,Pt=function(e){if(!Km(Cs,e)||!(Jm||typeof Cs[e]=="string")){var t="Symbol."+e;Jm&&Km(Qi,e)?Cs[e]=Qi[e]:v1&&Ym?Cs[e]=Ym(t):Cs[e]=n2(t)}return Cs[e]},a2=At,Qm=zt,Xm=_o,i2=cs,s2=Fx,o2=Pt,u2=TypeError,l2=o2("toPrimitive"),Qh=function(e,t){if(!Qm(e)||Xm(e))return e;var r=i2(e,l2),n;if(r){if(t===void 0&&(t="default"),n=a2(r,e,t),!Qm(n)||Xm(n))return n;throw u2("Can't convert object to primitive value")}return t===void 0&&(t="number"),s2(e,t)},c2=Qh,f2=_o,Ju=function(e){var t=c2(e,"string");return f2(t)?t:t+""},d2=ct,Zm=zt,Sv=d2.document,p2=Zm(Sv)&&Zm(Sv.createElement),vf=function(e){return p2?Sv.createElement(e):{}},v2=qt,h2=nt,y2=vf,h1=!v2&&!h2(function(){return Object.defineProperty(y2("div"),"a",{get:function(){return 7}}).a!=7}),g2=qt,m2=At,b2=zu,w2=ss,_2=Yr,S2=Ju,$2=Vt,T2=h1,eb=Object.getOwnPropertyDescriptor;Xn.f=g2?eb:function(t,r){if(t=_2(t),r=S2(r),T2)try{return eb(t,r)}catch{}if($2(t,r))return w2(!m2(b2.f,t,r),t[r])};var er={},k2=qt,E2=nt,y1=k2&&E2(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),C2=zt,I2=String,R2=TypeError,Jt=function(e){if(C2(e))return e;throw R2(I2(e)+" is not an object")},A2=qt,O2=h1,P2=y1,Rl=Jt,tb=Ju,M2=TypeError,md=Object.defineProperty,x2=Object.getOwnPropertyDescriptor,bd="enumerable",wd="configurable",_d="writable";er.f=A2?P2?function(t,r,n){if(Rl(t),r=tb(r),Rl(n),typeof t=="function"&&r==="prototype"&&"value"in n&&_d in n&&!n[_d]){var a=x2(t,r);a&&a[_d]&&(t[r]=n.value,n={configurable:wd in n?n[wd]:a[wd],enumerable:bd in n?n[bd]:a[bd],writable:!1})}return md(t,r,n)}:md:function(t,r,n){if(Rl(t),r=tb(r),Rl(n),O2)try{return md(t,r,n)}catch{}if("get"in n||"set"in n)throw M2("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var N2=qt,L2=er,j2=ss,Ca=N2?function(e,t,r){return L2.f(e,t,j2(1,r))}:function(e,t,r){return e[t]=r,e},Xh={exports:{}},$v=qt,U2=Vt,g1=Function.prototype,F2=$v&&Object.getOwnPropertyDescriptor,Zh=U2(g1,"name"),D2=Zh&&function(){}.name==="something",B2=Zh&&(!$v||$v&&F2(g1,"name").configurable),Yu={EXISTS:Zh,PROPER:D2,CONFIGURABLE:B2},q2=et,H2=Ot,Tv=Yh,W2=q2(Function.toString);H2(Tv.inspectSource)||(Tv.inspectSource=function(e){return W2(e)});var ey=Tv.inspectSource,G2=ct,z2=Ot,rb=G2.WeakMap,V2=z2(rb)&&/native code/.test(String(rb)),K2=fs.exports,J2=Ku,nb=K2("keys"),hf=function(e){return nb[e]||(nb[e]=J2(e))},Qu={},Y2=V2,m1=ct,Sd=et,Q2=zt,X2=Ca,$d=Vt,Td=Yh,Z2=hf,eN=Qu,ab="Object already initialized",kv=m1.TypeError,tN=m1.WeakMap,Ic,Mu,Rc,rN=function(e){return Rc(e)?Mu(e):Ic(e,{})},nN=function(e){return function(t){var r;if(!Q2(t)||(r=Mu(t)).type!==e)throw kv("Incompatible receiver, "+e+" required");return r}};if(Y2||Td.state){var Pi=Td.state||(Td.state=new tN),aN=Sd(Pi.get),ib=Sd(Pi.has),iN=Sd(Pi.set);Ic=function(e,t){if(ib(Pi,e))throw kv(ab);return t.facade=e,iN(Pi,e,t),t},Mu=function(e){return aN(Pi,e)||{}},Rc=function(e){return ib(Pi,e)}}else{var Is=Z2("state");eN[Is]=!0,Ic=function(e,t){if($d(e,Is))throw kv(ab);return t.facade=e,X2(e,Is,t),t},Mu=function(e){return $d(e,Is)?e[Is]:{}},Rc=function(e){return $d(e,Is)}}var yn={set:Ic,get:Mu,has:Rc,enforce:rN,getterFor:nN},sN=nt,oN=Ot,Al=Vt,Ev=qt,uN=Yu.CONFIGURABLE,lN=ey,b1=yn,cN=b1.enforce,fN=b1.get,fc=Object.defineProperty,dN=Ev&&!sN(function(){return fc(function(){},"length",{value:8}).length!==8}),pN=String(String).split("String"),vN=Xh.exports=function(e,t,r){String(t).slice(0,7)==="Symbol("&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Al(e,"name")||uN&&e.name!==t)&&(Ev?fc(e,"name",{value:t,configurable:!0}):e.name=t),dN&&r&&Al(r,"arity")&&e.length!==r.arity&&fc(e,"length",{value:r.arity});try{r&&Al(r,"constructor")&&r.constructor?Ev&&fc(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=cN(e);return Al(n,"source")||(n.source=pN.join(typeof t=="string"?t:"")),e};Function.prototype.toString=vN(function(){return oN(this)&&fN(this).source||lN(this)},"toString");var hN=Ot,yN=er,gN=Xh.exports,mN=Jh,Tr=function(e,t,r,n){n||(n={});var a=n.enumerable,i=n.name!==void 0?n.name:t;if(hN(r)&&gN(r,i,n),n.global)a?e[t]=r:mN(t,r);else{try{n.unsafe?e[t]&&(a=!0):delete e[t]}catch{}a?e[t]=r:yN.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},hi={},bN=Math.ceil,wN=Math.floor,_N=Math.trunc||function(t){var r=+t;return(r>0?wN:bN)(r)},SN=_N,ta=function(e){var t=+e;return t!==t||t===0?0:SN(t)},$N=ta,TN=Math.max,kN=Math.min,ds=function(e,t){var r=$N(e);return r<0?TN(r+t,0):kN(r,t)},EN=ta,CN=Math.min,Ia=function(e){return e>0?CN(EN(e),9007199254740991):0},IN=Ia,pr=function(e){return IN(e.length)},RN=Yr,AN=ds,ON=pr,sb=function(e){return function(t,r,n){var a=RN(t),i=ON(a),s=AN(n,i),o;if(e&&r!=r){for(;i>s;)if(o=a[s++],o!=o)return!0}else for(;i>s;s++)if((e||s in a)&&a[s]===r)return e||s||0;return!e&&-1}},yf={includes:sb(!0),indexOf:sb(!1)},PN=et,kd=Vt,MN=Yr,xN=yf.indexOf,NN=Qu,ob=PN([].push),w1=function(e,t){var r=MN(e),n=0,a=[],i;for(i in r)!kd(NN,i)&&kd(r,i)&&ob(a,i);for(;t.length>n;)kd(r,i=t[n++])&&(~xN(a,i)||ob(a,i));return a},ty=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],LN=w1,jN=ty,UN=jN.concat("length","prototype");hi.f=Object.getOwnPropertyNames||function(t){return LN(t,UN)};var Xu={};Xu.f=Object.getOwnPropertySymbols;var FN=hn,DN=et,BN=hi,qN=Xu,HN=Jt,WN=DN([].concat),_1=FN("Reflect","ownKeys")||function(t){var r=BN.f(HN(t)),n=qN.f;return n?WN(r,n(t)):r},ub=Vt,GN=_1,zN=Xn,VN=er,S1=function(e,t,r){for(var n=GN(t),a=VN.f,i=zN.f,s=0;s<n.length;s++){var o=n[s];!ub(e,o)&&!(r&&ub(r,o))&&a(e,o,i(t,o))}},KN=nt,JN=Ot,YN=/#|\.prototype\./,Zu=function(e,t){var r=XN[QN(e)];return r==eL?!0:r==ZN?!1:JN(t)?KN(t):!!t},QN=Zu.normalize=function(e){return String(e).replace(YN,".").toLowerCase()},XN=Zu.data={},ZN=Zu.NATIVE="N",eL=Zu.POLYFILL="P",gf=Zu,Ed=ct,tL=Xn.f,rL=Ca,nL=Tr,aL=Jh,iL=S1,sL=gf,ot=function(e,t){var r=e.target,n=e.global,a=e.stat,i,s,o,u,l,c;if(n?s=Ed:a?s=Ed[r]||aL(r,{}):s=(Ed[r]||{}).prototype,s)for(o in t){if(l=t[o],e.dontCallGetSet?(c=tL(s,o),u=c&&c.value):u=s[o],i=sL(n?o:r+(a?".":"#")+o,e.forced),!i&&u!==void 0){if(typeof l==typeof u)continue;iL(l,u)}(e.sham||u&&u.sham)&&rL(l,"sham",!0),nL(s,o,l,e)}},oL=er.f,uL=Vt,lL=Pt,lb=lL("toStringTag"),Ra=function(e,t,r){e&&!r&&(e=e.prototype),e&&!uL(e,lb)&&oL(e,lb,{configurable:!0,value:t})},cL=ot,fL=ct,dL=Ra;cL({global:!0},{Reflect:{}});dL(fL.Reflect,"Reflect",!0);var pL=Gu,$1=Function.prototype,cb=$1.apply,fb=$1.call,yi=typeof Reflect=="object"&&Reflect.apply||(pL?fb.bind(cb):function(){return fb.apply(cb,arguments)}),vL=et,So=vL([].slice),T1=et,hL=Nn,yL=zt,gL=Vt,db=So,mL=Gu,k1=Function,bL=T1([].concat),wL=T1([].join),Cd={},_L=function(e,t,r){if(!gL(Cd,t)){for(var n=[],a=0;a<t;a++)n[a]="a["+a+"]";Cd[t]=k1("C,a","return new C("+wL(n,",")+")")}return Cd[t](e,r)},SL=mL?k1.bind:function(t){var r=hL(this),n=r.prototype,a=db(arguments,1),i=function(){var o=bL(a,db(arguments));return this instanceof i?_L(r,o.length,o):r.apply(t,o)};return yL(n)&&(i.prototype=n),i},$L=Pt,TL=$L("toStringTag"),E1={};E1[TL]="z";var ry=String(E1)==="[object z]",kL=ry,EL=Ot,dc=vi,CL=Pt,IL=CL("toStringTag"),RL=Object,AL=dc(function(){return arguments}())=="Arguments",OL=function(e,t){try{return e[t]}catch{}},Aa=kL?dc:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=OL(t=RL(e),IL))=="string"?r:AL?dc(t):(n=dc(t))=="Object"&&EL(t.callee)?"Arguments":n},PL=et,ML=nt,C1=Ot,xL=Aa,NL=hn,LL=ey,I1=function(){},jL=[],R1=NL("Reflect","construct"),ny=/^\s*(?:class|function)\b/,UL=PL(ny.exec),FL=!ny.exec(I1),Vo=function(t){if(!C1(t))return!1;try{return R1(I1,jL,t),!0}catch{return!1}},A1=function(t){if(!C1(t))return!1;switch(xL(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return FL||!!UL(ny,LL(t))}catch{return!0}};A1.sham=!0;var mf=!R1||ML(function(){var e;return Vo(Vo.call)||!Vo(Object)||!Vo(function(){e=!0})||e})?A1:Vo,DL=mf,BL=ls,qL=TypeError,ay=function(e){if(DL(e))return e;throw qL(BL(e)+" is not a constructor")},iy={},HL=w1,WL=ty,el=Object.keys||function(t){return HL(t,WL)},GL=qt,zL=y1,VL=er,KL=Jt,JL=Yr,YL=el;iy.f=GL&&!zL?Object.defineProperties:function(t,r){KL(t);for(var n=JL(r),a=YL(r),i=a.length,s=0,o;i>s;)VL.f(t,o=a[s++],n[o]);return t};var QL=hn,O1=QL("document","documentElement"),XL=Jt,ZL=iy,pb=ty,ej=Qu,tj=O1,rj=vf,nj=hf,vb=">",hb="<",Cv="prototype",Iv="script",P1=nj("IE_PROTO"),Id=function(){},M1=function(e){return hb+Iv+vb+e+hb+"/"+Iv+vb},yb=function(e){e.write(M1("")),e.close();var t=e.parentWindow.Object;return e=null,t},aj=function(){var e=rj("iframe"),t="java"+Iv+":",r;return e.style.display="none",tj.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(M1("document.F=Object")),r.close(),r.F},Ol,pc=function(){try{Ol=new ActiveXObject("htmlfile")}catch{}pc=typeof document<"u"?document.domain&&Ol?yb(Ol):aj():yb(Ol);for(var e=pb.length;e--;)delete pc[Cv][pb[e]];return pc()};ej[P1]=!0;var gi=Object.create||function(t,r){var n;return t!==null?(Id[Cv]=XL(t),n=new Id,Id[Cv]=null,n[P1]=t):n=pc(),r===void 0?n:ZL.f(n,r)},ij=ot,sj=hn,Rd=yi,oj=SL,gb=ay,uj=Jt,mb=zt,lj=gi,x1=nt,sy=sj("Reflect","construct"),cj=Object.prototype,fj=[].push,N1=x1(function(){function e(){}return!(sy(function(){},[],e)instanceof e)}),L1=!x1(function(){sy(function(){})}),bb=N1||L1;ij({target:"Reflect",stat:!0,forced:bb,sham:bb},{construct:function(t,r){gb(t),uj(r);var n=arguments.length<3?t:gb(arguments[2]);if(L1&&!N1)return sy(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var a=[null];return Rd(fj,a,r),new(Rd(oj,t,a))}var i=n.prototype,s=lj(mb(i)?i:cj),o=Rd(t,s,r);return mb(o)?o:s}});var dj=ot,pj=$r,j1=el,vj=nt,hj=vj(function(){j1(1)});dj({target:"Object",stat:!0,forced:hj},{keys:function(t){return j1(pj(t))}});var yj=Aa,gj=String,lr=function(e){if(yj(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return gj(e)},oy={},mj=Ju,bj=er,wj=ss,$o=function(e,t,r){var n=mj(t);n in e?bj.f(e,n,wj(0,r)):e[n]=r},wb=ds,_j=pr,Sj=$o,$j=Array,Tj=Math.max,tl=function(e,t,r){for(var n=_j(e),a=wb(t,n),i=wb(r===void 0?n:r,n),s=$j(Tj(i-a,0)),o=0;a<i;a++,o++)Sj(s,o,e[a]);return s.length=o,s},kj=vi,Ej=Yr,U1=hi.f,Cj=tl,F1=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Ij=function(e){try{return U1(e)}catch{return Cj(F1)}};oy.f=function(t){return F1&&kj(t)=="Window"?Ij(t):U1(Ej(t))};var uy={},Rj=Pt;uy.f=Rj;var Aj=ct,Oj=Aj,_b=Oj,Pj=Vt,Mj=uy,xj=er.f,D1=function(e){var t=_b.Symbol||(_b.Symbol={});Pj(t,e)||xj(t,e,{value:Mj.f(e)})},Nj=At,Lj=hn,jj=Pt,Uj=Tr,Fj=function(){var e=Lj("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=jj("toPrimitive");t&&!t[n]&&Uj(t,n,function(a){return Nj(r,this)},{arity:1})},Sb=et,Dj=Nn,Bj=Gu,qj=Sb(Sb.bind),Oa=function(e,t){return Dj(e),t===void 0?e:Bj?qj(e,t):function(){return e.apply(t,arguments)}},Hj=vi,rl=Array.isArray||function(t){return Hj(t)=="Array"},$b=rl,Wj=mf,Gj=zt,zj=Pt,Vj=zj("species"),Tb=Array,Kj=function(e){var t;return $b(e)&&(t=e.constructor,Wj(t)&&(t===Tb||$b(t.prototype))?t=void 0:Gj(t)&&(t=t[Vj],t===null&&(t=void 0))),t===void 0?Tb:t},Jj=Kj,ly=function(e,t){return new(Jj(e))(t===0?0:t)},Yj=Oa,Qj=et,Xj=Vu,Zj=$r,eU=pr,tU=ly,kb=Qj([].push),Ha=function(e){var t=e==1,r=e==2,n=e==3,a=e==4,i=e==6,s=e==7,o=e==5||i;return function(u,l,c,h){for(var w=Zj(u),b=Xj(w),$=Yj(l,c),A=eU(b),x=0,U=h||tU,B=t?U(u,A):r||s?U(u,0):void 0,ve,se;A>x;x++)if((o||x in b)&&(ve=b[x],se=$(ve,x,w),e))if(t)B[x]=se;else if(se)switch(e){case 3:return!0;case 5:return ve;case 6:return x;case 2:kb(B,ve)}else switch(e){case 4:return!1;case 7:kb(B,ve)}return i?-1:n||a?a:B}},Qr={forEach:Ha(0),map:Ha(1),filter:Ha(2),some:Ha(3),every:Ha(4),find:Ha(5),findIndex:Ha(6),filterReject:Ha(7)},bf=ot,cy=ct,fy=At,rU=et,co=qt,fo=wo,nU=nt,or=Vt,aU=Ea,Rv=Jt,wf=Yr,dy=Ju,iU=lr,Av=ss,xu=gi,B1=el,sU=hi,q1=oy,oU=Xu,H1=Xn,W1=er,uU=iy,G1=zu,Ad=Tr,py=fs.exports,lU=hf,z1=Qu,Eb=Ku,cU=Pt,fU=uy,dU=D1,pU=Fj,vU=Ra,V1=yn,_f=Qr.forEach,Ur=lU("hidden"),Sf="Symbol",Nu="prototype",hU=V1.set,Cb=V1.getterFor(Sf),dn=Object[Nu],Xi=cy.Symbol,lu=Xi&&Xi[Nu],yU=cy.TypeError,Od=cy.QObject,K1=H1.f,Ya=W1.f,J1=q1.f,gU=G1.f,Y1=rU([].push),ma=py("symbols"),nl=py("op-symbols"),mU=py("wks"),Ov=!Od||!Od[Nu]||!Od[Nu].findChild,Pv=co&&nU(function(){return xu(Ya({},"a",{get:function(){return Ya(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=K1(dn,t);n&&delete dn[t],Ya(e,t,r),n&&e!==dn&&Ya(dn,t,n)}:Ya,Pd=function(e,t){var r=ma[e]=xu(lu);return hU(r,{type:Sf,tag:e,description:t}),co||(r.description=t),r},$f=function(t,r,n){t===dn&&$f(nl,r,n),Rv(t);var a=dy(r);return Rv(n),or(ma,a)?(n.enumerable?(or(t,Ur)&&t[Ur][a]&&(t[Ur][a]=!1),n=xu(n,{enumerable:Av(0,!1)})):(or(t,Ur)||Ya(t,Ur,Av(1,{})),t[Ur][a]=!0),Pv(t,a,n)):Ya(t,a,n)},vy=function(t,r){Rv(t);var n=wf(r),a=B1(n).concat(Z1(n));return _f(a,function(i){(!co||fy(Mv,n,i))&&$f(t,i,n[i])}),t},bU=function(t,r){return r===void 0?xu(t):vy(xu(t),r)},Mv=function(t){var r=dy(t),n=fy(gU,this,r);return this===dn&&or(ma,r)&&!or(nl,r)?!1:n||!or(this,r)||!or(ma,r)||or(this,Ur)&&this[Ur][r]?n:!0},Q1=function(t,r){var n=wf(t),a=dy(r);if(!(n===dn&&or(ma,a)&&!or(nl,a))){var i=K1(n,a);return i&&or(ma,a)&&!(or(n,Ur)&&n[Ur][a])&&(i.enumerable=!0),i}},X1=function(t){var r=J1(wf(t)),n=[];return _f(r,function(a){!or(ma,a)&&!or(z1,a)&&Y1(n,a)}),n},Z1=function(e){var t=e===dn,r=J1(t?nl:wf(e)),n=[];return _f(r,function(a){or(ma,a)&&(!t||or(dn,a))&&Y1(n,ma[a])}),n};fo||(Xi=function(){if(aU(lu,this))throw yU("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:iU(arguments[0]),r=Eb(t),n=function(a){this===dn&&fy(n,nl,a),or(this,Ur)&&or(this[Ur],r)&&(this[Ur][r]=!1),Pv(this,r,Av(1,a))};return co&&Ov&&Pv(dn,r,{configurable:!0,set:n}),Pd(r,t)},lu=Xi[Nu],Ad(lu,"toString",function(){return Cb(this).tag}),Ad(Xi,"withoutSetter",function(e){return Pd(Eb(e),e)}),G1.f=Mv,W1.f=$f,uU.f=vy,H1.f=Q1,sU.f=q1.f=X1,oU.f=Z1,fU.f=function(e){return Pd(cU(e),e)},co&&(Ya(lu,"description",{configurable:!0,get:function(){return Cb(this).description}}),Ad(dn,"propertyIsEnumerable",Mv,{unsafe:!0})));bf({global:!0,constructor:!0,wrap:!0,forced:!fo,sham:!fo},{Symbol:Xi});_f(B1(mU),function(e){dU(e)});bf({target:Sf,stat:!0,forced:!fo},{useSetter:function(){Ov=!0},useSimple:function(){Ov=!1}});bf({target:"Object",stat:!0,forced:!fo,sham:!co},{create:bU,defineProperty:$f,defineProperties:vy,getOwnPropertyDescriptor:Q1});bf({target:"Object",stat:!0,forced:!fo},{getOwnPropertyNames:X1});pU();vU(Xi,Sf);z1[Ur]=!0;var wU=wo,eT=wU&&!!Symbol.for&&!!Symbol.keyFor,_U=ot,SU=hn,$U=Vt,TU=lr,tT=fs.exports,kU=eT,Md=tT("string-to-symbol-registry"),EU=tT("symbol-to-string-registry");_U({target:"Symbol",stat:!0,forced:!kU},{for:function(e){var t=TU(e);if($U(Md,t))return Md[t];var r=SU("Symbol")(t);return Md[t]=r,EU[r]=t,r}});var CU=ot,IU=Vt,RU=_o,AU=ls,OU=fs.exports,PU=eT,Ib=OU("symbol-to-string-registry");CU({target:"Symbol",stat:!0,forced:!PU},{keyFor:function(t){if(!RU(t))throw TypeError(AU(t)+" is not a symbol");if(IU(Ib,t))return Ib[t]}});var MU=ot,rT=hn,nT=yi,xU=At,al=et,aT=nt,NU=rl,LU=Ot,jU=zt,Rb=_o,iT=So,UU=wo,ni=rT("JSON","stringify"),Pl=al(/./.exec),Ab=al("".charAt),FU=al("".charCodeAt),DU=al("".replace),BU=al(1 .toString),qU=/[\uD800-\uDFFF]/g,Ob=/^[\uD800-\uDBFF]$/,Pb=/^[\uDC00-\uDFFF]$/,Mb=!UU||aT(function(){var e=rT("Symbol")();return ni([e])!="[null]"||ni({a:e})!="{}"||ni(Object(e))!="{}"}),xb=aT(function(){return ni("\uDF06\uD834")!=='"\\udf06\\ud834"'||ni("\uDEAD")!=='"\\udead"'}),HU=function(e,t){var r=iT(arguments),n=t;if(!(!jU(t)&&e===void 0||Rb(e)))return NU(t)||(t=function(a,i){if(LU(n)&&(i=xU(n,this,a,i)),!Rb(i))return i}),r[1]=t,nT(ni,null,r)},WU=function(e,t,r){var n=Ab(r,t-1),a=Ab(r,t+1);return Pl(Ob,e)&&!Pl(Pb,a)||Pl(Pb,e)&&!Pl(Ob,n)?"\\u"+BU(FU(e,0),16):e};ni&&MU({target:"JSON",stat:!0,arity:3,forced:Mb||xb},{stringify:function(t,r,n){var a=iT(arguments),i=nT(Mb?HU:ni,null,a);return xb&&typeof i=="string"?DU(i,qU,WU):i}});var GU=ot,zU=wo,VU=nt,sT=Xu,KU=$r,JU=!zU||VU(function(){sT.f(1)});GU({target:"Object",stat:!0,forced:JU},{getOwnPropertySymbols:function(t){var r=sT.f;return r?r(KU(t)):[]}});var YU=nt,QU=Pt,XU=us,ZU=QU("species"),il=function(e){return XU>=51||!YU(function(){var t=[],r=t.constructor={};return r[ZU]=function(){return{foo:1}},t[e](Boolean).foo!==1})},eF=ot,tF=Qr.filter,rF=il,nF=rF("filter");eF({target:"Array",proto:!0,forced:!nF},{filter:function(t){return tF(this,t,arguments.length>1?arguments[1]:void 0)}});var aF=ot,iF=nt,sF=Yr,oT=Xn.f,uT=qt,oF=iF(function(){oT(1)}),uF=!uT||oF;aF({target:"Object",stat:!0,forced:uF,sham:!uT},{getOwnPropertyDescriptor:function(t,r){return oT(sF(t),r)}});var lF=ot,cF=qt,fF=_1,dF=Yr,pF=Xn,vF=$o;lF({target:"Object",stat:!0,sham:!cF},{getOwnPropertyDescriptors:function(t){for(var r=dF(t),n=pF.f,a=fF(r),i={},s=0,o,u;a.length>s;)u=n(r,o=a[s++]),u!==void 0&&vF(i,o,u);return i}});var To={exports:{}};(function(e){function t(n,a,i,s,o,u,l){try{var c=n[u](l),h=c.value}catch(w){i(w);return}c.done?a(h):Promise.resolve(h).then(s,o)}function r(n){return function(){var a=this,i=arguments;return new Promise(function(s,o){var u=n.apply(a,i);function l(h){t(u,s,o,l,c,"next",h)}function c(h){t(u,s,o,l,c,"throw",h)}l(void 0)})}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(To);var mi={exports:{}};(function(e){function t(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(mi);var Ln={exports:{}},Tf={exports:{}};(function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Tf);(function(e){var t=Tf.exports;function r(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(a&&a.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),a&&t(n,a)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Ln);var jn={exports:{}},Un={exports:{}};(function(e){function t(r){return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Un);(function(e){var t=Un.exports.default,r=mi.exports;function n(a,i){if(i&&(t(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(a)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(jn);var Xr={exports:{}};(function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Xr);var bi={exports:{}};(function(e){function t(r,n,a){return n in r?Object.defineProperty(r,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[n]=a,r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(bi);var ra={exports:{}};(function(e){function t(n,a){for(var i=0;i<a.length;i++){var s=a[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,s.key,s)}}function r(n,a,i){return a&&t(n.prototype,a),i&&t(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(ra);var Fn={exports:{}};(function(e){function t(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Fn);var hF=ry,yF=Aa,gF=hF?{}.toString:function(){return"[object "+yF(this)+"]"},mF=ry,bF=Tr,wF=gF;mF||bF(Object.prototype,"toString",wF,{unsafe:!0});var _F=vi,SF=ct,sl=_F(SF.process)=="process",$F=Ot,TF=String,kF=TypeError,EF=function(e){if(typeof e=="object"||$F(e))return e;throw kF("Can't set "+TF(e)+" as a prototype")},CF=et,IF=Jt,RF=EF,ko=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=CF(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),r(t,[]),e=t instanceof Array}catch{}return function(a,i){return IF(a),RF(i),e?r(a,i):a.__proto__=i,a}}():void 0),AF=hn,OF=er,PF=Pt,MF=qt,Nb=PF("species"),kf=function(e){var t=AF(e),r=OF.f;MF&&t&&!t[Nb]&&r(t,Nb,{configurable:!0,get:function(){return this}})},xF=Ea,NF=TypeError,ps=function(e,t){if(xF(t,e))return e;throw NF("Incorrect invocation")},Lb=Jt,LF=ay,jF=Zn,UF=Pt,FF=UF("species"),hy=function(e,t){var r=Lb(e).constructor,n;return r===void 0||jF(n=Lb(r)[FF])?t:LF(n)},DF=TypeError,yy=function(e,t){if(e<t)throw DF("Not enough arguments");return e},BF=os,lT=/(?:ipad|iphone|ipod).*applewebkit/i.test(BF),Kr=ct,qF=yi,HF=Oa,jb=Ot,WF=Vt,GF=nt,Ub=O1,zF=So,Fb=vf,VF=yy,KF=lT,JF=sl,xv=Kr.setImmediate,Nv=Kr.clearImmediate,YF=Kr.process,xd=Kr.Dispatch,QF=Kr.Function,Db=Kr.MessageChannel,XF=Kr.String,Nd=0,bu={},Bb="onreadystatechange",Lu,Mi,Ld,jd;try{Lu=Kr.location}catch{}var gy=function(e){if(WF(bu,e)){var t=bu[e];delete bu[e],t()}},Ud=function(e){return function(){gy(e)}},qb=function(e){gy(e.data)},Hb=function(e){Kr.postMessage(XF(e),Lu.protocol+"//"+Lu.host)};(!xv||!Nv)&&(xv=function(t){VF(arguments.length,1);var r=jb(t)?t:QF(t),n=zF(arguments,1);return bu[++Nd]=function(){qF(r,void 0,n)},Mi(Nd),Nd},Nv=function(t){delete bu[t]},JF?Mi=function(e){YF.nextTick(Ud(e))}:xd&&xd.now?Mi=function(e){xd.now(Ud(e))}:Db&&!KF?(Ld=new Db,jd=Ld.port2,Ld.port1.onmessage=qb,Mi=HF(jd.postMessage,jd)):Kr.addEventListener&&jb(Kr.postMessage)&&!Kr.importScripts&&Lu&&Lu.protocol!=="file:"&&!GF(Hb)?(Mi=Hb,Kr.addEventListener("message",qb,!1)):Bb in Fb("script")?Mi=function(e){Ub.appendChild(Fb("script"))[Bb]=function(){Ub.removeChild(this),gy(e)}}:Mi=function(e){setTimeout(Ud(e),0)});var cT={set:xv,clear:Nv},ZF=os,eD=ct,tD=/ipad|iphone|ipod/i.test(ZF)&&eD.Pebble!==void 0,rD=os,nD=/web0s(?!.*chrome)/i.test(rD),ts=ct,Wb=Oa,aD=Xn.f,Fd=cT.set,iD=lT,sD=tD,oD=nD,Dd=sl,Gb=ts.MutationObserver||ts.WebKitMutationObserver,zb=ts.document,Vb=ts.process,Ml=ts.Promise,Kb=aD(ts,"queueMicrotask"),fT=Kb&&Kb.value,Ko,Wi,wu,Bs,Bd,qd,xl,Jb;fT||(Ko=function(){var e,t;for(Dd&&(e=Vb.domain)&&e.exit();Wi;){t=Wi.fn,Wi=Wi.next;try{t()}catch(r){throw Wi?Bs():wu=void 0,r}}wu=void 0,e&&e.enter()},!iD&&!Dd&&!oD&&Gb&&zb?(Bd=!0,qd=zb.createTextNode(""),new Gb(Ko).observe(qd,{characterData:!0}),Bs=function(){qd.data=Bd=!Bd}):!sD&&Ml&&Ml.resolve?(xl=Ml.resolve(void 0),xl.constructor=Ml,Jb=Wb(xl.then,xl),Bs=function(){Jb(Ko)}):Dd?Bs=function(){Vb.nextTick(Ko)}:(Fd=Wb(Fd,ts),Bs=function(){Fd(Ko)}));var uD=fT||function(e){var t={fn:e,next:void 0};wu&&(wu.next=t),Wi||(Wi=t,Bs()),wu=t},lD=ct,cD=function(e,t){var r=lD.console;r&&r.error&&(arguments.length==1?r.error(e):r.error(e,t))},my=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},dT=function(){this.head=null,this.tail=null};dT.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var fD=dT,dD=ct,Ef=dD.Promise,pT=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",pD=pT,vD=sl,hD=!pD&&!vD&&typeof window=="object"&&typeof document=="object",yD=ct,_u=Ef,gD=Ot,mD=gf,bD=ey,wD=Pt,_D=hD,SD=pT,Hd=us;_u&&_u.prototype;var $D=wD("species"),Lv=!1,vT=gD(yD.PromiseRejectionEvent),TD=mD("Promise",function(){var e=bD(_u),t=e!==String(_u);if(!t&&Hd===66)return!0;if(!Hd||Hd<51||!/native code/.test(e)){var r=new _u(function(i){i(1)}),n=function(i){i(function(){},function(){})},a=r.constructor={};if(a[$D]=n,Lv=r.then(function(){})instanceof n,!Lv)return!0}return!t&&(_D||SD)&&!vT}),ol={CONSTRUCTOR:TD,REJECTION_EVENT:vT,SUBCLASSING:Lv},Eo={},Yb=Nn,kD=TypeError,ED=function(e){var t,r;this.promise=new e(function(n,a){if(t!==void 0||r!==void 0)throw kD("Bad Promise constructor");t=n,r=a}),this.resolve=Yb(t),this.reject=Yb(r)};Eo.f=function(e){return new ED(e)};var CD=ot,Ac=sl,fi=ct,po=At,Qb=Tr,Xb=ko,ID=Ra,RD=kf,AD=Nn,vc=Ot,OD=zt,PD=ps,MD=hy,hT=cT.set,by=uD,xD=cD,ND=my,LD=fD,yT=yn,Oc=Ef,wy=ol,gT=Eo,Cf="Promise",mT=wy.CONSTRUCTOR,jD=wy.REJECTION_EVENT,UD=wy.SUBCLASSING,Wd=yT.getterFor(Cf),FD=yT.set,qs=Oc&&Oc.prototype,Gi=Oc,Nl=qs,bT=fi.TypeError,jv=fi.document,_y=fi.process,Uv=gT.f,DD=Uv,BD=!!(jv&&jv.createEvent&&fi.dispatchEvent),wT="unhandledrejection",qD="rejectionhandled",Zb=0,_T=1,HD=2,Sy=1,ST=2,Ll,ew,WD,tw,$T=function(e){var t;return OD(e)&&vc(t=e.then)?t:!1},TT=function(e,t){var r=t.value,n=t.state==_T,a=n?e.ok:e.fail,i=e.resolve,s=e.reject,o=e.domain,u,l,c;try{a?(n||(t.rejection===ST&&zD(t),t.rejection=Sy),a===!0?u=r:(o&&o.enter(),u=a(r),o&&(o.exit(),c=!0)),u===e.promise?s(bT("Promise-chain cycle")):(l=$T(u))?po(l,u,i,s):i(u)):s(r)}catch(h){o&&!c&&o.exit(),s(h)}},kT=function(e,t){e.notified||(e.notified=!0,by(function(){for(var r=e.reactions,n;n=r.get();)TT(n,e);e.notified=!1,t&&!e.rejection&&GD(e)}))},ET=function(e,t,r){var n,a;BD?(n=jv.createEvent("Event"),n.promise=t,n.reason=r,n.initEvent(e,!1,!0),fi.dispatchEvent(n)):n={promise:t,reason:r},!jD&&(a=fi["on"+e])?a(n):e===wT&&xD("Unhandled promise rejection",r)},GD=function(e){po(hT,fi,function(){var t=e.facade,r=e.value,n=rw(e),a;if(n&&(a=ND(function(){Ac?_y.emit("unhandledRejection",r,t):ET(wT,t,r)}),e.rejection=Ac||rw(e)?ST:Sy,a.error))throw a.value})},rw=function(e){return e.rejection!==Sy&&!e.parent},zD=function(e){po(hT,fi,function(){var t=e.facade;Ac?_y.emit("rejectionHandled",t):ET(qD,t,e.value)})},Gs=function(e,t,r){return function(n){e(t,n,r)}},Qs=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=HD,kT(e,!0))},Fv=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw bT("Promise can't be resolved itself");var n=$T(t);n?by(function(){var a={done:!1};try{po(n,t,Gs(Fv,a,e),Gs(Qs,a,e))}catch(i){Qs(a,i,e)}}):(e.value=t,e.state=_T,kT(e,!1))}catch(a){Qs({done:!1},a,e)}}};if(mT&&(Gi=function(t){PD(this,Nl),AD(t),po(Ll,this);var r=Wd(this);try{t(Gs(Fv,r),Gs(Qs,r))}catch(n){Qs(r,n)}},Nl=Gi.prototype,Ll=function(t){FD(this,{type:Cf,done:!1,notified:!1,parent:!1,reactions:new LD,rejection:!1,state:Zb,value:void 0})},Ll.prototype=Qb(Nl,"then",function(t,r){var n=Wd(this),a=Uv(MD(this,Gi));return n.parent=!0,a.ok=vc(t)?t:!0,a.fail=vc(r)&&r,a.domain=Ac?_y.domain:void 0,n.state==Zb?n.reactions.add(a):by(function(){TT(a,n)}),a.promise}),ew=function(){var e=new Ll,t=Wd(e);this.promise=e,this.resolve=Gs(Fv,t),this.reject=Gs(Qs,t)},gT.f=Uv=function(e){return e===Gi||e===WD?new ew(e):DD(e)},vc(Oc)&&qs!==Object.prototype)){tw=qs.then,UD||Qb(qs,"then",function(t,r){var n=this;return new Gi(function(a,i){po(tw,n,a,i)}).then(t,r)},{unsafe:!0});try{delete qs.constructor}catch{}Xb&&Xb(qs,Nl)}CD({global:!0,constructor:!0,wrap:!0,forced:mT},{Promise:Gi});ID(Gi,Cf,!1);RD(Cf);var ul={},VD=Pt,KD=ul,JD=VD("iterator"),YD=Array.prototype,$y=function(e){return e!==void 0&&(KD.Array===e||YD[JD]===e)},QD=Aa,nw=cs,XD=Zn,ZD=ul,e3=Pt,t3=e3("iterator"),ll=function(e){if(!XD(e))return nw(e,t3)||nw(e,"@@iterator")||ZD[QD(e)]},r3=At,n3=Nn,a3=Jt,i3=ls,s3=ll,o3=TypeError,If=function(e,t){var r=arguments.length<2?s3(e):t;if(n3(r))return a3(r3(r,e));throw o3(i3(e)+" is not iterable")},u3=At,aw=Jt,l3=cs,CT=function(e,t,r){var n,a;aw(e);try{if(n=l3(e,"return"),!n){if(t==="throw")throw r;return r}n=u3(n,e)}catch(i){a=!0,n=i}if(t==="throw")throw r;if(a)throw n;return aw(n),r},c3=Oa,f3=At,d3=Jt,p3=ls,v3=$y,h3=pr,iw=Ea,y3=If,g3=ll,sw=CT,m3=TypeError,hc=function(e,t){this.stopped=e,this.result=t},ow=hc.prototype,Rf=function(e,t,r){var n=r&&r.that,a=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),s=!!(r&&r.IS_ITERATOR),o=!!(r&&r.INTERRUPTED),u=c3(t,n),l,c,h,w,b,$,A,x=function(B){return l&&sw(l,"normal",B),new hc(!0,B)},U=function(B){return a?(d3(B),o?u(B[0],B[1],x):u(B[0],B[1])):o?u(B,x):u(B)};if(i)l=e.iterator;else if(s)l=e;else{if(c=g3(e),!c)throw m3(p3(e)+" is not iterable");if(v3(c)){for(h=0,w=h3(e);w>h;h++)if(b=U(e[h]),b&&iw(ow,b))return b;return new hc(!1)}l=y3(e,c)}for($=i?e.next:l.next;!(A=f3($,l)).done;){try{b=U(A.value)}catch(B){sw(l,"throw",B)}if(typeof b=="object"&&b&&iw(ow,b))return b}return new hc(!1)},b3=Pt,IT=b3("iterator"),RT=!1;try{var w3=0,uw={next:function(){return{done:!!w3++}},return:function(){RT=!0}};uw[IT]=function(){return this},Array.from(uw,function(){throw 2})}catch{}var Af=function(e,t){if(!t&&!RT)return!1;var r=!1;try{var n={};n[IT]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},_3=Ef,S3=Af,$3=ol.CONSTRUCTOR,AT=$3||!S3(function(e){_3.all(e).then(void 0,function(){})}),T3=ot,k3=At,E3=Nn,C3=Eo,I3=my,R3=Rf,A3=AT;T3({target:"Promise",stat:!0,forced:A3},{all:function(t){var r=this,n=C3.f(r),a=n.resolve,i=n.reject,s=I3(function(){var o=E3(r.resolve),u=[],l=0,c=1;R3(t,function(h){var w=l++,b=!1;c++,k3(o,r,h).then(function($){b||(b=!0,u[w]=$,--c||a(u))},i)}),--c||a(u)});return s.error&&i(s.value),n.promise}});var O3=ot,P3=ol.CONSTRUCTOR,Dv=Ef,M3=hn,x3=Ot,N3=Tr,lw=Dv&&Dv.prototype;O3({target:"Promise",proto:!0,forced:P3,real:!0},{catch:function(e){return this.then(void 0,e)}});if(x3(Dv)){var cw=M3("Promise").prototype.catch;lw.catch!==cw&&N3(lw,"catch",cw,{unsafe:!0})}var L3=ot,j3=At,U3=Nn,F3=Eo,D3=my,B3=Rf,q3=AT;L3({target:"Promise",stat:!0,forced:q3},{race:function(t){var r=this,n=F3.f(r),a=n.reject,i=D3(function(){var s=U3(r.resolve);B3(t,function(o){j3(s,r,o).then(n.resolve,a)})});return i.error&&a(i.value),n.promise}});var H3=ot,W3=At,G3=Eo,z3=ol.CONSTRUCTOR;H3({target:"Promise",stat:!0,forced:z3},{reject:function(t){var r=G3.f(this);return W3(r.reject,void 0,t),r.promise}});var V3=Jt,K3=zt,J3=Eo,Y3=function(e,t){if(V3(e),K3(t)&&t.constructor===e)return t;var r=J3.f(e),n=r.resolve;return n(t),r.promise},Q3=ot,X3=hn,Z3=ol.CONSTRUCTOR,eB=Y3;X3("Promise");Q3({target:"Promise",stat:!0,forced:Z3},{resolve:function(t){return eB(this,t)}});var tB=ot,rB=Qr.map,nB=il,aB=nB("map");tB({target:"Array",proto:!0,forced:!aB},{map:function(t){return rB(this,t,arguments.length>1?arguments[1]:void 0)}});var OT={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},iB=vf,Gd=iB("span").classList,fw=Gd&&Gd.constructor&&Gd.constructor.prototype,PT=fw===Object.prototype?void 0:fw,sB=nt,cl=function(e,t){var r=[][e];return!!r&&sB(function(){r.call(null,t||function(){return 1},1)})},oB=Qr.forEach,uB=cl,lB=uB("forEach"),cB=lB?[].forEach:function(t){return oB(this,t,arguments.length>1?arguments[1]:void 0)},dw=ct,pw=OT,fB=PT,zd=cB,dB=Ca,MT=function(e){if(e&&e.forEach!==zd)try{dB(e,"forEach",zd)}catch{e.forEach=zd}};for(var Vd in pw)pw[Vd]&&MT(dw[Vd]&&dw[Vd].prototype);MT(fB);var xT={exports:{}};(function(e){var t=Un.exports.default;function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var n={},a=Object.prototype,i=a.hasOwnProperty,s=typeof Symbol=="function"?Symbol:{},o=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(re,H,ue){return Object.defineProperty(re,H,{value:ue,enumerable:!0,configurable:!0,writable:!0}),re[H]}try{c({},"")}catch{c=function(ue,W,me){return ue[W]=me}}function h(re,H,ue,W){var me=H&&H.prototype instanceof $?H:$,_e=Object.create(me.prototype),N=new le(W||[]);return _e._invoke=function(ft,dt,Ee){var Xe="suspendedStart";return function(Ye,D){if(Xe==="executing")throw new Error("Generator is already running");if(Xe==="completed"){if(Ye==="throw")throw D;return xe()}for(Ee.method=Ye,Ee.arg=D;;){var T=Ee.delegate;if(T){var Te=de(T,Ee);if(Te){if(Te===b)continue;return Te}}if(Ee.method==="next")Ee.sent=Ee._sent=Ee.arg;else if(Ee.method==="throw"){if(Xe==="suspendedStart")throw Xe="completed",Ee.arg;Ee.dispatchException(Ee.arg)}else Ee.method==="return"&&Ee.abrupt("return",Ee.arg);Xe="executing";var he=w(ft,dt,Ee);if(he.type==="normal"){if(Xe=Ee.done?"completed":"suspendedYield",he.arg===b)continue;return{value:he.arg,done:Ee.done}}he.type==="throw"&&(Xe="completed",Ee.method="throw",Ee.arg=he.arg)}}}(re,ue,N),_e}function w(re,H,ue){try{return{type:"normal",arg:re.call(H,ue)}}catch(W){return{type:"throw",arg:W}}}n.wrap=h;var b={};function $(){}function A(){}function x(){}var U={};c(U,o,function(){return this});var B=Object.getPrototypeOf,ve=B&&B(B(J([])));ve&&ve!==a&&i.call(ve,o)&&(U=ve);var se=x.prototype=$.prototype=Object.create(U);function Re(re){["next","throw","return"].forEach(function(H){c(re,H,function(ue){return this._invoke(H,ue)})})}function ke(re,H){function ue(me,_e,N,ft){var dt=w(re[me],re,_e);if(dt.type!=="throw"){var Ee=dt.arg,Xe=Ee.value;return Xe&&t(Xe)=="object"&&i.call(Xe,"__await")?H.resolve(Xe.__await).then(function(Ye){ue("next",Ye,N,ft)},function(Ye){ue("throw",Ye,N,ft)}):H.resolve(Xe).then(function(Ye){Ee.value=Ye,N(Ee)},function(Ye){return ue("throw",Ye,N,ft)})}ft(dt.arg)}var W;this._invoke=function(me,_e){function N(){return new H(function(ft,dt){ue(me,_e,ft,dt)})}return W=W?W.then(N,N):N()}}function de(re,H){var ue=re.iterator[H.method];if(ue===void 0){if(H.delegate=null,H.method==="throw"){if(re.iterator.return&&(H.method="return",H.arg=void 0,de(re,H),H.method==="throw"))return b;H.method="throw",H.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var W=w(ue,re.iterator,H.arg);if(W.type==="throw")return H.method="throw",H.arg=W.arg,H.delegate=null,b;var me=W.arg;return me?me.done?(H[re.resultName]=me.value,H.next=re.nextLoc,H.method!=="return"&&(H.method="next",H.arg=void 0),H.delegate=null,b):me:(H.method="throw",H.arg=new TypeError("iterator result is not an object"),H.delegate=null,b)}function P(re){var H={tryLoc:re[0]};1 in re&&(H.catchLoc=re[1]),2 in re&&(H.finallyLoc=re[2],H.afterLoc=re[3]),this.tryEntries.push(H)}function te(re){var H=re.completion||{};H.type="normal",delete H.arg,re.completion=H}function le(re){this.tryEntries=[{tryLoc:"root"}],re.forEach(P,this),this.reset(!0)}function J(re){if(re){var H=re[o];if(H)return H.call(re);if(typeof re.next=="function")return re;if(!isNaN(re.length)){var ue=-1,W=function me(){for(;++ue<re.length;)if(i.call(re,ue))return me.value=re[ue],me.done=!1,me;return me.value=void 0,me.done=!0,me};return W.next=W}}return{next:xe}}function xe(){return{value:void 0,done:!0}}return A.prototype=x,c(se,"constructor",x),c(x,"constructor",A),A.displayName=c(x,l,"GeneratorFunction"),n.isGeneratorFunction=function(re){var H=typeof re=="function"&&re.constructor;return!!H&&(H===A||(H.displayName||H.name)==="GeneratorFunction")},n.mark=function(re){return Object.setPrototypeOf?Object.setPrototypeOf(re,x):(re.__proto__=x,c(re,l,"GeneratorFunction")),re.prototype=Object.create(se),re},n.awrap=function(re){return{__await:re}},Re(ke.prototype),c(ke.prototype,u,function(){return this}),n.AsyncIterator=ke,n.async=function(re,H,ue,W,me){me===void 0&&(me=Promise);var _e=new ke(h(re,H,ue,W),me);return n.isGeneratorFunction(H)?_e:_e.next().then(function(N){return N.done?N.value:_e.next()})},Re(se),c(se,l,"Generator"),c(se,o,function(){return this}),c(se,"toString",function(){return"[object Generator]"}),n.keys=function(re){var H=[];for(var ue in re)H.push(ue);return H.reverse(),function W(){for(;H.length;){var me=H.pop();if(me in re)return W.value=me,W.done=!1,W}return W.done=!0,W}},n.values=J,le.prototype={constructor:le,reset:function(H){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(te),!H)for(var ue in this)ue.charAt(0)==="t"&&i.call(this,ue)&&!isNaN(+ue.slice(1))&&(this[ue]=void 0)},stop:function(){this.done=!0;var H=this.tryEntries[0].completion;if(H.type==="throw")throw H.arg;return this.rval},dispatchException:function(H){if(this.done)throw H;var ue=this;function W(Ee,Xe){return N.type="throw",N.arg=H,ue.next=Ee,Xe&&(ue.method="next",ue.arg=void 0),!!Xe}for(var me=this.tryEntries.length-1;me>=0;--me){var _e=this.tryEntries[me],N=_e.completion;if(_e.tryLoc==="root")return W("end");if(_e.tryLoc<=this.prev){var ft=i.call(_e,"catchLoc"),dt=i.call(_e,"finallyLoc");if(ft&&dt){if(this.prev<_e.catchLoc)return W(_e.catchLoc,!0);if(this.prev<_e.finallyLoc)return W(_e.finallyLoc)}else if(ft){if(this.prev<_e.catchLoc)return W(_e.catchLoc,!0)}else{if(!dt)throw new Error("try statement without catch or finally");if(this.prev<_e.finallyLoc)return W(_e.finallyLoc)}}}},abrupt:function(H,ue){for(var W=this.tryEntries.length-1;W>=0;--W){var me=this.tryEntries[W];if(me.tryLoc<=this.prev&&i.call(me,"finallyLoc")&&this.prev<me.finallyLoc){var _e=me;break}}_e&&(H==="break"||H==="continue")&&_e.tryLoc<=ue&&ue<=_e.finallyLoc&&(_e=null);var N=_e?_e.completion:{};return N.type=H,N.arg=ue,_e?(this.method="next",this.next=_e.finallyLoc,b):this.complete(N)},complete:function(H,ue){if(H.type==="throw")throw H.arg;return H.type==="break"||H.type==="continue"?this.next=H.arg:H.type==="return"?(this.rval=this.arg=H.arg,this.method="return",this.next="end"):H.type==="normal"&&ue&&(this.next=ue),b},finish:function(H){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var W=this.tryEntries[ue];if(W.finallyLoc===H)return this.complete(W.completion,W.afterLoc),te(W),b}},catch:function(H){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var W=this.tryEntries[ue];if(W.tryLoc===H){var me=W.completion;if(me.type==="throw"){var _e=me.arg;te(W)}return _e}}throw new Error("illegal catch attempt")},delegateYield:function(H,ue,W){return this.delegate={iterator:J(H),resultName:ue,nextLoc:W},this.method==="next"&&(this.arg=void 0),b}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(xT);var yc=xT.exports(),fl=yc;try{regeneratorRuntime=yc}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=yc:Function("r","regeneratorRuntime = r")(yc)}var pB=TypeError,vB=9007199254740991,NT=function(e){if(e>vB)throw pB("Maximum allowed index exceeded");return e},hB=ot,yB=nt,gB=rl,mB=zt,bB=$r,wB=pr,vw=NT,hw=$o,_B=ly,SB=il,$B=Pt,TB=us,LT=$B("isConcatSpreadable"),kB=TB>=51||!yB(function(){var e=[];return e[LT]=!1,e.concat()[0]!==e}),EB=SB("concat"),CB=function(e){if(!mB(e))return!1;var t=e[LT];return t!==void 0?!!t:gB(e)},IB=!kB||!EB;hB({target:"Array",proto:!0,arity:1,forced:IB},{concat:function(t){var r=bB(this),n=_B(r,0),a=0,i,s,o,u,l;for(i=-1,o=arguments.length;i<o;i++)if(l=i===-1?r:arguments[i],CB(l))for(u=wB(l),vw(a+u),s=0;s<u;s++,a++)s in l&&hw(n,a,l[s]);else vw(a+1),hw(n,a++,l);return n.length=a,n}});var RB=Jt,AB=CT,OB=function(e,t,r,n){try{return n?t(RB(r)[0],r[1]):t(r)}catch(a){AB(e,"throw",a)}},PB=Oa,MB=At,xB=$r,NB=OB,LB=$y,jB=mf,UB=pr,yw=$o,FB=If,DB=ll,gw=Array,jT=function(t){var r=xB(t),n=jB(this),a=arguments.length,i=a>1?arguments[1]:void 0,s=i!==void 0;s&&(i=PB(i,a>2?arguments[2]:void 0));var o=DB(r),u=0,l,c,h,w,b,$;if(o&&!(this===gw&&LB(o)))for(w=FB(r,o),b=w.next,c=n?new this:[];!(h=MB(b,w)).done;u++)$=s?NB(w,i,[h.value,u],!0):h.value,yw(c,u,$);else for(l=UB(r),c=n?new this(l):gw(l);l>u;u++)$=s?i(r[u],u):r[u],yw(c,u,$);return c.length=u,c},BB=ot,qB=jT,HB=Af,WB=!HB(function(e){Array.from(e)});BB({target:"Array",stat:!0,forced:WB},{from:qB});var Ty=et,GB=ta,zB=lr,VB=ea,KB=Ty("".charAt),mw=Ty("".charCodeAt),JB=Ty("".slice),bw=function(e){return function(t,r){var n=zB(VB(t)),a=GB(r),i=n.length,s,o;return a<0||a>=i?e?"":void 0:(s=mw(n,a),s<55296||s>56319||a+1===i||(o=mw(n,a+1))<56320||o>57343?e?KB(n,a):s:e?JB(n,a,a+2):(s-55296<<10)+(o-56320)+65536)}},ky={codeAt:bw(!1),charAt:bw(!0)},YB=nt,QB=!YB(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),XB=Vt,ZB=Ot,e4=$r,t4=hf,r4=QB,ww=t4("IE_PROTO"),Bv=Object,n4=Bv.prototype,Of=r4?Bv.getPrototypeOf:function(e){var t=e4(e);if(XB(t,ww))return t[ww];var r=t.constructor;return ZB(r)&&t instanceof r?r.prototype:t instanceof Bv?n4:null},a4=nt,i4=Ot,s4=zt,_w=Of,o4=Tr,u4=Pt,qv=u4("iterator"),UT=!1,rs,Kd,Jd;[].keys&&(Jd=[].keys(),"next"in Jd?(Kd=_w(_w(Jd)),Kd!==Object.prototype&&(rs=Kd)):UT=!0);var l4=!s4(rs)||a4(function(){var e={};return rs[qv].call(e)!==e});l4&&(rs={});i4(rs[qv])||o4(rs,qv,function(){return this});var FT={IteratorPrototype:rs,BUGGY_SAFARI_ITERATORS:UT},c4=FT.IteratorPrototype,f4=gi,d4=ss,p4=Ra,v4=ul,h4=function(){return this},DT=function(e,t,r,n){var a=t+" Iterator";return e.prototype=f4(c4,{next:d4(+!n,r)}),p4(e,a,!1),v4[a]=h4,e},y4=ot,g4=At,BT=Yu,m4=Ot,b4=DT,Sw=Of,$w=ko,w4=Ra,_4=Ca,Yd=Tr,S4=Pt,$4=ul,qT=FT,T4=BT.PROPER,k4=BT.CONFIGURABLE,Tw=qT.IteratorPrototype,jl=qT.BUGGY_SAFARI_ITERATORS,Jo=S4("iterator"),kw="keys",Yo="values",Ew="entries",E4=function(){return this},Ey=function(e,t,r,n,a,i,s){b4(r,t,n);var o=function(U){if(U===a&&w)return w;if(!jl&&U in c)return c[U];switch(U){case kw:return function(){return new r(this,U)};case Yo:return function(){return new r(this,U)};case Ew:return function(){return new r(this,U)}}return function(){return new r(this)}},u=t+" Iterator",l=!1,c=e.prototype,h=c[Jo]||c["@@iterator"]||a&&c[a],w=!jl&&h||o(a),b=t=="Array"&&c.entries||h,$,A,x;if(b&&($=Sw(b.call(new e)),$!==Object.prototype&&$.next&&(Sw($)!==Tw&&($w?$w($,Tw):m4($[Jo])||Yd($,Jo,E4)),w4($,u,!0))),T4&&a==Yo&&h&&h.name!==Yo&&(k4?_4(c,"name",Yo):(l=!0,w=function(){return g4(h,this)})),a)if(A={values:o(Yo),keys:i?w:o(kw),entries:o(Ew)},s)for(x in A)(jl||l||!(x in c))&&Yd(c,x,A[x]);else y4({target:t,proto:!0,forced:jl||l},A);return c[Jo]!==w&&Yd(c,Jo,w,{name:a}),$4[t]=w,A},Cy=function(e,t){return{value:e,done:t}},C4=ky.charAt,I4=lr,HT=yn,R4=Ey,Cw=Cy,WT="String Iterator",A4=HT.set,O4=HT.getterFor(WT);R4(String,"String",function(e){A4(this,{type:WT,string:I4(e),index:0})},function(){var t=O4(this),r=t.string,n=t.index,a;return n>=r.length?Cw(void 0,!0):(a=C4(r,n),t.index+=a.length,Cw(a,!1))});var vs={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.log=r()})(Rn,function(){var t=function(){},r="undefined",n=typeof window!==r&&typeof window.navigator!==r&&/Trident\/|MSIE /.test(window.navigator.userAgent),a=["trace","debug","info","warn","error"];function i(A,x){var U=A[x];if(typeof U.bind=="function")return U.bind(A);try{return Function.prototype.bind.call(U,A)}catch{return function(){return Function.prototype.apply.apply(U,[A,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(A){return A==="debug"&&(A="log"),typeof console===r?!1:A==="trace"&&n?s:console[A]!==void 0?i(console,A):console.log!==void 0?i(console,"log"):t}function u(A,x){for(var U=0;U<a.length;U++){var B=a[U];this[B]=U<A?t:this.methodFactory(B,A,x)}this.log=this.debug}function l(A,x,U){return function(){typeof console!==r&&(u.call(this,x,U),this[A].apply(this,arguments))}}function c(A,x,U){return o(A)||l.apply(this,arguments)}function h(A,x,U){var B=this,ve;x=x==null?"WARN":x;var se="loglevel";typeof A=="string"?se+=":"+A:typeof A=="symbol"&&(se=void 0);function Re(te){var le=(a[te]||"silent").toUpperCase();if(!(typeof window===r||!se)){try{window.localStorage[se]=le;return}catch{}try{window.document.cookie=encodeURIComponent(se)+"="+le+";"}catch{}}}function ke(){var te;if(!(typeof window===r||!se)){try{te=window.localStorage[se]}catch{}if(typeof te===r)try{var le=window.document.cookie,J=le.indexOf(encodeURIComponent(se)+"=");J!==-1&&(te=/^([^;]+)/.exec(le.slice(J))[1])}catch{}return B.levels[te]===void 0&&(te=void 0),te}}function de(){if(!(typeof window===r||!se)){try{window.localStorage.removeItem(se);return}catch{}try{window.document.cookie=encodeURIComponent(se)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}B.name=A,B.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},B.methodFactory=U||c,B.getLevel=function(){return ve},B.setLevel=function(te,le){if(typeof te=="string"&&B.levels[te.toUpperCase()]!==void 0&&(te=B.levels[te.toUpperCase()]),typeof te=="number"&&te>=0&&te<=B.levels.SILENT){if(ve=te,le!==!1&&Re(te),u.call(B,te,A),typeof console===r&&te<B.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+te},B.setDefaultLevel=function(te){x=te,ke()||B.setLevel(te,!1)},B.resetLevel=function(){B.setLevel(x,!1),de()},B.enableAll=function(te){B.setLevel(B.levels.TRACE,te)},B.disableAll=function(te){B.setLevel(B.levels.SILENT,te)};var P=ke();P==null&&(P=x),B.setLevel(P,!1)}var w=new h,b={};w.getLogger=function(x){if(typeof x!="symbol"&&typeof x!="string"||x==="")throw new TypeError("You must supply a name when creating a logger.");var U=b[x];return U||(U=b[x]=new h(x,w.getLevel(),w.methodFactory)),U};var $=typeof window!==r?window.log:void 0;return w.noConflict=function(){return typeof window!==r&&window.log===w&&(window.log=$),w},w.getLoggers=function(){return b},w.default=w,w})})(vs);const Zi="\\d+(?:[\\.,]\\d+)?",P4=`(${Zi}W)`,M4=`(${Zi}Y)?(${Zi}M)?(${Zi}D)?`,x4=`T(${Zi}H)?(${Zi}M)?(${Zi}S)?`,N4=`P(?:${P4}|${M4}(?:${x4})?)`,L4=["weeks","years","months","days","hours","minutes","seconds"],Iy=new RegExp(N4),GT=e=>e.match(Iy).slice(1).reduce((t,r,n)=>(t[L4[n]]=parseFloat(r)||0,t),{}),Ry=(e,t)=>{const r=t?t.getTime():Date.now(),n=new Date(r);return n.setFullYear(n.getFullYear()+e.years),n.setMonth(n.getMonth()+e.months),n.setDate(n.getDate()+e.days),n.setHours(n.getHours()+e.hours),n.setMinutes(n.getMinutes()+e.minutes),n.setMilliseconds(n.getMilliseconds()+e.seconds*1e3),n.setDate(n.getDate()+e.weeks*7),n},zT=(e,t)=>{const r=t?t.getTime():Date.now(),n=new Date(r);return(Ry(e,n).getTime()-n.getTime())/1e3},j4={end:Ry,toSeconds:zT,pattern:Iy,parse:GT},U4=Object.freeze(Object.defineProperty({__proto__:null,pattern:Iy,parse:GT,end:Ry,toSeconds:zT,default:j4},Symbol.toStringTag,{value:"Module"})),F4=tx(U4);var D4=Pt,B4=gi,q4=er.f,Hv=D4("unscopables"),Wv=Array.prototype;Wv[Hv]==null&&q4(Wv,Hv,{configurable:!0,value:B4(null)});var Ay=function(e){Wv[Hv][e]=!0},H4=Yr,Oy=Ay,Iw=ul,VT=yn,W4=er.f,G4=Ey,Ul=Cy,z4=qt,KT="Array Iterator",V4=VT.set,K4=VT.getterFor(KT),JT=G4(Array,"Array",function(e,t){V4(this,{type:KT,target:H4(e),index:0,kind:t})},function(){var e=K4(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Ul(void 0,!0)):r=="keys"?Ul(n,!1):r=="values"?Ul(t[n],!1):Ul([n,t[n]],!1)},"values"),Rw=Iw.Arguments=Iw.Array;Oy("keys");Oy("values");Oy("entries");if(z4&&Rw.name!=="values")try{W4(Rw,"name",{value:"values"})}catch{}var Aw=ct,YT=OT,J4=PT,cu=JT,Qd=Ca,QT=Pt,Xd=QT("iterator"),Ow=QT("toStringTag"),Zd=cu.values,XT=function(e,t){if(e){if(e[Xd]!==Zd)try{Qd(e,Xd,Zd)}catch{e[Xd]=Zd}if(e[Ow]||Qd(e,Ow,t),YT[t]){for(var r in cu)if(e[r]!==cu[r])try{Qd(e,r,cu[r])}catch{e[r]=cu[r]}}}};for(var ep in YT)XT(Aw[ep]&&Aw[ep].prototype,ep);XT(J4,"DOMTokenList");var Y4=Ot,Q4=zt,Pw=ko,Py=function(e,t,r){var n,a;return Pw&&Y4(n=t.constructor)&&n!==r&&Q4(a=n.prototype)&&a!==r.prototype&&Pw(e,a),e},X4=et,Z4=X4(1 .valueOf),e6=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,t6=et,r6=ea,n6=lr,a6=e6,Mw=t6("".replace),Pc="["+a6+"]",i6=RegExp("^"+Pc+Pc+"*"),s6=RegExp(Pc+Pc+"*$"),tp=function(e){return function(t){var r=n6(r6(t));return e&1&&(r=Mw(r,i6,"")),e&2&&(r=Mw(r,s6,"")),r}},o6={start:tp(1),end:tp(2),trim:tp(3)},u6=qt,My=ct,ZT=et,l6=gf,c6=Tr,xw=Vt,f6=Py,d6=Ea,p6=_o,ek=Qh,v6=nt,h6=hi.f,y6=Xn.f,g6=er.f,m6=Z4,b6=o6.trim,Gv="Number",Va=My[Gv],rp=Va.prototype,w6=My.TypeError,_6=ZT("".slice),Fl=ZT("".charCodeAt),S6=function(e){var t=ek(e,"number");return typeof t=="bigint"?t:$6(t)},$6=function(e){var t=ek(e,"number"),r,n,a,i,s,o,u,l;if(p6(t))throw w6("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=b6(t),r=Fl(t,0),r===43||r===45){if(n=Fl(t,2),n===88||n===120)return NaN}else if(r===48){switch(Fl(t,1)){case 66:case 98:a=2,i=49;break;case 79:case 111:a=8,i=55;break;default:return+t}for(s=_6(t,2),o=s.length,u=0;u<o;u++)if(l=Fl(s,u),l<48||l>i)return NaN;return parseInt(s,a)}}return+t};if(l6(Gv,!Va(" 0o1")||!Va("0b1")||Va("+0x1"))){for(var Rs=function(t){var r=arguments.length<1?0:Va(S6(t)),n=this;return d6(rp,n)&&v6(function(){m6(n)})?f6(Object(r),n,Rs):r},Nw=u6?h6(Va):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),np=0,Dl;Nw.length>np;np++)xw(Va,Dl=Nw[np])&&!xw(Rs,Dl)&&g6(Rs,Dl,y6(Va,Dl));Rs.prototype=rp,rp.constructor=Rs,c6(My,Gv,Rs,{constructor:!0})}var T6=Jt,tk=function(){var e=T6(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},xy=nt,k6=ct,Ny=k6.RegExp,Ly=xy(function(){var e=Ny("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),E6=Ly||xy(function(){return!Ny("a","y").sticky}),C6=Ly||xy(function(){var e=Ny("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),rk={BROKEN_CARET:C6,MISSED_STICKY:E6,UNSUPPORTED_Y:Ly},I6=nt,R6=ct,A6=R6.RegExp,O6=I6(function(){var e=A6(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),P6=nt,M6=ct,x6=M6.RegExp,N6=P6(function(){var e=x6("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),zs=At,Pf=et,L6=lr,j6=tk,U6=rk,F6=fs.exports,D6=gi,B6=yn.get,q6=O6,H6=N6,W6=F6("native-string-replace",String.prototype.replace),Mc=RegExp.prototype.exec,zv=Mc,G6=Pf("".charAt),z6=Pf("".indexOf),V6=Pf("".replace),ap=Pf("".slice),Vv=function(){var e=/a/,t=/b*/g;return zs(Mc,e,"a"),zs(Mc,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),nk=U6.BROKEN_CARET,Kv=/()??/.exec("")[1]!==void 0,K6=Vv||Kv||nk||q6||H6;K6&&(zv=function(t){var r=this,n=B6(r),a=L6(t),i=n.raw,s,o,u,l,c,h,w;if(i)return i.lastIndex=r.lastIndex,s=zs(zv,i,a),r.lastIndex=i.lastIndex,s;var b=n.groups,$=nk&&r.sticky,A=zs(j6,r),x=r.source,U=0,B=a;if($&&(A=V6(A,"y",""),z6(A,"g")===-1&&(A+="g"),B=ap(a,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&G6(a,r.lastIndex-1)!==`
`)&&(x="(?: "+x+")",B=" "+B,U++),o=new RegExp("^(?:"+x+")",A)),Kv&&(o=new RegExp("^"+x+"$(?!\\s)",A)),Vv&&(u=r.lastIndex),l=zs(Mc,$?o:r,B),$?l?(l.input=ap(l.input,U),l[0]=ap(l[0],U),l.index=r.lastIndex,r.lastIndex+=l[0].length):r.lastIndex=0:Vv&&l&&(r.lastIndex=r.global?l.index+l[0].length:u),Kv&&l&&l.length>1&&zs(W6,l[0],o,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(l[c]=void 0)}),l&&b)for(l.groups=h=D6(null),c=0;c<b.length;c++)w=b[c],h[w[0]]=l[w[1]];return l});var Mf=zv,J6=ot,Lw=Mf;J6({target:"RegExp",proto:!0,forced:/./.exec!==Lw},{exec:Lw});var jw=et,Uw=Tr,Y6=Mf,Fw=nt,ak=Pt,Q6=Ca,X6=ak("species"),ip=RegExp.prototype,xf=function(e,t,r,n){var a=ak(e),i=!Fw(function(){var l={};return l[a]=function(){return 7},""[e](l)!=7}),s=i&&!Fw(function(){var l=!1,c=/a/;return e==="split"&&(c={},c.constructor={},c.constructor[X6]=function(){return c},c.flags="",c[a]=/./[a]),c.exec=function(){return l=!0,null},c[a](""),!l});if(!i||!s||r){var o=jw(/./[a]),u=t(a,""[e],function(l,c,h,w,b){var $=jw(l),A=c.exec;return A===Y6||A===ip.exec?i&&!b?{done:!0,value:o(c,h,w)}:{done:!0,value:$(h,c,w)}:{done:!1}});Uw(String.prototype,e,u[0]),Uw(ip,a,u[1])}n&&Q6(ip[a],"sham",!0)},Z6=ky.charAt,jy=function(e,t,r){return t+(r?Z6(e,t).length:1)},Uy=et,e5=$r,t5=Math.floor,sp=Uy("".charAt),r5=Uy("".replace),op=Uy("".slice),n5=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a5=/\$([$&'`]|\d{1,2})/g,i5=function(e,t,r,n,a,i){var s=r+e.length,o=n.length,u=a5;return a!==void 0&&(a=e5(a),u=n5),r5(i,u,function(l,c){var h;switch(sp(c,0)){case"$":return"$";case"&":return e;case"`":return op(t,0,r);case"'":return op(t,s);case"<":h=a[op(c,1,-1)];break;default:var w=+c;if(w===0)return l;if(w>o){var b=t5(w/10);return b===0?l:b<=o?n[b-1]===void 0?sp(c,1):n[b-1]+sp(c,1):l}h=n[w-1]}return h===void 0?"":h})},Dw=At,s5=Jt,o5=Ot,u5=vi,l5=Mf,c5=TypeError,Nf=function(e,t){var r=e.exec;if(o5(r)){var n=Dw(r,e,t);return n!==null&&s5(n),n}if(u5(e)==="RegExp")return Dw(l5,e,t);throw c5("RegExp#exec called on incompatible receiver")},f5=yi,Bw=At,Lf=et,d5=xf,p5=nt,v5=Jt,h5=Ot,y5=Zn,g5=ta,m5=Ia,As=lr,b5=ea,w5=jy,_5=cs,S5=i5,$5=Nf,T5=Pt,Jv=T5("replace"),k5=Math.max,E5=Math.min,C5=Lf([].concat),up=Lf([].push),qw=Lf("".indexOf),Hw=Lf("".slice),I5=function(e){return e===void 0?e:String(e)},R5=function(){return"a".replace(/./,"$0")==="$0"}(),Ww=function(){return/./[Jv]?/./[Jv]("a","$0")==="":!1}(),A5=!p5(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});d5("replace",function(e,t,r){var n=Ww?"$":"$0";return[function(i,s){var o=b5(this),u=y5(i)?void 0:_5(i,Jv);return u?Bw(u,i,o,s):Bw(t,As(o),i,s)},function(a,i){var s=v5(this),o=As(a);if(typeof i=="string"&&qw(i,n)===-1&&qw(i,"$<")===-1){var u=r(t,s,o,i);if(u.done)return u.value}var l=h5(i);l||(i=As(i));var c=s.global;if(c){var h=s.unicode;s.lastIndex=0}for(var w=[];;){var b=$5(s,o);if(b===null||(up(w,b),!c))break;var $=As(b[0]);$===""&&(s.lastIndex=w5(o,m5(s.lastIndex),h))}for(var A="",x=0,U=0;U<w.length;U++){b=w[U];for(var B=As(b[0]),ve=k5(E5(g5(b.index),o.length),0),se=[],Re=1;Re<b.length;Re++)up(se,I5(b[Re]));var ke=b.groups;if(l){var de=C5([B],se,ve,o);ke!==void 0&&up(de,ke);var P=As(f5(i,void 0,de))}else P=S5(B,o,ve,se,ke,i);ve>=x&&(A+=Hw(o,x,ve)+P,x=ve+B.length)}return A+Hw(o,x)}]},!A5||!R5||Ww);var O5=ot,P5=et,M5=Vu,x5=Yr,N5=cl,L5=P5([].join),j5=M5!=Object,U5=N5("join",",");O5({target:"Array",proto:!0,forced:j5||!U5},{join:function(t){return L5(x5(this),t===void 0?",":t)}});var kr={},F5=ot,Gw=rl,D5=mf,B5=zt,zw=ds,q5=pr,H5=Yr,W5=$o,G5=Pt,z5=il,V5=So,K5=z5("slice"),J5=G5("species"),lp=Array,Y5=Math.max;F5({target:"Array",proto:!0,forced:!K5},{slice:function(t,r){var n=H5(this),a=q5(n),i=zw(t,a),s=zw(r===void 0?a:r,a),o,u,l;if(Gw(n)&&(o=n.constructor,D5(o)&&(o===lp||Gw(o.prototype))?o=void 0:B5(o)&&(o=o[J5],o===null&&(o=void 0)),o===lp||o===void 0))return V5(n,i,s);for(u=new(o===void 0?lp:o)(Y5(s-i,0)),l=0;i<s;i++,l++)i in n&&W5(u,l,n[i]);return u.length=l,u}});var Q5=ot,Vw=At,X5=Ot,Kw=Jt,Z5=lr,e8=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},t.test("abc")===!0&&e}(),t8=/./.test;Q5({target:"RegExp",proto:!0,forced:!e8},{test:function(e){var t=Kw(this),r=Z5(e),n=t.exec;if(!X5(n))return Vw(t8,t,r);var a=Vw(n,t,r);return a===null?!1:(Kw(a),!0)}});var r8=ot,n8=qt,a8=ct,Bl=et,i8=Vt,s8=Ot,o8=Ea,u8=lr,l8=er.f,c8=S1,fa=a8.Symbol,xi=fa&&fa.prototype;if(n8&&s8(fa)&&(!("description"in xi)||fa().description!==void 0)){var Jw={},ql=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:u8(arguments[0]),r=o8(xi,this)?new fa(t):t===void 0?fa():fa(t);return t===""&&(Jw[r]=!0),r};c8(ql,fa),ql.prototype=xi,xi.constructor=ql;var f8=String(fa("test"))=="Symbol(test)",d8=Bl(xi.valueOf),p8=Bl(xi.toString),v8=/^Symbol\((.*)\)[^)]+$/,h8=Bl("".replace),y8=Bl("".slice);l8(xi,"description",{configurable:!0,get:function(){var t=d8(this);if(i8(Jw,t))return"";var r=p8(t),n=f8?y8(r,7,-1):h8(r,v8,"$1");return n===""?void 0:n}}),r8({global:!0,constructor:!0,forced:!0},{Symbol:ql})}var g8=D1;g8("iterator");var m8=qt,b8=Yu.EXISTS,ik=et,w8=er.f,sk=Function.prototype,_8=ik(sk.toString),ok=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,S8=ik(ok.exec),$8="name";m8&&!b8&&w8(sk,$8,{configurable:!0,get:function(){try{return S8(ok,_8(this))[1]}catch{return""}}});var wi={exports:{}},uk={exports:{}};(function(e){function t(r){if(Array.isArray(r))return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(uk);var lk={exports:{}};(function(e){function t(r,n){var a=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(a!=null){var i=[],s=!0,o=!1,u,l;try{for(a=a.call(r);!(s=(u=a.next()).done)&&(i.push(u.value),!(n&&i.length===n));s=!0);}catch(c){o=!0,l=c}finally{try{!s&&a.return!=null&&a.return()}finally{if(o)throw l}}return i}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(lk);var Fy={exports:{}},Dy={exports:{}};(function(e){function t(r,n){(n==null||n>r.length)&&(n=r.length);for(var a=0,i=new Array(n);a<n;a++)i[a]=r[a];return i}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Dy);(function(e){var t=Dy.exports;function r(n,a){if(!!n){if(typeof n=="string")return t(n,a);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(n,a)}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Fy);var ck={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(ck);(function(e){var t=uk.exports,r=lk.exports,n=Fy.exports,a=ck.exports;function i(s,o){return t(s)||r(s,o)||n(s,o)||a()}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports})(wi);var _i={exports:{}},fk={exports:{}};(function(e){var t=Dy.exports;function r(n){if(Array.isArray(n))return t(n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(fk);var dk={exports:{}};(function(e){function t(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(dk);var pk={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(pk);(function(e){var t=fk.exports,r=dk.exports,n=Fy.exports,a=pk.exports;function i(s){return t(s)||r(s)||n(s)||a()}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports})(_i);var T8=ot,k8=yf.includes,E8=nt,C8=Ay,I8=E8(function(){return!Array(1).includes()});T8({target:"Array",proto:!0,forced:I8},{includes:function(t){return k8(this,t,arguments.length>1?arguments[1]:void 0)}});C8("includes");var R8=zt,A8=Math.floor,vk=Number.isInteger||function(t){return!R8(t)&&isFinite(t)&&A8(t)===t},O8=ot,P8=vk;O8({target:"Number",stat:!0},{isInteger:P8});var M8=qt,hk=et,x8=el,N8=Yr,L8=zu.f,j8=hk(L8),U8=hk([].push),Yw=function(e){return function(t){for(var r=N8(t),n=x8(r),a=n.length,i=0,s=[],o;a>i;)o=n[i++],(!M8||j8(r,o))&&U8(s,e?[o,r[o]]:r[o]);return s}},F8={entries:Yw(!0),values:Yw(!1)},D8=ot,B8=F8.entries;D8({target:"Object",stat:!0},{entries:function(t){return B8(t)}});/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(kr,"__esModule",{value:!0});var q8=Un.exports,H8=wi.exports,W8=_i.exports,G8=ra.exports,z8=Fn.exports,V8=Ln.exports,K8=jn.exports,J8=Xr.exports;function Si(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Xs=Si(q8),ba=Si(H8),cp=Si(W8),Y8=Si(G8),Q8=Si(z8),X8=Si(V8),Z8=Si(K8),Qw=Si(J8),Pa=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function eq(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=tq(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function tq(e,t){if(!!e){if(typeof e=="string")return Xw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xw(e,t)}}function Xw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var yk=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Pa(function(a){var i=!1,s=[],o=eq(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;if(typeof l=="string"){i=i||Xs.default(a)===l,s.push("of type ".concat(l));continue}i=i||a instanceof l,s.push("an instance of ".concat(l.name))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function rq(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=nq(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function nq(e,t){if(!!e){if(typeof e=="string")return Zw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zw(e,t)}}function Zw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var aq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Pa(function(a){var i=!1,s=[],o=rq(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;i=i||a===l,s.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function iq(e){var t=sq();return function(){var n=Qw.default(e),a;if(t){var i=Qw.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Z8.default(this,a)}}function sq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ju(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=oq(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function oq(e,t){if(!!e){if(typeof e=="string")return e_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e_(e,t)}}function e_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var jf=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=ju(r.entries()),a;try{for(n.s();!(a=n.n()).done;){var i=ba.default(a.value,2),s=i[0],o=i[1],u=Ff(t[s],o),l=ba.default(u,4),c=l[0],h=l[1],w=l[2],b=l[3];if(!c){var $=s+1;throw new Error("Argument ".concat($," is expected to be ").concat(w).concat(b," but got ").concat(h))}}}catch(A){n.e(A)}finally{n.f()}},gk=function(t){var r,n,a=["undefined","boolean","number","bigint","string"];if(a.includes(Xs.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),Xs.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var i;n=t===null?"null":"instance of ".concat(t==null||(i=t.constructor)===null||i===void 0?void 0:i.name)}return n||(n=Xs.default(t)),n},uq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=By(r);return function(i){return function(s){X8.default(u,s);var o=iq(u);function u(){Q8.default(this,u);for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return jf(a,c),o.call.apply(o,[this].concat(c))}return Y8.default(u)}(i)}},lq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=By(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return jf(a,c),u.apply(this,c)}}},cq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=By(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];try{jf(a,c)}catch(w){return Promise.reject(w)}return u.apply(this,c)}}},By=function(t){var r=[],n=ju(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.push(Uf(i))}}catch(s){n.e(s)}finally{n.f()}return r},Uf=function(t){var r=[],n=Array.isArray(t)?t:[t],a=ju(n),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;if(typeof s=="string"||typeof s=="function"){r.push(yk(s));continue}r.push(s)}}catch(o){a.e(o)}finally{a.f()}return r},Ff=function(t,r){var n=[],a,i=!1,s=ju(t),o;try{for(s.s();!(o=s.n()).done;){var u=o.value,l=ju(u.checks),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,w=h(r),b=ba.default(w,3),$=b[0],A=b[1],x=b[2];i=i||$,!a&&x&&(a=x),A&&(n=typeof A=="string"?[].concat(cp.default(n),[A]):[].concat(cp.default(n),cp.default(A)))}}catch(se){l.e(se)}finally{l.f()}}}catch(se){s.e(se)}finally{s.f()}if(i)return[!0];var U=a||gk(r),B=n.length-1,ve=B>0?"".concat(n.slice(0,B).join(", ")," or ").concat(n[B]):n.join(", ");return[!1,U,ve,B>1?";":","]};function fq(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=dq(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function dq(e,t){if(!!e){if(typeof e=="string")return t_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t_(e,t)}}function t_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var pq=function(t,r){return Pa(function(n){if(!Array.isArray(n)||n.length<1)return[!1,"a non-empty array of ".concat(t)];var a=fq(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=ba.default(i.value,2),o=s[0],u=s[1],l=Ff(Uf(r),u),c=ba.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid non-empty array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})},vq=Pa(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),hq=Pa(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),yq=Pa(function(e){return[Xs.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]}),gq=function(t,r){return Pa(function(n){if(Xs.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var a=0,i=Object.entries(r);a<i.length;a++){var s=ba.default(i[a],2),o=s[0],u=s[1],l=Ff(Uf(u),n[o]),c=ba.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"valid ".concat(t,' (key "').concat(o,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(o,'" is ').concat(w,")")]}return[!0]})};function mq(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=bq(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function bq(e,t){if(!!e){if(typeof e=="string")return r_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r_(e,t)}}function r_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var wq=function(t,r){return Pa(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var a=mq(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=ba.default(i.value,2),o=s[0],u=s[1],l=Ff(Uf(r),u),c=ba.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})};kr.array=wq;kr.custom=Pa;kr.literal=aq;kr.nonEmptyArray=pq;kr.nonEmptyString=vq;kr.nonNegativeInteger=hq;kr.objectSchema=gq;kr.pureObject=yq;kr.runtimeTypeValidation=jf;kr.stringifyReceivedType=gk;kr.type=yk;kr.validateConstructorTypes=uq;kr.validateTypes=lq;kr.validateTypesAsync=cq;var qy={},Df={exports:{}},mk={exports:{}};(function(e){var t=Xr.exports;function r(n,a){for(;!Object.prototype.hasOwnProperty.call(n,a)&&(n=t(n),n!==null););return n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(mk);(function(e){var t=mk.exports;function r(){return typeof Reflect<"u"&&Reflect.get?(e.exports=r=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=r=function(a,i,s){var o=t(a,i);if(!!o){var u=Object.getOwnPropertyDescriptor(o,i);return u.get?u.get.call(arguments.length<3?a:s):u.value}},e.exports.__esModule=!0,e.exports.default=e.exports),r.apply(this,arguments)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Df);/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/Object.defineProperty(qy,"__esModule",{value:!0});var _q=_i.exports,Sq=Fn.exports,$q=ra.exports,Tq=mi.exports,kq=Df.exports,Eq=Ln.exports,Cq=jn.exports,Iq=Xr.exports,Rq=bi.exports;function Ma(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var n_=Ma(_q),Aq=Ma(Sq),Oq=Ma($q),Pq=Ma(Tq),Ni=Ma(kq),Mq=Ma(Eq),xq=Ma(Cq),da=Ma(Iq),Nq=Ma(Rq),Lq;function ai(){}ai.prototype=Object.create(null);function xt(){xt.init.call(this)}xt.EventEmitter=xt;xt.usingDomains=!1;xt.prototype.domain=void 0;xt.prototype._events=void 0;xt.prototype._maxListeners=void 0;xt.defaultMaxListeners=10;xt.init=function(){this.domain=null,xt.usingDomains&&Lq.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new ai,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};xt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function bk(e){return e._maxListeners===void 0?xt.defaultMaxListeners:e._maxListeners}xt.prototype.getMaxListeners=function(){return bk(this)};function jq(e,t,r){if(t)e.call(r);else for(var n=e.length,a=dl(e,n),i=0;i<n;++i)a[i].call(r)}function Uq(e,t,r,n){if(t)e.call(r,n);else for(var a=e.length,i=dl(e,a),s=0;s<a;++s)i[s].call(r,n)}function Fq(e,t,r,n,a){if(t)e.call(r,n,a);else for(var i=e.length,s=dl(e,i),o=0;o<i;++o)s[o].call(r,n,a)}function Dq(e,t,r,n,a,i){if(t)e.call(r,n,a,i);else for(var s=e.length,o=dl(e,s),u=0;u<s;++u)o[u].call(r,n,a,i)}function Bq(e,t,r,n){if(t)e.apply(r,n);else for(var a=e.length,i=dl(e,a),s=0;s<a;++s)i[s].apply(r,n)}xt.prototype.emit=function(t){var r,n,a,i,s,o,u,l=t==="error";if(o=this._events,o)l=l&&o.error==null;else if(!l)return!1;if(u=this.domain,l){if(r=arguments[1],u)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=u,r.domainThrown=!1,u.emit("error",r);else{if(r instanceof Error)throw r;var c=new Error('Uncaught, unspecified "error" event. ('+r+")");throw c.context=r,c}return!1}if(n=o[t],!n)return!1;var h=typeof n=="function";switch(a=arguments.length,a){case 1:jq(n,h,this);break;case 2:Uq(n,h,this,arguments[1]);break;case 3:Fq(n,h,this,arguments[1],arguments[2]);break;case 4:Dq(n,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(a-1),s=1;s<a;s++)i[s-1]=arguments[s];Bq(n,h,this,i)}return!0};function wk(e,t,r,n){var a,i,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=e._events,i?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]):(i=e._events=new ai,e._eventsCount=0),!s)s=i[t]=r,++e._eventsCount;else if(typeof s=="function"?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(a=bk(e),a&&a>0&&s.length>a)){s.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,qq(o)}return e}function qq(e){typeof console.warn=="function"?console.warn(e):console.log(e)}xt.prototype.addListener=function(t,r){return wk(this,t,r,!1)};xt.prototype.on=xt.prototype.addListener;xt.prototype.prependListener=function(t,r){return wk(this,t,r,!0)};function _k(e,t,r){var n=!1;function a(){e.removeListener(t,a),n||(n=!0,r.apply(e,arguments))}return a.listener=r,a}xt.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,_k(this,t,r)),this};xt.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,_k(this,t,r)),this};xt.prototype.removeListener=function(t,r){var n,a,i,s,o;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=this._events,!a)return this;if(n=a[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new ai:(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){o=n[s].listener,i=s;break}if(i<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new ai,this;delete a[t]}else Hq(n,i);a.removeListener&&this.emit("removeListener",t,o||r)}return this};xt.prototype.off=function(e,t){return this.removeListener(e,t)};xt.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new ai,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new ai:delete n[t]),this;if(arguments.length===0){for(var a=Object.keys(n),i=0,s;i<a.length;++i)s=a[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new ai,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};xt.prototype.listeners=function(t){var r,n,a=this._events;return a?(r=a[t],r?typeof r=="function"?n=[r.listener||r]:n=Wq(r):n=[]):n=[],n};xt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Sk.call(e,t)};xt.prototype.listenerCount=Sk;function Sk(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}xt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function Hq(e,t){for(var r=t,n=r+1,a=e.length;n<a;r+=1,n+=1)e[r]=e[n];e.pop()}function dl(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function Wq(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function Gq(e){var t=zq();return function(){var n=da.default(e),a;if(t){var i=da.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return xq.default(this,a)}}function zq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Vq=function(e){Mq.default(r,e);var t=Gq(r);function r(){var n;return Aq.default(this,r),n=t.call(this),Nq.default(Pq.default(n),"eventHistory",new Map),n}return Oq.default(r,[{key:"on",value:function(a,i){return Ni.default(da.default(r.prototype),"on",this).call(this,a,i)}},{key:"once",value:function(a,i){return Ni.default(da.default(r.prototype),"once",this).call(this,a,i)}},{key:"off",value:function(a,i){return Ni.default(da.default(r.prototype),"off",this).call(this,a,i)}},{key:"emit",value:function(a){for(var i,s=arguments.length,o=new Array(s>1?s-1:0),u=1;u<s;u++)o[u-1]=arguments[u];return this.eventHistory.set(a,o),(i=Ni.default(da.default(r.prototype),"emit",this)).call.apply(i,[this,a].concat(o))}},{key:"addListener",value:function(a,i){return Ni.default(da.default(r.prototype),"addListener",this).call(this,a,i)}},{key:"removeListener",value:function(a,i){return Ni.default(da.default(r.prototype),"removeListener",this).call(this,a,i)}},{key:"addListenerWithReplay",value:function(a,i){var s=this.eventHistory.get(a);return s!==void 0&&i.apply(void 0,n_.default(s)),this.addListener(a,i)}},{key:"onWithReplay",value:function(a,i){return this.addListenerWithReplay(a,i)}},{key:"onceWithReplay",value:function(a,i){var s=this.eventHistory.get(a);return s!==void 0?(i.apply(void 0,n_.default(s)),this):Ni.default(da.default(r.prototype),"once",this).call(this,a,i)}}]),r}(xt);qy.ReplayEventEmitter=Vq;var Yv={exports:{}};(function(e,t){var r=200,n="__lodash_hash_undefined__",a=1,i=2,s=9007199254740991,o="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",c="[object Boolean]",h="[object Date]",w="[object Error]",b="[object Function]",$="[object GeneratorFunction]",A="[object Map]",x="[object Number]",U="[object Null]",B="[object Object]",ve="[object Promise]",se="[object Proxy]",Re="[object RegExp]",ke="[object Set]",de="[object String]",P="[object Symbol]",te="[object Undefined]",le="[object WeakMap]",J="[object ArrayBuffer]",xe="[object DataView]",re="[object Float32Array]",H="[object Float64Array]",ue="[object Int8Array]",W="[object Int16Array]",me="[object Int32Array]",_e="[object Uint8Array]",N="[object Uint8ClampedArray]",ft="[object Uint16Array]",dt="[object Uint32Array]",Ee=/[\\^$.*+?()[\]{}|]/g,Xe=/^\[object .+?Constructor\]$/,Ye=/^(?:0|[1-9]\d*)$/,D={};D[re]=D[H]=D[ue]=D[W]=D[me]=D[_e]=D[N]=D[ft]=D[dt]=!0,D[o]=D[u]=D[J]=D[c]=D[xe]=D[h]=D[w]=D[b]=D[A]=D[x]=D[B]=D[Re]=D[ke]=D[de]=D[le]=!1;var T=typeof Rn=="object"&&Rn&&Rn.Object===Object&&Rn,Te=typeof self=="object"&&self&&self.Object===Object&&self,he=T||Te||Function("return this")(),Ke=t&&!t.nodeType&&t,Qe=Ke&&!0&&e&&!e.nodeType&&e,Se=Qe&&Qe.exports===Ke,Ge=Se&&T.process,R=function(){try{return Ge&&Ge.binding&&Ge.binding("util")}catch{}}(),C=R&&R.isTypedArray;function Y(M,X){for(var ie=-1,Be=M==null?0:M.length,Dt=0,ut=[];++ie<Be;){var Kt=M[ie];X(Kt,ie,M)&&(ut[Dt++]=Kt)}return ut}function pe(M,X){for(var ie=-1,Be=X.length,Dt=M.length;++ie<Be;)M[Dt+ie]=X[ie];return M}function z(M,X){for(var ie=-1,Be=M==null?0:M.length;++ie<Be;)if(X(M[ie],ie,M))return!0;return!1}function Oe(M,X){for(var ie=-1,Be=Array(M);++ie<M;)Be[ie]=X(ie);return Be}function be(M){return function(X){return M(X)}}function we(M,X){return M.has(X)}function Ae(M,X){return M==null?void 0:M[X]}function ee(M){var X=-1,ie=Array(M.size);return M.forEach(function(Be,Dt){ie[++X]=[Dt,Be]}),ie}function Fe(M,X){return function(ie){return M(X(ie))}}function Ue(M){var X=-1,ie=Array(M.size);return M.forEach(function(Be){ie[++X]=Be}),ie}var Pe=Array.prototype,oe=Function.prototype,F=Object.prototype,G=he["__core-js_shared__"],Q=oe.toString,ye=F.hasOwnProperty,Ne=function(){var M=/[^.]+$/.exec(G&&G.keys&&G.keys.IE_PROTO||"");return M?"Symbol(src)_1."+M:""}(),qe=F.toString,ze=RegExp("^"+Q.call(ye).replace(Ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=Se?he.Buffer:void 0,He=he.Symbol,Le=he.Uint8Array,Z=F.propertyIsEnumerable,ae=Pe.splice,q=He?He.toStringTag:void 0,K=Object.getOwnPropertySymbols,ne=De?De.isBuffer:void 0,ge=Fe(Object.keys,Object),ce=pt(he,"DataView"),je=pt(he,"Map"),Ve=pt(he,"Promise"),at=pt(he,"Set"),tt=pt(he,"WeakMap"),We=pt(Object,"create"),vr=p(ce),rt=p(je),Rr=p(Ve),Ut=p(at),mn=p(tt),rr=He?He.prototype:void 0,Dn=rr?rr.valueOf:void 0;function Ct(M){var X=-1,ie=M==null?0:M.length;for(this.clear();++X<ie;){var Be=M[X];this.set(Be[0],Be[1])}}function hr(){this.__data__=We?We(null):{},this.size=0}function qr(M){var X=this.has(M)&&delete this.__data__[M];return this.size-=X?1:0,X}function Hr(M){var X=this.__data__;if(We){var ie=X[M];return ie===n?void 0:ie}return ye.call(X,M)?X[M]:void 0}function yr(M){var X=this.__data__;return We?X[M]!==void 0:ye.call(X,M)}function ms(M,X){var ie=this.__data__;return this.size+=this.has(M)?0:1,ie[M]=We&&X===void 0?n:X,this}Ct.prototype.clear=hr,Ct.prototype.delete=qr,Ct.prototype.get=Hr,Ct.prototype.has=yr,Ct.prototype.set=ms;function Nr(M){var X=-1,ie=M==null?0:M.length;for(this.clear();++X<ie;){var Be=M[X];this.set(Be[0],Be[1])}}function bs(){this.__data__=[],this.size=0}function Ro(M){var X=this.__data__,ie=_n(X,M);if(ie<0)return!1;var Be=X.length-1;return ie==Be?X.pop():ae.call(X,ie,1),--this.size,!0}function Ao(M){var X=this.__data__,ie=_n(X,M);return ie<0?void 0:X[ie][1]}function ws(M){return _n(this.__data__,M)>-1}function Oo(M,X){var ie=this.__data__,Be=_n(ie,M);return Be<0?(++this.size,ie.push([M,X])):ie[Be][1]=X,this}Nr.prototype.clear=bs,Nr.prototype.delete=Ro,Nr.prototype.get=Ao,Nr.prototype.has=ws,Nr.prototype.set=Oo;function bn(M){var X=-1,ie=M==null?0:M.length;for(this.clear();++X<ie;){var Be=M[X];this.set(Be[0],Be[1])}}function wn(){this.size=0,this.__data__={hash:new Ct,map:new(je||Nr),string:new Ct}}function St(M){var X=aa(this,M).delete(M);return this.size-=X?1:0,X}function Po(M){return aa(this,M).get(M)}function Mo(M){return aa(this,M).has(M)}function xo(M,X){var ie=aa(this,M),Be=ie.size;return ie.set(M,X),this.size+=ie.size==Be?0:1,this}bn.prototype.clear=wn,bn.prototype.delete=St,bn.prototype.get=Po,bn.prototype.has=Mo,bn.prototype.set=xo;function na(M){var X=-1,ie=M==null?0:M.length;for(this.__data__=new bn;++X<ie;)this.add(M[X])}function _s(M){return this.__data__.set(M,n),this}function No(M){return this.__data__.has(M)}na.prototype.add=na.prototype.push=_s,na.prototype.has=No;function tn(M){var X=this.__data__=new Nr(M);this.size=X.size}function Lo(){this.__data__=new Nr,this.size=0}function gr(M){var X=this.__data__,ie=X.delete(M);return this.size=X.size,ie}function jo(M){return this.__data__.get(M)}function Uo(M){return this.__data__.has(M)}function Fo(M,X){var ie=this.__data__;if(ie instanceof Nr){var Be=ie.__data__;if(!je||Be.length<r-1)return Be.push([M,X]),this.size=++ie.size,this;ie=this.__data__=new bn(Be)}return ie.set(M,X),this.size=ie.size,this}tn.prototype.clear=Lo,tn.prototype.delete=gr,tn.prototype.get=jo,tn.prototype.has=Uo,tn.prototype.set=Fo;function Do(M,X){var ie=y(M),Be=!ie&&m(M),Dt=!ie&&!Be&&E(M),ut=!ie&&!Be&&!Dt&&Ze(M),Kt=ie||Be||Dt||ut,ar=Kt?Oe(M.length,String):[],fr=ar.length;for(var Gt in M)(X||ye.call(M,Gt))&&!(Kt&&(Gt=="length"||Dt&&(Gt=="offset"||Gt=="parent")||ut&&(Gt=="buffer"||Gt=="byteLength"||Gt=="byteOffset")||S(Gt,fr)))&&ar.push(Gt);return ar}function _n(M,X){for(var ie=M.length;ie--;)if(f(M[ie][0],X))return ie;return-1}function Bo(M,X,ie){var Be=X(M);return y(M)?Be:pe(Be,ie(M))}function Lr(M){return M==null?M===void 0?te:U:q&&q in Object(M)?Ts(M):d(M)}function Ua(M){return Ft(M)&&Lr(M)==o}function Ci(M,X,ie,Be,Dt){return M===X?!0:M==null||X==null||!Ft(M)&&!Ft(X)?M!==M&&X!==X:qo(M,X,ie,Be,Ci,Dt)}function qo(M,X,ie,Be,Dt,ut){var Kt=y(M),ar=y(X),fr=Kt?u:O(M),Gt=ar?u:O(X);fr=fr==o?B:fr,Gt=Gt==o?B:Gt;var Wr=fr==B,Sn=Gt==B,br=fr==Gt;if(br&&E(M)){if(!E(X))return!1;Kt=!0,Wr=!1}if(br&&!Wr)return ut||(ut=new tn),Kt||Ze(M)?ht(M,X,ie,Be,Dt,ut):$s(M,X,fr,ie,Be,Dt,ut);if(!(ie&a)){var rn=Wr&&ye.call(M,"__wrapped__"),nn=Sn&&ye.call(X,"__wrapped__");if(rn||nn){var Da=rn?M.value():M,ia=nn?X.value():X;return ut||(ut=new tn),Dt(Da,ia,ie,Be,ut)}}return br?(ut||(ut=new tn),Fa(M,X,ie,Be,Dt,ut)):!1}function Ss(M){if(!Je(M)||v(M))return!1;var X=j(M)?ze:Xe;return X.test(p(M))}function Ho(M){return Ft(M)&&Ce(M.length)&&!!D[Lr(M)]}function Wo(M){if(!g(M))return ge(M);var X=[];for(var ie in Object(M))ye.call(M,ie)&&ie!="constructor"&&X.push(ie);return X}function ht(M,X,ie,Be,Dt,ut){var Kt=ie&a,ar=M.length,fr=X.length;if(ar!=fr&&!(Kt&&fr>ar))return!1;var Gt=ut.get(M);if(Gt&&ut.get(X))return Gt==X;var Wr=-1,Sn=!0,br=ie&i?new na:void 0;for(ut.set(M,X),ut.set(X,M);++Wr<ar;){var rn=M[Wr],nn=X[Wr];if(Be)var Da=Kt?Be(nn,rn,Wr,X,M,ut):Be(rn,nn,Wr,M,X,ut);if(Da!==void 0){if(Da)continue;Sn=!1;break}if(br){if(!z(X,function(ia,Ri){if(!we(br,Ri)&&(rn===ia||Dt(rn,ia,ie,Be,ut)))return br.push(Ri)})){Sn=!1;break}}else if(!(rn===nn||Dt(rn,nn,ie,Be,ut))){Sn=!1;break}}return ut.delete(M),ut.delete(X),Sn}function $s(M,X,ie,Be,Dt,ut,Kt){switch(ie){case xe:if(M.byteLength!=X.byteLength||M.byteOffset!=X.byteOffset)return!1;M=M.buffer,X=X.buffer;case J:return!(M.byteLength!=X.byteLength||!ut(new Le(M),new Le(X)));case c:case h:case x:return f(+M,+X);case w:return M.name==X.name&&M.message==X.message;case Re:case de:return M==X+"";case A:var ar=ee;case ke:var fr=Be&a;if(ar||(ar=Ue),M.size!=X.size&&!fr)return!1;var Gt=Kt.get(M);if(Gt)return Gt==X;Be|=i,Kt.set(M,X);var Wr=ht(ar(M),ar(X),Be,Dt,ut,Kt);return Kt.delete(M),Wr;case P:if(Dn)return Dn.call(M)==Dn.call(X)}return!1}function Fa(M,X,ie,Be,Dt,ut){var Kt=ie&a,ar=Ii(M),fr=ar.length,Gt=Ii(X),Wr=Gt.length;if(fr!=Wr&&!Kt)return!1;for(var Sn=fr;Sn--;){var br=ar[Sn];if(!(Kt?br in X:ye.call(X,br)))return!1}var rn=ut.get(M);if(rn&&ut.get(X))return rn==X;var nn=!0;ut.set(M,X),ut.set(X,M);for(var Da=Kt;++Sn<fr;){br=ar[Sn];var ia=M[br],Ri=X[br];if(Be)var Ng=Kt?Be(Ri,ia,br,X,M,ut):Be(ia,Ri,br,M,X,ut);if(!(Ng===void 0?ia===Ri||Dt(ia,Ri,ie,Be,ut):Ng)){nn=!1;break}Da||(Da=br=="constructor")}if(nn&&!Da){var wl=M.constructor,_l=X.constructor;wl!=_l&&"constructor"in M&&"constructor"in X&&!(typeof wl=="function"&&wl instanceof wl&&typeof _l=="function"&&_l instanceof _l)&&(nn=!1)}return ut.delete(M),ut.delete(X),nn}function Ii(M){return Bo(M,mr,I)}function aa(M,X){var ie=M.__data__;return _(X)?ie[typeof X=="string"?"string":"hash"]:ie.map}function pt(M,X){var ie=Ae(M,X);return Ss(ie)?ie:void 0}function Ts(M){var X=ye.call(M,q),ie=M[q];try{M[q]=void 0;var Be=!0}catch{}var Dt=qe.call(M);return Be&&(X?M[q]=ie:delete M[q]),Dt}var I=K?function(M){return M==null?[]:(M=Object(M),Y(K(M),function(X){return Z.call(M,X)}))}:cr,O=Lr;(ce&&O(new ce(new ArrayBuffer(1)))!=xe||je&&O(new je)!=A||Ve&&O(Ve.resolve())!=ve||at&&O(new at)!=ke||tt&&O(new tt)!=le)&&(O=function(M){var X=Lr(M),ie=X==B?M.constructor:void 0,Be=ie?p(ie):"";if(Be)switch(Be){case vr:return xe;case rt:return A;case Rr:return ve;case Ut:return ke;case mn:return le}return X});function S(M,X){return X=X==null?s:X,!!X&&(typeof M=="number"||Ye.test(M))&&M>-1&&M%1==0&&M<X}function _(M){var X=typeof M;return X=="string"||X=="number"||X=="symbol"||X=="boolean"?M!=="__proto__":M===null}function v(M){return!!Ne&&Ne in M}function g(M){var X=M&&M.constructor,ie=typeof X=="function"&&X.prototype||F;return M===ie}function d(M){return qe.call(M)}function p(M){if(M!=null){try{return Q.call(M)}catch{}try{return M+""}catch{}}return""}function f(M,X){return M===X||M!==M&&X!==X}var m=Ua(function(){return arguments}())?Ua:function(M){return Ft(M)&&ye.call(M,"callee")&&!Z.call(M,"callee")},y=Array.isArray;function k(M){return M!=null&&Ce(M.length)&&!j(M)}var E=ne||Ar;function L(M,X){return Ci(M,X)}function j(M){if(!Je(M))return!1;var X=Lr(M);return X==b||X==$||X==l||X==se}function Ce(M){return typeof M=="number"&&M>-1&&M%1==0&&M<=s}function Je(M){var X=typeof M;return M!=null&&(X=="object"||X=="function")}function Ft(M){return M!=null&&typeof M=="object"}var Ze=C?be(C):Ho;function mr(M){return k(M)?Do(M):Wo(M)}function cr(){return[]}function Ar(){return!1}e.exports=L})(Yv,Yv.exports);var Hy={exports:{}},Kq=nt,Jq=Kq(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),Yq=nt,Qq=zt,Xq=vi,a_=Jq,gc=Object.isExtensible,Zq=Yq(function(){gc(1)}),eH=Zq||a_?function(t){return!Qq(t)||a_&&Xq(t)=="ArrayBuffer"?!1:gc?gc(t):!0}:gc,tH=nt,rH=!tH(function(){return Object.isExtensible(Object.preventExtensions({}))}),nH=ot,aH=et,iH=Qu,sH=zt,Wy=Vt,oH=er.f,i_=hi,uH=oy,Gy=eH,lH=Ku,cH=rH,$k=!1,wa=lH("meta"),fH=0,zy=function(e){oH(e,wa,{value:{objectID:"O"+fH++,weakData:{}}})},dH=function(e,t){if(!sH(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!Wy(e,wa)){if(!Gy(e))return"F";if(!t)return"E";zy(e)}return e[wa].objectID},pH=function(e,t){if(!Wy(e,wa)){if(!Gy(e))return!0;if(!t)return!1;zy(e)}return e[wa].weakData},vH=function(e){return cH&&$k&&Gy(e)&&!Wy(e,wa)&&zy(e),e},hH=function(){yH.enable=function(){},$k=!0;var e=i_.f,t=aH([].splice),r={};r[wa]=1,e(r).length&&(i_.f=function(n){for(var a=e(n),i=0,s=a.length;i<s;i++)if(a[i]===wa){t(a,i,1);break}return a},nH({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:uH.f}))},yH=Hy.exports={enable:hH,fastKey:dH,getWeakData:pH,onFreeze:vH};iH[wa]=!0;var gH=ot,mH=ct,bH=et,s_=gf,wH=Tr,_H=Hy.exports,SH=Rf,$H=ps,TH=Ot,kH=Zn,fp=zt,dp=nt,EH=Af,CH=Ra,IH=Py,Tk=function(e,t,r){var n=e.indexOf("Map")!==-1,a=e.indexOf("Weak")!==-1,i=n?"set":"add",s=mH[e],o=s&&s.prototype,u=s,l={},c=function(U){var B=bH(o[U]);wH(o,U,U=="add"?function(se){return B(this,se===0?0:se),this}:U=="delete"?function(ve){return a&&!fp(ve)?!1:B(this,ve===0?0:ve)}:U=="get"?function(se){return a&&!fp(se)?void 0:B(this,se===0?0:se)}:U=="has"?function(se){return a&&!fp(se)?!1:B(this,se===0?0:se)}:function(se,Re){return B(this,se===0?0:se,Re),this})},h=s_(e,!TH(s)||!(a||o.forEach&&!dp(function(){new s().entries().next()})));if(h)u=r.getConstructor(t,e,n,i),_H.enable();else if(s_(e,!0)){var w=new u,b=w[i](a?{}:-0,1)!=w,$=dp(function(){w.has(1)}),A=EH(function(U){new s(U)}),x=!a&&dp(function(){for(var U=new s,B=5;B--;)U[i](B,B);return!U.has(-0)});A||(u=t(function(U,B){$H(U,o);var ve=IH(new s,U,u);return kH(B)||SH(B,ve[i],{that:ve,AS_ENTRIES:n}),ve}),u.prototype=o,o.constructor=u),($||x)&&(c("delete"),c("has"),n&&c("get")),(x||b)&&c(i),a&&o.clear&&delete o.clear}return l[e]=u,gH({global:!0,constructor:!0,forced:u!=s},l),CH(u,e),a||r.setStrong(u,e,n),u},RH=Tr,Vy=function(e,t,r){for(var n in t)RH(e,n,t[n],r);return e},AH=er.f,OH=gi,o_=Vy,PH=Oa,MH=ps,xH=Zn,NH=Rf,LH=Ey,Hl=Cy,jH=kf,Qo=qt,u_=Hy.exports.fastKey,kk=yn,l_=kk.set,pp=kk.getterFor,Ek={getConstructor:function(e,t,r,n){var a=e(function(l,c){MH(l,i),l_(l,{type:t,index:OH(null),first:void 0,last:void 0,size:0}),Qo||(l.size=0),xH(c)||NH(c,l[n],{that:l,AS_ENTRIES:r})}),i=a.prototype,s=pp(t),o=function(l,c,h){var w=s(l),b=u(l,c),$,A;return b?b.value=h:(w.last=b={index:A=u_(c,!0),key:c,value:h,previous:$=w.last,next:void 0,removed:!1},w.first||(w.first=b),$&&($.next=b),Qo?w.size++:l.size++,A!=="F"&&(w.index[A]=b)),l},u=function(l,c){var h=s(l),w=u_(c),b;if(w!=="F")return h.index[w];for(b=h.first;b;b=b.next)if(b.key==c)return b};return o_(i,{clear:function(){for(var c=this,h=s(c),w=h.index,b=h.first;b;)b.removed=!0,b.previous&&(b.previous=b.previous.next=void 0),delete w[b.index],b=b.next;h.first=h.last=void 0,Qo?h.size=0:c.size=0},delete:function(l){var c=this,h=s(c),w=u(c,l);if(w){var b=w.next,$=w.previous;delete h.index[w.index],w.removed=!0,$&&($.next=b),b&&(b.previous=$),h.first==w&&(h.first=b),h.last==w&&(h.last=$),Qo?h.size--:c.size--}return!!w},forEach:function(c){for(var h=s(this),w=PH(c,arguments.length>1?arguments[1]:void 0),b;b=b?b.next:h.first;)for(w(b.value,b.key,this);b&&b.removed;)b=b.previous},has:function(c){return!!u(this,c)}}),o_(i,r?{get:function(c){var h=u(this,c);return h&&h.value},set:function(c,h){return o(this,c===0?0:c,h)}}:{add:function(c){return o(this,c=c===0?0:c,c)}}),Qo&&AH(i,"size",{get:function(){return s(this).size}}),a},setStrong:function(e,t,r){var n=t+" Iterator",a=pp(t),i=pp(n);LH(e,t,function(s,o){l_(this,{type:n,target:s,state:a(s),kind:o,last:void 0})},function(){for(var s=i(this),o=s.kind,u=s.last;u&&u.removed;)u=u.previous;return!s.target||!(s.last=u=u?u.next:s.state.first)?(s.target=void 0,Hl(void 0,!0)):o=="keys"?Hl(u.key,!1):o=="values"?Hl(u.value,!1):Hl([u.key,u.value],!1)},r?"entries":"values",!r,!0),jH(t)}},UH=Tk,FH=Ek;UH("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},FH);var xa={};/*
@license
Copyright (c) 2016, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/Object.defineProperty(xa,"__esModule",{value:!0});var DH=Fn.exports,BH=ra.exports,qH=mi.exports,HH=Ln.exports,WH=jn.exports,GH=Xr.exports,zH=bi.exports;function hs(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Ky=hs(DH),Jy=hs(BH),va=hs(qH),Yy=hs(HH),Ck=hs(WH),xc=hs(GH),ha=hs(zH),VH;function ii(){}ii.prototype=Object.create(null);function kt(){kt.init.call(this)}kt.EventEmitter=kt;kt.usingDomains=!1;kt.prototype.domain=void 0;kt.prototype._events=void 0;kt.prototype._maxListeners=void 0;kt.defaultMaxListeners=10;kt.init=function(){this.domain=null,kt.usingDomains&&VH.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new ii,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};kt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function Ik(e){return e._maxListeners===void 0?kt.defaultMaxListeners:e._maxListeners}kt.prototype.getMaxListeners=function(){return Ik(this)};function KH(e,t,r){if(t)e.call(r);else for(var n=e.length,a=pl(e,n),i=0;i<n;++i)a[i].call(r)}function JH(e,t,r,n){if(t)e.call(r,n);else for(var a=e.length,i=pl(e,a),s=0;s<a;++s)i[s].call(r,n)}function YH(e,t,r,n,a){if(t)e.call(r,n,a);else for(var i=e.length,s=pl(e,i),o=0;o<i;++o)s[o].call(r,n,a)}function QH(e,t,r,n,a,i){if(t)e.call(r,n,a,i);else for(var s=e.length,o=pl(e,s),u=0;u<s;++u)o[u].call(r,n,a,i)}function XH(e,t,r,n){if(t)e.apply(r,n);else for(var a=e.length,i=pl(e,a),s=0;s<a;++s)i[s].apply(r,n)}kt.prototype.emit=function(t){var r,n,a,i,s,o,u,l=t==="error";if(o=this._events,o)l=l&&o.error==null;else if(!l)return!1;if(u=this.domain,l){if(r=arguments[1],u)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=u,r.domainThrown=!1,u.emit("error",r);else{if(r instanceof Error)throw r;var c=new Error('Uncaught, unspecified "error" event. ('+r+")");throw c.context=r,c}return!1}if(n=o[t],!n)return!1;var h=typeof n=="function";switch(a=arguments.length,a){case 1:KH(n,h,this);break;case 2:JH(n,h,this,arguments[1]);break;case 3:YH(n,h,this,arguments[1],arguments[2]);break;case 4:QH(n,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(a-1),s=1;s<a;s++)i[s-1]=arguments[s];XH(n,h,this,i)}return!0};function Rk(e,t,r,n){var a,i,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=e._events,i?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]):(i=e._events=new ii,e._eventsCount=0),!s)s=i[t]=r,++e._eventsCount;else if(typeof s=="function"?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(a=Ik(e),a&&a>0&&s.length>a)){s.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,ZH(o)}return e}function ZH(e){typeof console.warn=="function"?console.warn(e):console.log(e)}kt.prototype.addListener=function(t,r){return Rk(this,t,r,!1)};kt.prototype.on=kt.prototype.addListener;kt.prototype.prependListener=function(t,r){return Rk(this,t,r,!0)};function Ak(e,t,r){var n=!1;function a(){e.removeListener(t,a),n||(n=!0,r.apply(e,arguments))}return a.listener=r,a}kt.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,Ak(this,t,r)),this};kt.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,Ak(this,t,r)),this};kt.prototype.removeListener=function(t,r){var n,a,i,s,o;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=this._events,!a)return this;if(n=a[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new ii:(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){o=n[s].listener,i=s;break}if(i<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new ii,this;delete a[t]}else eW(n,i);a.removeListener&&this.emit("removeListener",t,o||r)}return this};kt.prototype.off=function(e,t){return this.removeListener(e,t)};kt.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new ii,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new ii:delete n[t]),this;if(arguments.length===0){for(var a=Object.keys(n),i=0,s;i<a.length;++i)s=a[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new ii,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};kt.prototype.listeners=function(t){var r,n,a=this._events;return a?(r=a[t],r?typeof r=="function"?n=[r.listener||r]:n=tW(r):n=[]):n=[],n};kt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Ok.call(e,t)};kt.prototype.listenerCount=Ok;function Ok(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}kt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function eW(e,t){for(var r=t,n=r+1,a=e.length;n<a;r+=1,n+=1)e[r]=e[n];e.pop()}function pl(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function tW(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function Pk(e){var t=rW();return function(){var n=xc.default(e),a;if(t){var i=xc.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ck.default(this,a)}}function rW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Mk=function(e){Yy.default(r,e);var t=Pk(r);function r(n){var a;return Ky.default(this,r),a=t.call(this),ha.default(va.default(a),"timeout",null),ha.default(va.default(a),"startTimestamp",-1),a.minDelay=n.min,a.maxDelay=n.max,a.initialDelay=n.initial||0,a.maxAttemptsCount=n.maxAttemptsCount||0,a.maxAttemptsTime=n.maxAttemptsTime||0,a.randomness=n.randomness||0,a.inProgress=!1,a.attemptNum=0,a.prevDelay=0,a.currDelay=0,a}return Jy.default(r,[{key:"attempt",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.attemptNum++,this.emit("attempt",this)}},{key:"nextDelay",value:function(a){if(typeof a=="number")return this.prevDelay=0,this.currDelay=a,a;if(this.attemptNum==0)return this.initialDelay;if(this.attemptNum==1)return this.currDelay=this.minDelay,this.currDelay;this.prevDelay=this.currDelay;var i=this.currDelay+this.prevDelay;return this.maxDelay&&i>this.maxDelay&&(this.currDelay=this.maxDelay,i=this.maxDelay),this.currDelay=i,i}},{key:"randomize",value:function(a){var i=a*this.randomness,s=Math.round(Math.random()*i*2-i);return Math.max(0,a+s)}},{key:"scheduleAttempt",value:function(a){var i=this;if(this.maxAttemptsCount&&this.attemptNum>=this.maxAttemptsCount){this.cleanup(),this.emit("failed",new Error("Maximum attempt count limit reached"));return}var s=this.nextDelay(a);if(s=this.randomize(s),this.maxAttemptsTime&&this.startTimestamp+this.maxAttemptsTime<Date.now()+s){this.cleanup(),this.emit("failed",new Error("Maximum attempt time limit reached"));return}this.timeout=setTimeout(function(){return i.attempt()},s)}},{key:"cleanup",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0}},{key:"start",value:function(){if(this.inProgress)throw new Error("Retrier is already in progress");this.inProgress=!0,this.startTimestamp=Date.now(),this.scheduleAttempt(this.initialDelay)}},{key:"cancel",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.emit("cancelled"))}},{key:"succeeded",value:function(a){this.emit("succeeded",a)}},{key:"failed",value:function(a,i){if(this.timeout)throw new Error("Retrier attempt is already in progress");this.scheduleAttempt(i)}}]),r}(kt),nW=function(e){Yy.default(r,e);var t=Pk(r);function r(n){var a;return Ky.default(this,r),a=t.call(this),ha.default(va.default(a),"resolve",function(){}),ha.default(va.default(a),"reject",function(){}),a.retrier=new Mk(n),a}return Jy.default(r,[{key:"run",value:function(a){var i=this;return this.retrier.on("attempt",function(){a().then(function(s){return i.retrier.succeeded(s)}).catch(function(s){return i.retrier.failed(s)})}),this.retrier.on("succeeded",function(s){return i.resolve(s)}),this.retrier.on("cancelled",function(){return i.reject(new Error("Cancelled"))}),this.retrier.on("failed",function(s){return i.reject(s)}),new Promise(function(s,o){i.resolve=s,i.reject=o,i.retrier.start()})}},{key:"cancel",value:function(){this.retrier.cancel()}}]),r}(kt);function aW(e){var t=iW();return function(){var n=xc.default(e),a;if(t){var i=xc.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ck.default(this,a)}}function iW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wl(e){return e!=null}var sW=function(e){Yy.default(r,e);var t=aW(r);function r(n){var a;Ky.default(this,r),a=t.call(this),ha.default(va.default(a),"backoffDelay",0),ha.default(va.default(a),"nextBackoffDelay",0),ha.default(va.default(a),"backoffNumber",0),ha.default(va.default(a),"timeoutID",null),ha.default(va.default(a),"maxNumberOfRetry",-1),n=n||{};var i=n,s=i.initialDelay,o=i.maxDelay,u=i.randomisationFactor,l=i.factor;if(Wl(s)&&s<1)throw new Error("The initial timeout must be equal to or greater than 1.");if(Wl(o)&&o<=1)throw new Error("The maximal timeout must be greater than 1.");if(Wl(u)&&(u<0||u>1))throw new Error("The randomisation factor must be between 0 and 1.");if(Wl(l)&&l<=1)throw new Error("Exponential factor should be greater than 1.");if(a.initialDelay=s||100,a.maxDelay=o||1e4,a.maxDelay<=a.initialDelay)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");return a.randomisationFactor=u||0,a.factor=l||2,a.reset(),a}return Jy.default(r,[{key:"backoff",value:function(a){this.timeoutID==null&&(this.backoffNumber===this.maxNumberOfRetry?(this.emit("fail",a),this.reset()):(this.backoffDelay=this.next(),this.timeoutID=setTimeout(this.onBackoff.bind(this),this.backoffDelay),this.emit("backoff",this.backoffNumber,this.backoffDelay,a)))}},{key:"reset",value:function(){this.backoffDelay=0,this.nextBackoffDelay=this.initialDelay,this.backoffNumber=0,this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=null}},{key:"failAfter",value:function(a){if(a<=0)throw new Error("Expected a maximum number of retry greater than 0 but got ".concat(a));this.maxNumberOfRetry=a}},{key:"next",value:function(){this.backoffDelay=Math.min(this.nextBackoffDelay,this.maxDelay),this.nextBackoffDelay=this.backoffDelay*this.factor;var a=1+Math.random()*this.randomisationFactor;return Math.min(this.maxDelay,Math.round(this.backoffDelay*a))}},{key:"onBackoff",value:function(){this.timeoutID=null,this.emit("ready",this.backoffNumber,this.backoffDelay),this.backoffNumber++}}],[{key:"exponential",value:function(a){return new r(a)}}]),r}(kt);xa.AsyncRetrier=nW;xa.Backoff=sW;xa.Retrier=Mk;var Bf={},oW=At,uW=Vt,lW=Ea,cW=tk,c_=RegExp.prototype,fW=function(e){var t=e.flags;return t===void 0&&!("flags"in c_)&&!uW(e,"flags")&&lW(c_,e)?oW(cW,e):t},dW=Yu.PROPER,pW=Tr,vW=Jt,f_=lr,hW=nt,yW=fW,Qy="toString",gW=RegExp.prototype,xk=gW[Qy],mW=hW(function(){return xk.call({source:"a",flags:"b"})!="/a/b"}),bW=dW&&xk.name!=Qy;(mW||bW)&&pW(RegExp.prototype,Qy,function(){var t=vW(this),r=f_(t.source),n=f_(yW(t));return"/"+r+"/"+n},{unsafe:!0});var Er={};/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(Er,"__esModule",{value:!0});var wW=Un.exports,_W=wi.exports,SW=_i.exports,$W=Fn.exports,TW=Ln.exports,kW=jn.exports,EW=Xr.exports;function ys(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Zs=ys(wW),ns=ys(_W),vp=ys(SW),CW=ys($W),IW=ys(TW),RW=ys(kW),d_=ys(EW),$i=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function AW(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=OW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function OW(e,t){if(!!e){if(typeof e=="string")return p_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p_(e,t)}}function p_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Nk=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return $i(function(a){var i=!1,s=[],o=AW(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;if(typeof l=="string"){i=i||Zs.default(a)===l,s.push("of type ".concat(l));continue}i=i||a instanceof l,s.push("an instance of ".concat(l.name))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function PW(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=MW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function MW(e,t){if(!!e){if(typeof e=="string")return v_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v_(e,t)}}function v_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var xW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return $i(function(a){var i=!1,s=[],o=PW(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;i=i||a===l,s.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})},NW=$i(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),LW=$i(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),jW=$i(function(e){return[Zs.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]});function UW(e){var t=FW();return function(){var n=d_.default(e),a;if(t){var i=d_.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return RW.default(this,a)}}function FW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Uu(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=DW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function DW(e,t){if(!!e){if(typeof e=="string")return h_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h_(e,t)}}function h_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var qf=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=Uu(r.entries()),a;try{for(n.s();!(a=n.n()).done;){var i=ns.default(a.value,2),s=i[0],o=i[1],u=eg(t[s],o),l=ns.default(u,4),c=l[0],h=l[1],w=l[2],b=l[3];if(!c){var $=s+1;throw new Error("Argument ".concat($," is expected to be ").concat(w).concat(b," but got ").concat(h))}}}catch(A){n.e(A)}finally{n.f()}},Lk=function(t){var r,n,a=["undefined","boolean","number","bigint","string"];if(a.includes(Zs.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),Zs.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var i;n=t===null?"null":"instance of ".concat(t==null||(i=t.constructor)===null||i===void 0?void 0:i.name)}return n||(n=Zs.default(t)),n},BW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Xy(r);return function(i){return function(s){IW.default(u,s);var o=UW(u);function u(){CW.default(this,u);for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return qf(a,c),o.call.apply(o,[this].concat(c))}return u}(i)}},qW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Xy(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return qf(a,c),u.apply(this,c)}}},HW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Xy(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];try{qf(a,c)}catch(w){return Promise.reject(w)}return u.apply(this,c)}}},Xy=function(t){var r=[],n=Uu(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.push(Zy(i))}}catch(s){n.e(s)}finally{n.f()}return r},Zy=function(t){var r=[],n=Array.isArray(t)?t:[t],a=Uu(n),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;if(typeof s=="string"||typeof s=="function"){r.push(Nk(s));continue}r.push(s)}}catch(o){a.e(o)}finally{a.f()}return r},eg=function(t,r){var n=[],a,i=!1,s=Uu(t),o;try{for(s.s();!(o=s.n()).done;){var u=o.value,l=Uu(u.checks),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,w=h(r),b=ns.default(w,3),$=b[0],A=b[1],x=b[2];i=i||$,!a&&x&&(a=x),A&&(n=typeof A=="string"?[].concat(vp.default(n),[A]):[].concat(vp.default(n),vp.default(A)))}}catch(se){l.e(se)}finally{l.f()}}}catch(se){s.e(se)}finally{s.f()}if(i)return[!0];var U=a||Lk(r),B=n.length-1,ve=B>0?"".concat(n.slice(0,B).join(", ")," or ").concat(n[B]):n.join(", ");return[!1,U,ve,B>1?";":","]},WW=function(t,r){return $i(function(n){if(Zs.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var a=0,i=Object.entries(r);a<i.length;a++){var s=ns.default(i[a],2),o=s[0],u=s[1],l=eg(Zy(u),n[o]),c=ns.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"valid ".concat(t,' (key "').concat(o,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(o,'" is ').concat(w,")")]}return[!0]})};function GW(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=zW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function zW(e,t){if(!!e){if(typeof e=="string")return y_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y_(e,t)}}function y_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var VW=function(t,r){return $i(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var a=GW(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=ns.default(i.value,2),o=s[0],u=s[1],l=eg(Zy(r),u),c=ns.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})};Er.array=VW;Er.custom=$i;Er.literal=xW;Er.nonEmptyString=NW;Er.nonNegativeInteger=LW;Er.objectSchema=WW;Er.pureObject=jW;Er.runtimeTypeValidation=qf;Er.stringifyReceivedType=Lk;Er.type=Nk;Er.validateConstructorTypes=BW;Er.validateTypes=qW;Er.validateTypesAsync=HW;var KW=Tk,JW=Ek;KW("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},JW);var jk={exports:{}};(function(e,t){(function(n,a){e.exports=a()})(Rn,function(){return function(r){var n={};function a(i){if(n[i])return n[i].exports;var s=n[i]={i,l:!1,exports:{}};return r[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=r,a.c=n,a.i=function(i){return i},a.d=function(i,s,o){a.o(i,s)||Object.defineProperty(i,s,{configurable:!1,enumerable:!0,get:o})},a.n=function(i){var s=i&&i.__esModule?function(){return i.default}:function(){return i};return a.d(s,"a",s),s},a.o=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)},a.p="",a(a.s=5)}([function(r,n,a){r.exports=function(i,s){var o,u,l;for(o=1;o<arguments.length;o++){u=arguments[o];for(l in u)u.hasOwnProperty(l)&&(i[l]=u[l])}return i}},function(r,n,a){var i=a(0);r.exports={build:function(s,o){var u,l,c,h=o.plugins;for(u=0,l=h.length;u<l;u++)c=h[u],c.methods&&i(s,c.methods),c.properties&&Object.defineProperties(s,c.properties)},hook:function(s,o,u){var l,c,h,w,b=s.config.plugins,$=[s.context];for(u&&($=$.concat(u)),l=0,c=b.length;l<c;l++)w=b[l],h=b[l][o],h&&h.apply(w,$)}}},function(r,n,a){function i(s){if(s.length===0)return s;var o,u,l=s.split(/[_-]/);if(l.length===1&&l[0][0].toLowerCase()===l[0][0])return s;for(u=l[0].toLowerCase(),o=1;o<l.length;o++)u=u+l[o].charAt(0).toUpperCase()+l[o].substring(1).toLowerCase();return u}i.prepended=function(s,o){return o=i(o),s+o[0].toUpperCase()+o.substring(1)},r.exports=i},function(r,n,a){var i=a(0),s=a(2);function o(u,l){u=u||{},this.options=u,this.defaults=l.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(u.init),this.data=this.configureData(u.data),this.methods=this.configureMethods(u.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(u.transitions||[]),this.plugins=this.configurePlugins(u.plugins,l.plugin)}i(o.prototype,{addState:function(u){this.map[u]||(this.states.push(u),this.addStateLifecycleNames(u),this.map[u]={})},addStateLifecycleNames:function(u){this.lifecycle.onEnter[u]=s.prepended("onEnter",u),this.lifecycle.onLeave[u]=s.prepended("onLeave",u),this.lifecycle.on[u]=s.prepended("on",u)},addTransition:function(u){this.transitions.indexOf(u)<0&&(this.transitions.push(u),this.addTransitionLifecycleNames(u))},addTransitionLifecycleNames:function(u){this.lifecycle.onBefore[u]=s.prepended("onBefore",u),this.lifecycle.onAfter[u]=s.prepended("onAfter",u),this.lifecycle.on[u]=s.prepended("on",u)},mapTransition:function(u){var l=u.name,c=u.from,h=u.to;return this.addState(c),typeof h!="function"&&this.addState(h),this.addTransition(l),this.map[c][l]=u,u},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(u){return typeof u=="string"?this.mapTransition(i({},this.defaults.init,{to:u,active:!0})):typeof u=="object"?this.mapTransition(i({},this.defaults.init,u,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(u){return typeof u=="function"?u:typeof u=="object"?function(){return u}:function(){return{}}},configureMethods:function(u){return u||{}},configurePlugins:function(u,l){u=u||[];var c,h,w;for(c=0,h=u.length;c<h;c++)w=u[c],typeof w=="function"&&(u[c]=w=w()),w.configure&&w.configure(this);return u},configureTransitions:function(u){var l,c,h,w,b,$=this.defaults.wildcard;for(c=0;c<u.length;c++)for(h=u[c],w=Array.isArray(h.from)?h.from:[h.from||$],b=h.to||$,l=0;l<w.length;l++)this.mapTransition({name:h.name,from:w[l],to:b})},transitionFor:function(u,l){var c=this.defaults.wildcard;return this.map[u][l]||this.map[c][l]},transitionsFor:function(u){var l=this.defaults.wildcard;return Object.keys(this.map[u]).concat(Object.keys(this.map[l]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),r.exports=o},function(r,n,a){var i=a(0),s=a(6),o=a(1),u=[null,[]];function l(c,h){this.context=c,this.config=h,this.state=h.init.from,this.observers=[c]}i(l.prototype,{init:function(c){if(i(this.context,this.config.data.apply(this.context,c)),o.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(c){return Array.isArray(c)?c.indexOf(this.state)>=0:this.state===c},isPending:function(){return this.pending},can:function(c){return!this.isPending()&&!!this.seek(c)},cannot:function(c){return!this.can(c)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(c,h){var w=this.config.defaults.wildcard,b=this.config.transitionFor(this.state,c),$=b&&b.to;return typeof $=="function"?$.apply(this.context,h):$===w?this.state:$},fire:function(c,h){return this.transit(c,this.state,this.seek(c,h),h)},transit:function(c,h,w,b){var $=this.config.lifecycle,A=this.config.options.observeUnchangedState||h!==w;return w?this.isPending()?this.context.onPendingTransition(c,h,w):(this.config.addState(w),this.beginTransit(),b.unshift({transition:c,from:h,to:w,fsm:this.context}),this.observeEvents([this.observersForEvent($.onBefore.transition),this.observersForEvent($.onBefore[c]),A?this.observersForEvent($.onLeave.state):u,A?this.observersForEvent($.onLeave[h]):u,this.observersForEvent($.on.transition),A?["doTransit",[this]]:u,A?this.observersForEvent($.onEnter.state):u,A?this.observersForEvent($.onEnter[w]):u,A?this.observersForEvent($.on[w]):u,this.observersForEvent($.onAfter.transition),this.observersForEvent($.onAfter[c]),this.observersForEvent($.on[c])],b)):this.context.onInvalidTransition(c,h,w)},beginTransit:function(){this.pending=!0},endTransit:function(c){return this.pending=!1,c},failTransit:function(c){throw this.pending=!1,c},doTransit:function(c){this.state=c.to},observe:function(c){if(c.length===2){var h={};h[c[0]]=c[1],this.observers.push(h)}else this.observers.push(c[0])},observersForEvent:function(c){for(var h=0,w=this.observers.length,b,$=[];h<w;h++)b=this.observers[h],b[c]&&$.push(b);return[c,$,!0]},observeEvents:function(c,h,w,b){if(c.length===0)return this.endTransit(b===void 0?!0:b);var $=c[0][0],A=c[0][1],x=c[0][2];if(h[0].event=$,$&&x&&$!==w&&o.hook(this,"lifecycle",h),A.length===0)return c.shift(),this.observeEvents(c,h,$,b);var U=A.shift(),B=U[$].apply(U,h);return B&&typeof B.then=="function"?B.then(this.observeEvents.bind(this,c,h,$)).catch(this.failTransit.bind(this)):B===!1?this.endTransit(!1):this.observeEvents(c,h,$,B)},onInvalidTransition:function(c,h,w){throw new s("transition is invalid in current state",c,h,w,this.state)},onPendingTransition:function(c,h,w){throw new s("transition is invalid while previous transition is still in progress",c,h,w,this.state)}}),r.exports=l},function(r,n,a){var i=a(0),s=a(2),o=a(1),u=a(3),l=a(4),c={is:function(x){return this._fsm.is(x)},can:function(x){return this._fsm.can(x)},cannot:function(x){return this._fsm.cannot(x)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(x,U,B){return this._fsm.onInvalidTransition(x,U,B)},onPendingTransition:function(x,U,B){return this._fsm.onPendingTransition(x,U,B)}},h={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(x){throw Error("use transitions to change state")}}};function w(x){return $(this||{},x)}function b(){var x,U;typeof arguments[0]=="function"?(x=arguments[0],U=arguments[1]||{}):(x=function(){this._fsm.apply(this,arguments)},U=arguments[0]||{});var B=new u(U,w);return A(x.prototype,B),x.prototype._fsm.config=B,x}function $(x,U){var B=new u(U,w);return A(x,B),x._fsm(),x}function A(x,U){if(typeof x!="object"||Array.isArray(x))throw Error("StateMachine can only be applied to objects");o.build(x,U),Object.defineProperties(x,h),i(x,c),i(x,U.methods),U.allTransitions().forEach(function(B){x[s(B)]=function(){return this._fsm.fire(B,[].slice.call(arguments))}}),x._fsm=function(){this._fsm=new l(this,U),this._fsm.init(arguments)}}w.version="3.0.1",w.factory=b,w.apply=$,w.defaults={wildcard:"*",init:{name:"init",from:"none"}},r.exports=w},function(r,n,a){r.exports=function(i,s,o,u,l){this.message=i,this.transition=s,this.from=o,this.to=u,this.current=l}}])})})(jk);var Nc={exports:{}},g_=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(g_){var m_=new Uint8Array(16);Nc.exports=function(){return g_(m_),m_}}else{var b_=new Array(16);Nc.exports=function(){for(var t=0,r;t<16;t++)(t&3)===0&&(r=Math.random()*4294967296),b_[t]=r>>>((t&3)<<3)&255;return b_}}var Uk=[];for(var Gl=0;Gl<256;++Gl)Uk[Gl]=(Gl+256).toString(16).substr(1);function YW(e,t){var r=t||0,n=Uk;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}var Fk=YW,QW=Nc.exports,XW=Fk,w_,hp,yp=0,gp=0;function ZW(e,t,r){var n=t&&r||0,a=t||[];e=e||{};var i=e.node||w_,s=e.clockseq!==void 0?e.clockseq:hp;if(i==null||s==null){var o=QW();i==null&&(i=w_=[o[0]|1,o[1],o[2],o[3],o[4],o[5]]),s==null&&(s=hp=(o[6]<<8|o[7])&16383)}var u=e.msecs!==void 0?e.msecs:new Date().getTime(),l=e.nsecs!==void 0?e.nsecs:gp+1,c=u-yp+(l-gp)/1e4;if(c<0&&e.clockseq===void 0&&(s=s+1&16383),(c<0||u>yp)&&e.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");yp=u,gp=l,hp=s,u+=122192928e5;var h=((u&268435455)*1e4+l)%4294967296;a[n++]=h>>>24&255,a[n++]=h>>>16&255,a[n++]=h>>>8&255,a[n++]=h&255;var w=u/4294967296*1e4&268435455;a[n++]=w>>>8&255,a[n++]=w&255,a[n++]=w>>>24&15|16,a[n++]=w>>>16&255,a[n++]=s>>>8|128,a[n++]=s&255;for(var b=0;b<6;++b)a[n+b]=i[b];return t||XW(a)}var eG=ZW,tG=Nc.exports,rG=Fk;function nG(e,t,r){var n=t&&r||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var a=e.random||(e.rng||tG)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,t)for(var i=0;i<16;++i)t[n+i]=a[i];return t||rG(a)}var aG=nG,iG=eG,Dk=aG,tg=Dk;tg.v1=iG;tg.v4=Dk;var Hf=tg,Qv={exports:{}},Bk=typeof ArrayBuffer<"u"&&typeof DataView<"u",sG=Bk,rg=qt,Mr=ct,qk=Ot,Wf=zt,di=Vt,ng=Aa,oG=ls,uG=Ca,Xv=Tr,lG=er.f,cG=Ea,Gf=Of,Co=ko,fG=Pt,dG=Ku,Hk=yn,Wk=Hk.enforce,pG=Hk.get,Lc=Mr.Int8Array,Zv=Lc&&Lc.prototype,__=Mr.Uint8ClampedArray,S_=__&&__.prototype,Kn=Lc&&Gf(Lc),An=Zv&&Gf(Zv),vG=Object.prototype,ag=Mr.TypeError,$_=fG("toStringTag"),eh=dG("TYPED_ARRAY_TAG"),jc="TypedArrayConstructor",_a=sG&&!!Co&&ng(Mr.opera)!=="Opera",Gk=!1,Fr,Qa,eo,Sa={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},ig={BigInt64Array:8,BigUint64Array:8},hG=function(t){if(!Wf(t))return!1;var r=ng(t);return r==="DataView"||di(Sa,r)||di(ig,r)},zk=function(e){var t=Gf(e);if(!!Wf(t)){var r=pG(t);return r&&di(r,jc)?r[jc]:zk(t)}},Vk=function(e){if(!Wf(e))return!1;var t=ng(e);return di(Sa,t)||di(ig,t)},yG=function(e){if(Vk(e))return e;throw ag("Target is not a typed array")},gG=function(e){if(qk(e)&&(!Co||cG(Kn,e)))return e;throw ag(oG(e)+" is not a typed array constructor")},mG=function(e,t,r,n){if(!!rg){if(r)for(var a in Sa){var i=Mr[a];if(i&&di(i.prototype,e))try{delete i.prototype[e]}catch{try{i.prototype[e]=t}catch{}}}(!An[e]||r)&&Xv(An,e,r?t:_a&&Zv[e]||t,n)}},bG=function(e,t,r){var n,a;if(!!rg){if(Co){if(r){for(n in Sa)if(a=Mr[n],a&&di(a,e))try{delete a[e]}catch{}}if(!Kn[e]||r)try{return Xv(Kn,e,r?t:_a&&Kn[e]||t)}catch{}else return}for(n in Sa)a=Mr[n],a&&(!a[e]||r)&&Xv(a,e,t)}};for(Fr in Sa)Qa=Mr[Fr],eo=Qa&&Qa.prototype,eo?Wk(eo)[jc]=Qa:_a=!1;for(Fr in ig)Qa=Mr[Fr],eo=Qa&&Qa.prototype,eo&&(Wk(eo)[jc]=Qa);if((!_a||!qk(Kn)||Kn===Function.prototype)&&(Kn=function(){throw ag("Incorrect invocation")},_a))for(Fr in Sa)Mr[Fr]&&Co(Mr[Fr],Kn);if((!_a||!An||An===vG)&&(An=Kn.prototype,_a))for(Fr in Sa)Mr[Fr]&&Co(Mr[Fr].prototype,An);_a&&Gf(S_)!==An&&Co(S_,An);if(rg&&!di(An,$_)){Gk=!0,lG(An,$_,{get:function(){return Wf(this)?this[eh]:void 0}});for(Fr in Sa)Mr[Fr]&&uG(Mr[Fr],eh,Fr)}var Nt={NATIVE_ARRAY_BUFFER_VIEWS:_a,TYPED_ARRAY_TAG:Gk&&eh,aTypedArray:yG,aTypedArrayConstructor:gG,exportTypedArrayMethod:mG,exportTypedArrayStaticMethod:bG,getTypedArrayConstructor:zk,isView:hG,isTypedArray:Vk,TypedArray:Kn,TypedArrayPrototype:An},Kk=ct,mp=nt,wG=Af,_G=Nt.NATIVE_ARRAY_BUFFER_VIEWS,SG=Kk.ArrayBuffer,Li=Kk.Int8Array,$G=!_G||!mp(function(){Li(1)})||!mp(function(){new Li(-1)})||!wG(function(e){new Li,new Li(null),new Li(1.5),new Li(e)},!0)||mp(function(){return new Li(new SG(2),1,void 0).length!==1}),TG=ta,kG=Ia,EG=RangeError,Jk=function(e){if(e===void 0)return 0;var t=TG(e),r=kG(t);if(t!==r)throw EG("Wrong length or index");return r},CG=Array,IG=Math.abs,pa=Math.pow,RG=Math.floor,AG=Math.log,OG=Math.LN2,PG=function(e,t,r){var n=CG(r),a=r*8-t-1,i=(1<<a)-1,s=i>>1,o=t===23?pa(2,-24)-pa(2,-77):0,u=e<0||e===0&&1/e<0?1:0,l=0,c,h,w;for(e=IG(e),e!=e||e===1/0?(h=e!=e?1:0,c=i):(c=RG(AG(e)/OG),w=pa(2,-c),e*w<1&&(c--,w*=2),c+s>=1?e+=o/w:e+=o*pa(2,1-s),e*w>=2&&(c++,w/=2),c+s>=i?(h=0,c=i):c+s>=1?(h=(e*w-1)*pa(2,t),c=c+s):(h=e*pa(2,s-1)*pa(2,t),c=0));t>=8;)n[l++]=h&255,h/=256,t-=8;for(c=c<<t|h,a+=t;a>0;)n[l++]=c&255,c/=256,a-=8;return n[--l]|=u*128,n},MG=function(e,t){var r=e.length,n=r*8-t-1,a=(1<<n)-1,i=a>>1,s=n-7,o=r-1,u=e[o--],l=u&127,c;for(u>>=7;s>0;)l=l*256+e[o--],s-=8;for(c=l&(1<<-s)-1,l>>=-s,s+=t;s>0;)c=c*256+e[o--],s-=8;if(l===0)l=1-i;else{if(l===a)return c?NaN:u?-1/0:1/0;c=c+pa(2,t),l=l-i}return(u?-1:1)*c*pa(2,l-t)},xG={pack:PG,unpack:MG},NG=$r,T_=ds,LG=pr,Yk=function(t){for(var r=NG(this),n=LG(r),a=arguments.length,i=T_(a>1?arguments[1]:void 0,n),s=a>2?arguments[2]:void 0,o=s===void 0?n:T_(s,n);o>i;)r[i++]=t;return r},zf=ct,sg=et,bp=qt,jG=Bk,Qk=Yu,k_=Ca,E_=Vy,wp=nt,zl=ps,UG=ta,FG=Ia,Uc=Jk,Xk=xG,DG=Of,C_=ko,BG=hi.f,qG=er.f,HG=Yk,WG=tl,Zk=Ra,eE=yn,GG=Qk.PROPER,I_=Qk.CONFIGURABLE,vo=eE.get,R_=eE.set,Fc="ArrayBuffer",tE="DataView",to="prototype",zG="Wrong length",rE="Wrong index",ln=zf[Fc],zr=ln,Os=zr&&zr[to],Wn=zf[tE],ji=Wn&&Wn[to],A_=Object.prototype,VG=zf.Array,Dc=zf.RangeError,KG=sg(HG),JG=sg([].reverse),nE=Xk.pack,O_=Xk.unpack,P_=function(e){return[e&255]},M_=function(e){return[e&255,e>>8&255]},x_=function(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]},N_=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},YG=function(e){return nE(e,23,4)},QG=function(e){return nE(e,52,8)},Vl=function(e,t){qG(e[to],t,{get:function(){return vo(this)[t]}})},Wa=function(e,t,r,n){var a=Uc(r),i=vo(e);if(a+t>i.byteLength)throw Dc(rE);var s=vo(i.buffer).bytes,o=a+i.byteOffset,u=WG(s,o,o+t);return n?u:JG(u)},Ga=function(e,t,r,n,a,i){var s=Uc(r),o=vo(e);if(s+t>o.byteLength)throw Dc(rE);for(var u=vo(o.buffer).bytes,l=s+o.byteOffset,c=n(+a),h=0;h<t;h++)u[l+h]=c[i?h:t-h-1]};if(!jG)zr=function(t){zl(this,Os);var r=Uc(t);R_(this,{bytes:KG(VG(r),0),byteLength:r}),bp||(this.byteLength=r)},Os=zr[to],Wn=function(t,r,n){zl(this,ji),zl(t,Os);var a=vo(t).byteLength,i=UG(r);if(i<0||i>a)throw Dc("Wrong offset");if(n=n===void 0?a-i:FG(n),i+n>a)throw Dc(zG);R_(this,{buffer:t,byteLength:n,byteOffset:i}),bp||(this.buffer=t,this.byteLength=n,this.byteOffset=i)},ji=Wn[to],bp&&(Vl(zr,"byteLength"),Vl(Wn,"buffer"),Vl(Wn,"byteLength"),Vl(Wn,"byteOffset")),E_(ji,{getInt8:function(t){return Wa(this,1,t)[0]<<24>>24},getUint8:function(t){return Wa(this,1,t)[0]},getInt16:function(t){var r=Wa(this,2,t,arguments.length>1?arguments[1]:void 0);return(r[1]<<8|r[0])<<16>>16},getUint16:function(t){var r=Wa(this,2,t,arguments.length>1?arguments[1]:void 0);return r[1]<<8|r[0]},getInt32:function(t){return N_(Wa(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return N_(Wa(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return O_(Wa(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return O_(Wa(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,r){Ga(this,1,t,P_,r)},setUint8:function(t,r){Ga(this,1,t,P_,r)},setInt16:function(t,r){Ga(this,2,t,M_,r,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,r){Ga(this,2,t,M_,r,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,r){Ga(this,4,t,x_,r,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,r){Ga(this,4,t,x_,r,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,r){Ga(this,4,t,YG,r,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,r){Ga(this,8,t,QG,r,arguments.length>2?arguments[2]:void 0)}});else{var L_=GG&&ln.name!==Fc;if(!wp(function(){ln(1)})||!wp(function(){new ln(-1)})||wp(function(){return new ln,new ln(1.5),new ln(NaN),ln.length!=1||L_&&!I_})){zr=function(t){return zl(this,Os),new ln(Uc(t))},zr[to]=Os;for(var j_=BG(ln),U_=0,_p;j_.length>U_;)(_p=j_[U_++])in zr||k_(zr,_p,ln[_p]);Os.constructor=zr}else L_&&I_&&k_(ln,"name",Fc);C_&&DG(ji)!==A_&&C_(ji,A_);var Kl=new Wn(new zr(2)),F_=sg(ji.setInt8);Kl.setInt8(0,2147483648),Kl.setInt8(1,2147483649),(Kl.getInt8(0)||!Kl.getInt8(1))&&E_(ji,{setInt8:function(t,r){F_(this,t,r<<24>>24)},setUint8:function(t,r){F_(this,t,r<<24>>24)}},{unsafe:!0})}Zk(zr,Fc);Zk(Wn,tE);var aE={ArrayBuffer:zr,DataView:Wn},XG=ta,ZG=RangeError,ez=function(e){var t=XG(e);if(t<0)throw ZG("The argument can't be less than 0");return t},tz=ez,rz=RangeError,iE=function(e,t){var r=tz(e);if(r%t)throw rz("Wrong offset");return r},nz=Aa,az=et,iz=az("".slice),sz=function(e){return iz(nz(e),0,3)==="Big"},oz=Qh,uz=TypeError,sE=function(e){var t=oz(e,"number");if(typeof t=="number")throw uz("Can't convert number to bigint");return BigInt(t)},lz=Oa,cz=At,fz=ay,dz=$r,pz=pr,vz=If,hz=ll,yz=$y,gz=sz,mz=Nt.aTypedArrayConstructor,bz=sE,wz=function(t){var r=fz(this),n=dz(t),a=arguments.length,i=a>1?arguments[1]:void 0,s=i!==void 0,o=hz(n),u,l,c,h,w,b,$,A;if(o&&!yz(o))for($=vz(n,o),A=$.next,n=[];!(b=cz(A,$)).done;)n.push(b.value);for(s&&a>2&&(i=lz(i,arguments[2])),l=pz(n),c=new(mz(r))(l),h=gz(c),u=0;l>u;u++)w=s?i(n[u],u):n[u],c[u]=h?bz(w):+w;return c},D_=ot,oE=ct,B_=At,_z=qt,Sz=$G,Io=Nt,uE=aE,q_=ps,$z=ss,Xo=Ca,Tz=vk,kz=Ia,H_=Jk,Sp=iE,lE=Ju,Zo=Vt,Ez=Aa,th=zt,Cz=_o,Iz=gi,Rz=Ea,Jl=ko,Az=hi.f,W_=wz,Oz=Qr.forEach,Pz=kf,cE=er,fE=Xn,og=yn,Mz=Py,rh=og.get,xz=og.set,Nz=og.enforce,ug=cE.f,Lz=fE.f,jz=Math.round,$p=oE.RangeError,dE=uE.ArrayBuffer,Uz=dE.prototype,Fz=uE.DataView,Yl=Io.NATIVE_ARRAY_BUFFER_VIEWS,G_=Io.TYPED_ARRAY_TAG,z_=Io.TypedArray,eu=Io.TypedArrayPrototype,Dz=Io.aTypedArrayConstructor,nh=Io.isTypedArray,Ql="BYTES_PER_ELEMENT",Tp="Wrong length",V_=function(e,t){Dz(e);for(var r=0,n=t.length,a=new e(n);n>r;)a[r]=t[r++];return a},Xl=function(e,t){ug(e,t,{get:function(){return rh(this)[t]}})},K_=function(e){var t;return Rz(Uz,e)||(t=Ez(e))=="ArrayBuffer"||t=="SharedArrayBuffer"},pE=function(e,t){return nh(e)&&!Cz(t)&&t in e&&Tz(+t)&&t>=0},J_=function(t,r){return r=lE(r),pE(t,r)?$z(2,t[r]):Lz(t,r)},Y_=function(t,r,n){return r=lE(r),pE(t,r)&&th(n)&&Zo(n,"value")&&!Zo(n,"get")&&!Zo(n,"set")&&!n.configurable&&(!Zo(n,"writable")||n.writable)&&(!Zo(n,"enumerable")||n.enumerable)?(t[r]=n.value,t):ug(t,r,n)};_z?(Yl||(fE.f=J_,cE.f=Y_,Xl(eu,"buffer"),Xl(eu,"byteOffset"),Xl(eu,"byteLength"),Xl(eu,"length")),D_({target:"Object",stat:!0,forced:!Yl},{getOwnPropertyDescriptor:J_,defineProperty:Y_}),Qv.exports=function(e,t,r){var n=e.match(/\d+$/)[0]/8,a=e+(r?"Clamped":"")+"Array",i="get"+e,s="set"+e,o=oE[a],u=o,l=u&&u.prototype,c={},h=function(A,x){var U=rh(A);return U.view[i](x*n+U.byteOffset,!0)},w=function(A,x,U){var B=rh(A);r&&(U=(U=jz(U))<0?0:U>255?255:U&255),B.view[s](x*n+B.byteOffset,U,!0)},b=function(A,x){ug(A,x,{get:function(){return h(this,x)},set:function(U){return w(this,x,U)},enumerable:!0})};Yl?Sz&&(u=t(function(A,x,U,B){return q_(A,l),Mz(function(){return th(x)?K_(x)?B!==void 0?new o(x,Sp(U,n),B):U!==void 0?new o(x,Sp(U,n)):new o(x):nh(x)?V_(u,x):B_(W_,u,x):new o(H_(x))}(),A,u)}),Jl&&Jl(u,z_),Oz(Az(o),function(A){A in u||Xo(u,A,o[A])}),u.prototype=l):(u=t(function(A,x,U,B){q_(A,l);var ve=0,se=0,Re,ke,de;if(!th(x))de=H_(x),ke=de*n,Re=new dE(ke);else if(K_(x)){Re=x,se=Sp(U,n);var P=x.byteLength;if(B===void 0){if(P%n||(ke=P-se,ke<0))throw $p(Tp)}else if(ke=kz(B)*n,ke+se>P)throw $p(Tp);de=ke/n}else return nh(x)?V_(u,x):B_(W_,u,x);for(xz(A,{buffer:Re,byteOffset:se,byteLength:ke,length:de,view:new Fz(Re)});ve<de;)b(A,ve++)}),Jl&&Jl(u,z_),l=u.prototype=Iz(eu)),l.constructor!==u&&Xo(l,"constructor",u),Nz(l).TypedArrayConstructor=u,G_&&Xo(l,G_,a);var $=u!=o;c[a]=u,D_({global:!0,constructor:!0,forced:$,sham:!Yl},c),Ql in u||Xo(u,Ql,n),Ql in l||Xo(l,Ql,n),Pz(a)}):Qv.exports=function(){};var Bz=Qv.exports;Bz("Uint8",function(e){return function(r,n,a){return e(this,r,n,a)}});var Q_=ls,qz=TypeError,lg=function(e,t){if(!delete e[t])throw qz("Cannot delete property "+Q_(t)+" of "+Q_(e))},Hz=$r,kp=ds,Wz=pr,Gz=lg,zz=Math.min,Vz=[].copyWithin||function(t,r){var n=Hz(this),a=Wz(n),i=kp(t,a),s=kp(r,a),o=arguments.length>2?arguments[2]:void 0,u=zz((o===void 0?a:kp(o,a))-s,a-i),l=1;for(s<i&&i<s+u&&(l=-1,s+=u-1,i+=u-1);u-- >0;)s in n?n[i]=n[s]:Gz(n,i),i+=l,s+=l;return n},Kz=et,vE=Nt,Jz=Vz,Yz=Kz(Jz),Qz=vE.aTypedArray,Xz=vE.exportTypedArrayMethod;Xz("copyWithin",function(t,r){return Yz(Qz(this),t,r,arguments.length>2?arguments[2]:void 0)});var hE=Nt,Zz=Qr.every,eV=hE.aTypedArray,tV=hE.exportTypedArrayMethod;tV("every",function(t){return Zz(eV(this),t,arguments.length>1?arguments[1]:void 0)});var yE=Nt,rV=Yk,nV=sE,aV=Aa,iV=At,sV=et,oV=nt,uV=yE.aTypedArray,lV=yE.exportTypedArrayMethod,cV=sV("".slice),fV=oV(function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),e!==1});lV("fill",function(t){var r=arguments.length;uV(this);var n=cV(aV(this),0,3)==="Big"?nV(t):+t;return iV(rV,this,n,r>1?arguments[1]:void 0,r>2?arguments[2]:void 0)},fV);var dV=pr,pV=function(e,t){for(var r=0,n=dV(t),a=new e(n);n>r;)a[r]=t[r++];return a},gE=Nt,vV=hy,hV=gE.aTypedArrayConstructor,yV=gE.getTypedArrayConstructor,Vf=function(e){return hV(vV(e,yV(e)))},gV=pV,mV=Vf,bV=function(e,t){return gV(mV(e),t)},mE=Nt,wV=Qr.filter,_V=bV,SV=mE.aTypedArray,$V=mE.exportTypedArrayMethod;$V("filter",function(t){var r=wV(SV(this),t,arguments.length>1?arguments[1]:void 0);return _V(this,r)});var bE=Nt,TV=Qr.find,kV=bE.aTypedArray,EV=bE.exportTypedArrayMethod;EV("find",function(t){return TV(kV(this),t,arguments.length>1?arguments[1]:void 0)});var wE=Nt,CV=Qr.findIndex,IV=wE.aTypedArray,RV=wE.exportTypedArrayMethod;RV("findIndex",function(t){return CV(IV(this),t,arguments.length>1?arguments[1]:void 0)});var _E=Nt,AV=Qr.forEach,OV=_E.aTypedArray,PV=_E.exportTypedArrayMethod;PV("forEach",function(t){AV(OV(this),t,arguments.length>1?arguments[1]:void 0)});var SE=Nt,MV=yf.includes,xV=SE.aTypedArray,NV=SE.exportTypedArrayMethod;NV("includes",function(t){return MV(xV(this),t,arguments.length>1?arguments[1]:void 0)});var $E=Nt,LV=yf.indexOf,jV=$E.aTypedArray,UV=$E.exportTypedArrayMethod;UV("indexOf",function(t){return LV(jV(this),t,arguments.length>1?arguments[1]:void 0)});var FV=ct,DV=nt,cg=et,TE=Nt,fg=JT,BV=Pt,dg=BV("iterator"),X_=FV.Uint8Array,qV=cg(fg.values),HV=cg(fg.keys),WV=cg(fg.entries),pg=TE.aTypedArray,Kf=TE.exportTypedArrayMethod,Hs=X_&&X_.prototype,Jf=!DV(function(){Hs[dg].call([1])}),kE=!!Hs&&Hs.values&&Hs[dg]===Hs.values&&Hs.values.name==="values",EE=function(){return qV(pg(this))};Kf("entries",function(){return WV(pg(this))},Jf);Kf("keys",function(){return HV(pg(this))},Jf);Kf("values",EE,Jf||!kE,{name:"values"});Kf(dg,EE,Jf||!kE,{name:"values"});var CE=Nt,GV=et,zV=CE.aTypedArray,VV=CE.exportTypedArrayMethod,KV=GV([].join);VV("join",function(t){return KV(zV(this),t)});var JV=yi,YV=Yr,QV=ta,XV=pr,ZV=cl,e7=Math.min,ah=[].lastIndexOf,IE=!!ah&&1/[1].lastIndexOf(1,-0)<0,t7=ZV("lastIndexOf"),r7=IE||!t7,n7=r7?function(t){if(IE)return JV(ah,this,arguments)||0;var r=YV(this),n=XV(r),a=n-1;for(arguments.length>1&&(a=e7(a,QV(arguments[1]))),a<0&&(a=n+a);a>=0;a--)if(a in r&&r[a]===t)return a||0;return-1}:ah,RE=Nt,a7=yi,i7=n7,s7=RE.aTypedArray,o7=RE.exportTypedArrayMethod;o7("lastIndexOf",function(t){var r=arguments.length;return a7(i7,s7(this),r>1?[t,arguments[1]]:[t])});var AE=Nt,u7=Qr.map,l7=Vf,c7=AE.aTypedArray,f7=AE.exportTypedArrayMethod;f7("map",function(t){return u7(c7(this),t,arguments.length>1?arguments[1]:void 0,function(r,n){return new(l7(r))(n)})});var d7=Nn,p7=$r,v7=Vu,h7=pr,y7=TypeError,Z_=function(e){return function(t,r,n,a){d7(r);var i=p7(t),s=v7(i),o=h7(i),u=e?o-1:0,l=e?-1:1;if(n<2)for(;;){if(u in s){a=s[u],u+=l;break}if(u+=l,e?u<0:o<=u)throw y7("Reduce of empty array with no initial value")}for(;e?u>=0:o>u;u+=l)u in s&&(a=r(a,s[u],u,i));return a}},vg={left:Z_(!1),right:Z_(!0)},OE=Nt,g7=vg.left,m7=OE.aTypedArray,b7=OE.exportTypedArrayMethod;b7("reduce",function(t){var r=arguments.length;return g7(m7(this),t,r,r>1?arguments[1]:void 0)});var PE=Nt,w7=vg.right,_7=PE.aTypedArray,S7=PE.exportTypedArrayMethod;S7("reduceRight",function(t){var r=arguments.length;return w7(_7(this),t,r,r>1?arguments[1]:void 0)});var ME=Nt,$7=ME.aTypedArray,T7=ME.exportTypedArrayMethod,k7=Math.floor;T7("reverse",function(){for(var t=this,r=$7(t).length,n=k7(r/2),a=0,i;a<n;)i=t[a],t[a++]=t[--r],t[r]=i;return t});var xE=ct,NE=At,hg=Nt,E7=pr,C7=iE,I7=$r,LE=nt,R7=xE.RangeError,ih=xE.Int8Array,eS=ih&&ih.prototype,jE=eS&&eS.set,A7=hg.aTypedArray,O7=hg.exportTypedArrayMethod,sh=!LE(function(){var e=new Uint8ClampedArray(2);return NE(jE,e,{length:1,0:3},1),e[1]!==3}),P7=sh&&hg.NATIVE_ARRAY_BUFFER_VIEWS&&LE(function(){var e=new ih(2);return e.set(1),e.set("2",1),e[0]!==0||e[1]!==2});O7("set",function(t){A7(this);var r=C7(arguments.length>1?arguments[1]:void 0,1),n=I7(t);if(sh)return NE(jE,this,n,r);var a=this.length,i=E7(n),s=0;if(i+r>a)throw R7("Wrong length");for(;s<i;)this[r+s]=n[s++]},!sh||P7);var UE=Nt,M7=Vf,x7=nt,N7=So,L7=UE.aTypedArray,j7=UE.exportTypedArrayMethod,U7=x7(function(){new Int8Array(1).slice()});j7("slice",function(t,r){for(var n=N7(L7(this),t,r),a=M7(this),i=0,s=n.length,o=new a(s);s>i;)o[i]=n[i++];return o},U7);var FE=Nt,F7=Qr.some,D7=FE.aTypedArray,B7=FE.exportTypedArrayMethod;B7("some",function(t){return F7(D7(this),t,arguments.length>1?arguments[1]:void 0)});var tS=tl,q7=Math.floor,oh=function(e,t){var r=e.length,n=q7(r/2);return r<8?H7(e,t):W7(e,oh(tS(e,0,n),t),oh(tS(e,n),t),t)},H7=function(e,t){for(var r=e.length,n=1,a,i;n<r;){for(i=n,a=e[n];i&&t(e[i-1],a)>0;)e[i]=e[--i];i!==n++&&(e[i]=a)}return e},W7=function(e,t,r,n){for(var a=t.length,i=r.length,s=0,o=0;s<a||o<i;)e[s+o]=s<a&&o<i?n(t[s],r[o])<=0?t[s++]:r[o++]:s<a?t[s++]:r[o++];return e},yg=oh,G7=os,rS=G7.match(/firefox\/(\d+)/i),DE=!!rS&&+rS[1],z7=os,BE=/MSIE|Trident/.test(z7),V7=os,nS=V7.match(/AppleWebKit\/(\d+)\./),qE=!!nS&&+nS[1],K7=ct,J7=et,uh=nt,Y7=Nn,Q7=yg,HE=Nt,aS=DE,X7=BE,iS=us,sS=qE,Z7=HE.aTypedArray,eK=HE.exportTypedArrayMethod,Fu=K7.Uint16Array,ro=Fu&&J7(Fu.prototype.sort),tK=!!ro&&!(uh(function(){ro(new Fu(2),null)})&&uh(function(){ro(new Fu(2),{})})),oS=!!ro&&!uh(function(){if(iS)return iS<74;if(aS)return aS<67;if(X7)return!0;if(sS)return sS<602;var e=new Fu(516),t=Array(516),r,n;for(r=0;r<516;r++)n=r%4,e[r]=515-r,t[r]=r-2*n+3;for(ro(e,function(a,i){return(a/4|0)-(i/4|0)}),r=0;r<516;r++)if(e[r]!==t[r])return!0}),rK=function(e){return function(t,r){return e!==void 0?+e(t,r)||0:r!==r?-1:t!==t?1:t===0&&r===0?1/t>0&&1/r<0?1:-1:t>r}};eK("sort",function(t){return t!==void 0&&Y7(t),oS?ro(this,t):Q7(Z7(this),rK(t))},!oS||tK);var WE=Nt,nK=Ia,uS=ds,aK=Vf,iK=WE.aTypedArray,sK=WE.exportTypedArrayMethod;sK("subarray",function(t,r){var n=iK(this),a=n.length,i=uS(t,a),s=aK(n);return new s(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,nK((r===void 0?a:uS(r,a))-i))});var oK=ct,uK=yi,GE=Nt,lh=nt,lS=So,Bc=oK.Int8Array,cS=GE.aTypedArray,lK=GE.exportTypedArrayMethod,zE=[].toLocaleString,cK=!!Bc&&lh(function(){zE.call(new Bc(1))}),fK=lh(function(){return[1,2].toLocaleString()!=new Bc([1,2]).toLocaleString()})||!lh(function(){Bc.prototype.toLocaleString.call([1,2])});lK("toLocaleString",function(){return uK(zE,cK?lS(cS(this)):cS(this),lS(arguments))},fK);var dK=Nt.exportTypedArrayMethod,pK=nt,vK=ct,hK=et,fS=vK.Uint8Array,yK=fS&&fS.prototype||{},qc=[].toString,gK=hK([].join);pK(function(){qc.call({})})&&(qc=function(){return gK(this)});var mK=yK.toString!=qc;dK("toString",qc,mK);var bK=zt,wK=vi,_K=Pt,SK=_K("match"),VE=function(e){var t;return bK(e)&&((t=e[SK])!==void 0?!!t:wK(e)=="RegExp")},$K=yi,tu=At,gg=et,TK=xf,kK=Jt,EK=Zn,CK=VE,dS=ea,IK=hy,RK=jy,AK=Ia,Ep=lr,OK=cs,pS=tl,vS=Nf,PK=Mf,MK=rk,xK=nt,Ps=MK.UNSUPPORTED_Y,hS=4294967295,NK=Math.min,KE=[].push,LK=gg(/./.exec),Ms=gg(KE),ru=gg("".slice),jK=!xK(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});TK("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(a,i){var s=Ep(dS(this)),o=i===void 0?hS:i>>>0;if(o===0)return[];if(a===void 0)return[s];if(!CK(a))return tu(t,s,a,o);for(var u=[],l=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(a.sticky?"y":""),c=0,h=new RegExp(a.source,l+"g"),w,b,$;(w=tu(PK,h,s))&&(b=h.lastIndex,!(b>c&&(Ms(u,ru(s,c,w.index)),w.length>1&&w.index<s.length&&$K(KE,u,pS(w,1)),$=w[0].length,c=b,u.length>=o)));)h.lastIndex===w.index&&h.lastIndex++;return c===s.length?($||!LK(h,""))&&Ms(u,""):Ms(u,ru(s,c)),u.length>o?pS(u,0,o):u}:"0".split(void 0,0).length?n=function(a,i){return a===void 0&&i===0?[]:tu(t,this,a,i)}:n=t,[function(i,s){var o=dS(this),u=EK(i)?void 0:OK(i,e);return u?tu(u,i,o,s):tu(n,Ep(o),i,s)},function(a,i){var s=kK(this),o=Ep(a),u=r(n,s,o,i,n!==t);if(u.done)return u.value;var l=IK(s,RegExp),c=s.unicode,h=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(Ps?"g":"y"),w=new l(Ps?"^(?:"+s.source+")":s,h),b=i===void 0?hS:i>>>0;if(b===0)return[];if(o.length===0)return vS(w,o)===null?[o]:[];for(var $=0,A=0,x=[];A<o.length;){w.lastIndex=Ps?0:A;var U=vS(w,Ps?ru(o,A):o),B;if(U===null||(B=NK(AK(w.lastIndex+(Ps?A:0)),o.length))===$)A=RK(o,A,c);else{if(Ms(x,ru(o,$,A)),x.length===b)return x;for(var ve=1;ve<=U.length-1;ve++)if(Ms(x,U[ve]),x.length===b)return x;A=$=B}}return Ms(x,ru(o,$)),x}]},!jK,Ps);var mg={exports:{}},JE={exports:{}};(function(e){function t(r){return Function.toString.call(r).indexOf("[native code]")!==-1}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(JE);var YE={exports:{}},QE={exports:{}};(function(e){function t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(QE);(function(e){var t=Tf.exports,r=QE.exports;function n(a,i,s){return r()?(e.exports=n=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=n=function(u,l,c){var h=[null];h.push.apply(h,l);var w=Function.bind.apply(u,h),b=new w;return c&&t(b,c.prototype),b},e.exports.__esModule=!0,e.exports.default=e.exports),n.apply(null,arguments)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(YE);(function(e){var t=Xr.exports,r=Tf.exports,n=JE.exports,a=YE.exports;function i(s){var o=typeof Map=="function"?new Map:void 0;return e.exports=i=function(l){if(l===null||!n(l))return l;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(typeof o<"u"){if(o.has(l))return o.get(l);o.set(l,c)}function c(){return a(l,arguments,t(this).constructor)}return c.prototype=Object.create(l.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),r(c,l)},e.exports.__esModule=!0,e.exports.default=e.exports,i(s)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports})(mg);var Hc={exports:{}};/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */(function(e,t){(function(){var r={function:!0,object:!0},n=r[typeof window]&&window||this,a=t,i=e&&!e.nodeType&&e,s=a&&i&&typeof Rn=="object"&&Rn;s&&(s.global===s||s.window===s||s.self===s)&&(n=s);var o=Math.pow(2,53)-1,u=/\bOpera/,l=Object.prototype,c=l.hasOwnProperty,h=l.toString;function w(P){return P=String(P),P.charAt(0).toUpperCase()+P.slice(1)}function b(P,te,le){var J={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return te&&le&&/^Win/i.test(P)&&!/^Windows Phone /i.test(P)&&(J=J[/[\d.]+$/.exec(P)])&&(P="Windows "+J),P=String(P),te&&le&&(P=P.replace(RegExp(te,"i"),le)),P=A(P.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),P}function $(P,te){var le=-1,J=P?P.length:0;if(typeof J=="number"&&J>-1&&J<=o)for(;++le<J;)te(P[le],le,P);else x(P,te)}function A(P){return P=Re(P),/^(?:webOS|i(?:OS|P))/.test(P)?P:w(P)}function x(P,te){for(var le in P)c.call(P,le)&&te(P[le],le,P)}function U(P){return P==null?w(P):h.call(P).slice(8,-1)}function B(P,te){var le=P!=null?typeof P[te]:"number";return!/^(?:boolean|number|string|undefined)$/.test(le)&&(le=="object"?!!P[te]:!0)}function ve(P){return String(P).replace(/([ -])(?!$)/g,"$1?")}function se(P,te){var le=null;return $(P,function(J,xe){le=te(le,J,xe,P)}),le}function Re(P){return String(P).replace(/^ +| +$/g,"")}function ke(P){var te=n,le=P&&typeof P=="object"&&U(P)!="String";le&&(te=P,P=null);var J=te.navigator||{},xe=J.userAgent||"";P||(P=xe);var re=le?!!J.likeChrome:/\bChrome\b/.test(P)&&!/internal|\n/i.test(h.toString()),H="Object",ue=le?H:"ScriptBridgingProxyObject",W=le?H:"Environment",me=le&&te.java?"JavaPackage":U(te.java),_e=le?H:"RuntimeObject",N=/\bJava/.test(me)&&te.java,ft=N&&U(te.environment)==W,dt=N?"a":"\u03B1",Ee=N?"b":"\u03B2",Xe=te.document||{},Ye=te.operamini||te.opera,D=u.test(D=le&&Ye?Ye["[[Class]]"]:U(Ye))?D:Ye=null,T,Te=P,he=[],Ke=null,Qe=P==xe,Se=Qe&&Ye&&typeof Ye.version=="function"&&Ye.version(),Ge,R=Oe([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),C=we(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),Y=ee([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),pe=be({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),z=Ae(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Oe(oe){return se(oe,function(F,G){return F||RegExp("\\b"+(G.pattern||ve(G))+"\\b","i").exec(P)&&(G.label||G)})}function be(oe){return se(oe,function(F,G,Q){return F||(G[Y]||G[/^[a-z]+(?: +[a-z]+\b)*/i.exec(Y)]||RegExp("\\b"+ve(Q)+"(?:\\b|\\w*\\d)","i").exec(P))&&Q})}function we(oe){return se(oe,function(F,G){return F||RegExp("\\b"+(G.pattern||ve(G))+"\\b","i").exec(P)&&(G.label||G)})}function Ae(oe){return se(oe,function(F,G){var Q=G.pattern||ve(G);return!F&&(F=RegExp("\\b"+Q+"(?:/[\\d.]+|[ \\w.]*)","i").exec(P))&&(F=b(F,Q,G.label||G)),F})}function ee(oe){return se(oe,function(F,G){var Q=G.pattern||ve(G);return!F&&(F=RegExp("\\b"+Q+" *\\d+[.\\w_]*","i").exec(P)||RegExp("\\b"+Q+" *\\w+-[\\w]*","i").exec(P)||RegExp("\\b"+Q+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(P))&&((F=String(G.label&&!RegExp(Q,"i").test(G.label)?G.label:F).split("/"))[1]&&!/[\d.]+/.test(F[0])&&(F[0]+=" "+F[1]),G=G.label||G,F=A(F[0].replace(RegExp(Q,"i"),G).replace(RegExp("; *(?:"+G+"[_-])?","i")," ").replace(RegExp("("+G+")[-_.]?(\\w)","i"),"$1 $2"))),F})}function Fe(oe){return se(oe,function(F,G){return F||(RegExp(G+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(P)||0)[1]||null})}function Ue(){return this.description||""}if(R&&(R=[R]),/\bAndroid\b/.test(z)&&!Y&&(T=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(P))&&(Y=Re(T[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),pe&&!Y?Y=ee([pe]):pe&&Y&&(Y=Y.replace(RegExp("^("+ve(pe)+")[-_.\\s]","i"),pe+" ").replace(RegExp("^("+ve(pe)+")[-_.]?(\\w)","i"),pe+" $2")),(T=/\bGoogle TV\b/.exec(Y))&&(Y=T[0]),/\bSimulator\b/i.test(P)&&(Y=(Y?Y+" ":"")+"Simulator"),C=="Opera Mini"&&/\bOPiOS\b/.test(P)&&he.push("running in Turbo/Uncompressed mode"),C=="IE"&&/\blike iPhone OS\b/.test(P)?(T=ke(P.replace(/like iPhone OS/,"")),pe=T.manufacturer,Y=T.product):/^iP/.test(Y)?(C||(C="Safari"),z="iOS"+((T=/ OS ([\d_]+)/i.exec(P))?" "+T[1].replace(/_/g,"."):"")):C=="Konqueror"&&/^Linux\b/i.test(z)?z="Kubuntu":pe&&pe!="Google"&&(/Chrome/.test(C)&&!/\bMobile Safari\b/i.test(P)||/\bVita\b/.test(Y))||/\bAndroid\b/.test(z)&&/^Chrome/.test(C)&&/\bVersion\//i.test(P)?(C="Android Browser",z=/\bAndroid\b/.test(z)?z:"Android"):C=="Silk"?(/\bMobi/i.test(P)||(z="Android",he.unshift("desktop mode")),/Accelerated *= *true/i.test(P)&&he.unshift("accelerated")):C=="UC Browser"&&/\bUCWEB\b/.test(P)?he.push("speed mode"):C=="PaleMoon"&&(T=/\bFirefox\/([\d.]+)\b/.exec(P))?he.push("identifying as Firefox "+T[1]):C=="Firefox"&&(T=/\b(Mobile|Tablet|TV)\b/i.exec(P))?(z||(z="Firefox OS"),Y||(Y=T[1])):!C||(T=!/\bMinefield\b/i.test(P)&&/\b(?:Firefox|Safari)\b/.exec(C))?(C&&!Y&&/[\/,]|^[^(]+?\)/.test(P.slice(P.indexOf(T+"/")+8))&&(C=null),(T=Y||pe||z)&&(Y||pe||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(z))&&(C=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(z)?z:T)+" Browser")):C=="Electron"&&(T=(/\bChrome\/([\d.]+)\b/.exec(P)||0)[1])&&he.push("Chromium "+T),Se||(Se=Fe(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",ve(C),"(?:Firefox|Minefield|NetFront)"])),(T=R=="iCab"&&parseFloat(Se)>3&&"WebKit"||/\bOpera\b/.test(C)&&(/\bOPR\b/.test(P)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(P)&&!/^(?:Trident|EdgeHTML)$/.test(R)&&"WebKit"||!R&&/\bMSIE\b/i.test(P)&&(z=="Mac OS"?"Tasman":"Trident")||R=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(C)&&"NetFront")&&(R=[T]),C=="IE"&&(T=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(P)||0)[1])?(C+=" Mobile",z="Windows Phone "+(/\+$/.test(T)?T:T+".x"),he.unshift("desktop mode")):/\bWPDesktop\b/i.test(P)?(C="IE Mobile",z="Windows Phone 8.x",he.unshift("desktop mode"),Se||(Se=(/\brv:([\d.]+)/.exec(P)||0)[1])):C!="IE"&&R=="Trident"&&(T=/\brv:([\d.]+)/.exec(P))&&(C&&he.push("identifying as "+C+(Se?" "+Se:"")),C="IE",Se=T[1]),Qe){if(B(te,"global"))if(N&&(T=N.lang.System,Te=T.getProperty("os.arch"),z=z||T.getProperty("os.name")+" "+T.getProperty("os.version")),ft){try{Se=te.require("ringo/engine").version.join("."),C="RingoJS"}catch{(T=te.system)&&T.global.system==te.system&&(C="Narwhal",z||(z=T[0].os||null))}C||(C="Rhino")}else typeof te.process=="object"&&!te.process.browser&&(T=te.process)&&(typeof T.versions=="object"&&(typeof T.versions.electron=="string"?(he.push("Node "+T.versions.node),C="Electron",Se=T.versions.electron):typeof T.versions.nw=="string"&&(he.push("Chromium "+Se,"Node "+T.versions.node),C="NW.js",Se=T.versions.nw)),C||(C="Node.js",Te=T.arch,z=T.platform,Se=/[\d.]+/.exec(T.version),Se=Se?Se[0]:null));else U(T=te.runtime)==ue?(C="Adobe AIR",z=T.flash.system.Capabilities.os):U(T=te.phantom)==_e?(C="PhantomJS",Se=(T=T.version||null)&&T.major+"."+T.minor+"."+T.patch):typeof Xe.documentMode=="number"&&(T=/\bTrident\/(\d+)/i.exec(P))?(Se=[Se,Xe.documentMode],(T=+T[1]+4)!=Se[1]&&(he.push("IE "+Se[1]+" mode"),R&&(R[1]=""),Se[1]=T),Se=C=="IE"?String(Se[1].toFixed(1)):Se[0]):typeof Xe.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(C)&&(he.push("masking as "+C+" "+Se),C="IE",Se="11.0",R=["Trident"],z="Windows");z=z&&A(z)}if(Se&&(T=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(Se)||/(?:alpha|beta)(?: ?\d)?/i.exec(P+";"+(Qe&&J.appMinorVersion))||/\bMinefield\b/i.test(P)&&"a")&&(Ke=/b/i.test(T)?"beta":"alpha",Se=Se.replace(RegExp(T+"\\+?$"),"")+(Ke=="beta"?Ee:dt)+(/\d+\+?/.exec(T)||"")),C=="Fennec"||C=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(z))C="Firefox Mobile";else if(C=="Maxthon"&&Se)Se=Se.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(Y))Y=="Xbox 360"&&(z=null),Y=="Xbox 360"&&/\bIEMobile\b/.test(P)&&he.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(C)||C&&!Y&&!/Browser|Mobi/.test(C))&&(z=="Windows CE"||/Mobi/i.test(P)))C+=" Mobile";else if(C=="IE"&&Qe)try{te.external===null&&he.unshift("platform preview")}catch{he.unshift("embedded")}else(/\bBlackBerry\b/.test(Y)||/\bBB10\b/.test(P))&&(T=(RegExp(Y.replace(/ +/g," *")+"/([.\\d]+)","i").exec(P)||0)[1]||Se)?(T=[T,/BB10/.test(P)],z=(T[1]?(Y=null,pe="BlackBerry"):"Device Software")+" "+T[0],Se=null):this!=x&&Y!="Wii"&&(Qe&&Ye||/Opera/.test(C)&&/\b(?:MSIE|Firefox)\b/i.test(P)||C=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(z)||C=="IE"&&(z&&!/^Win/.test(z)&&Se>5.5||/\bWindows XP\b/.test(z)&&Se>8||Se==8&&!/\bTrident\b/.test(P)))&&!u.test(T=ke.call(x,P.replace(u,"")+";"))&&T.name&&(T="ing as "+T.name+((T=T.version)?" "+T:""),u.test(C)?(/\bIE\b/.test(T)&&z=="Mac OS"&&(z=null),T="identify"+T):(T="mask"+T,D?C=A(D.replace(/([a-z])([A-Z])/g,"$1 $2")):C="Opera",/\bIE\b/.test(T)&&(z=null),Qe||(Se=null)),R=["Presto"],he.push(T));(T=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(P)||0)[1])&&(T=[parseFloat(T.replace(/\.(\d)$/,".0$1")),T],C=="Safari"&&T[1].slice(-1)=="+"?(C="WebKit Nightly",Ke="alpha",Se=T[1].slice(0,-1)):(Se==T[1]||Se==(T[2]=(/\bSafari\/([\d.]+\+?)/i.exec(P)||0)[1]))&&(Se=null),T[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(P)||0)[1],T[0]==537.36&&T[2]==537.36&&parseFloat(T[1])>=28&&R=="WebKit"&&(R=["Blink"]),!Qe||!re&&!T[1]?(R&&(R[1]="like Safari"),T=(T=T[0],T<400?1:T<500?2:T<526?3:T<533?4:T<534?"4+":T<535?5:T<537?6:T<538?7:T<601?8:T<602?9:T<604?10:T<606?11:T<608?12:"12")):(R&&(R[1]="like Chrome"),T=T[1]||(T=T[0],T<530?1:T<532?2:T<532.05?3:T<533?4:T<534.03?5:T<534.07?6:T<534.1?7:T<534.13?8:T<534.16?9:T<534.24?10:T<534.3?11:T<535.01?12:T<535.02?"13+":T<535.07?15:T<535.11?16:T<535.19?17:T<536.05?18:T<536.1?19:T<537.01?20:T<537.11?"21+":T<537.13?23:T<537.18?24:T<537.24?25:T<537.36?26:R!="Blink"?"27":"28")),R&&(R[1]+=" "+(T+=typeof T=="number"?".x":/[.+]/.test(T)?"":"+")),C=="Safari"&&(!Se||parseInt(Se)>45)?Se=T:C=="Chrome"&&/\bHeadlessChrome/i.test(P)&&he.unshift("headless")),C=="Opera"&&(T=/\bzbov|zvav$/.exec(z))?(C+=" ",he.unshift("desktop mode"),T=="zvav"?(C+="Mini",Se=null):C+="Mobile",z=z.replace(RegExp(" *"+T+"$"),"")):C=="Safari"&&/\bChrome\b/.exec(R&&R[1])?(he.unshift("desktop mode"),C="Chrome Mobile",Se=null,/\bOS X\b/.test(z)?(pe="Apple",z="iOS 4.3+"):z=null):/\bSRWare Iron\b/.test(C)&&!Se&&(Se=Fe("Chrome")),Se&&Se.indexOf(T=/[\d.]+$/.exec(z))==0&&P.indexOf("/"+T+"-")>-1&&(z=Re(z.replace(T,""))),z&&z.indexOf(C)!=-1&&!RegExp(C+" OS").test(z)&&(z=z.replace(RegExp(" *"+ve(C)+" *"),"")),R&&!/\b(?:Avant|Nook)\b/.test(C)&&(/Browser|Lunascape|Maxthon/.test(C)||C!="Safari"&&/^iOS/.test(z)&&/\bSafari\b/.test(R[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(C)&&R[1])&&(T=R[R.length-1])&&he.push(T),he.length&&(he=["("+he.join("; ")+")"]),pe&&Y&&Y.indexOf(pe)<0&&he.push("on "+pe),Y&&he.push((/^on /.test(he[he.length-1])?"":"on ")+Y),z&&(T=/ ([\d.+]+)$/.exec(z),Ge=T&&z.charAt(z.length-T[0].length-1)=="/",z={architecture:32,family:T&&!Ge?z.replace(T[0],""):z,version:T?T[1]:null,toString:function(){var oe=this.version;return this.family+(oe&&!Ge?" "+oe:"")+(this.architecture==64?" 64-bit":"")}}),(T=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Te))&&!/\bi686\b/i.test(Te)?(z&&(z.architecture=64,z.family=z.family.replace(RegExp(" *"+T),"")),C&&(/\bWOW64\b/i.test(P)||Qe&&/\w(?:86|32)$/.test(J.cpuClass||J.platform)&&!/\bWin64; x64\b/i.test(P))&&he.unshift("32-bit")):z&&/^OS X/.test(z.family)&&C=="Chrome"&&parseFloat(Se)>=39&&(z.architecture=64),P||(P=null);var Pe={};return Pe.description=P,Pe.layout=R&&R[0],Pe.manufacturer=pe,Pe.name=C,Pe.prerelease=Ke,Pe.product=Y,Pe.ua=P,Pe.version=C&&Se,Pe.os=z||{architecture:null,family:null,version:null,toString:function(){return"null"}},Pe.parse=ke,Pe.toString=Ue,Pe.version&&he.unshift(Se),Pe.name&&he.unshift(C),z&&C&&!(z==String(z).split(" ")[0]&&(z==C.split(" ")[0]||Y))&&he.push(Y?"("+z+")":"on "+z),he.length&&(Pe.description=he.join(" ")),Pe}var de=ke();a&&i?x(de,function(P,te){a[te]=P}):n.platform=de}).call(Rn)})(Hc,Hc.exports);var UK=At,FK=xf,DK=Jt,BK=Zn,qK=Ia,Cp=lr,HK=ea,WK=cs,GK=jy,yS=Nf;FK("match",function(e,t,r){return[function(a){var i=HK(this),s=BK(a)?void 0:WK(a,e);return s?UK(s,a,i):new RegExp(a)[e](Cp(i))},function(n){var a=DK(this),i=Cp(n),s=r(t,a,i);if(s.done)return s.value;if(!a.global)return yS(a,i);var o=a.unicode;a.lastIndex=0;for(var u=[],l=0,c;(c=yS(a,i))!==null;){var h=Cp(c[0]);u[l]=h,h===""&&(a.lastIndex=GK(i,qK(a.lastIndex),o)),l++}return l===0?null:u}]});var zK=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},VK=At,KK=xf,JK=Jt,YK=Zn,QK=ea,gS=zK,mS=lr,XK=cs,ZK=Nf;KK("search",function(e,t,r){return[function(a){var i=QK(this),s=YK(a)?void 0:XK(a,e);return s?VK(s,a,i):new RegExp(a)[e](mS(i))},function(n){var a=JK(this),i=mS(n),s=r(t,a,i);if(s.done)return s.value;var o=a.lastIndex;gS(o,0)||(a.lastIndex=0);var u=ZK(a,i);return gS(a.lastIndex,o)||(a.lastIndex=o),u===null?-1:u.index}]});var e9=qt,t9=rl,r9=TypeError,n9=Object.getOwnPropertyDescriptor,a9=e9&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),i9=a9?function(e,t){if(t9(e)&&!n9(e,"length").writable)throw r9("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},s9=ot,o9=$r,u9=ds,l9=ta,c9=pr,f9=i9,d9=NT,p9=ly,v9=$o,Ip=lg,h9=il,y9=h9("splice"),g9=Math.max,m9=Math.min;s9({target:"Array",proto:!0,forced:!y9},{splice:function(t,r){var n=o9(this),a=c9(n),i=u9(t,a),s=arguments.length,o,u,l,c,h,w;for(s===0?o=u=0:s===1?(o=0,u=a-i):(o=s-2,u=m9(g9(l9(r),0),a-i)),d9(a+o-u),l=p9(n,u),c=0;c<u;c++)h=i+c,h in n&&v9(l,c,n[h]);if(l.length=u,o<u){for(c=i;c<a-u;c++)h=c+u,w=c+o,h in n?n[w]=n[h]:Ip(n,w);for(c=a;c>a-u+o;c--)Ip(n,c-1)}else if(o>u)for(c=a-u;c>i;c--)h=c+u-1,w=c+o-1,h in n?n[w]=n[h]:Ip(n,w);for(c=0;c<o;c++)n[c+i]=arguments[c+2];return f9(n,a-u+o),l}});/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.


*/(function(e){var t=typeof t<"u"?t:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(e,"__esModule",{value:!0});var r=To.exports,n=ra.exports,a=mi.exports,i=Df.exports,s=Ln.exports,o=jn.exports,u=Xr.exports,l=Fn.exports,c=bi.exports,h=fl,w=Un.exports,b=Er,$=vs.exports,A=jk.exports,x=Hf,U=mg.exports,B=xa,ve=Hc.exports;function se(v){return v&&typeof v=="object"&&"default"in v?v:{default:v}}function Re(v){if(v&&v.__esModule)return v;var g=Object.create(null);return v&&Object.keys(v).forEach(function(d){if(d!=="default"){var p=Object.getOwnPropertyDescriptor(v,d);Object.defineProperty(g,d,p.get?p:{enumerable:!0,get:function(){return v[d]}})}}),g.default=v,Object.freeze(g)}var ke=se(r),de=se(n),P=se(a),te=se(i),le=se(s),J=se(o),xe=se(u),re=se(l),H=se(c),ue=se(h),W=se(w),me=Re($),_e=Re(A),N=se(U),ft=Re(ve);function dt(v,g,d,p){var f=arguments.length,m=f<3?g:p===null?p=Object.getOwnPropertyDescriptor(g,d):p,y;if((typeof Reflect>"u"?"undefined":W.default(Reflect))==="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(v,g,d,p);else for(var k=v.length-1;k>=0;k--)(y=v[k])&&(m=(f<3?y(m):f>3?y(g,d,m):y(g,d))||m);return f>3&&m&&Object.defineProperty(g,d,m),m}function Ee(v,g){if((typeof Reflect>"u"?"undefined":W.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(v,g)}var Xe;function Ye(){}Ye.prototype=Object.create(null);function D(){D.init.call(this)}D.EventEmitter=D,D.usingDomains=!1,D.prototype.domain=void 0,D.prototype._events=void 0,D.prototype._maxListeners=void 0,D.defaultMaxListeners=10,D.init=function(){this.domain=null,D.usingDomains&&Xe.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Ye,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},D.prototype.setMaxListeners=function(g){if(typeof g!="number"||g<0||isNaN(g))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=g,this};function T(v){return v._maxListeners===void 0?D.defaultMaxListeners:v._maxListeners}D.prototype.getMaxListeners=function(){return T(this)};function Te(v,g,d){if(g)v.call(d);else for(var p=v.length,f=z(v,p),m=0;m<p;++m)f[m].call(d)}function he(v,g,d,p){if(g)v.call(d,p);else for(var f=v.length,m=z(v,f),y=0;y<f;++y)m[y].call(d,p)}function Ke(v,g,d,p,f){if(g)v.call(d,p,f);else for(var m=v.length,y=z(v,m),k=0;k<m;++k)y[k].call(d,p,f)}function Qe(v,g,d,p,f,m){if(g)v.call(d,p,f,m);else for(var y=v.length,k=z(v,y),E=0;E<y;++E)k[E].call(d,p,f,m)}function Se(v,g,d,p){if(g)v.apply(d,p);else for(var f=v.length,m=z(v,f),y=0;y<f;++y)m[y].apply(d,p)}D.prototype.emit=function(g){var d,p,f,m,y,k,E,L=g==="error";if(k=this._events,k)L=L&&k.error==null;else if(!L)return!1;if(E=this.domain,L){if(d=arguments[1],E)d||(d=new Error('Uncaught, unspecified "error" event')),d.domainEmitter=this,d.domain=E,d.domainThrown=!1,E.emit("error",d);else{if(d instanceof Error)throw d;var j=new Error('Uncaught, unspecified "error" event. ('+d+")");throw j.context=d,j}return!1}if(p=k[g],!p)return!1;var Ce=typeof p=="function";switch(f=arguments.length,f){case 1:Te(p,Ce,this);break;case 2:he(p,Ce,this,arguments[1]);break;case 3:Ke(p,Ce,this,arguments[1],arguments[2]);break;case 4:Qe(p,Ce,this,arguments[1],arguments[2],arguments[3]);break;default:for(m=new Array(f-1),y=1;y<f;y++)m[y-1]=arguments[y];Se(p,Ce,this,m)}return!0};function Ge(v,g,d,p){var f,m,y;if(typeof d!="function")throw new TypeError('"listener" argument must be a function');if(m=v._events,m?(m.newListener&&(v.emit("newListener",g,d.listener?d.listener:d),m=v._events),y=m[g]):(m=v._events=new Ye,v._eventsCount=0),!y)y=m[g]=d,++v._eventsCount;else if(typeof y=="function"?y=m[g]=p?[d,y]:[y,d]:p?y.unshift(d):y.push(d),!y.warned&&(f=T(v),f&&f>0&&y.length>f)){y.warned=!0;var k=new Error("Possible EventEmitter memory leak detected. "+y.length+" "+g+" listeners added. Use emitter.setMaxListeners() to increase limit");k.name="MaxListenersExceededWarning",k.emitter=v,k.type=g,k.count=y.length,R(k)}return v}function R(v){typeof console.warn=="function"?console.warn(v):console.log(v)}D.prototype.addListener=function(g,d){return Ge(this,g,d,!1)},D.prototype.on=D.prototype.addListener,D.prototype.prependListener=function(g,d){return Ge(this,g,d,!0)};function C(v,g,d){var p=!1;function f(){v.removeListener(g,f),p||(p=!0,d.apply(v,arguments))}return f.listener=d,f}D.prototype.once=function(g,d){if(typeof d!="function")throw new TypeError('"listener" argument must be a function');return this.on(g,C(this,g,d)),this},D.prototype.prependOnceListener=function(g,d){if(typeof d!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(g,C(this,g,d)),this},D.prototype.removeListener=function(g,d){var p,f,m,y,k;if(typeof d!="function")throw new TypeError('"listener" argument must be a function');if(f=this._events,!f)return this;if(p=f[g],!p)return this;if(p===d||p.listener&&p.listener===d)--this._eventsCount===0?this._events=new Ye:(delete f[g],f.removeListener&&this.emit("removeListener",g,p.listener||d));else if(typeof p!="function"){for(m=-1,y=p.length;y-- >0;)if(p[y]===d||p[y].listener&&p[y].listener===d){k=p[y].listener,m=y;break}if(m<0)return this;if(p.length===1){if(p[0]=void 0,--this._eventsCount===0)return this._events=new Ye,this;delete f[g]}else pe(p,m);f.removeListener&&this.emit("removeListener",g,k||d)}return this},D.prototype.off=function(v,g){return this.removeListener(v,g)},D.prototype.removeAllListeners=function(g){var d,p;if(p=this._events,!p)return this;if(!p.removeListener)return arguments.length===0?(this._events=new Ye,this._eventsCount=0):p[g]&&(--this._eventsCount===0?this._events=new Ye:delete p[g]),this;if(arguments.length===0){for(var f=Object.keys(p),m=0,y;m<f.length;++m)y=f[m],y!=="removeListener"&&this.removeAllListeners(y);return this.removeAllListeners("removeListener"),this._events=new Ye,this._eventsCount=0,this}if(d=p[g],typeof d=="function")this.removeListener(g,d);else if(d)do this.removeListener(g,d[d.length-1]);while(d[0]);return this},D.prototype.listeners=function(g){var d,p,f=this._events;return f?(d=f[g],d?typeof d=="function"?p=[d.listener||d]:p=Oe(d):p=[]):p=[],p},D.listenerCount=function(v,g){return typeof v.listenerCount=="function"?v.listenerCount(g):Y.call(v,g)},D.prototype.listenerCount=Y;function Y(v){var g=this._events;if(g){var d=g[v];if(typeof d=="function")return 1;if(d)return d.length}return 0}D.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function pe(v,g){for(var d=g,p=d+1,f=v.length;p<f;d+=1,p+=1)v[d]=v[p];v.pop()}function z(v,g){for(var d=new Array(g);g--;)d[g]=v[g];return d}function Oe(v){for(var g=new Array(v.length),d=0;d<g.length;++d)g[d]=v[d].listener||v[d];return g}var be=me.getLogger("twilsock");function we(v,g){return["".concat(new Date().toISOString()," Twilsock ").concat(v,":")].concat(Array.from(g))}var Ae=function(){function v(g){re.default(this,v),H.default(this,"prefix",""),this.prefix=g!=null&&g.length>0?" "+g+":":""}return de.default(v,[{key:"setLevel",value:function(d){be.setLevel(d)}},{key:"trace",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.trace.apply(null,we("T",p))}},{key:"debug",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.debug.apply(null,we("D",p))}},{key:"info",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.info.apply(null,we("I",p))}},{key:"warn",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.warn.apply(null,we("W",p))}},{key:"error",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.error.apply(null,we("E",p))}}],[{key:"setLevel",value:function(d){be.setLevel(d)}},{key:"trace",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.trace.apply(null,we("T",p))}},{key:"debug",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.debug.apply(null,we("D",p))}},{key:"info",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.info.apply(null,we("I",p))}},{key:"warn",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.warn.apply(null,we("W",p))}},{key:"error",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.error.apply(null,we("E",p))}}]),v}(),ee=new Ae(""),Fe="0.12.2",Ue=function(){function v(g,d,p){re.default(this,v),H.default(this,"confirmedCapabilities",new Set),this.activeGrant=d,this._token=g;var f=p.region||"us1",m="wss://tsock.".concat(f,".twilio.com/v3/wsconnect"),y=p.twilsock||p.Twilsock||{};this.url=y.uri||m,this._continuationToken=p.continuationToken?p.continuationToken:null,this.logLevel=p.logLevel?p.logLevel:"error",this.retryPolicy=p.retryPolicy?p.retryPolicy:{min:1*1e3,max:2*60*1e3,randomness:.2},this.clientMetadata=p.clientMetadata?p.clientMetadata:{},this.clientMetadata.ver=Fe,this.initRegistrations=p.initRegistrations?p.initRegistrations:null,this.tweaks=p.tweaks?p.tweaks:null}return de.default(v,[{key:"token",get:function(){return this._token}},{key:"continuationToken",get:function(){return this._continuationToken}},{key:"updateToken",value:function(d){this._token=d}},{key:"updateContinuationToken",value:function(d){this._continuationToken=d}}]),v}(),Pe=function v(g){re.default(this,v),this.id=g||"TM".concat(x.v4())};function oe(v){var g=F();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function F(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var G=function(v){le.default(d,v);var g=oe(d);function d(p,f,m,y,k){var E;return re.default(this,d),E=g.call(this),H.default(P.default(E),"method","init"),E.token=p,E.continuation_token=f,E.metadata=m,E.registrations=y,E.tweaks=k,E.capabilities=["client_update","offline_storage","telemetry.v1"],E}return d}(Pe);function Q(v){var g=ye();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function ye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ne=function(v){le.default(d,v);var g=Q(d);function d(p,f,m,y,k,E,L){var j;return re.default(this,d),j=g.call(this,p),j.continuationToken=f,j.continuationTokenStatus=y,j.offlineStorage=k,j.initRegistrations=E,j.debugInfo=L,j.confirmedCapabilities=m,j}return d}(Pe);function qe(v){var g=ze();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function ze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var De=function(v){le.default(d,v);var g=qe(d);function d(p){var f;return re.default(this,d),f=g.call(this),H.default(P.default(f),"method","update"),f.token=p,f}return d}(Pe);function He(v){var g=Le();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function Le(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Z=function(v){le.default(d,v);var g=He(d);function d(p,f,m){var y;return re.default(this,d),y=g.call(this),H.default(P.default(y),"method","message"),y.active_grant=p,y.payload_type=f,y.http_request=m,y}return d}(Pe);function ae(v){var g=q();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var K=function(v){le.default(d,v);var g=ae(d);function d(p){var f;return re.default(this,d),f=g.call(this,p),H.default(P.default(f),"method","reply"),H.default(P.default(f),"payload_type","application/json"),H.default(P.default(f),"status",{code:200,status:"OK"}),f}return d}(Pe);function ne(v){var g=ge();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function ge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ce=function(v){le.default(d,v);var g=ne(d);function d(){var p;return re.default(this,d),p=g.call(this),H.default(P.default(p),"method","close"),p}return d}(Pe);function je(v){var g=Ve();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function Ve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var at=function v(g,d,p,f,m,y){re.default(this,v),this.start=g,this.end=d,this.title=p,this.details=f,this.id=m,this.type=y},tt=function(v){le.default(d,v);var g=je(d);function d(p){var f;return re.default(this,d),f=g.call(this),H.default(P.default(f),"method","telemetry.v1"),f.events=p,f}return d}(Pe);function We(v){var g=encodeURIComponent(v),d=g.replace(/%([0-9A-F]{2})/g,function(p,f){return String.fromCharCode(Number("0x"+f))});return d.length}function vr(v){var g=encodeURIComponent(v),d=g.replace(/%([0-9A-F]{2})/g,function(f,m){return String.fromCharCode(Number("0x"+m))}),p=new Uint8Array(d.length);return Array.prototype.forEach.call(d,function(f,m){p[m]=f.charCodeAt(0)}),p}function rt(v){var g=Array.prototype.map.call(v,function(p){return String.fromCharCode(p)}).join(""),d=g.replace(/(.)/g,function(p,f){var m=f.charCodeAt(0).toString(16).toUpperCase();return m.length<2&&(m="0"+m),"%"+m});return decodeURIComponent(d)}function Rr(v){return JSON.parse(rt(v))}function Ut(v){for(var g="",d=0;d<v.length;++d){var p=String.fromCharCode(v[d]);if(g+=p,p==="\r"){d+=2;break}}var f=g.split(" ");return{size:d,protocol:f[0],version:f[1],headerSize:Number(f[2])}}var mn=function(){function v(){re.default(this,v)}return de.default(v,null,[{key:"parse",value:function(d){var p=2,f=new Uint8Array(d),m=Ut(f);if(m.protocol!=="TWILSOCK"||m.version!=="V3.0")return ee.error("unsupported protocol: ".concat(m.protocol," ver ").concat(m.version)),null;var y;try{y=Rr(f.subarray(m.size,m.size+m.headerSize))}catch(j){return ee.error("failed to parse message header",j,d),null}ee.debug("message received: ",y.method),ee.trace("message received: ",y);var k;if(y.payload_size>0){var E=p+m.size+m.headerSize,L=y.payload_size;if(!y.hasOwnProperty("payload_type")||y.payload_type.indexOf("application/json")===0)try{k=Rr(f.subarray(E,E+L))}catch(j){return ee.error("failed to parse message body",j,d),null}else y.payload_type.indexOf("text/plain")===0&&(k=rt(f.subarray(E,E+L)))}return{method:y.method,header:y,payload:k}}},{key:"createPacket",value:function(d){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";d.payload_size=We(p);var f=JSON.stringify(d),m="TWILSOCK V3.0 "+We(f);ee.debug("send request:",m+f+p);var y=vr(m+`\r
`+f+`\r
`+p);return y.buffer}}]),v}();function rr(v){var g=Dn();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function Dn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ct=function(v){le.default(d,v);var g=rr(d);function d(p){return re.default(this,d),g.call(this,p)}return d}(N.default(Error));function hr(v){var g=qr();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function qr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Hr=function(v){le.default(d,v);var g=hr(d);function d(p,f){var m;return re.default(this,d),m=g.call(this,p),m.reply=f,m}return d}(Ct);function yr(v,g){var d=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);g&&(p=p.filter(function(f){return Object.getOwnPropertyDescriptor(v,f).enumerable})),d.push.apply(d,p)}return d}function ms(v){for(var g=1;g<arguments.length;g++){var d=arguments[g]!=null?arguments[g]:{};g%2?yr(Object(d),!0).forEach(function(p){H.default(v,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(d)):yr(Object(d)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(d,p))})}return v}function Nr(v){var g=bs();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function bs(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ro=function(v){le.default(d,v);var g=Nr(d);function d(p){var f;return re.default(this,d),f=g.call(this),H.default(P.default(f),"newBackoff",null),H.default(P.default(f),"usedBackoff",null),H.default(P.default(f),"retrier",null),f.options=p?ms({},p):{},f}return de.default(d,[{key:"inProgress",get:function(){return!!this.retrier}},{key:"start",value:function(){if(this.inProgress)throw new Error("Already waiting for next attempt, call finishAttempt(success : boolean) to finish it");this.createRetrier()}},{key:"stop",value:function(){this.cleanRetrier(),this.newBackoff=null,this.usedBackoff=null}},{key:"modifyBackoff",value:function(f){this.newBackoff=f}},{key:"attemptFailed",value:function(){if(!this.inProgress)throw new Error("No attempt is in progress");if(this.newBackoff){var f=!this.usedBackoff||this.usedBackoff<this.newBackoff;if(f)this.createRetrier();else{var m;(m=this.retrier)===null||m===void 0||m.failed(new Error)}}else{var y;(y=this.retrier)===null||y===void 0||y.failed(new Error)}}},{key:"cancel",value:function(){var f;(f=this.retrier)===null||f===void 0||f.cancel()}},{key:"cleanRetrier",value:function(){var f,m;(f=this.retrier)===null||f===void 0||f.removeAllListeners(),(m=this.retrier)===null||m===void 0||m.cancel(),this.retrier=null}},{key:"getRetryPolicy",value:function(){var f=ms({},this.options);return this.newBackoff&&(f.min=this.newBackoff,f.max=this.options.max&&this.options.max>this.newBackoff?this.options.max:this.newBackoff),f.maxAttemptsCount=this.options.maxAttemptsCount?this.options.maxAttemptsCount+1:void 0,f}},{key:"createRetrier",value:function(){var f=this;this.cleanRetrier();var m=this.getRetryPolicy();this.retrier=new B.Retrier(m),this.retrier.once("attempt",function(){var y,k;(y=f.retrier)===null||y===void 0||y.on("attempt",function(){return f.emit("attempt")}),(k=f.retrier)===null||k===void 0||k.failed(new Error("Skipping first attempt"))}),this.retrier.on("failed",function(y){return f.emit("failed",y)}),this.usedBackoff=this.newBackoff,this.newBackoff=null,this.retrier.start()}}]),d}(D);function Ao(v){var g=ws();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function ws(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Oo=3e3;function bn(v){setTimeout(v,0)}var wn=function(v){le.default(d,v);var g=Ao(d);function d(p,f,m){var y;re.default(this,d),y=g.call(this),H.default(P.default(y),"disconnectingTimer",null),H.default(P.default(y),"disconnectedPromiseResolve",null),H.default(P.default(y),"terminalStates",["disconnected","rejected"]),H.default(P.default(y),"tokenExpiredSasCode",20104),H.default(P.default(y),"terminationReason","Connection is not initialized"),y.websocket=p,y.websocket.on("connected",function(){return y.fsm.socketConnected()}),y.websocket.on("disconnected",function(){return y.fsm.socketClosed()}),y.websocket.on("message",function(E){return y.onIncomingMessage(E)}),y.websocket.on("socketError",function(E){return y.emit("connectionError",{terminal:!1,message:"Socket error: ".concat(E.message),httpStatusCode:null,errorCode:null})}),y.transport=f,y.config=m,y.retrier=new Ro(m.retryPolicy),y.retrier.on("attempt",function(){return y.retry()}),y.retrier.on("failed",function(E){ee.warn("Retrying failed: ".concat(E.message)),y.disconnect()}),typeof window<"u"&&typeof window.addEventListener<"u"&&(window.addEventListener("online",function(){ee.debug("Browser reported connectivity state: online"),y.resetBackoff(),y.fsm.systemOnline()}),window.addEventListener("offline",function(){ee.debug("Browser reported connectivity state: offline"),y.websocket.close(),y.fsm.socketClosed()}));var k=_e.factory({init:"disconnected",transitions:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"},{name:"userSend",from:["connected"],to:"connected"},{name:"systemOnline",from:["retrying"],to:"connecting"}],methods:{onConnecting:function(){y.setupSocket(),y.emit("connecting")},onEnterInitialising:function(){y.sendInit()},onLeaveInitialising:function(){y.cancelInit()},onEnterUpdating:function(){y.sendUpdate()},onLeaveUpdating:function(){y.cancelUpdate()},onEnterRetrying:function(){y.initRetry(),y.emit("connecting")},onEnterConnected:function(){y.resetBackoff(),y.onConnected()},onUserUpdateToken:function(){y.resetBackoff()},onTokenRejected:function(){y.resetBackoff(),y.closeSocket(!0),y.finalizeSocket()},onUserDisconnect:function(){y.closeSocket(!0)},onEnterDisconnecting:function(){y.startDisconnectTimer()},onLeaveDisconnecting:function(){y.cancelDisconnectTimer()},onEnterWaitSocketClosed:function(){y.startDisconnectTimer()},onLeaveWaitSocketClosed:function(){y.cancelDisconnectTimer()},onEnterWaitOffloadSocketClosed:function(){y.startDisconnectTimer()},onLeaveWaitOffloadSocketClosed:function(){y.cancelDisconnectTimer()},onDisconnected:function(){y.resetBackoff(),y.finalizeSocket()},onReceiveClose:function(){y.onCloseReceived()},onReceiveOffload:function(L,j){ee.debug("onreceiveoffload: ",j),y.modifyBackoff(j.body),y.onCloseReceived()},onUnsupported:function(){y.closeSocket(!0),y.finalizeSocket()},onError:function(L,j){y.closeSocket(j),y.finalizeSocket()},onEnterState:function(L){L.from!=="none"&&y.changeState(L)},onInvalidTransition:function(L,j,Ce){ee.warn("FSM: unexpected transition",j,Ce)}}});return y.fsm=new k,y}return de.default(d,[{key:"changeState",value:function(f){ee.debug("FSM: ".concat(f.transition,": ").concat(f.from," --> ").concat(f.to)),this.lastEmittedState!==this.state&&(this.lastEmittedState=this.state,this.emit("stateChanged",this.state))}},{key:"resetBackoff",value:function(){ee.trace("resetBackoff"),this.retrier.stop()}},{key:"modifyBackoff",value:function(f){ee.trace("modifyBackoff",f);var m=f?f.backoff_policy:null;m&&typeof m.reconnect_min_ms=="number"&&this.retrier.modifyBackoff(m.reconnect_min_ms)}},{key:"startDisconnectTimer",value:function(){var f=this;ee.trace("startDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null),this.disconnectingTimer=setTimeout(function(){ee.debug("disconnecting is timed out"),f.closeSocket(!0)},Oo)}},{key:"cancelDisconnectTimer",value:function(){ee.trace("cancelDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null)}},{key:"isConnected",get:function(){return this.state==="connected"&&this.websocket.isConnected}},{key:"state",get:function(){switch(this.fsm.state){case"connecting":case"initialising":case"retrying":case"error":return"connecting";case"updating":case"connected":return"connected";case"rejected":return"denied";case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return"disconnecting";case"disconnected":default:return"disconnected"}}},{key:"initRetry",value:function(){ee.debug("initRetry"),this.retrier.inProgress?this.retrier.attemptFailed():this.retrier.start()}},{key:"retry",value:function(){this.fsm.state!="connecting"?(ee.trace("retry"),this.websocket.close(),this.fsm.userRetry()):ee.trace("can	 retry as already connecting")}},{key:"onConnected",value:function(){this.emit("connected")}},{key:"finalizeSocket",value:function(){ee.trace("finalizeSocket"),this.websocket.close(),this.emit("disconnected"),this.disconnectedPromiseResolve&&(this.disconnectedPromiseResolve(),this.disconnectedPromiseResolve=null)}},{key:"setupSocket",value:function(){ee.trace("setupSocket:",this.config.token),this.emit("beforeConnect"),this.websocket.connect()}},{key:"onIncomingMessage",value:function(f){var m=mn.parse(f);if(!!m){var y=m.method,k=m.header,E=m.payload;if(y!=="reply"&&this.confirmReceiving(k),y==="notification")this.emit("message",k.message_type,E);else if(k.method==="reply")this.transport.processReply({id:k.id,status:k.status,header:k,body:E});else if(k.method==="client_update")k.client_update_type==="token_about_to_expire"&&this.emit("tokenAboutToExpire");else if(k.method==="close")if(k.status.code===308)ee.debug("Connection has been offloaded"),this.fsm.receiveOffload({status:k.status.status,body:E});else if(k.status.code===406){var L="Server closed connection because can't parse protocol: ".concat(JSON.stringify(k.status));this.emitReplyConnectionError(L,k,!0),ee.error(L),this.fsm.receiveFatalClose()}else k.status.code===417?(ee.error("Server closed connection because can't parse client reply: ".concat(JSON.stringify(k.status))),this.fsm.receiveFatalClose(k.status.status)):k.status.code===410?(ee.warn("Server closed connection: ".concat(JSON.stringify(k.status))),this.fsm.receiveClose(k.status.status),this.emit("tokenExpired")):k.status.code===401?(ee.error("Server closed connection: ".concat(JSON.stringify(k.status))),this.fsm.receiveClose(k.status.status)):(ee.warn("unexpected message: ",k.status),this.fsm.receiveOffload({status:k.status.status,body:null}))}}},{key:"sendInit",value:function(){var p=ke.default(ue.default.mark(function m(){var y,k;return ue.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return ee.trace("sendInit"),L.prev=1,this.emit("beforeSendInit"),L.next=5,this.transport.sendInit();case 5:y=L.sent,this.config.updateContinuationToken(y.continuationToken),this.config.confirmedCapabilities=y.confirmedCapabilities,this.fsm.initSuccess(y),this.emit("initialized",y),this.emit("tokenUpdated"),L.next=17;break;case 13:L.prev=13,L.t0=L.catch(1),L.t0 instanceof Hr?(k=!1,ee.warn("Init rejected by server: ".concat(JSON.stringify(L.t0.reply.status))),this.emit("sendInitFailed"),L.t0.reply.status.code===401||L.t0.reply.status.code===403?(k=!0,this.fsm.tokenRejected(L.t0.reply.status),L.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):L.t0.reply.status.code===429?(this.modifyBackoff(L.t0.reply.body),this.fsm.initError(!0)):L.t0.reply.status.code===500?this.fsm.initError(!1):this.fsm.initError(!0),this.emitReplyConnectionError(L.t0.message,L.t0.reply,k)):(this.terminationReason=L.t0.message,this.emit("connectionError",{terminal:!0,message:"Unknown error during connection initialisation: ".concat(L.t0.message,`
`).concat(JSON.stringify(L.t0,null,2)),httpStatusCode:null,errorCode:null}),this.fsm.initError(!0)),this.emit("tokenUpdated",L.t0);case 17:case"end":return L.stop()}},m,this,[[1,13]])}));function f(){return p.apply(this,arguments)}return f}()},{key:"sendUpdate",value:function(){var p=ke.default(ue.default.mark(function m(){var y,k,E;return ue.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return ee.trace("sendUpdate"),y=new De(this.config.token),j.prev=2,j.next=5,this.transport.sendWithReply(y);case 5:k=j.sent,this.fsm.updateSuccess(k.body),this.emit("tokenUpdated"),j.next=14;break;case 10:j.prev=10,j.t0=j.catch(2),j.t0 instanceof Hr?(E=!1,ee.warn("Token update rejected by server: ".concat(JSON.stringify(j.t0.reply.status))),j.t0.reply.status.code===401||j.t0.reply.status.code===403?(E=!0,this.fsm.tokenRejected(j.t0.reply.status),j.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):j.t0.reply.status.code===429?(this.modifyBackoff(j.t0.reply.body),this.fsm.updateError(j.t0.reply.status)):this.fsm.updateError(j.t0.reply.status),this.emitReplyConnectionError(j.t0.message,j.t0.reply,E)):(this.emit("error",!1,j.t0.message,null,null),this.fsm.updateError(j.t0)),this.emit("tokenUpdated",j.t0);case 14:case"end":return j.stop()}},m,this,[[2,10]])}));function f(){return p.apply(this,arguments)}return f}()},{key:"emitReplyConnectionError",value:function(f,m,y){var k=m.status&&m.status.description?m.status.description:f,E=m.status.code,L=m.status&&m.status.errorCode?m.status.errorCode:null;y&&(this.terminationReason=k),this.emit("connectionError",{terminal:y,message:"Connection error: ".concat(k),httpStatusCode:E,errorCode:L})}},{key:"cancelInit",value:function(){ee.trace("cancelInit")}},{key:"cancelUpdate",value:function(){ee.trace("cancelUpdate")}},{key:"confirmReceiving",value:function(f){ee.trace("confirmReceiving");try{this.transport.send(new K(f.id))}catch(m){ee.debug("failed to confirm packet receiving",m)}}},{key:"closeSocket",value:function(f){var m=this;ee.trace("closeSocket (graceful: ".concat(f,")")),f&&this.transport.isConnected&&this.transport.sendClose(),this.websocket.close(),bn(function(){return m.fsm.socketClosed()})}},{key:"connect",value:function(){ee.trace("connect"),this.fsm.userConnect()}},{key:"disconnect",value:function(){var f=this;return ee.trace("disconnect"),this.fsm.is("disconnected")?Promise.resolve():new Promise(function(m){f.disconnectedPromiseResolve=m,f.fsm.userDisconnect()})}},{key:"updateToken",value:function(f){var m=this;return ee.trace("updateToken:",f),new Promise(function(y,k){m.once("tokenUpdated",function(E){E?k(E):y()}),m.fsm.userUpdateToken()})}},{key:"isTerminalState",get:function(){return this.terminalStates.indexOf(this.fsm.state)!==-1}},{key:"getTerminationReason",get:function(){return this.terminationReason}},{key:"onCloseReceived",value:function(){this.websocket.close()}}]),d}(D),St=function(){function v(){re.default(this,v)}return de.default(v,null,[{key:"getMetadata",value:function(d){var p,f,m,y,k,E,L,j,Ce=d&&d.clientMetadata?d.clientMetadata:{},Je=["ver","env","envv","os","osv","osa","type","sdk","sdkv","dev","devv","devt","app","appv"],Ft={env:(p=ft.name)!==null&&p!==void 0?p:"unknown",envv:(f=ft.version)!==null&&f!==void 0?f:"unknown",os:(m=(y=ft.os)===null||y===void 0?void 0:y.family)!==null&&m!==void 0?m:"unknown",osv:(k=(E=ft.os)===null||E===void 0?void 0:E.version)!==null&&k!==void 0?k:"unknown",osa:(L=(j=ft.os)===null||j===void 0?void 0:j.architecture)!==null&&L!==void 0?L:"unknown",sdk:"js-default"},Ze={};return Je.filter(function(mr){return mr in Ce||mr in Ft}).forEach(function(mr){return Ze[mr]=mr in Ce?Ce[mr]:Ft[mr]}),Ze}}]),v}(),Po=3e4;function Mo(v){return v>=200&&v<300}function xo(v){switch(W.default(v)){case"undefined":return"";case"object":return JSON.stringify(v);default:return v}}var na=function(){function v(g,d){var p=this;re.default(this,v),this.config=d,this.activeRequests=new Map,this.channel=g,this.channel.on("reply",function(f){return p.processReply(f)}),this.channel.on("disconnected",function(){p.activeRequests.forEach(function(f){clearTimeout(f.timeout),f.reject(new Ct("disconnected"))}),p.activeRequests.clear()})}return de.default(v,[{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"processReply",value:function(d){var p=this.activeRequests.get(d.id);p&&(clearTimeout(p.timeout),this.activeRequests.delete(d.id),Mo(d.status.code)?p.resolve(d):(p.reject(new Hr("Transport failure: "+d.status.status,d)),ee.trace("message rejected")))}},{key:"storeRequest",value:function(d,p,f){var m={resolve:p,reject:f,timeout:setTimeout(function(){ee.trace("request",d,"is timed out"),f(new Ct("Twilsock: request timeout: "+d))},Po)};this.activeRequests.set(d,m)}},{key:"shutdown",value:function(){this.activeRequests.forEach(function(d){clearTimeout(d.timeout),d.reject(new Ct("Twilsock: request cancelled by user"))}),this.activeRequests.clear()}},{key:"sendInit",value:function(){var g=ke.default(ue.default.mark(function p(){var f,m,y;return ue.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return ee.trace("sendInit"),f=St.getMetadata(this.config),m=new G(this.config.token,this.config.continuationToken,f,this.config.initRegistrations,this.config.tweaks),E.next=5,this.sendWithReply(m);case 5:return y=E.sent,E.abrupt("return",new Ne(y.id,y.header.continuation_token,new Set(y.header.capabilities),y.header.continuation_token_status,y.header.offline_storage,y.header.init_registrations,y.header.debug_info));case 7:case"end":return E.stop()}},p,this)}));function d(){return g.apply(this,arguments)}return d}()},{key:"sendClose",value:function(){var d=new ce;this.send(d)}},{key:"sendWithReply",value:function(d,p){var f=this;return new Promise(function(m,y){var k=f.send(d,p);f.storeRequest(k,m,y)})}},{key:"send",value:function(d,p){d.id=d.id||"TM".concat(x.v4());var f=mn.createPacket(d,xo(p));try{return this.channel.send(f),d.id}catch(m){throw ee.debug("failed to send ",d,m),ee.trace(m.stack),m}}}]),v}();function _s(v){var g=No();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function No(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var tn=function(v){le.default(d,v);var g=_s(d);function d(p){var f;return re.default(this,d),f=g.call(this),H.default(P.default(f),"socket",null),f.url=p,f.url=p,f.WebSocket=t.WebSocket||t.MozWebSocket||{},f}return de.default(d,[{key:"isConnected",get:function(){return!!this.socket&&this.socket.readyState===1}},{key:"connect",value:function(){var f=this;ee.trace("connecting to socket");var m;try{m=new this.WebSocket(this.url)}catch(y){ee.debug("Socket error: ".concat(this.url)),this.emit("socketError",y);return}m.binaryType="arraybuffer",m.onopen=function(){ee.debug("socket opened ".concat(f.url)),f.emit("connected")},m.onclose=function(y){ee.debug("socket closed",y),f.emit("disconnected",y)},m.onerror=function(y){ee.debug("Socket error:",y),f.emit("socketError",y)},m.onmessage=function(y){f.emit("message",y.data)},this.socket=m}},{key:"send",value:function(f){return this.socket&&this.socket.send(f)}},{key:"close",value:function(){if(ee.trace("closing socket"),this.socket){this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null;try{this.socket.close()}finally{}}}}]),d}(D);function Lo(v){var g=gr();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function gr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jo=function(v){le.default(d,v);var g=Lo(d);function d(p){var f;return re.default(this,d),f=g.call(this),f.transport=p,f.registrations=new Map,f.registrationsInProgress=new Map,f}return de.default(d,[{key:"putNotificationContext",value:function(){var p=ke.default(ue.default.mark(function m(y,k){var E;return ue.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return E={method:"put_notification_ctx",notification_ctx_id:y},j.next=3,this.transport.sendWithReply(E,k);case 3:case"end":return j.stop()}},m,this)}));function f(m,y){return p.apply(this,arguments)}return f}()},{key:"deleteNotificationContext",value:function(){var p=ke.default(ue.default.mark(function m(y){var k;return ue.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return k={method:"delete_notification_ctx",notification_ctx_id:y},L.next=3,this.transport.sendWithReply(k);case 3:case"end":return L.stop()}},m,this)}));function f(m){return p.apply(this,arguments)}return f}()},{key:"updateRegistration",value:function(){var p=ke.default(ue.default.mark(function m(y,k){var E,L;return ue.default.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return ee.debug("update registration for context",y),E=this.registrationsInProgress.get(y),E||(E=new Set,this.registrationsInProgress.set(y,E)),L=x.v4(),E.add(L),Ce.prev=5,Ce.next=8,this.putNotificationContext(y,k);case 8:ee.debug("registration attempt succeeded for context",k),E.delete(L),E.size===0&&(this.registrationsInProgress.delete(y),this.emit("registered",y)),Ce.next=19;break;case 13:Ce.prev=13,Ce.t0=Ce.catch(5),ee.warn("registration attempt failed for context",k),ee.debug(Ce.t0),E.delete(L),E.size===0&&(this.registrationsInProgress.delete(y),this.emit("registrationFailed",y,Ce.t0));case 19:case"end":return Ce.stop()}},m,this,[[5,13]])}));function f(m,y){return p.apply(this,arguments)}return f}()},{key:"updateRegistrations",value:function(){var p=ke.default(ue.default.mark(function m(){var y=this,k;return ue.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return ee.trace("refreshing ".concat(this.registrations.size," registrations")),k=[],this.registrations.forEach(function(j,Ce){k.push(y.updateRegistration(Ce,j))}),L.next=5,Promise.all(k);case 5:case"end":return L.stop()}},m,this)}));function f(){return p.apply(this,arguments)}return f}()},{key:"setNotificationsContext",value:function(){var p=ke.default(ue.default.mark(function m(y,k){return ue.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(!(!y||!k)){L.next=2;break}throw new Ct("Invalid arguments provided");case 2:return this.registrations.set(y,k),L.next=5,this.updateRegistration(y,k);case 5:return L.abrupt("return",L.sent);case 6:case"end":return L.stop()}},m,this)}));function f(m,y){return p.apply(this,arguments)}return f}()},{key:"removeNotificationsContext",value:function(){var p=ke.default(ue.default.mark(function m(y){return ue.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(this.registrations.has(y)){E.next=2;break}return E.abrupt("return");case 2:return E.next=4,this.deleteNotificationContext(y);case 4:this.transport.isConnected&&this.registrations.delete(y);case 5:case"end":return E.stop()}},m,this)}));function f(m){return p.apply(this,arguments)}return f}()}]),d}(D);function Uo(v){var g=Fo();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function Fo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Do=function(v){le.default(d,v);var g=Uo(d);function d(p,f,m){var y;return re.default(this,d),y=g.call(this,f),y.status=p,y.description=f,y.body=m,y}return d}(Ct);function _n(v){var g=Bo();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function Bo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Lr=function(v){le.default(d,v);var g=_n(d);function d(p){return re.default(this,d),g.call(this,p)}return d}(Ct),Ua=2e4;function Ci(v){return v>=200&&v<300}function qo(v){return v&&v.header&&v.header.http_status}function Ss(v){var g=v.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(g){var d={protocol:g[1],host:g[2],hostname:g[3],port:g[4],pathname:g[5],search:g[6],hash:g[7],params:{}};if(d.search.length>0){var p=d.search.substring(1);d.params=p.split("&").map(function(f){return f.split("=")}).reduce(function(f,m){return f.hasOwnProperty(m[0])?Array.isArray(f[m[0]])?f[m[0]].push(m[1]):f[m[0]]=[f[m[0]],m[1]]:f[m[0]]=m[1],f},{})}return d}throw new Ct("Incorrect URI: "+v)}function Ho(v,g){var d=Ss(g),p={method:v,host:d.host,path:d.pathname};return d.params&&(p.params=d.params),p}function Wo(v,g,d,p,f){return{to:Ho(v,g),headers:d,body:p,grant:f}}var ht=function(){function v(g,d,p){re.default(this,v),this.config=p,this.transport=g,this.pendingMessages=[],this.twilsock=d}return de.default(v,[{key:"saveMessage",value:function(d){var p=this;return new Promise(function(f,m){var y={message:d,resolve:f,reject:m,alreadyRejected:!1,timeout:setTimeout(function(){ee.debug("request is timed out"),m(new Ct("request '".concat(d.to.method,"' to '").concat(d.to.host,"' timed out"))),y.alreadyRejected=!0},Ua)};p.pendingMessages.push(y)})}},{key:"sendPendingMessages",value:function(){for(var d=this,p=function(){var y=d.pendingMessages[0];if(!y.alreadyRejected)try{var k=y.message;d.actualSend(k).then(function(E){return y.resolve(E)}).catch(function(E){return y.reject(E)}),clearTimeout(y.timeout)}catch(E){return ee.debug("Failed to send pending message",E),"break"}d.pendingMessages.splice(0,1)};this.pendingMessages.length>0;){var f=p();if(f==="break")break}}},{key:"rejectPendingMessages",value:function(){var d=this;this.pendingMessages.forEach(function(p){p.reject(new Lr("Unable to connect: "+d.twilsock.getTerminationReason)),p.alreadyRejected=!0,clearTimeout(p.timeout)}),this.pendingMessages.splice(0,this.pendingMessages.length)}},{key:"actualSend",value:function(){var g=ke.default(ue.default.mark(function p(f){var m,y,k,E,L,j,Ce,Je;return ue.default.wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return y=f.to,k=f.headers,E=f.body,L=(m=f.grant)!==null&&m!==void 0?m:this.config.activeGrant,j={host:y.host,path:y.path,method:y.method,params:y.params,headers:k},Ce=new Z(L,k["Content-Type"]||"application/json",j),ee.trace("Sending upstream message",Ce),Ze.next=9,this.transport.sendWithReply(Ce,E);case 9:if(Je=Ze.sent,ee.trace("Received upstream message response",Je),!(qo(Je)&&!Ci(Je.header.http_status.code))){Ze.next=13;break}throw new Do(Je.header.http_status.code,Je.header.http_status.status,Je.body);case 13:return Ze.abrupt("return",{status:Je.header.http_status,headers:Je.header.http_headers,body:Je.body});case 14:case"end":return Ze.stop()}},p,this)}));function d(p){return g.apply(this,arguments)}return d}()},{key:"send",value:function(d,p){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=arguments.length>3?arguments[3]:void 0,y=arguments.length>4?arguments[4]:void 0;if(this.twilsock.isTerminalState)return Promise.reject(new Lr("Unable to connect: "+this.twilsock.getTerminationReason));var k=Wo(d,p,f,m,y);return this.twilsock.isConnected?this.actualSend(k):this.saveMessage(k)}}]),v}(),$s=function(){function v(){var g=this;re.default(this,v),this._promise=new Promise(function(d,p){g._resolve=d,g._reject=p})}return de.default(v,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(d){this._resolve(d)}},{key:"set",value:function(d){this._resolve(d)}},{key:"fail",value:function(d){this._reject(d)}}]),v}(),Fa=function(){function v(g){re.default(this,v),this.id=g}return de.default(v,null,[{key:"create",value:function(d){if(d instanceof Object&&"storage_id"in d)return new v(d.storage_id);throw new Ct('Field "storage_id" is missing')}}]),v}(),Ii=function(){function v(){return re.default(this,v),H.default(this,"initializedFlag","twilio_twilsock_token_storage"),H.default(this,"tokenStoragePrefix","twilio_continuation_token_"),v._instance||(this.initialize(),v._instance=this),v._instance}return de.default(v,[{key:"sessionStorage",value:function(){try{return t.sessionStorage}catch{return null}}},{key:"window",value:function(){try{return t.window}catch{return null}}},{key:"storeToken",value:function(d,p){this.canStore()&&this.sessionStorage.setItem(this.getKeyName(p),d)}},{key:"getStoredToken",value:function(d){return this.canStore()?this.sessionStorage.getItem(this.getKeyName(d)):null}},{key:"initialize",value:function(){var d=this;if(this.canStore()){var p=this.sessionStorage.getItem(this.initializedFlag);p&&this.clear(),this.sessionStorage.setItem(this.initializedFlag,"true");var f=this.sessionStorage.removeItem;this.window.addEventListener("unload",function(){f(d.initializedFlag)})}}},{key:"clear",value:function(){if(this.canStore()){for(var d=[],p=0;p<this.sessionStorage.length;p++){var f=this.sessionStorage.key(p);f&&f.indexOf(this.tokenStoragePrefix)===0&&d.push(f)}var m=this.sessionStorage.removeItem;d.forEach(function(y){return m(y)}),m(this.initializedFlag)}}},{key:"getKeyName",value:function(d){return"".concat(this.tokenStoragePrefix).concat(d)}},{key:"canStore",value:function(){return!!(this.sessionStorage&&this.sessionStorage.length&&this.window)}}]),v}();H.default(Ii,"_instance",null);var aa=new Ii,pt=function(){function v(g,d,p,f,m,y){re.default(this,v),this.title=g,this.details=d,this.start=p,this.type=m,this.id=y,this.end=f}return de.default(v,[{key:"toTelemetryEvent",value:function(){var d=new Date,p=this.start,f=this.end?this.end:d;if(f<p){var m=f;f=p,p=m}var y=p.getTime()-d.getTime(),k=f.getTime()-d.getTime(),E=new at(y,k,this.title,this.details,this.id,this.type);return E}}]),v}();e.TelemetryPoint=void 0,function(v){v[v.Start=0]="Start",v[v.End=1]="End"}(e.TelemetryPoint||(e.TelemetryPoint={})),e.EventSendingLimitation=void 0,function(v){v[v.MinEventsPortion=0]="MinEventsPortion",v[v.AnyEvents=1]="AnyEvents",v[v.AnyEventsIncludingUnfinished=2]="AnyEventsIncludingUnfinished"}(e.EventSendingLimitation||(e.EventSendingLimitation={}));var Ts=function(){function v(g,d){re.default(this,v),H.default(this,"minEventsPortionToSend",50),H.default(this,"maxEventsPortionToSend",100),H.default(this,"pendingEvents",new Map),H.default(this,"readyEvents",[]),H.default(this,"hasInitializationFinished",!1),H.default(this,"_canSendTelemetry",!1),this.config=g,this.packetInterface=d}return de.default(v,[{key:"isTelemetryEnabled",get:function(){return this.config.confirmedCapabilities.has("telemetry.v1")}},{key:"canSendTelemetry",get:function(){return this._canSendTelemetry&&this.isTelemetryEnabled},set:function(d){ee.debug("TelemetryTracker.canSendTelemetry: ".concat(d," TelemetryTracker.isTelemetryEnabled: ").concat(this.isTelemetryEnabled)),this._canSendTelemetry&&!d&&(this.pendingEvents.clear(),this.readyEvents=[]),this._canSendTelemetry=d,d&&this.sendTelemetry(e.EventSendingLimitation.AnyEvents),d&&!this.hasInitializationFinished&&(this.hasInitializationFinished=!0)}},{key:"addTelemetryEvent",value:function(d){!this.canSendTelemetry&&this.hasInitializationFinished||this.readyEvents.push(d)}},{key:"addPartialEvent",value:function(d,p,f){ee.debug("Adding ".concat(f===e.TelemetryPoint.Start?"starting":"ending"," timepoint for '").concat(p,"' event"));var m=this.pendingEvents.has(p);if(f===e.TelemetryPoint.Start)m&&ee.debug("Overwriting starting point for '".concat(p,"' event")),this.pendingEvents.set(p,d);else{if(!m){ee.info("Could not find started event for '".concat(p,"' event"));return}this.addTelemetryEvent(this.merge(this.pendingEvents.get(p),d)),this.pendingEvents.delete(p)}}},{key:"getTelemetryToSend",value:function(d){return!this.canSendTelemetry||this.readyEvents.length==0?[]:d==e.EventSendingLimitation.MinEventsPortion&&this.readyEvents.length<this.minEventsPortionToSend?[]:this.getTelemetryPortion(d==e.EventSendingLimitation.AnyEventsIncludingUnfinished)}},{key:"getTelemetryPortion",value:function(d){var p=this,f=Math.min(this.readyEvents.length,this.maxEventsPortionToSend),m=this.readyEvents.splice(0,f);return d&&m.length<this.maxEventsPortionToSend&&this.pendingEvents.forEach(function(y,k){if(!(m.length>=p.maxEventsPortionToSend)){var E=p.pendingEvents.get(k);p.pendingEvents.delete(k),m.push(new pt("[UNFINISHED] ".concat(E.title),E.details,E.start,null,E.type,E.id))}}),m}},{key:"merge",value:function(d,p){return new pt(p.title?p.title:d.title,p.details?p.details:d.details,d.start,p.end,p.type?p.type:d.type,p.id?p.id:d.id)}},{key:"sendTelemetryIfMinimalPortionCollected",value:function(){this.sendTelemetry(e.EventSendingLimitation.MinEventsPortion)}},{key:"sendTelemetry",value:function(d){var p=this.getTelemetryToSend(d);if(p.length!==0)try{this.packetInterface.send(new tt(p.map(function(f){return f.toTelemetryEvent()})))}catch(f){ee.debug("Error while sending ".concat(p.length," telemetry events due to ").concat(f,"; they will be resubmitted")),this.readyEvents=this.readyEvents.concat(p)}}}]),v}();function I(v){var g=O();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return J.default(this,f)}}function O(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var S=function v(){re.default(this,v)};H.default(S,"TWILSOCK_CONNECT","twilsock.sdk.connect"),H.default(S,"TWILSOCK_INIT","twilsock.sdk.init"),e.TwilsockClient=function(v){le.default(d,v);var g=I(d);function d(p,f,m){var y;re.default(this,d),y=g.call(this),H.default(P.default(y),"version",Fe),H.default(P.default(y),"offlineStorageDeferred",new $s),m.continuationToken=m.continuationToken?m.continuationToken:aa.getStoredToken(f);var k=y.config=new Ue(p,f,m);ee.setLevel(k.logLevel);var E=new tn(k.url),L=new na(E,k);return y.channel=new wn(E,L,k),y.registrations=new jo(L),y.upstream=new ht(L,y.channel,k),y.telemetryTracker=new Ts(k,L),y.channel.on("initialized",function(){return y.telemetryTracker.canSendTelemetry=!0}),E.on("disconnected",function(){return y.telemetryTracker.canSendTelemetry=!1}),y.registrations.on("registered",function(j){return y.emit("registered",j)}),y.channel.on("message",function(j,Ce){return setTimeout(function(){return y.emit("message",j,Ce)},0)}),y.channel.on("stateChanged",function(j){return setTimeout(function(){return y.emit("stateChanged",j)},0)}),y.channel.on("connectionError",function(j){return setTimeout(function(){return y.emit("connectionError",j)},0)}),y.channel.on("tokenAboutToExpire",function(){return setTimeout(function(){return y.emit("tokenAboutToExpire")},0)}),y.channel.on("tokenExpired",function(){return setTimeout(function(){return y.emit("tokenExpired")},0)}),y.channel.on("connected",function(){return y.registrations.updateRegistrations()}),y.channel.on("connected",function(){return y.upstream.sendPendingMessages()}),y.channel.on("connected",function(){return setTimeout(function(){return y.emit("connected")},0)}),y.channel.on("beforeConnect",function(){return y.telemetryTracker.addPartialEvent(new pt("Establish WebSocket connection","",new Date),S.TWILSOCK_CONNECT,e.TelemetryPoint.Start)}),y.channel.on("connected",function(){return y.telemetryTracker.addPartialEvent(new pt("Establish WebSocket connection","",new Date,new Date),S.TWILSOCK_CONNECT,e.TelemetryPoint.End)}),y.channel.on("beforeSendInit",function(){return y.telemetryTracker.addPartialEvent(new pt("Send Twilsock init","",new Date),S.TWILSOCK_INIT,e.TelemetryPoint.Start)}),y.channel.on("initialized",function(){return y.telemetryTracker.addPartialEvent(new pt("Send Twilsock init","Succeeded",new Date,new Date),S.TWILSOCK_INIT,e.TelemetryPoint.End)}),y.channel.on("sendInitFailed",function(){return y.telemetryTracker.addPartialEvent(new pt("Send Twilsock init","Failed",new Date,new Date),S.TWILSOCK_INIT,e.TelemetryPoint.End)}),y.channel.on("initialized",function(j){y.handleStorageId(f,j),aa.storeToken(j.continuationToken,f),setTimeout(function(){return y.emit("initialized",j)},0)}),y.channel.on("disconnected",function(){return setTimeout(function(){return y.emit("disconnected")},0)}),y.channel.on("disconnected",function(){return y.upstream.rejectPendingMessages()}),y.channel.on("disconnected",function(){return y.offlineStorageDeferred.fail(new Ct("Client disconnected"))}),y.offlineStorageDeferred.promise.catch(function(){}),y}return de.default(d,[{key:"emit",value:function(f){for(var m,y=arguments.length,k=new Array(y>1?y-1:0),E=1;E<y;E++)k[E-1]=arguments[E];return ee.debug("Emitting ".concat(f.toString(),"(").concat(k.map(function(L){return JSON.stringify(L)}).join(", "),")")),(m=te.default(xe.default(d.prototype),"emit",this)).call.apply(m,[this,f].concat(k))}},{key:"handleStorageId",value:function(f,m){if(!m.offlineStorage)this.offlineStorageDeferred.fail(new Ct("No offline storage id"));else if(m.offlineStorage.hasOwnProperty(f))try{this.offlineStorageDeferred.set(Fa.create(m.offlineStorage[f])),ee.debug("Offline storage for '".concat(f,"' product: ").concat(JSON.stringify(m.offlineStorage[f]),"."))}catch(y){this.offlineStorageDeferred.fail(new Ct("Failed to parse offline storage for ".concat(f," ").concat(JSON.stringify(m.offlineStorage[f]),". ").concat(y,".")))}else this.offlineStorageDeferred.fail(new Ct("No offline storage id for '".concat(f,"' product: ").concat(JSON.stringify(m.offlineStorage))))}},{key:"storageId",value:function(){return this.offlineStorageDeferred.promise}},{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"state",get:function(){return this.channel.state}},{key:"updateToken",value:function(){var p=ke.default(ue.default.mark(function m(y){return ue.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(ee.trace("updating token '".concat(y,"'")),this.config.token!==y){E.next=3;break}return E.abrupt("return");case 3:return this.config.updateToken(y),E.next=6,this.channel.updateToken(y);case 6:return E.abrupt("return",E.sent);case 7:case"end":return E.stop()}},m,this)}));function f(m){return p.apply(this,arguments)}return f}()},{key:"setNotificationsContext",value:function(){var p=ke.default(ue.default.mark(function m(y,k){return ue.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,this.registrations.setNotificationsContext(y,k);case 2:case"end":return L.stop()}},m,this)}));function f(m,y){return p.apply(this,arguments)}return f}()},{key:"removeNotificationsContext",value:function(){var p=ke.default(ue.default.mark(function m(y){return ue.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this.registrations.removeNotificationsContext(y);case 2:case"end":return E.stop()}},m,this)}));function f(m){return p.apply(this,arguments)}return f}()},{key:"connect",value:function(){return this.channel.connect()}},{key:"disconnect",value:function(){var p=ke.default(ue.default.mark(function m(){return ue.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEventsIncludingUnfinished),k.next=3,this.channel.disconnect();case 3:return k.abrupt("return",k.sent);case 4:case"end":return k.stop()}},m,this)}));function f(){return p.apply(this,arguments)}return f}()},{key:"get",value:function(){var p=ke.default(ue.default.mark(function m(y,k,E){return ue.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),j.next=3,this.upstream.send("GET",y,k,void 0,E);case 3:return j.abrupt("return",j.sent);case 4:case"end":return j.stop()}},m,this)}));function f(m,y,k){return p.apply(this,arguments)}return f}()},{key:"post",value:function(){var p=ke.default(ue.default.mark(function m(y,k,E,L){return ue.default.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),Ce.next=3,this.upstream.send("POST",y,k,E,L);case 3:return Ce.abrupt("return",Ce.sent);case 4:case"end":return Ce.stop()}},m,this)}));function f(m,y,k,E){return p.apply(this,arguments)}return f}()},{key:"put",value:function(){var p=ke.default(ue.default.mark(function m(y,k,E,L){return ue.default.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),Ce.next=3,this.upstream.send("PUT",y,k,E,L);case 3:return Ce.abrupt("return",Ce.sent);case 4:case"end":return Ce.stop()}},m,this)}));function f(m,y,k,E){return p.apply(this,arguments)}return f}()},{key:"delete",value:function(){var p=ke.default(ue.default.mark(function m(y,k,E,L){return ue.default.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),Ce.next=3,this.upstream.send("DELETE",y,k,E,L);case 3:return Ce.abrupt("return",Ce.sent);case 4:case"end":return Ce.stop()}},m,this)}));function f(m,y,k,E){return p.apply(this,arguments)}return f}()},{key:"addTelemetryEvent",value:function(f){this.telemetryTracker.addTelemetryEvent(f),this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}},{key:"addPartialTelemetryEvent",value:function(f,m,y){this.telemetryTracker.addPartialEvent(f,m,y),y===e.TelemetryPoint.End&&this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}}]),d}(D),e.TwilsockClient=dt([b.validateConstructorTypes(b.nonEmptyString,b.nonEmptyString,[b.pureObject,"undefined",b.literal(null)]),Ee("design:paramtypes",[String,String,Object])],e.TwilsockClient);var _=function(){function v(g){re.default(this,v),this.product=g,this.type="ers",this.notification_protocol_version=0,this.message_types=[]}return de.default(v,[{key:"populateInitRegistrations",value:function(d){var p=new Set(this.message_types);for(var f in d)p.add(d[f]);this.message_types=Array.from(p)}}]),v}();e.InitRegistration=_,e.TelemetryEventDescription=pt,e.TelemetryTracker=Ts,e.TransportUnavailableError=Lr,e.Twilsock=e.TwilsockClient,e.TwilsockError=Ct})(Bf);var XE={},bS=qt,b9=et,w9=At,_9=nt,Rp=el,S9=Xu,$9=zu,T9=$r,k9=Vu,xs=Object.assign,wS=Object.defineProperty,E9=b9([].concat),ZE=!xs||_9(function(){if(bS&&xs({b:1},xs(wS({},"a",{enumerable:!0,get:function(){wS(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(a){t[a]=a}),xs({},e)[r]!=7||Rp(xs({},t)).join("")!=n})?function(t,r){for(var n=T9(t),a=arguments.length,i=1,s=S9.f,o=$9.f;a>i;)for(var u=k9(arguments[i++]),l=s?E9(Rp(u),s(u)):Rp(u),c=l.length,h=0,w;c>h;)w=l[h++],(!bS||w9(o,u,w))&&(n[w]=u[w]);return n}:xs,C9=ot,_S=ZE;C9({target:"Object",stat:!0,arity:2,forced:Object.assign!==_S},{assign:_S});var Cr={};/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(Cr,"__esModule",{value:!0});var I9=Un.exports,R9=wi.exports,A9=_i.exports,O9=ra.exports,P9=Fn.exports,M9=Ln.exports,x9=jn.exports,N9=Xr.exports;function Ti(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var no=Ti(I9),$a=Ti(R9),Ap=Ti(A9),L9=Ti(O9),j9=Ti(P9),U9=Ti(M9),F9=Ti(x9),SS=Ti(N9),Na=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function D9(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=B9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function B9(e,t){if(!!e){if(typeof e=="string")return $S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $S(e,t)}}function $S(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var eC=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Na(function(a){var i=!1,s=[],o=D9(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;if(typeof l=="string"){i=i||no.default(a)===l,s.push("of type ".concat(l));continue}i=i||a instanceof l,s.push("an instance of ".concat(l.name))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function q9(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=H9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function H9(e,t){if(!!e){if(typeof e=="string")return TS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TS(e,t)}}function TS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var W9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Na(function(a){var i=!1,s=[],o=q9(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;i=i||a===l,s.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function G9(e){var t=z9();return function(){var n=SS.default(e),a;if(t){var i=SS.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return F9.default(this,a)}}function z9(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Du(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=V9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function V9(e,t){if(!!e){if(typeof e=="string")return kS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kS(e,t)}}function kS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Yf=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=Du(r.entries()),a;try{for(n.s();!(a=n.n()).done;){var i=$a.default(a.value,2),s=i[0],o=i[1],u=Xf(t[s],o),l=$a.default(u,4),c=l[0],h=l[1],w=l[2],b=l[3];if(!c){var $=s+1;throw new Error("Argument ".concat($," is expected to be ").concat(w).concat(b," but got ").concat(h))}}}catch(A){n.e(A)}finally{n.f()}},tC=function(t){var r,n,a=["undefined","boolean","number","bigint","string"];if(a.includes(no.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),no.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var i;n=t===null?"null":"instance of ".concat(t==null||(i=t.constructor)===null||i===void 0?void 0:i.name)}return n||(n=no.default(t)),n},K9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=bg(r);return function(i){return function(s){U9.default(u,s);var o=G9(u);function u(){j9.default(this,u);for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Yf(a,c),o.call.apply(o,[this].concat(c))}return L9.default(u)}(i)}},J9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=bg(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Yf(a,c),u.apply(this,c)}}},Y9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=bg(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];try{Yf(a,c)}catch(w){return Promise.reject(w)}return u.apply(this,c)}}},bg=function(t){var r=[],n=Du(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.push(Qf(i))}}catch(s){n.e(s)}finally{n.f()}return r},Qf=function(t){var r=[],n=Array.isArray(t)?t:[t],a=Du(n),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;if(typeof s=="string"||typeof s=="function"){r.push(eC(s));continue}r.push(s)}}catch(o){a.e(o)}finally{a.f()}return r},Xf=function(t,r){var n=[],a,i=!1,s=Du(t),o;try{for(s.s();!(o=s.n()).done;){var u=o.value,l=Du(u.checks),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,w=h(r),b=$a.default(w,3),$=b[0],A=b[1],x=b[2];i=i||$,!a&&x&&(a=x),A&&(n=typeof A=="string"?[].concat(Ap.default(n),[A]):[].concat(Ap.default(n),Ap.default(A)))}}catch(se){l.e(se)}finally{l.f()}}}catch(se){s.e(se)}finally{s.f()}if(i)return[!0];var U=a||tC(r),B=n.length-1,ve=B>0?"".concat(n.slice(0,B).join(", ")," or ").concat(n[B]):n.join(", ");return[!1,U,ve,B>1?";":","]};function Q9(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=X9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function X9(e,t){if(!!e){if(typeof e=="string")return ES(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ES(e,t)}}function ES(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Z9=function(t,r){return Na(function(n){if(!Array.isArray(n)||n.length<1)return[!1,"a non-empty array of ".concat(t)];var a=Q9(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=$a.default(i.value,2),o=s[0],u=s[1],l=Xf(Qf(r),u),c=$a.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid non-empty array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})},eJ=Na(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),tJ=Na(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),rJ=Na(function(e){return[no.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]}),nJ=function(t,r){return Na(function(n){if(no.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var a=0,i=Object.entries(r);a<i.length;a++){var s=$a.default(i[a],2),o=s[0],u=s[1],l=Xf(Qf(u),n[o]),c=$a.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"valid ".concat(t,' (key "').concat(o,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(o,'" is ').concat(w,")")]}return[!0]})};function aJ(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=iJ(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function iJ(e,t){if(!!e){if(typeof e=="string")return CS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CS(e,t)}}function CS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var sJ=function(t,r){return Na(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var a=aJ(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=$a.default(i.value,2),o=s[0],u=s[1],l=Xf(Qf(r),u),c=$a.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})};Cr.array=sJ;Cr.custom=Na;Cr.literal=W9;Cr.nonEmptyArray=Z9;Cr.nonEmptyString=eJ;Cr.nonNegativeInteger=tJ;Cr.objectSchema=nJ;Cr.pureObject=rJ;Cr.runtimeTypeValidation=Yf;Cr.stringifyReceivedType=tC;Cr.type=eC;Cr.validateConstructorTypes=K9;Cr.validateTypes=J9;Cr.validateTypesAsync=Y9;/*
@license
The MIT License (MIT)

Copyright (c) 2016 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=To.exports,r=Fn.exports,n=ra.exports,a=Ln.exports,i=jn.exports,s=Xr.exports,o=fl,u=Un.exports,l=Bf,c=mi.exports,h=bi.exports,w=xa,b=wi.exports,$=_i.exports,A=vs.exports,x=Hf,U=Cr;function B(Z){return Z&&typeof Z=="object"&&"default"in Z?Z:{default:Z}}function ve(Z){if(Z&&Z.__esModule)return Z;var ae=Object.create(null);return Z&&Object.keys(Z).forEach(function(q){if(q!=="default"){var K=Object.getOwnPropertyDescriptor(Z,q);Object.defineProperty(ae,q,K.get?K:{enumerable:!0,get:function(){return Z[q]}})}}),ae.default=Z,Object.freeze(ae)}var se=B(t),Re=B(r),ke=B(n),de=B(a),P=B(i),te=B(s),le=B(o),J=B(u),xe=B(c),re=B(h),H=B(b),ue=B($),W=ve(A),me=ve(x);function _e(Z,ae,q,K){var ne=arguments.length,ge=ne<3?ae:K===null?K=Object.getOwnPropertyDescriptor(ae,q):K,ce;if((typeof Reflect>"u"?"undefined":J.default(Reflect))==="object"&&typeof Reflect.decorate=="function")ge=Reflect.decorate(Z,ae,q,K);else for(var je=Z.length-1;je>=0;je--)(ce=Z[je])&&(ge=(ne<3?ce(ge):ne>3?ce(ae,q,ge):ce(ae,q))||ge);return ne>3&&ge&&Object.defineProperty(ae,q,ge),ge}function N(Z,ae){if((typeof Reflect>"u"?"undefined":J.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(Z,ae)}var ft;function dt(){}dt.prototype=Object.create(null);function Ee(){Ee.init.call(this)}Ee.EventEmitter=Ee,Ee.usingDomains=!1,Ee.prototype.domain=void 0,Ee.prototype._events=void 0,Ee.prototype._maxListeners=void 0,Ee.defaultMaxListeners=10,Ee.init=function(){this.domain=null,Ee.usingDomains&&ft.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new dt,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ee.prototype.setMaxListeners=function(ae){if(typeof ae!="number"||ae<0||isNaN(ae))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=ae,this};function Xe(Z){return Z._maxListeners===void 0?Ee.defaultMaxListeners:Z._maxListeners}Ee.prototype.getMaxListeners=function(){return Xe(this)};function Ye(Z,ae,q){if(ae)Z.call(q);else for(var K=Z.length,ne=C(Z,K),ge=0;ge<K;++ge)ne[ge].call(q)}function D(Z,ae,q,K){if(ae)Z.call(q,K);else for(var ne=Z.length,ge=C(Z,ne),ce=0;ce<ne;++ce)ge[ce].call(q,K)}function T(Z,ae,q,K,ne){if(ae)Z.call(q,K,ne);else for(var ge=Z.length,ce=C(Z,ge),je=0;je<ge;++je)ce[je].call(q,K,ne)}function Te(Z,ae,q,K,ne,ge){if(ae)Z.call(q,K,ne,ge);else for(var ce=Z.length,je=C(Z,ce),Ve=0;Ve<ce;++Ve)je[Ve].call(q,K,ne,ge)}function he(Z,ae,q,K){if(ae)Z.apply(q,K);else for(var ne=Z.length,ge=C(Z,ne),ce=0;ce<ne;++ce)ge[ce].apply(q,K)}Ee.prototype.emit=function(ae){var q,K,ne,ge,ce,je,Ve,at=ae==="error";if(je=this._events,je)at=at&&je.error==null;else if(!at)return!1;if(Ve=this.domain,at){if(q=arguments[1],Ve)q||(q=new Error('Uncaught, unspecified "error" event')),q.domainEmitter=this,q.domain=Ve,q.domainThrown=!1,Ve.emit("error",q);else{if(q instanceof Error)throw q;var tt=new Error('Uncaught, unspecified "error" event. ('+q+")");throw tt.context=q,tt}return!1}if(K=je[ae],!K)return!1;var We=typeof K=="function";switch(ne=arguments.length,ne){case 1:Ye(K,We,this);break;case 2:D(K,We,this,arguments[1]);break;case 3:T(K,We,this,arguments[1],arguments[2]);break;case 4:Te(K,We,this,arguments[1],arguments[2],arguments[3]);break;default:for(ge=new Array(ne-1),ce=1;ce<ne;ce++)ge[ce-1]=arguments[ce];he(K,We,this,ge)}return!0};function Ke(Z,ae,q,K){var ne,ge,ce;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if(ge=Z._events,ge?(ge.newListener&&(Z.emit("newListener",ae,q.listener?q.listener:q),ge=Z._events),ce=ge[ae]):(ge=Z._events=new dt,Z._eventsCount=0),!ce)ce=ge[ae]=q,++Z._eventsCount;else if(typeof ce=="function"?ce=ge[ae]=K?[q,ce]:[ce,q]:K?ce.unshift(q):ce.push(q),!ce.warned&&(ne=Xe(Z),ne&&ne>0&&ce.length>ne)){ce.warned=!0;var je=new Error("Possible EventEmitter memory leak detected. "+ce.length+" "+ae+" listeners added. Use emitter.setMaxListeners() to increase limit");je.name="MaxListenersExceededWarning",je.emitter=Z,je.type=ae,je.count=ce.length,Qe(je)}return Z}function Qe(Z){typeof console.warn=="function"?console.warn(Z):console.log(Z)}Ee.prototype.addListener=function(ae,q){return Ke(this,ae,q,!1)},Ee.prototype.on=Ee.prototype.addListener,Ee.prototype.prependListener=function(ae,q){return Ke(this,ae,q,!0)};function Se(Z,ae,q){var K=!1;function ne(){Z.removeListener(ae,ne),K||(K=!0,q.apply(Z,arguments))}return ne.listener=q,ne}Ee.prototype.once=function(ae,q){if(typeof q!="function")throw new TypeError('"listener" argument must be a function');return this.on(ae,Se(this,ae,q)),this},Ee.prototype.prependOnceListener=function(ae,q){if(typeof q!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(ae,Se(this,ae,q)),this},Ee.prototype.removeListener=function(ae,q){var K,ne,ge,ce,je;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if(ne=this._events,!ne)return this;if(K=ne[ae],!K)return this;if(K===q||K.listener&&K.listener===q)--this._eventsCount===0?this._events=new dt:(delete ne[ae],ne.removeListener&&this.emit("removeListener",ae,K.listener||q));else if(typeof K!="function"){for(ge=-1,ce=K.length;ce-- >0;)if(K[ce]===q||K[ce].listener&&K[ce].listener===q){je=K[ce].listener,ge=ce;break}if(ge<0)return this;if(K.length===1){if(K[0]=void 0,--this._eventsCount===0)return this._events=new dt,this;delete ne[ae]}else R(K,ge);ne.removeListener&&this.emit("removeListener",ae,je||q)}return this},Ee.prototype.off=function(Z,ae){return this.removeListener(Z,ae)},Ee.prototype.removeAllListeners=function(ae){var q,K;if(K=this._events,!K)return this;if(!K.removeListener)return arguments.length===0?(this._events=new dt,this._eventsCount=0):K[ae]&&(--this._eventsCount===0?this._events=new dt:delete K[ae]),this;if(arguments.length===0){for(var ne=Object.keys(K),ge=0,ce;ge<ne.length;++ge)ce=ne[ge],ce!=="removeListener"&&this.removeAllListeners(ce);return this.removeAllListeners("removeListener"),this._events=new dt,this._eventsCount=0,this}if(q=K[ae],typeof q=="function")this.removeListener(ae,q);else if(q)do this.removeListener(ae,q[q.length-1]);while(q[0]);return this},Ee.prototype.listeners=function(ae){var q,K,ne=this._events;return ne?(q=ne[ae],q?typeof q=="function"?K=[q.listener||q]:K=Y(q):K=[]):K=[],K},Ee.listenerCount=function(Z,ae){return typeof Z.listenerCount=="function"?Z.listenerCount(ae):Ge.call(Z,ae)},Ee.prototype.listenerCount=Ge;function Ge(Z){var ae=this._events;if(ae){var q=ae[Z];if(typeof q=="function")return 1;if(q)return q.length}return 0}Ee.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function R(Z,ae){for(var q=ae,K=q+1,ne=Z.length;K<ne;q+=1,K+=1)Z[q]=Z[K];Z.pop()}function C(Z,ae){for(var q=new Array(ae);ae--;)q[ae]=Z[ae];return q}function Y(Z){for(var ae=new Array(Z.length),q=0;q<ae.length;++q)ae[q]=Z[q].listener||Z[q];return ae}var pe=W.getLogger("twilio-notificatiions");function z(Z,ae){return["".concat(new Date().toISOString()," Twilio.Notifications ").concat(Z,":")].concat(Array.from(ae))}var Oe=function(){function Z(){Re.default(this,Z)}return ke.default(Z,[{key:"setLevel",value:function(q){pe.setLevel(q)}},{key:"trace",value:function(){for(var q=arguments.length,K=new Array(q),ne=0;ne<q;ne++)K[ne]=arguments[ne];pe.trace.apply(null,z("T",K))}},{key:"debug",value:function(){for(var q=arguments.length,K=new Array(q),ne=0;ne<q;ne++)K[ne]=arguments[ne];pe.debug.apply(null,z("D",K))}},{key:"info",value:function(){for(var q=arguments.length,K=new Array(q),ne=0;ne<q;ne++)K[ne]=arguments[ne];pe.info.apply(null,z("I",K))}},{key:"warn",value:function(){for(var q=arguments.length,K=new Array(q),ne=0;ne<q;ne++)K[ne]=arguments[ne];pe.warn.apply(null,z("W",K))}},{key:"error",value:function(){for(var q=arguments.length,K=new Array(q),ne=0;ne<q;ne++)K[ne]=arguments[ne];pe.error.apply(null,z("E",K))}}]),Z}(),be=new Oe;function we(Z){var ae=Ae();return function(){var K=te.default(Z),ne;if(ae){var ge=te.default(this).constructor;ne=Reflect.construct(K,arguments,ge)}else ne=K.apply(this,arguments);return P.default(this,ne)}}function Ae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ee=ke.default(function Z(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Set;Re.default(this,Z),this.token=ae,this.notificationId=q,this.messageTypes=K});function Fe(Z,ae){return[].concat(ue.default(ue.default(Z).filter(function(q){return!ae.has(q)})),ue.default(ue.default(ae).filter(function(q){return!Z.has(q)})))}function Ue(Z,ae){var q=new Set;return Z.notificationId!==ae.notificationId&&q.add("notificationId"),Z.token!==ae.token&&q.add("token"),Fe(Z.messageTypes,ae.messageTypes).length>0&&q.add("messageType"),[q.size>0,q]}var Pe=function(Z){de.default(q,Z);var ae=we(q);function q(K){var ne;return Re.default(this,q),ne=ae.call(this),re.default(xe.default(ne),"desiredState",new ee),re.default(xe.default(ne),"currentState",new ee),re.default(xe.default(ne),"_hasActiveAttempt",!1),ne.channelType=K,ne}return ke.default(q,[{key:"setNotificationId",value:function(ne){this.desiredState.notificationId=ne}},{key:"isActive",value:function(){return this.desiredState.notificationId!==""}},{key:"subscribe",value:function(ne){if(this.desiredState.messageTypes.has(ne)){be.debug("message type '".concat(ne,"' for channel ").concat(this.channelType," is already registered"));return}this.desiredState.messageTypes.add(ne)}},{key:"unsubscribe",value:function(ne){!this.desiredState.messageTypes.has(ne)||this.desiredState.messageTypes.delete(ne)}},{key:"updateToken",value:function(ne){this.desiredState.token=ne}},{key:"commitChanges",value:function(){var K=se.default(le.default.mark(function ge(){var ce,je,Ve,at,tt,We;return le.default.wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:if(!this._hasActiveAttempt){rt.next=3;break}throw be.error("One registration attempt is already in progress"),new Error("One registration attempt is already in progress");case 3:if(ce=Ue(this.desiredState,this.currentState),je=H.default(ce,2),Ve=je[0],at=je[1],Ve){rt.next=6;break}return rt.abrupt("return");case 6:if(this.currentState.notificationId||at.delete("notificationId"),be.trace("Persisting ".concat(this.channelType," registration"),at,this.desiredState),rt.prev=8,this._hasActiveAttempt=!0,tt=new ee,tt.token=this.desiredState.token,tt.notificationId=this.desiredState.notificationId,tt.messageTypes=new Set(this.desiredState.messageTypes),!(tt.messageTypes.size>0)){rt.next=24;break}return rt.next=17,this.updateRegistration(tt,at);case 17:We=rt.sent,this.currentState.token=We.token,this.currentState.notificationId=We.notificationId,this.currentState.messageTypes=new Set(We.messageTypes),this.emit("stateChanged",this.channelType,"registered",this.currentState),rt.next=30;break;case 24:return rt.next=26,this.removeRegistration();case 26:this.currentState.token=tt.token,this.currentState.notificationId=tt.notificationId,this.currentState.messageTypes.clear(),this.emit("stateChanged",this.channelType,"unregistered",this.currentState);case 30:rt.next=35;break;case 32:throw rt.prev=32,rt.t0=rt.catch(8),rt.t0;case 35:return rt.prev=35,this._hasActiveAttempt=!1,rt.finish(35);case 38:case"end":return rt.stop()}},ge,this,[[8,32,35,38]])}));function ne(){return K.apply(this,arguments)}return ne}()}]),q}(Ee);function oe(Z){var ae=F();return function(){var K=te.default(Z),ne;if(ae){var ge=te.default(this).constructor;ne=Reflect.construct(K,arguments,ge)}else ne=K.apply(this,arguments);return P.default(this,ne)}}function F(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var G={min:2e3,max:12e4,randomness:.2},Q=function(Z){de.default(q,Z);var ae=oe(q);function q(K,ne,ge,ce){var je;return Re.default(this,q),je=ae.call(this,K),re.default(xe.default(je),"registrationId",null),je.context=ne,je.twilsock=ge,je.registrarUrl=ce,je}return ke.default(q,[{key:"updateRegistration",value:function(){var K=se.default(le.default.mark(function ge(ce,je){var Ve=this,at,tt,We,vr,rt;return le.default.wrap(function(Ut){for(;;)switch(Ut.prev=Ut.next){case 0:if(!je.has("notificationId")){Ut.next=3;break}return Ut.next=3,this.removeRegistration();case 3:if(!(!ce.notificationId||!ce.notificationId.length)){Ut.next=6;break}throw be.error("No push notification ID for registration"),new Error("No push notification ID for registration");case 6:return be.trace("Registering",this.channelType,ce),at={endpoint_platform:this.context.platform,channel_type:this.channelType,version:this.context.protocolVersion.toString(),message_types:Array.from(ce.messageTypes),data:{registration_id:ce.notificationId}},tt=this.context.productId,We="".concat(this.registrarUrl,"?productId=").concat(tt),vr={"Content-Type":"application/json"},be.trace("Creating registration for channel ".concat(this.channelType)),Ut.prev=12,Ut.next=15,new w.AsyncRetrier(G).run(function(){return Ve.twilsock.post(We,vr,at,tt)});case 15:rt=Ut.sent,this.registrationId=rt.body.id,be.debug("Registration created: ",rt),Ut.next=24;break;case 20:throw Ut.prev=20,Ut.t0=Ut.catch(12),be.error("Registration failed: ",Ut.t0),Ut.t0;case 24:return Ut.abrupt("return",ce);case 25:case"end":return Ut.stop()}},ge,this,[[12,20]])}));function ne(ge,ce){return K.apply(this,arguments)}return ne}()},{key:"removeRegistration",value:function(){var K=se.default(le.default.mark(function ge(){var ce=this,je,Ve,at;return le.default.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:if(this.registrationId){We.next=2;break}return We.abrupt("return");case 2:return je=this.context.productId,Ve="".concat(this.registrarUrl,"/").concat(this.registrationId,"?productId=").concat(je),at={"Content-Type":"application/json"},be.trace("Removing registration for ".concat(this.channelType)),We.prev=6,We.next=9,new w.AsyncRetrier(Object.assign(G,{maxAttemptsCount:3})).run(function(){return ce.twilsock.delete(Ve,at,{},je)});case 9:this.registrationId=null,this.currentState.notificationId="",be.debug("Registration removed for ".concat(this.channelType)),We.next=18;break;case 14:throw We.prev=14,We.t0=We.catch(6),be.error("Failed to remove registration ",this.channelType,We.t0),We.t0;case 18:case"end":return We.stop()}},ge,this,[[6,14]])}));function ne(){return K.apply(this,arguments)}return ne}()},{key:"sendDeviceRemoveRequest",value:function(){var K=se.default(le.default.mark(function ge(ce){var je=this,Ve,at,tt,We;return le.default.wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:if(ce!==""){rt.next=2;break}throw new Error("Empty registration ID");case 2:return Ve=this.context.productId,at="".concat(this.registrarUrl,"?productId=").concat(Ve),tt={"Content-Type":"application/json"},We={binding_type:this.channelType,address:ce},rt.prev=6,be.trace("Removing old registrations for ".concat(this.channelType)),rt.next=10,new w.AsyncRetrier(Object.assign(G,{maxAttemptsCount:3})).run(function(){return je.twilsock.delete(at,tt,We,Ve)});case 10:this.registrationId=null,this.currentState.notificationId="",be.debug("Registration removed for ".concat(this.channelType)),rt.next=19;break;case 15:throw rt.prev=15,rt.t0=rt.catch(6),be.error("Failed to remove registration ",this.channelType,rt.t0),rt.t0;case 19:case"end":return rt.stop()}},ge,this,[[6,15]])}));function ne(ge){return K.apply(this,arguments)}return ne}()}]),q}(Pe);function ye(Z){var ae=Ne();return function(){var K=te.default(Z),ne;if(ae){var ge=te.default(this).constructor;ne=Reflect.construct(K,arguments,ge)}else ne=K.apply(this,arguments);return P.default(this,ne)}}function Ne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qe=function(Z){de.default(q,Z);var ae=ye(q);function q(K,ne,ge){var ce;return Re.default(this,q),ce=ae.call(this,"twilsock"),re.default(xe.default(ce),"contextId",me.v4()),ce.productId=K,ce.platform=ne,ce.twilsock=ge,ce}return ke.default(q,[{key:"updateRegistration",value:function(){var K=se.default(le.default.mark(function ge(ce,je){var Ve,at;return le.default.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:if(je.has("messageType")){We.next=2;break}return We.abrupt("return",ce);case 2:return Ve=Array.from(ce.messageTypes),at={product_id:this.productId,notification_protocol_version:4,endpoint_platform:this.platform,message_types:Ve},We.prev=4,We.next=7,this.twilsock.setNotificationsContext(this.contextId,at);case 7:We.next=13;break;case 9:throw We.prev=9,We.t0=We.catch(4),be.error("Failed to update twilsock notification context: ".concat(We.t0)),We.t0;case 13:return We.abrupt("return",ce);case 14:case"end":return We.stop()}},ge,this,[[4,9]])}));function ne(ge,ce){return K.apply(this,arguments)}return ne}()},{key:"removeRegistration",value:function(){var K=se.default(le.default.mark(function ge(){return le.default.wrap(function(je){for(;;)switch(je.prev=je.next){case 0:return je.prev=0,je.next=3,this.twilsock.removeNotificationsContext(this.contextId);case 3:je.next=9;break;case 5:throw je.prev=5,je.t0=je.catch(0),be.error("Failed to remove twilsock notification context: ".concat(je.t0)),je.t0;case 9:case"end":return je.stop()}},ge,this,[[0,5]])}));function ne(){return K.apply(this,arguments)}return ne}()},{key:"sendDeviceRemoveRequest",value:function(){var K=se.default(le.default.mark(function ge(ce){return le.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:case"end":return Ve.stop()}},ge)}));function ne(ge){return K.apply(this,arguments)}return ne}()}]),q}(Pe);function ze(Z){var ae=De();return function(){var K=te.default(Z),ne;if(ae){var ge=te.default(this).constructor;ne=Reflect.construct(K,arguments,ge)}else ne=K.apply(this,arguments);return P.default(this,ne)}}function De(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var He,Le=U.literal("apn","fcm","twilsock");e.Notifications=He=function(Z){de.default(q,Z);var ae=ze(q);function q(K){var ne,ge,ce,je,Ve,at,tt,We=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Re.default(this,q),tt=ae.call(this),We.logLevel=(ne=We.logLevel)!==null&&ne!==void 0?ne:"error",be.setLevel(We.logLevel);var vr=(ge=We.productId)!==null&&ge!==void 0?ge:"notifications",rt=!We.twilsockClient,Rr=We.twilsockClient=(ce=We.twilsockClient)!==null&&ce!==void 0?ce:new l.TwilsockClient(K,vr,We),Ut=(je=We.notifications)!==null&&je!==void 0?je:{},mn=(Ve=(at=Ut.region)!==null&&at!==void 0?at:We.region)!==null&&Ve!==void 0?Ve:"us1",rr="https://ers.".concat(mn,".twilio.com/v1/registrations"),Dn=Ut.ersUrl||rr;tt.connectors=new Map;var Ct=He._detectPlatform();return tt.connectors.set("apn",new Q("apn",{protocolVersion:4,productId:vr,platform:Ct},Rr,Dn)),tt.connectors.set("fcm",new Q("fcm",{protocolVersion:3,productId:vr,platform:Ct},Rr,Dn)),tt.connectors.set("twilsock",new qe(vr,Ct,Rr)),Rr.on("stateChanged",function(hr){return tt.emit("transportState",hr)}),tt._connector("twilsock").on("stateChanged",function(hr,qr,Hr){return tt.emit("stateChanged",hr,qr,Hr)}),tt._connector("apn").on("stateChanged",function(hr,qr,Hr){return tt.emit("stateChanged",hr,qr,Hr)}),tt._connector("fcm").on("stateChanged",function(hr,qr,Hr){return tt.emit("stateChanged",hr,qr,Hr)}),Rr.on("message",function(hr,qr){return tt._routeMessage(hr,qr)}),tt.updateToken(K),rt&&(Rr.connect(),tt.twilsock=Rr),tt}return ke.default(q,[{key:"shutdown",value:function(){var K=se.default(le.default.mark(function ge(){return le.default.wrap(function(je){for(;;)switch(je.prev=je.next){case 0:if(this.connectors.clear(),!this.twilsock){je.next=4;break}return je.next=4,this.twilsock.disconnect();case 4:case"end":return je.stop()}},ge,this)}));function ne(){return K.apply(this,arguments)}return ne}()},{key:"setPushRegistrationId",value:function(ne,ge){be.debug("Set ".concat(ne," push registration id '").concat(ge,"'")),this._connector(ne).setNotificationId(ge)}},{key:"subscribe",value:function(ne,ge){be.debug("Add ".concat(ne," subscriptions for message type ").concat(ge)),this._connector(ne).subscribe(ge)}},{key:"unsubscribe",value:function(ne,ge){be.debug("Remove ".concat(ne," subscriptions for message type ").concat(ge)),this._connector(ne).unsubscribe(ge)}},{key:"updateToken",value:function(ne){this.connectors.forEach(function(ge){return ge.updateToken(ne)})}},{key:"commitChanges",value:function(){var K=se.default(le.default.mark(function ge(){var ce;return le.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return ce=[],this.connectors.forEach(function(at){at.isActive()&&ce.push(at.commitChanges())}),Ve.next=4,Promise.all(ce);case 4:case"end":return Ve.stop()}},ge,this)}));function ne(){return K.apply(this,arguments)}return ne}()},{key:"removeRegistrations",value:function(){var K=se.default(le.default.mark(function ge(ce,je){return le.default.wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return at.next=2,this._connector(ce).sendDeviceRemoveRequest(je);case 2:case"end":return at.stop()}},ge,this)}));function ne(ge,ce){return K.apply(this,arguments)}return ne}()},{key:"handlePushNotification",value:function(ne){return{messageType:ne.twi_message_type,payload:ne.payload}}},{key:"_routeMessage",value:function(ne,ge){be.debug("Notification message arrived: ",ne,ge),this.emit("message",ne,ge)}},{key:"_connector",value:function(ne){var ge=this.connectors.get(ne);if(!ge)throw new Error("Unknown channel type: ".concat(ne));return ge}}],[{key:"_detectPlatform",value:function(){var ne="";return typeof navigator<"u"?(ne="unknown",typeof navigator.product<"u"&&(ne=navigator.product),typeof navigator.userAgent<"u"&&(ne=navigator.userAgent)):ne="web",ne.substring(0,128)}}]),q}(Ee),_e([U.validateTypes(Le,U.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String,String]),N("design:returntype",void 0)],e.Notifications.prototype,"setPushRegistrationId",null),_e([U.validateTypes(Le,U.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String,String]),N("design:returntype",void 0)],e.Notifications.prototype,"subscribe",null),_e([U.validateTypes(Le,U.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String,String]),N("design:returntype",void 0)],e.Notifications.prototype,"unsubscribe",null),_e([U.validateTypes(U.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String]),N("design:returntype",void 0)],e.Notifications.prototype,"updateToken",null),_e([U.validateTypesAsync(Le,U.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String,String]),N("design:returntype",Promise)],e.Notifications.prototype,"removeRegistrations",null),e.Notifications=He=_e([U.validateConstructorTypes(U.nonEmptyString,[U.pureObject,"undefined",U.literal(null)]),N("design:paramtypes",[String,Object])],e.Notifications)})(XE);var Br={};/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes Backoff library under the following license

    Copyright (C) 2012 Mathieu Turcotte

    Permission is hereby granted, free of charge, to any person obtaining a copy of
    this software and associated documentation files (the "Software"), to deal in
    the Software without restriction, including without limitation the rights to
    use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
    of the Software, and to permit persons to whom the Software is furnished to do
    so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.

This software includes Event-to-Promise library under the following license

    Copyright (c) 2014, Julien Fontanet <julien.fontanet@isonoe.net>.

    Permission to use, copy, modify, and/or distribute this software for any purpose
    with or without fee is hereby granted, provided that the above copyright notice
    and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
    FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
    OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
    TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
    THIS SOFTWARE.

*/Object.defineProperty(Br,"__esModule",{value:!0});var oJ=To.exports,uJ=Fn.exports,lJ=ra.exports,cJ=mi.exports,fJ=Ln.exports,dJ=jn.exports,pJ=Xr.exports,vJ=bi.exports,hJ=fl,yJ=Un.exports,$e=Er,Wc=Bf,gJ=mg.exports,mJ=vs.exports,bJ=wi.exports,rC=xa,nC=Hf,wJ=Df.exports,_J=Hc.exports;function Zr(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function wg(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if(r!=="default"){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,Object.freeze(t)}var Me=Zr(oJ),gt=Zr(uJ),$t=Zr(lJ),Jn=Zr(cJ),xr=Zr(fJ),ki=Zr(dJ),Xt=Zr(pJ),Tt=Zr(vJ),V=Zr(hJ),aC=Zr(yJ),SJ=Zr(gJ),$J=wg(mJ),iC=Zr(bJ),TJ=wg(nC),vl=Zr(wJ),Zl=wg(_J);function wt(e,t,r,n){var a=arguments.length,i=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if((typeof Reflect>"u"?"undefined":aC.default(Reflect))==="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(i=(a<3?s(i):a>3?s(t,r,i):s(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function Ie(e,t){if((typeof Reflect>"u"?"undefined":aC.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}var kJ;function si(){}si.prototype=Object.create(null);function Et(){Et.init.call(this)}Et.EventEmitter=Et;Et.usingDomains=!1;Et.prototype.domain=void 0;Et.prototype._events=void 0;Et.prototype._maxListeners=void 0;Et.defaultMaxListeners=10;Et.init=function(){this.domain=null,Et.usingDomains&&kJ.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new si,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Et.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function sC(e){return e._maxListeners===void 0?Et.defaultMaxListeners:e._maxListeners}Et.prototype.getMaxListeners=function(){return sC(this)};function EJ(e,t,r){if(t)e.call(r);else for(var n=e.length,a=hl(e,n),i=0;i<n;++i)a[i].call(r)}function CJ(e,t,r,n){if(t)e.call(r,n);else for(var a=e.length,i=hl(e,a),s=0;s<a;++s)i[s].call(r,n)}function IJ(e,t,r,n,a){if(t)e.call(r,n,a);else for(var i=e.length,s=hl(e,i),o=0;o<i;++o)s[o].call(r,n,a)}function RJ(e,t,r,n,a,i){if(t)e.call(r,n,a,i);else for(var s=e.length,o=hl(e,s),u=0;u<s;++u)o[u].call(r,n,a,i)}function AJ(e,t,r,n){if(t)e.apply(r,n);else for(var a=e.length,i=hl(e,a),s=0;s<a;++s)i[s].apply(r,n)}Et.prototype.emit=function(t){var r,n,a,i,s,o,u,l=t==="error";if(o=this._events,o)l=l&&o.error==null;else if(!l)return!1;if(u=this.domain,l){if(r=arguments[1],u)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=u,r.domainThrown=!1,u.emit("error",r);else{if(r instanceof Error)throw r;var c=new Error('Uncaught, unspecified "error" event. ('+r+")");throw c.context=r,c}return!1}if(n=o[t],!n)return!1;var h=typeof n=="function";switch(a=arguments.length,a){case 1:EJ(n,h,this);break;case 2:CJ(n,h,this,arguments[1]);break;case 3:IJ(n,h,this,arguments[1],arguments[2]);break;case 4:RJ(n,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(a-1),s=1;s<a;s++)i[s-1]=arguments[s];AJ(n,h,this,i)}return!0};function oC(e,t,r,n){var a,i,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=e._events,i?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]):(i=e._events=new si,e._eventsCount=0),!s)s=i[t]=r,++e._eventsCount;else if(typeof s=="function"?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(a=sC(e),a&&a>0&&s.length>a)){s.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,OJ(o)}return e}function OJ(e){typeof console.warn=="function"?console.warn(e):console.log(e)}Et.prototype.addListener=function(t,r){return oC(this,t,r,!1)};Et.prototype.on=Et.prototype.addListener;Et.prototype.prependListener=function(t,r){return oC(this,t,r,!0)};function uC(e,t,r){var n=!1;function a(){e.removeListener(t,a),n||(n=!0,r.apply(e,arguments))}return a.listener=r,a}Et.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,uC(this,t,r)),this};Et.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,uC(this,t,r)),this};Et.prototype.removeListener=function(t,r){var n,a,i,s,o;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=this._events,!a)return this;if(n=a[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new si:(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){o=n[s].listener,i=s;break}if(i<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new si,this;delete a[t]}else PJ(n,i);a.removeListener&&this.emit("removeListener",t,o||r)}return this};Et.prototype.off=function(e,t){return this.removeListener(e,t)};Et.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new si,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new si:delete n[t]),this;if(arguments.length===0){for(var a=Object.keys(n),i=0,s;i<a.length;++i)s=a[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new si,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};Et.prototype.listeners=function(t){var r,n,a=this._events;return a?(r=a[t],r?typeof r=="function"?n=[r.listener||r]:n=MJ(r):n=[]):n=[],n};Et.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):lC.call(e,t)};Et.prototype.listenerCount=lC;function lC(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}Et.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function PJ(e,t){for(var r=t,n=r+1,a=e.length;n<a;r+=1,n+=1)e[r]=e[n];e.pop()}function hl(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function MJ(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}var ho=function(){function e(t){gt.default(this,e),this.base=t,this.args=new Array,this.paths=new Array}return $t.default(e,[{key:"pathSegment",value:function(r){return this.paths.push(encodeURIComponent(r)),this}},{key:"queryParam",value:function(r,n){return typeof n<"u"&&this.args.push(encodeURIComponent(r)+"="+encodeURIComponent(n)),this}},{key:"build",value:function(){var r=this.base;return this.paths.length&&(r+="/"+this.paths.join("/")),this.args.length&&(r+="?"+this.args.join("&")),r}}]),e}();function cC(e){var t=xJ();return function(){var n=Xt.default(e),a;if(t){var i=Xt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return ki.default(this,a)}}function xJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Dr=function(e){xr.default(r,e);var t=cC(r);function r(n){var a,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return gt.default(this,r),a=t.call(this),a.name=a.constructor.name,a.message="".concat(n," (status: ").concat(i,", code: ").concat(s,")"),a.status=i,a.code=s,a}return r}(SJ.default(Error)),NJ=function(e){xr.default(r,e);var t=cC(r);function r(n){var a,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0;return gt.default(this,r),a=t.call(this,n,i,s),a.body=o,a}return r}(Dr);function On(e){return JSON.parse(JSON.stringify(e))}function fC(e){var t=e===void 0||_g(e);if(!t)throw new Dr("Invalid pageSize parameter. Expected a positive integer, was '".concat(e,"'."),400,20007)}function LJ(e){return!isNaN(parseInt(e))&&isFinite(e)}function _g(e){return LJ(e)&&e>0}var Ns=$J.getLogger("twilio-sync");function nu(e,t){return["".concat(new Date().toISOString()," Sync ").concat(e,":")].concat(Array.from(t))}var _t={setLevel:function(t){Ns.setLevel(t)},trace:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Ns.trace.apply(null,nu("T",r))},debug:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Ns.debug.apply(null,nu("D",r))},info:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Ns.info.apply(null,nu("I",r))},warn:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Ns.warn.apply(null,nu("W",r))},error:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Ns.error.apply(null,nu("E",r))}},jJ="/v4/Subscriptions",UJ="/v3/Maps",FJ="/v3/Lists",DJ="/v3/Documents",BJ="/v3/Streams",qJ="/v3/Insights";function HJ(e,t,r){return e&&typeof e[t]<"u"?e[t]:r}var WJ=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};gt.default(this,e);var r=t.region||"us1",n="https://cds.".concat(r,".twilio.com"),a=t.cdsUri||n;this.settings={subscriptionsUri:a+jJ,documentsUri:a+DJ,listsUri:a+FJ,mapsUri:a+UJ,streamsUri:a+BJ,insightsUri:a+qJ,sessionStorageEnabled:HJ(t.Sync,"enableSessionStorage",!0),productId:t.productId}}return $t.default(e,[{key:"subscriptionsUri",get:function(){return this.settings.subscriptionsUri}},{key:"documentsUri",get:function(){return this.settings.documentsUri}},{key:"listsUri",get:function(){return this.settings.listsUri}},{key:"mapsUri",get:function(){return this.settings.mapsUri}},{key:"streamsUri",get:function(){return this.settings.streamsUri}},{key:"insightsUri",get:function(){return this.settings.insightsUri}},{key:"backoffConfig",get:function(){return this.settings.backoffConfig||{}}},{key:"sessionStorageEnabled",get:function(){return this.settings.sessionStorageEnabled}},{key:"productId",get:function(){return this.settings.productId}}]),e}();function au(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=GJ(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function GJ(e,t){if(!!e){if(typeof e=="string")return IS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IS(e,t)}}function IS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var zJ=function(){function e(t){gt.default(this,e),this.localObject=t,this.pendingCorrelationId=null,this.pendingAction=null,this.established=!1,this.retryCount=0}return $t.default(e,[{key:"sid",get:function(){return this.localObject.sid}},{key:"type",get:function(){return this.localObject.type}},{key:"lastEventId",get:function(){return this.localObject.lastEventId}},{key:"indexName",get:function(){return this.localObject.indexName}},{key:"queryString",get:function(){return this.localObject.queryString}},{key:"isEstablished",get:function(){return this.established}},{key:"update",value:function(r,n){this.localObject._update(r,n)}},{key:"updatePending",value:function(r,n){this.pendingAction=r,this.pendingCorrelationId=n}},{key:"reset",value:function(){this.updatePending(null,null),this.retryCount=0,this.established=!1,this.setSubscriptionState("none")}},{key:"markAsFailed",value:function(r){this.rejectedWithError=r.error,this.updatePending(null,null),this.localObject.reportFailure(new Dr("Failed to subscribe on service events: ".concat(r.error.message),r.error.status,r.error.code))}},{key:"complete",value:function(r){this.updatePending(null,null),this.established=!0,this.localObject._advanceLastEventId(r)}},{key:"setSubscriptionState",value:function(r){this.localObject._setSubscriptionState(r)}}]),e}(),VJ=function(){function e(t){var r=this;gt.default(this,e),Tt.default(this,"isConnected",!1),Tt.default(this,"maxBatchSize",100),Tt.default(this,"subscriptionTtlTimer",null),Tt.default(this,"pendingPokeReason",null),this.services=t,this.subscriptions=new Map,this.persisted=new Map,this.latestPokeResponseArrivalTimestampByCorrelationId=new Map;var n={randomisationFactor:.2,initialDelay:100,maxDelay:2*60*1e3};this.backoff=rC.Backoff.exponential(Object.assign(n,this.services.config.backoffConfig)),this.backoff.on("ready",function(){var a=r.getSubscriptionUpdateBatch(),i=a.action,s=a.subscriptions;i?r.applyNewSubscriptionUpdateBatch(i,s):(r.backoff.reset(),_t.debug("All subscriptions resolved."))})}return $t.default(e,[{key:"getSubscriptionUpdateBatch",value:function(){function r(i,s,o,u){var l=[],c=au(i),h;try{for(c.s();!(h=c.n()).done;){var w=iC.default(h.value,2),b=w[0],$=w[1],A=s.get(b);if(!A&&o!==$.pendingAction&&!$.rejectedWithError&&(l.push($),u&&l.length>=u))break}}catch(x){c.e(x)}finally{c.f()}return l}var n=r(this.subscriptions,this.persisted,"establish",this.maxBatchSize);if(n.length>0)return{action:"establish",subscriptions:n};var a=r(this.persisted,this.subscriptions,"cancel",this.maxBatchSize);return a.length>0?{action:"cancel",subscriptions:a}:{action:null,subscriptions:null}}},{key:"persist",value:function(){this.backoff.backoff()}},{key:"applyNewSubscriptionUpdateBatch",value:function(){var t=Me.default(V.default.mark(function n(a,i){var s=this,o,u,l,c,h,w,b,$,A,x,U,B,ve,se,Re,ke;return V.default.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(this.isConnected){P.next=4;break}return _t.debug("Twilsock connection (required for subscription) not ready; waiting\u2026"),this.backoff.reset(),P.abrupt("return");case 4:i=this.processLocalActions(a,i),o=new Date().getTime(),u=au(i);try{for(u.s();!(l=u.n()).done;)c=l.value,this.recordActionAttemptOn(c,a,o)}catch(te){u.e(te)}finally{u.f()}return h=this.pendingPokeReason,this.pendingPokeReason=null,P.prev=10,P.next=13,this.request(a,o,h,i);case 13:w=P.sent,b=w.body.max_batch_size,!isNaN(parseInt(b))&&isFinite(b)&&b>0&&(this.maxBatchSize=b),this.subscriptionTtlTimer||($=w.body.ttl_in_s,A=!isNaN(parseFloat($))&&isFinite($),x=A&&$>0,x&&(this.subscriptionTtlTimer=setTimeout(function(){return s.onSubscriptionTtlElapsed()},$*1e3))),a==="establish"&&(U=w.body.estimated_delivery_in_ms,B=!isNaN(parseFloat(U))&&isFinite(U),ve=B&&U>0,ve?setTimeout(function(){return s.verifyPokeDelivery(o,U,i)},U):_t.error("Invalid timeout: ".concat(U)),i.filter(function(te){return te.pendingCorrelationId===o}).forEach(function(te){return te.setSubscriptionState("response_in_flight")})),this.backoff.reset(),P.next=26;break;case 21:P.prev=21,P.t0=P.catch(10),se=au(i);try{for(se.s();!(Re=se.n()).done;)ke=Re.value,this.recordActionFailureOn(ke,a)}catch(te){se.e(te)}finally{se.f()}P.t0 instanceof Wc.TransportUnavailableError?(_t.debug("Twilsock connection (required for subscription) not ready (c:".concat(o,"); waiting\u2026")),this.backoff.reset()):(_t.debug("Failed an attempt to ".concat(a," subscriptions (c:").concat(o,"); retrying"),P.t0),this.persist());case 26:case"end":return P.stop()}},n,this,[[10,21]])}));function r(n,a){return t.apply(this,arguments)}return r}()},{key:"verifyPokeDelivery",value:function(r,n,a){var i=this,s=this.latestPokeResponseArrivalTimestampByCorrelationId.get(r),o=s?new Date().getTime()-s:n;if(o>=n)a.filter(function(l){return l.pendingCorrelationId===r}).forEach(function(l){l.updatePending(null,null),l.retryCount++,i.persisted.delete(l.sid)}),this.persist(),this.latestPokeResponseArrivalTimestampByCorrelationId.delete(r);else{var u=n-o;setTimeout(function(){return i.verifyPokeDelivery(r,n,a)},u)}}},{key:"processLocalActions",value:function(r,n){return r==="cancel"?n.filter(function(a){return!a.rejectedWithError}):n}},{key:"recordActionAttemptOn",value:function(r,n,a){if(r.setSubscriptionState("request_in_flight"),n==="establish")this.persisted.set(r.sid,r),r.updatePending(n,a);else{var i=this.persisted.get(r.sid);i&&i.updatePending(n,a)}}},{key:"recordActionFailureOn",value:function(r,n){r.setSubscriptionState("none"),r.updatePending(null,null),n==="establish"&&this.persisted.delete(r.sid)}},{key:"request",value:function(r,n,a,i){var s=i.map(function(l){return{object_sid:l.sid,object_type:l.type,last_event_id:r==="establish"?l.lastEventId:void 0,index_name:r==="establish"?l.indexName:void 0,query_string:r==="establish"?l.queryString:void 0}}),o=i.filter(function(l){return l.retryCount>0}).length;_t.debug("Attempting '".concat(r,"' request (c:").concat(n,"):"),s);var u={event_protocol_version:4,action:r,correlation_id:n,retried_requests:o,ttl_in_s:-1,requests:s};return a==="ttl"&&(u.reason=a),this.services.network.post(this.services.config.subscriptionsUri,u)}},{key:"add",value:function(r,n){_t.debug("Establishing intent to subscribe to ".concat(r));var a=this.subscriptions.get(r);a&&n&&a.lastEventId===n.lastEventId||(this.persisted.delete(r),this.subscriptions.set(r,new zJ(n)),this.persist())}},{key:"remove",value:function(r){_t.debug("Establishing intent to unsubscribe from ".concat(r));var n=this.subscriptions.delete(r);n&&this.persist()}},{key:"acceptMessage",value:function(r,n){_t.trace("Subscriptions received",r);var a=r.event_type,i=typeof r.events<"u"?r.events:[r.event],s=r.correlation_id;s&&this.latestPokeResponseArrivalTimestampByCorrelationId.set(s,new Date().getTime());var o=au(i),u;try{for(o.s();!(u=o.n()).done;){var l=u.value,c=void 0;switch(r.event_type){case"subscription_established":this.applySubscriptionEstablishedMessage(l,s);break;case"subscription_canceled":this.applySubscriptionCancelledMessage(l,s);break;case"subscription_failed":this.applySubscriptionFailedMessage(l,s);break;case(c=a.match(/^(?:map|list|document|stream|live_query)_/)||{}).input:{var h=void 0;switch(c[0]){case"map_":h=l.map_sid;break;case"list_":h=l.list_sid;break;case"document_":h=l.document_sid;break;case"stream_":h=l.stream_sid;break;case"live_query_":h=l.query_id,n=!1,r.strictly_ordered===!0&&(n=!0);break;default:h=void 0}this.applyEventToSubscribedEntity(h,l,a,n);break}default:_t.debug("Dropping unknown message type ".concat(a));break}}}catch(w){o.e(w)}finally{o.f()}}},{key:"applySubscriptionEstablishedMessage",value:function(r,n){var a=r.object_sid,i=this.persisted.get(r.object_sid);i&&i.pendingCorrelationId===n?r.replay_status==="interrupted"?(_t.debug("Event Replay for subscription to ".concat(a," (c:").concat(n,") interrupted; continuing eagerly.")),i.updatePending(null,null),this.persisted.delete(i.sid),this.backoff.reset()):r.replay_status==="completed"&&(_t.debug("Event Replay for subscription to ".concat(a," (c:").concat(n,") completed. Subscription is ready.")),i.complete(r.last_event_id),this.persisted.set(r.object_sid,i),i.setSubscriptionState("established"),this.backoff.reset()):_t.debug("Late message for ".concat(r.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionCancelledMessage",value:function(r,n){var a=this.persisted.get(r.object_sid);a&&a.pendingCorrelationId===n?(a.updatePending(null,null),a.setSubscriptionState("none"),this.persisted.delete(r.object_sid)):_t.debug("Late message for ".concat(r.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionFailedMessage",value:function(r,n){var a=r.object_sid,i=this.subscriptions.get(a),s=this.persisted.get(a);i&&s?s.pendingCorrelationId===n&&(_t.error("Failed to subscribe on ".concat(s.sid),r.error),s.markAsFailed(r),s.setSubscriptionState("none")):!i&&s&&(this.persisted.delete(a),s.setSubscriptionState("none")),this.persist()}},{key:"applyEventToSubscribedEntity",value:function(r,n,a,i){var s=this;if(!!r){i=i||function(){var u=s.persisted.get(r);return u&&u.isEstablished}();var o=this.subscriptions.get(r);o?(n.type=a,o.update(n,i)):_t.debug("Message dropped for SID '".concat(r,"', for which there is no subscription."))}}},{key:"onConnectionStateChanged",value:function(r){this.isConnected=r,r&&this.poke("reconnect")}},{key:"onSubscriptionTtlElapsed",value:function(){this.isConnected&&this.poke("ttl")}},{key:"poke",value:function(r){_t.debug("Triggering event replay for all subscriptions, reason=".concat(r)),this.pendingPokeReason=r,this.subscriptionTtlTimer&&(clearTimeout(this.subscriptionTtlTimer),this.subscriptionTtlTimer=null);var n=[],a=au(this.persisted.values()),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;s.reset(),s.rejectedWithError&&n.push(s)}}catch(c){a.e(c)}finally{a.f()}this.persisted.clear();for(var o=0,u=n;o<u.length;o++){var l=u[o];this.persisted.set(l.sid,l)}this.persist()}},{key:"shutdown",value:function(){this.backoff.reset(),this.subscriptions.clear()}}]),e}(),KJ=4e3,JJ=6e4,YJ=9e4,QJ=.2;function RS(e){if(e.body&&e.body.message)return e.body.message;switch(e.status){case 429:return"Throttled by server";case 404:return"Not found from server";default:return"Error from server"}}function AS(e){return e.body?e.body.code:0}function iu(e){return e.status===409?new NJ(RS(e),e.status,AS(e),e.body):e.status?new Dr(RS(e),e.status,AS(e)):e instanceof Wc.TransportUnavailableError?e:new Dr(e.message,0,0)}var XJ=function(){function e(t,r,n){gt.default(this,e),this.clientInfo=t,this.config=r,this.transport=n}return $t.default(e,[{key:"createHeaders",value:function(){return{"Content-Type":"application/json","Twilio-Sync-Client-Info":JSON.stringify(this.clientInfo),"Twilio-Request-Id":"RQ"+TJ.v4().replace(/-/g,"")}}},{key:"backoffConfig",value:function(){return Object.assign({min:KJ,max:JJ,maxAttemptsTime:YJ,randomness:QJ},this.config.backoffConfig)}},{key:"executeWithRetry",value:function(r){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new Promise(function(i,s){var o=[502,503,504];a&&o.push(429);var u=new rC.Retrier(n.backoffConfig());u.on("attempt",function(){r().then(function(l){return u.succeeded(l)}).catch(function(l){if(o.includes(l.status)){var c=parseInt(l.headers?l.headers["Retry-After"]:null);u.failed(iu(l),isNaN(c)?null:c*1e3)}else l.message==="Twilsock disconnected"?u.failed(iu(l)):(u.removeAllListeners(),u.cancel(),s(iu(l)))})}),u.on("succeeded",function(l){i(l)}),u.on("cancelled",function(l){return s(iu(l))}),u.on("failed",function(l){return s(iu(l))}),u.start()})}},{key:"get",value:function(r){var n=this,a=this.createHeaders();return _t.debug("GET",r,"ID:",a["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.get(r,a,n.config.productId)},!0)}},{key:"post",value:function(r,n,a){var i=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.createHeaders();return typeof a<"u"&&a!==null&&(o["If-Match"]=a),_t.debug("POST",r,"ID:",o["Twilio-Request-Id"]),this.executeWithRetry(function(){return i.transport.post(r,o,n,i.config.productId)},s)}},{key:"put",value:function(r,n,a){var i=this,s=this.createHeaders();return typeof a<"u"&&a!==null&&(s["If-Match"]=a),_t.debug("PUT",r,"ID:",s["Twilio-Request-Id"]),this.executeWithRetry(function(){return i.transport.put(r,s,n,i.config.productId)},!1)}},{key:"delete",value:function(r){var n=this,a=this.createHeaders();return _t.debug("DELETE",r,"ID:",a["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.delete(r,a,n.config.productId)},!1)}}]),e}(),ZJ=function(){function e(t,r){gt.default(this,e),this.config=t,this.storageId=null;try{this.storage=r||sessionStorage}catch{}}return $t.default(e,[{key:"storageKey",value:function(r,n){return"".concat(this.storageId,"::").concat(r,"::").concat(n)}},{key:"isReady",get:function(){return this.config.sessionStorageEnabled&&!!this.storageId}},{key:"updateStorageId",value:function(r){this.storageId=r}},{key:"store",value:function(r,n,a){return this.isReady?this._store(this.storageKey(r,n),a):null}},{key:"read",value:function(r,n){return this.isReady?this._read(this.storageKey(r,n)):null}},{key:"remove",value:function(r,n,a){if(!this.isReady)return null;try{this.storage.removeItem(this.storageKey(r,n)),a&&this.storage.removeItem(this.storageKey(r,a))}catch{}}},{key:"update",value:function(r,n,a,i){if(!this.isReady)return null;this._apply(this.storageKey(r,n),i),a&&this._apply(this.storageKey(r,a),i)}},{key:"_store",value:function(r,n){try{this.storage.setItem(r,JSON.stringify(n))}catch{}}},{key:"_read",value:function(r){try{var n=this.storage.getItem(r);if(n)return JSON.parse(n)}catch{}return null}},{key:"_apply",value:function(r,n){var a=this._read(r);if(!a)return!1;this._store(r,Object.assign(a,n))}}]),e}();function eY(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=tY(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function tY(e,t){if(!!e){if(typeof e=="string")return OS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OS(e,t)}}function OS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var yl=function(){function e(t,r){gt.default(this,e),this.services=t,this.removalHandler=r,this.subscriptionState="none",this._attachedListeners=new Map}return $t.default(e,[{key:"_advanceLastEventId",value:function(r,n){}},{key:"reportFailure",value:function(r){r.status===404?this.onRemoved(!1):this.broadcastEventToListeners("failure",r)}},{key:"_subscribe",value:function(){this.services.router._subscribe(this.sid,this)}},{key:"_unsubscribe",value:function(){this.services.router._unsubscribe(this.sid)}},{key:"_setSubscriptionState",value:function(r){this.subscriptionState=r,this.broadcastEventToListeners("_subscriptionStateChanged",r)}},{key:"close",value:function(){this._unsubscribe(),this.removalHandler!=null&&this.removalHandler(this.type,this.sid,this.uniqueName)}},{key:"attach",value:function(r){var n=r.listenerUuid,a=this._attachedListeners.get(n);a||(this._attachedListeners.size||this._subscribe(),this._attachedListeners.set(n,r))}},{key:"detach",value:function(r){this._attachedListeners.delete(r),this._attachedListeners.size||this.close()}},{key:"broadcastEventToListeners",value:function(r,n){var a=eY(this._attachedListeners.values()),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;s.emit(r,n)}}catch(o){a.e(o)}finally{a.f()}}}]),e}(),dC=function(){function e(t){gt.default(this,e),Tt.default(this,"queuedRequests",[]),Tt.default(this,"isRequestInFlight",!1),this.inputMergingFunction=t}return $t.default(e,[{key:"add",value:function(r,n){var a=this,i=new Promise(function(s,o){return a.queuedRequests.push({input:r,requestFunction:n,resolve:s,reject:o})});return this.wakeupQueue(),i}},{key:"squashAndAdd",value:function(r,n){var a=this.queuedRequests;this.queuedRequests=[];var i;a.length>0?(i=a.map(function(o){return o.input}).reduce(this.inputMergingFunction),i=this.inputMergingFunction(i,r)):i=r;var s=this.add(i,n);return a.forEach(function(o){return s.then(o.resolve,o.reject)}),s}},{key:"isEmpty",value:function(){return this.queuedRequests.length===0&&!this.isRequestInFlight}},{key:"wakeupQueue",value:function(){var r=this;if(!(this.queuedRequests.length===0||this.isRequestInFlight)){var n=this.queuedRequests.shift();this.isRequestInFlight=!0,n.requestFunction(n.input).then(n.resolve,n.reject).then(function(a){r.isRequestInFlight=!1,r.wakeupQueue()})}}}]),e}(),pC=function(){function e(t){gt.default(this,e),Tt.default(this,"queueByNamespaceKey",new Map),this.inputReducer=t}return $t.default(e,[{key:"add",value:function(){var t=Me.default(V.default.mark(function n(a,i,s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.invokeQueueMethod(a,function(l){return l.add(i,s)}));case 1:case"end":return u.stop()}},n,this)}));function r(n,a,i){return t.apply(this,arguments)}return r}()},{key:"squashAndAdd",value:function(){var t=Me.default(V.default.mark(function n(a,i,s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.invokeQueueMethod(a,function(l){return l.squashAndAdd(i,s)}));case 1:case"end":return u.stop()}},n,this)}));function r(n,a,i){return t.apply(this,arguments)}return r}()},{key:"invokeQueueMethod",value:function(){var t=Me.default(V.default.mark(function n(a,i){var s,o;return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.queueByNamespaceKey.has(a)||this.queueByNamespaceKey.set(a,new dC(this.inputReducer)),s=this.queueByNamespaceKey.get(a),o=i(s),this.queueByNamespaceKey.get(a).isEmpty()&&this.queueByNamespaceKey.delete(a),l.abrupt("return",o);case 5:case"end":return l.stop()}},n,this)}));function r(n,a){return t.apply(this,arguments)}return r}()}]),e}();function rY(e){var t=nY();return function(){var n=Xt.default(e),a;if(t){var i=Xt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return ki.default(this,a)}}function nY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var gl=function(e){xr.default(r,e);var t=rY(r);function r(){var n;return gt.default(this,r),n=t.call(this),n.closed=!1,n.uuid=nC.v4(),n}return $t.default(r,[{key:"listenerUuid",get:function(){return this.uuid}},{key:"close",value:function(){this.removeAllListeners(),this.closed=!0}},{key:"ensureNotClosed",value:function(){if(this.closed)throw new Error("Invalid operation on closed object")}}]),r}(Et);function vC(e){var t=aY();return function(){var n=Xt.default(e),a;if(t){var i=Xt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return ki.default(this,a)}}function aY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ch=function(e){xr.default(r,e);var t=vC(r);function r(n,a,i){var s;gt.default(this,r),s=t.call(this,n,i),Tt.default(Jn.default(s),"isDeleted",!1);var o=function(l,c){return typeof c.ttl=="number"?{ttl:c.ttl}:l};return s.updateMergingQueue=new dC(o),s.descriptor=a,s.descriptor.data=s.descriptor.data||{},s.descriptor.date_updated=new Date(s.descriptor.date_updated),s}return $t.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"document"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"_update",value:function(a){switch(a.date_created=new Date(a.date_created),a.type){case"document_updated":if(a.id<=this.lastEventId){_t.trace("Document update skipped, current:",this.lastEventId,", remote:",a.id);break}var i=this.descriptor.data!==void 0?On(this.descriptor.data):null;this.descriptor.last_event_id=a.id,this.descriptor.revision=a.document_revision,this.descriptor.date_updated=a.date_created,this.descriptor.data=a.document_data,this.broadcastEventToListeners("updated",{data:a.document_data,isLocal:!1,previousData:i}),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:a.id,revision:a.document_revision,date_updated:a.date_created,data:a.document_data});break;case"document_removed":this.onRemoved(!1);break}}},{key:"set",value:function(){var n=Me.default(V.default.mark(function i(s,o){var u=this,l;return V.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return l=o||{},h.abrupt("return",this.updateMergingQueue.squashAndAdd(l,function(w){return u._setUnconditionally(s,w.ttl)}));case 2:case"end":return h.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=Me.default(V.default.mark(function i(s,o){var u=this,l;return V.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return l=o||{},h.abrupt("return",this.updateMergingQueue.add(l,function(w){return u._setWithIfMatch(s,w.ttl)}));case 2:case"end":return h.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=Me.default(V.default.mark(function i(s,o){return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.mutate(function(c){return Object.assign(c,s)},o));case 1:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Me.default(V.default.mark(function i(s){var o;return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._postUpdateToServer({ttl:s});case 2:o=l.sent,this.descriptor.date_expires=o.date_expires;case 4:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_setUnconditionally",value:function(){var n=Me.default(V.default.mark(function i(s,o){var u;return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this._postUpdateToServer({data:s,revision:void 0,ttl:o});case 2:return u=c.sent,this._handleSuccessfulUpdateResult(u),c.abrupt("return",this.descriptor.data);case 5:case"end":return c.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"_setWithIfMatch",value:function(){var n=Me.default(V.default.mark(function i(s,o){var u,l,c;return V.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(u=s(On(this.descriptor.data)),!u){w.next=22;break}return l=this.revision,w.prev=3,w.next=6,this._postUpdateToServer({data:u,revision:l,ttl:o});case 6:return c=w.sent,this._handleSuccessfulUpdateResult(c),w.abrupt("return",this.descriptor.data);case 11:if(w.prev=11,w.t0=w.catch(3),w.t0.status!==412){w.next=19;break}return w.next=16,this._softSync();case 16:return w.abrupt("return",this._setWithIfMatch(s));case 19:throw w.t0;case 20:w.next=23;break;case 22:return w.abrupt("return",this.descriptor.data);case 23:case"end":return w.stop()}},i,this,[[3,11]])}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"_handleSuccessfulUpdateResult",value:function(a){if(!(a.last_event_id<=this.descriptor.last_event_id)){var i=this.descriptor.data!==void 0?On(this.descriptor.data):null;this.descriptor.revision=a.revision,this.descriptor.data=a.data,this.descriptor.last_event_id=a.last_event_id,this.descriptor.date_expires=a.date_expires,this.descriptor.date_updated=new Date(a.date_updated),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:a.last_event_id,revision:a.revision,date_updated:a.date_updated,data:a.data}),this.broadcastEventToListeners("updated",{data:this.descriptor.data,isLocal:!0,previousData:i})}}},{key:"_postUpdateToServer",value:function(){var n=Me.default(V.default.mark(function i(s){var o,u,l;return V.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.isDeleted){h.next=17;break}return o={data:s.data},s.ttl!==void 0&&(o.ttl=s.ttl),u=s.revision,h.prev=4,h.next=7,this.services.network.post(this.uri,o,u);case 7:return l=h.sent,h.abrupt("return",{revision:l.body.revision,data:s.data,last_event_id:l.body.last_event_id,date_updated:l.body.date_updated,date_expires:l.body.date_expires});case 11:throw h.prev=11,h.t0=h.catch(4),h.t0.status===404&&this.onRemoved(!1),h.t0;case 15:h.next=18;break;case 17:return h.abrupt("return",Promise.reject(new Dr("The Document has been removed",404,54100)));case 18:case"end":return h.stop()}},i,this,[[4,11]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_softSync",value:function(){var n=Me.default(V.default.mark(function i(){var s=this;return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.services.network.get(this.uri).then(function(l){var c={type:"document_updated",id:l.body.last_event_id,document_revision:l.body.revision,document_data:l.body.data,date_created:l.body.date_updated};return s._update(c),s}).catch(function(l){l.status===404?s.onRemoved(!1):_t.error("Can't get updates for ".concat(s.sid,":"),l)}));case 1:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"onRemoved",value:function(a){if(!this.isDeleted){var i=this.descriptor.data!==void 0?On(this.descriptor.data):null;this.isDeleted=!0,this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:a,previousData:i})}}},{key:"removeDocument",value:function(){var n=Me.default(V.default.mark(function i(){return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.isDeleted){o.next=6;break}return o.next=3,this.services.network.delete(this.uri);case 3:this.onRemoved(!0),o.next=7;break;case 6:return o.abrupt("return",Promise.reject(new Dr("The Document has been removed",404,54100)));case 7:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()}],[{key:"type",get:function(){return"document"}}]),r}(yl),fn=function(e){xr.default(r,e);var t=vC(r);function r(n){var a;return gt.default(this,r),a=t.call(this),a.syncDocumentImpl=n,a.syncDocumentImpl.attach(Jn.default(a)),a}return $t.default(r,[{key:"uri",get:function(){return this.syncDocumentImpl.uri}},{key:"revision",get:function(){return this.syncDocumentImpl.revision}},{key:"lastEventId",get:function(){return this.syncDocumentImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncDocumentImpl.dateExpires}},{key:"type",get:function(){return ch.type}},{key:"sid",get:function(){return this.syncDocumentImpl.sid}},{key:"data",get:function(){return this.syncDocumentImpl.data}},{key:"dateUpdated",get:function(){return this.syncDocumentImpl.dateUpdated}},{key:"uniqueName",get:function(){return this.syncDocumentImpl.uniqueName}},{key:"set",value:function(){var n=Me.default(V.default.mark(function i(s,o){return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncDocumentImpl.set(s,o));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=Me.default(V.default.mark(function i(s,o){return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncDocumentImpl.mutate(s,o));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=Me.default(V.default.mark(function i(s,o){return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncDocumentImpl.update(s,o));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncDocumentImpl.setTtl(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"removeDocument",value:function(){var n=Me.default(V.default.mark(function i(){return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncDocumentImpl.removeDocument());case 2:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"close",value:function(){vl.default(Xt.default(r.prototype),"close",this).call(this),this.syncDocumentImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return ch.type}}]),r}(gl);Tt.default(fn,"removed","removed");Tt.default(fn,"updated","updated");wt([$e.validateTypesAsync($e.pureObject,["undefined",$e.objectSchema("document metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[Object,Object]),Ie("design:returntype",Promise)],fn.prototype,"set",null);wt([$e.validateTypesAsync("function",["undefined",$e.objectSchema("document metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[Function,Object]),Ie("design:returntype",Promise)],fn.prototype,"mutate",null);wt([$e.validateTypesAsync($e.pureObject,["undefined",$e.objectSchema("document metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[Object,Object]),Ie("design:returntype",Promise)],fn.prototype,"update",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ie("design:type",Function),Ie("design:paramtypes",[Number]),Ie("design:returntype",Promise)],fn.prototype,"setTtl",null);var fh=function(){function e(t){gt.default(this,e),this.descriptor=t}return $t.default(e,[{key:"uri",get:function(){return this.descriptor.uri}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.lastEventId}},{key:"dateUpdated",get:function(){return this.descriptor.dateUpdated}},{key:"dateExpires",get:function(){return this.descriptor.dateExpires}},{key:"index",get:function(){return this.descriptor.index}},{key:"data",get:function(){return this.descriptor.data}},{key:"update",value:function(r,n,a,i){return this.descriptor.lastEventId=r,this.descriptor.revision=n,this.descriptor.data=a,this.descriptor.dateUpdated=i,this}},{key:"updateDateExpires",value:function(r){this.descriptor.dateExpires=r}}]),e}(),Sg=function(){function e(t,r,n,a){gt.default(this,e),this.prevToken=n,this.nextToken=a,this.items=t,this.source=r}return $t.default(e,[{key:"hasNextPage",get:function(){return!!this.nextToken}},{key:"hasPrevPage",get:function(){return!!this.prevToken}},{key:"nextPage",value:function(){var t=Me.default(V.default.mark(function n(){return V.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this.hasNextPage){i.next=2;break}throw new Error("No next page");case 2:return i.abrupt("return",this.source(this.nextToken));case 3:case"end":return i.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"prevPage",value:function(){var t=Me.default(V.default.mark(function n(){return V.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this.hasPrevPage){i.next=2;break}throw new Error("No previous page");case 2:return i.abrupt("return",this.source(this.prevToken));case 3:case"end":return i.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()}]),e}();function iY(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=sY(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function sY(e,t){if(!!e){if(typeof e=="string")return PS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PS(e,t)}}function PS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var oY=function(){function e(t,r){gt.default(this,e),this.balanceFactor=0,this.key=t,this.value=r,this.parent=null,this.left=null,this.right=null}return $t.default(e,[{key:"isRoot",get:function(){return this.parent===null}},{key:"isLeaf",get:function(){return this.left===null&&this.right===null}},{key:"isLeftChild",get:function(){return this.parent.left===this}},{key:"update",value:function(r){this.value=r}},{key:"replace",value:function(r,n){!r||(this.left===n?this.left=n:this.right===n&&(this.right=n))}}]),e}(),uY=function(){function e(t,r){gt.default(this,e),this.isLessThan=t||function(n,a){return n<a},this.isEqual=r||function(n,a){return n===a},this.root=null,this.count=null}return $t.default(e,[{key:"size",get:function(){return this.count}},{key:"clear",value:function(){this.root=null,this.count=0}},{key:"set",value:function(r,n){var a=this.getNode(r);a?a.update(n):this.insert(r,n)}},{key:"insert",value:function(r,n){var a=new oY(r,n);if(this.count++,!this.root){this.root=a;return}for(var i=this.root;;)if(this.isLessThan(r,i.key))if(i.left)i=i.left;else{i.left=a;break}else if(i.right)i=i.right;else{i.right=a;break}for(a.parent=i,i=a;i.parent;){var s=i.parent,o=s.balanceFactor;if(i.isLeftChild?s.balanceFactor++:s.balanceFactor--,Math.abs(s.balanceFactor)<Math.abs(o))break;if(s.balanceFactor<-1||s.balanceFactor>1){this.rebalance(s);break}i=s}}},{key:"get",value:function(r){for(var n=this.root;n;){if(this.isEqual(r,n.key))return n.value;this.isLessThan(r,n.key)?n=n.left:n=n.right}return null}},{key:"delete",value:function(r){var n=this.getNode(r);if(!n||n.key!==r)return null;var a=n.parent,i=n.left,s=n.right;if(!!i!=!!s){var o=i||s;!a&&!o?this.root=null:a&&!o?this.root=o:(a.replace(n,null),this.rebalance(a))}else{for(var u=n.left;u.right;)u=u.right;if(n.left===u)n.isRoot?(this.root=u,u.parent=null):(n.isLeftChild?n.parent.left=u:n.parent.right=u,u.parent=n.parent),u.right=n.right,u.right.parent=u,u.balanceFactor=n.balanceFactor,n={parent:u,isLeftChild:!0};else{var l=u.parent,c=u.left;l.right=c,c&&(c.parent=l),n.isRoot?(this.root=u,u.parent=null):(n.isLeftChild?n.parent.left=u:n.parent.right=u,u.parent=n.parent),u.right=n.right,u.right.parent=u,u.left=n.left,u.left.parent=u,u.balanceFactor=n.balanceFactor,n={parent:l,isLeftChild:!1}}}for(this.count--;n.parent;){var h=n.parent,w=h.balanceFactor;if(n.isLeftChild?h.balanceFactor-=1:h.balanceFactor+=1,Math.abs(h.balanceFactor)>Math.abs(w))if(h.balanceFactor<-1||h.balanceFactor>1)if(this.rebalance(h),h.parent.balanceFactor===0)n=h.parent;else break;else break;else n=h}return null}},{key:"getNode",value:function(r){for(var n=this.root;n;){if(this.isEqual(r,n.key))return n;this.isLessThan(r,n.key)?n=n.left:n=n.right}return null}},{key:"rebalance",value:function(r){r.balanceFactor<0?r.right.balanceFactor>0?(this.rotateRight(r.right),this.rotateLeft(r)):this.rotateLeft(r):r.balanceFactor>0&&(r.left.balanceFactor<0?(this.rotateLeft(r.left),this.rotateRight(r)):this.rotateRight(r))}},{key:"rotateLeft",value:function(r){var n=r.right;r.right=n.left,n.left!==null&&(n.left.parent=r),n.parent=r.parent,n.parent===null?this.root=n:r.isLeftChild?n.parent.left=n:n.parent.right=n,n.left=r,r.parent=n,r.balanceFactor=r.balanceFactor+1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor+1-Math.max(r.balanceFactor,0)}},{key:"rotateRight",value:function(r){var n=r.left;r.left=n.right,n.right!==null&&(n.right.parent=r),n.parent=r.parent,n.parent===null?this.root=n:r.isLeftChild?n.parent.left=n:n.parent.right=n,n.right=r,r.parent=n,r.balanceFactor=r.balanceFactor-1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor-1-Math.max(r.balanceFactor,0)}},{key:Symbol.iterator,value:V.default.mark(function t(){var r,n,a;return V.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:r=iY(this.getIterator()),s.prev=1,r.s();case 3:if((n=r.n()).done){s.next=9;break}return a=n.value,s.next=7,a;case 7:s.next=3;break;case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),r.e(s.t0);case 14:return s.prev=14,r.f(),s.finish(14);case 17:case"end":return s.stop()}},t,this,[[1,11,14,17]])})},{key:"getIterator",value:V.default.mark(function t(){var r,n,a,i=arguments;return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=i.length>0&&i[0]!==void 0?i[0]:null,n=this.root;case 2:if(!n){o.next=8;break}if(!(this.isEqual(r,n.key)||r===null&&!n.left)){o.next=5;break}return o.abrupt("break",8);case 5:this.isLessThan(r,n.key)||r===null?n=n.left:n=n.right,o.next=2;break;case 8:if(n){o.next=10;break}return o.abrupt("return",null);case 10:a=!0;case 11:if(!a){o.next=29;break}return o.next=14,[n.key,n.value];case 14:if(a=!1,!n.right){o.next=21;break}for(n=n.right;n.left;)n=n.left;a=!0,o.next=27;break;case 21:if(!n.parent){o.next=26;break}a=n.parent.left===n,n=n.parent,o.next=27;break;case 26:return o.abrupt("break",37);case 27:o.next=35;break;case 29:if(!n.parent){o.next=34;break}a=n.parent.left===n,n=n.parent,o.next=35;break;case 34:return o.abrupt("break",37);case 35:o.next=11;break;case 37:return o.abrupt("return",null);case 38:case"end":return o.stop()}},t,this)})},{key:"getReverseIterator",value:V.default.mark(function t(){var r,n,a,i=arguments;return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=i.length>0&&i[0]!==void 0?i[0]:null,n=this.root;case 2:if(!n){o.next=8;break}if(!(this.isEqual(r,n.key)||r===null&&!n.right)){o.next=5;break}return o.abrupt("break",8);case 5:!this.isLessThan(r,n.key)||r===null?n=n.right:n=n.left,o.next=2;break;case 8:if(n){o.next=10;break}return o.abrupt("return",null);case 10:a=!0;case 11:if(!a){o.next=29;break}return o.next=14,[n.key,n.value];case 14:if(a=!1,!n.left){o.next=21;break}for(n=n.left;n.right;)n=n.right;a=!0,o.next=27;break;case 21:if(!n.parent){o.next=26;break}a=n.parent.right===n,n=n.parent,o.next=27;break;case 26:return o.abrupt("break",37);case 27:o.next=35;break;case 29:if(!n.parent){o.next=34;break}a=n.parent.right===n,n=n.parent,o.next=35;break;case 34:return o.abrupt("break",37);case 35:o.next=11;break;case 37:return o.abrupt("return",null);case 38:case"end":return o.stop()}},t,this)})}]),e}();function lY(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=cY(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function cY(e,t){if(!!e){if(typeof e=="string")return MS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MS(e,t)}}function MS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var fY=function(){function e(t,r){gt.default(this,e),this.value=t,this.revision=r||0}return $t.default(e,[{key:"isValid",get:function(){return!0}}]),e}(),dY=function(){function e(t){gt.default(this,e),this.revision=t}return $t.default(e,[{key:"isValid",get:function(){return!1}}]),e}(),$g=function(){function e(){gt.default(this,e),this.items=new uY}return $t.default(e,[{key:"store",value:function(r,n,a){var i=this.items.get(r);return i&&i.revision>a?i.isValid?i.value:null:(this.items.set(r,new fY(n,a)),n)}},{key:"delete",value:function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.items.get(r);(!i||i.revision<n||i&&a===!0)&&this.items.set(r,new dY(n))}},{key:"isKnown",value:function(r,n){var a=this.items.get(r);return a&&a.revision>=n}},{key:"get",value:function(r){var n=this.items.get(r);return n&&n.isValid?n.value:null}},{key:"has",value:function(r){var n=this.items.get(r);return n&&n.isValid}},{key:"forEach",value:function(r){if(this.items){var n=lY(this.items),a;try{for(n.s();!(a=n.n()).done;){var i=iC.default(a.value,2),s=i[0],o=i[1];o.isValid&&r(s,o.value)}}catch(u){n.e(u)}finally{n.f()}}}}]),e}();function hC(e){var t=pY();return function(){var n=Xt.default(e),a;if(t){var i=Xt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return ki.default(this,a)}}function pY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dh=function(e){xr.default(r,e);var t=hC(r);function r(n,a,i){var s;gt.default(this,r),s=t.call(this,n,i);var o=function(l,c){return typeof c.ttl=="number"?{ttl:c.ttl}:l};return s.updateMergingQueue=new pC(o),s.cache=new $g,s.descriptor=a,s.descriptor.date_updated=new Date(s.descriptor.date_updated),s}return $t.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"list"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"_addOrUpdateItemOnServer",value:function(){var n=Me.default(V.default.mark(function i(s,o,u,l){var c,h;return V.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c={data:o},l!==void 0&&(c.ttl=l),b.next=4,this.services.network.post(s,c,u);case 4:return h=b.sent,h.body.data=o,h.body.date_updated=new Date(h.body.date_updated),b.abrupt("return",h.body);case 8:case"end":return b.stop()}},i,this)}));function a(i,s,o,u){return n.apply(this,arguments)}return a}()},{key:"push",value:function(){var n=Me.default(V.default.mark(function i(s,o){var u,l,c;return V.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return u=(o||{}).ttl,w.next=3,this._addOrUpdateItemOnServer(this.links.items,s,void 0,u);case 3:return l=w.sent,c=Number(l.index),this._handleItemMutated(c,l.url,l.last_event_id,l.revision,s,l.date_updated,l.date_expires,!0,!1),w.abrupt("return",this.cache.get(c));case 7:case"end":return w.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"set",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){var l=this,c;return V.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=u||{},w.abrupt("return",this.updateMergingQueue.squashAndAdd(s,c,function(b){return l._updateItemUnconditionally(s,o,b.ttl)}));case 2:case"end":return w.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"_updateItemUnconditionally",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){var l,c;return V.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.get(s);case 2:return l=w.sent,w.next=5,this._addOrUpdateItemOnServer(l.uri,o,void 0,u);case 5:return c=w.sent,this._handleItemMutated(s,c.url,c.last_event_id,c.revision,c.data,c.date_updated,c.date_expires,!1,!1),w.abrupt("return",this.cache.get(s));case 8:case"end":return w.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"_updateItemWithIfMatch",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){var l,c,h,w;return V.default.wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,this.get(s);case 2:if(l=$.sent,c=o(On(l.data)),!c){$.next=25;break}return h=l.revision,$.prev=6,$.next=9,this._addOrUpdateItemOnServer(l.uri,c,h,u);case 9:return w=$.sent,this._handleItemMutated(s,w.url,w.last_event_id,w.revision,w.data,w.date_updated,w.date_expires,!1,!1),$.abrupt("return",this.cache.get(s));case 14:if($.prev=14,$.t0=$.catch(6),$.t0.status!==412){$.next=22;break}return $.next=19,this._getItemFromServer(s);case 19:return $.abrupt("return",this._updateItemWithIfMatch(s,o,u));case 22:throw $.t0;case 23:$.next=26;break;case 25:return $.abrupt("return",l);case 26:case"end":return $.stop()}},i,this,[[6,14]])}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){var l=this,c;return V.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=u||{},w.abrupt("return",this.updateMergingQueue.add(s,c,function(b){return l._updateItemWithIfMatch(s,o,b.ttl)}));case 2:case"end":return w.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.mutate(s,function(h){return Object.assign(h,o)},u));case 1:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"remove",value:function(){var n=Me.default(V.default.mark(function i(s){var o,u,l;return V.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.get(s);case 2:return o=h.sent,u=On(o.data),h.next=6,this.services.network.delete(o.uri);case 6:l=h.sent,this._handleItemRemoved(s,l.body.last_event_id,u,new Date(l.body.date_updated),!1);case 8:case"end":return h.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"get",value:function(){var n=Me.default(V.default.mark(function i(s){var o;return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(o=this.cache.get(s),!o){l.next=5;break}return l.abrupt("return",o);case 5:return l.abrupt("return",this._getItemFromServer(s));case 6:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_getItemFromServer",value:function(){var n=Me.default(V.default.mark(function i(s){var o;return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.queryItems({index:s});case 2:if(o=l.sent,!(o.items.length<1)){l.next=7;break}throw new Dr("No item with index ".concat(s," found"),404,54151);case 7:return l.abrupt("return",o.items[0]);case 8:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"queryItems",value:function(){var n=Me.default(V.default.mark(function i(s){var o=this,u,l,c,h;return V.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return s=s||{},u=new ho(this.links.items).queryParam("From",s.from).queryParam("PageSize",s.limit).queryParam("Index",s.index).queryParam("PageToken",s.pageToken).queryParam("Order",s.order).build(),b.next=4,this.services.network.get(u);case 4:return l=b.sent,c=l.body.items.map(function($){$.date_updated=new Date($.date_updated);var A=o.cache.get($.index);return A?o._handleItemMutated($.index,$.url,$.last_event_id,$.revision,$.data,$.date_updated,$.date_expires,!1,!0):o.cache.store(Number($.index),new fh({index:Number($.index),uri:$.url,revision:$.revision,lastEventId:$.last_event_id,dateUpdated:$.date_updated,dateExpires:$.date_expires,data:$.data}),$.last_event_id),o.cache.get($.index)}),h=l.body.meta,b.abrupt("return",new Sg(c,function($){return o.queryItems({pageToken:$})},h.previous_token,h.next_token));case 8:case"end":return b.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return s=s||{},fC(s.pageSize),s.limit=s.pageSize||s.limit||50,s.order=s.order||"asc",u.abrupt("return",this.queryItems(s));case 5:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getContext",value:function(){var n=Me.default(V.default.mark(function i(){var s;return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.context){u.next=5;break}return u.next=3,this.services.network.get(this.links.context);case 3:s=u.sent,this._updateContextIfRequired(s.body.data,s.body.last_event_id);case 5:return u.abrupt("return",this.context);case 6:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Me.default(V.default.mark(function i(s){var o,u;return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,o={ttl:s},c.next=4,this.services.network.post(this.uri,o);case 4:u=c.sent,this.descriptor.date_expires=u.body.date_expires,c.next=12;break;case 8:throw c.prev=8,c.t0=c.catch(0),c.t0.status===404&&this.onRemoved(!1),c.t0;case 12:case"end":return c.stop()}},i,this,[[0,8]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setItemTtl",value:function(){var n=Me.default(V.default.mark(function i(s,o){var u,l,c;return V.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.get(s);case 2:return u=w.sent,l={ttl:o},w.next=6,this.services.network.post(u.uri,l);case 6:c=w.sent,u.updateDateExpires(c.body.date_expires);case 8:case"end":return w.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"removeList",value:function(){var n=Me.default(V.default.mark(function i(){return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"onRemoved",value:function(a){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:a})}},{key:"shouldIgnoreEvent",value:function(a,i){return this.cache.isKnown(a,i)}},{key:"_update",value:function(a,i){var s=Number(a.item_index);switch(a.date_created=new Date(a.date_created),a.type){case"list_item_added":case"list_item_updated":this._handleItemMutated(s,a.item_url,a.id,a.item_revision,a.item_data,a.date_created,void 0,a.type==="list_item_added",!0);break;case"list_item_removed":this._handleItemRemoved(s,a.id,a.item_data,a.date_created,!0);break;case"list_context_updated":this._handleContextUpdate(a.context_data,a.id,a.date_created);break;case"list_removed":this.onRemoved(!1);break}i&&this._advanceLastEventId(a.id,a.list_revision)}},{key:"_advanceLastEventId",value:function(a,i){this.lastEventId<a&&(this.descriptor.last_event_id=a,i&&(this.descriptor.revision=i))}},{key:"_updateRootDateUpdated",value:function(a){(!this.descriptor.date_updated||a.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=a,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:a}))}},{key:"_handleItemMutated",value:function(a,i,s,o,u,l,c,h,w){if(this.shouldIgnoreEvent(a,s)){_t.trace("Item ".concat(a," update skipped, current: ").concat(this.lastEventId,", remote: ").concat(s));return}this._updateRootDateUpdated(l);var b=this.cache.get(a);if(!b){var $=new fh({index:a,uri:i,lastEventId:s,revision:o,data:u,dateUpdated:l,dateExpires:c});this.cache.store(a,$,s),this.emitItemMutationEvent($,w,h);return}var A=On(b.data);b.update(s,o,u,l),this.cache.store(a,b,s),c!==void 0&&b.updateDateExpires(c),this.emitItemMutationEvent(b,w,!1,A)}},{key:"emitItemMutationEvent",value:function(a,i,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=s?"itemAdded":"itemUpdated",l={item:a,isLocal:!i};s||(l.previousItemData=o),this.broadcastEventToListeners(u,l)}},{key:"_handleItemRemoved",value:function(a,i,s,o,u){this._updateRootDateUpdated(o),this.cache.delete(a,i),this.broadcastEventToListeners("itemRemoved",{index:a,isLocal:!u,previousItemData:s})}},{key:"_handleContextUpdate",value:function(a,i,s){this._updateRootDateUpdated(s),this._updateContextIfRequired(a,i)&&this.broadcastEventToListeners("contextUpdated",{context:a,isLocal:!1})}},{key:"_updateContextIfRequired",value:function(a,i){return!this.contextEventId||i>this.contextEventId?(this.context=a,this.contextEventId=i,!0):(_t.trace("Context update skipped, current:",this.lastEventId,", remote:",i),!1)}}],[{key:"type",get:function(){return"list"}}]),r}(yl),tr=function(e){xr.default(r,e);var t=hC(r);function r(n){var a;return gt.default(this,r),a=t.call(this),a.syncListImpl=n,a.syncListImpl.attach(Jn.default(a)),a}return $t.default(r,[{key:"uri",get:function(){return this.syncListImpl.uri}},{key:"revision",get:function(){return this.syncListImpl.revision}},{key:"lastEventId",get:function(){return this.syncListImpl.lastEventId}},{key:"links",get:function(){return this.syncListImpl.links}},{key:"dateExpires",get:function(){return this.syncListImpl.dateExpires}},{key:"type",get:function(){return dh.type}},{key:"sid",get:function(){return this.syncListImpl.sid}},{key:"uniqueName",get:function(){return this.syncListImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncListImpl.dateUpdated}},{key:"push",value:function(){var n=Me.default(V.default.mark(function i(s,o){return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncListImpl.push(s,o));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"set",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.set(s,o,u));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.mutate(s,o,u));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.update(s,o,u));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"remove",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.remove(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"get",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.get(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getContext",value:function(){var n=Me.default(V.default.mark(function i(){return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.getContext());case 2:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.getItems(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.setTtl(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setItemTtl",value:function(){var n=Me.default(V.default.mark(function i(s,o){return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncListImpl.setItemTtl(s,o));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"removeList",value:function(){var n=Me.default(V.default.mark(function i(){return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.removeList());case 2:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"close",value:function(){vl.default(Xt.default(r.prototype),"close",this).call(this),this.syncListImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return dh.type}}]),r}(gl);Tt.default(tr,"itemAdded","itemAdded");Tt.default(tr,"itemUpdated","itemUpdated");Tt.default(tr,"itemRemoved","itemRemoved");Tt.default(tr,"removed","removed");wt([$e.validateTypesAsync($e.pureObject,["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[Object,Object]),Ie("design:returntype",Promise)],tr.prototype,"push",null);wt([$e.validateTypesAsync($e.nonNegativeInteger,$e.pureObject,["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[Number,Object,Object]),Ie("design:returntype",Promise)],tr.prototype,"set",null);wt([$e.validateTypesAsync($e.nonNegativeInteger,"function",["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[Number,Function,Object]),Ie("design:returntype",Promise)],tr.prototype,"mutate",null);wt([$e.validateTypesAsync($e.nonNegativeInteger,$e.pureObject,["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[Number,Object,Object]),Ie("design:returntype",Promise)],tr.prototype,"update",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ie("design:type",Function),Ie("design:paramtypes",[Number]),Ie("design:returntype",Promise)],tr.prototype,"remove",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ie("design:type",Function),Ie("design:paramtypes",[Number]),Ie("design:returntype",Promise)],tr.prototype,"get",null);wt([$e.validateTypesAsync(["undefined",$e.objectSchema("query options",{from:[$e.nonNegativeInteger,"undefined"],pageSize:[$e.custom(function(e){return[_g(e),"a positive integer"]}),"undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[Object]),Ie("design:returntype",Promise)],tr.prototype,"getItems",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ie("design:type",Function),Ie("design:paramtypes",[Number]),Ie("design:returntype",Promise)],tr.prototype,"setTtl",null);wt([$e.validateTypesAsync($e.nonNegativeInteger,$e.nonNegativeInteger),Ie("design:type",Function),Ie("design:paramtypes",[Number,Number]),Ie("design:returntype",Promise)],tr.prototype,"setItemTtl",null);var fu=function(){function e(t){gt.default(this,e),this.descriptor=t}return $t.default(e,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"key",get:function(){return this.descriptor.key}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"update",value:function(r,n,a,i){return this.descriptor.last_event_id=r,this.descriptor.revision=n,this.descriptor.data=a,this.descriptor.date_updated=i,this}},{key:"updateDateExpires",value:function(r){this.descriptor.date_expires=r}}]),e}();function yC(e){var t=vY();return function(){var n=Xt.default(e),a;if(t){var i=Xt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return ki.default(this,a)}}function vY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ph=function(e){xr.default(r,e);var t=yC(r);function r(n,a,i){var s;gt.default(this,r),s=t.call(this,n,i);var o=function(l,c){return typeof c.ttl=="number"?{ttl:c.ttl}:l};return s.updateMergingQueue=new pC(o),s.cache=new $g,s.descriptor=a,s.descriptor.date_updated=new Date(s.descriptor.date_updated),a.items&&a.items.forEach(function(u){u.date_updated=new Date(u.date_updated),s.cache.store(u.key,new fu(u),u.last_event_id)}),s}return $t.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"map"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"set",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){var l=this,c;return V.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=u||{},w.abrupt("return",this.updateMergingQueue.squashAndAdd(s,c,function(b){return l._putItemUnconditionally(s,o,b.ttl)}));case 2:case"end":return w.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"get",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(s!=null){u.next=2;break}throw new Dr("SyncMapItem key may not be empty",400,54209);case 2:if(!this.cache.has(s)){u.next=6;break}return u.abrupt("return",this.cache.get(s));case 6:return u.abrupt("return",this._getItemFromServer(s));case 7:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_getItemFromServer",value:function(){var n=Me.default(V.default.mark(function i(s){var o;return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.queryItems({key:s});case 2:if(o=l.sent,!(o.items.length<1)){l.next=7;break}throw new Dr("The specified Map Item does not exist",404,54201);case 7:return l.abrupt("return",o.items[0]);case 8:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){var l=this,c;return V.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=u||{},w.abrupt("return",this.updateMergingQueue.add(s,c,function(b){return l._putItemWithIfMatch(s,o,b.ttl)}));case 2:case"end":return w.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.mutate(s,function(h){return Object.assign(h,o)},u));case 1:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"_putItemUnconditionally",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){var l,c;return V.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._putItemToServer(s,o,void 0,u);case 2:return l=w.sent,c=l.item,this._handleItemMutated(c.key,c.url,c.last_event_id,c.revision,c.data,c.date_updated,c.date_expires,l.added,!1),w.abrupt("return",this.cache.get(c.key));case 6:case"end":return w.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"_putItemWithIfMatch",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){var l,c,h,w,b;return V.default.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this.get(s).catch(function(x){if(x.status===404)return new fu({key:s,data:{},last_event_id:-1,revision:"-1",url:null,date_updated:null,date_expires:null});throw x});case 2:if(l=A.sent,c=o(On(l.data)),!c){A.next=26;break}return h=l.revision,A.prev=6,A.next=9,this._putItemToServer(s,c,h,u);case 9:return w=A.sent,b=w.item,this._handleItemMutated(b.key,b.url,b.last_event_id,b.revision,b.data,b.date_updated,b.date_expires,w.added,!1),A.abrupt("return",this.cache.get(b.key));case 15:if(A.prev=15,A.t0=A.catch(6),A.t0.status!==412){A.next=23;break}return A.next=20,this._getItemFromServer(s);case 20:return A.abrupt("return",this._putItemWithIfMatch(s,o,u));case 23:throw A.t0;case 24:A.next=27;break;case 26:return A.abrupt("return",l);case 27:case"end":return A.stop()}},i,this,[[6,15]])}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"_putItemToServer",value:function(){var n=Me.default(V.default.mark(function i(s,o,u,l){var c,h,w,b,$;return V.default.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return c=new ho(this.links.items).pathSegment(s).build(),h={data:o},l!==void 0&&(h.ttl=l),x.prev=3,x.next=6,this.services.network.put(c,h,u);case 6:return w=x.sent,b=w.body,b.data=o,b.date_updated=new Date(b.date_updated),$=w.status.code===201,x.abrupt("return",{added:$,item:b});case 14:throw x.prev=14,x.t0=x.catch(3),x.t0.status===404&&this.onRemoved(!1),x.t0;case 18:case"end":return x.stop()}},i,this,[[3,14]])}));function a(i,s,o,u){return n.apply(this,arguments)}return a}()},{key:"remove",value:function(){var n=Me.default(V.default.mark(function i(s){var o,u,l;return V.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.get(s);case 2:return o=h.sent,u=On(o.data),h.next=6,this.services.network.delete(o.uri);case 6:l=h.sent,this._handleItemRemoved(s,l.body.last_event_id,u,new Date(l.body.date_updated),!1);case 8:case"end":return h.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"queryItems",value:function(){var n=Me.default(V.default.mark(function i(s){var o=this,u,l,c,h;return V.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return s=s||{},u=new ho(this.links.items).queryParam("From",s.from).queryParam("PageSize",s.limit).queryParam("Key",s.key).queryParam("PageToken",s.pageToken).queryParam("Order",s.order).build(),b.next=4,this.services.network.get(u);case 4:return l=b.sent,c=l.body.items.map(function($){$.date_updated=new Date($.date_updated);var A=o.cache.get($.key);return A?o._handleItemMutated($.key,$.url,$.last_event_id,$.revision,$.data,$.date_updated,$.date_expires,!1,!0):o.cache.store($.key,new fu($),$.last_event_id),o.cache.get($.key)}),h=l.body.meta,b.abrupt("return",new Sg(c,function($){return o.queryItems({pageToken:$})},h.previous_token,h.next_token));case 8:case"end":return b.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return s=s||{},fC(s.pageSize),s.limit=s.pageSize||s.limit||50,s.order=s.order||"asc",u.abrupt("return",this.queryItems(s));case 5:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"shouldIgnoreEvent",value:function(a,i){return this.cache.isKnown(a,i)}},{key:"_update",value:function(a,i){switch(a.date_created=new Date(a.date_created),a.type){case"map_item_added":case"map_item_updated":this._handleItemMutated(a.item_key,a.item_url,a.id,a.item_revision,a.item_data,a.date_created,void 0,a.type==="map_item_added",!0);break;case"map_item_removed":this._handleItemRemoved(a.item_key,a.id,a.item_data,a.date_created,!0);break;case"map_removed":this.onRemoved(!1);break}i&&this._advanceLastEventId(a.id,a.map_revision)}},{key:"_advanceLastEventId",value:function(a,i){this.lastEventId<a&&(this.descriptor.last_event_id=a,i&&(this.descriptor.revision=i))}},{key:"_updateRootDateUpdated",value:function(a){(!this.descriptor.date_updated||a.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=a,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:a}))}},{key:"_handleItemMutated",value:function(a,i,s,o,u,l,c,h,w){if(this.shouldIgnoreEvent(a,s)){_t.trace("SyncMapItem ",a," update skipped, current:",this.lastEventId,", remote:",s);return}this._updateRootDateUpdated(l);var b=this.cache.get(a);if(!b){var $=new fu({key:a,url:i,last_event_id:s,revision:o,data:u,date_updated:l,date_expires:c});this.cache.store(a,$,s),this.emitItemMutationEvent($,w,h);return}var A=On(b.data);b.update(s,o,u,l),this.cache.store(a,b,s),c!==void 0&&b.updateDateExpires(c),this.emitItemMutationEvent(b,w,!1,A)}},{key:"emitItemMutationEvent",value:function(a,i,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=s?"itemAdded":"itemUpdated",l={item:a,isLocal:!i};s||(l.previousItemData=o),this.broadcastEventToListeners(u,l)}},{key:"_handleItemRemoved",value:function(a,i,s,o,u){this._updateRootDateUpdated(o),this.cache.delete(a,i),this.broadcastEventToListeners("itemRemoved",{key:a,isLocal:!u,previousItemData:s})}},{key:"onRemoved",value:function(a){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:a})}},{key:"setTtl",value:function(){var n=Me.default(V.default.mark(function i(s){var o,u;return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,o={ttl:s},c.next=4,this.services.network.post(this.uri,o);case 4:u=c.sent,this.descriptor.date_expires=u.body.date_expires,c.next=12;break;case 8:throw c.prev=8,c.t0=c.catch(0),c.t0.status===404&&this.onRemoved(!1),c.t0;case 12:case"end":return c.stop()}},i,this,[[0,8]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setItemTtl",value:function(){var n=Me.default(V.default.mark(function i(s,o){var u,l,c;return V.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.get(s);case 2:return u=w.sent,l={ttl:o},w.next=6,this.services.network.post(u.uri,l);case 6:c=w.sent,u.updateDateExpires(c.body.date_expires);case 8:case"end":return w.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"removeMap",value:function(){var n=Me.default(V.default.mark(function i(){return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()}],[{key:"type",get:function(){return"map"}}]),r}(yl),nr=function(e){xr.default(r,e);var t=yC(r);function r(n){var a;return gt.default(this,r),a=t.call(this),a.syncMapImpl=n,a.syncMapImpl.attach(Jn.default(a)),a}return $t.default(r,[{key:"uri",get:function(){return this.syncMapImpl.uri}},{key:"links",get:function(){return this.syncMapImpl.links}},{key:"revision",get:function(){return this.syncMapImpl.revision}},{key:"lastEventId",get:function(){return this.syncMapImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncMapImpl.dateExpires}},{key:"type",get:function(){return ph.type}},{key:"sid",get:function(){return this.syncMapImpl.sid}},{key:"uniqueName",get:function(){return this.syncMapImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncMapImpl.dateUpdated}},{key:"set",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.set(s,o,u));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"get",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.get(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.mutate(s,o,u));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=Me.default(V.default.mark(function i(s,o,u){return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.update(s,o,u));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"remove",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.remove(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.getItems(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.setTtl(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setItemTtl",value:function(){var n=Me.default(V.default.mark(function i(s,o){return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncMapImpl.setItemTtl(s,o));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"removeMap",value:function(){var n=Me.default(V.default.mark(function i(){return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.next=3,this.syncMapImpl.removeMap();case 3:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"close",value:function(){vl.default(Xt.default(r.prototype),"close",this).call(this),this.syncMapImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return ph.type}}]),r}(gl);Tt.default(nr,"itemAdded","itemAdded");Tt.default(nr,"itemUpdated","itemUpdated");Tt.default(nr,"itemRemoved","itemRemoved");Tt.default(nr,"removed","removed");wt([$e.validateTypesAsync("string",$e.pureObject,["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[String,Object,Object]),Ie("design:returntype",Promise)],nr.prototype,"set",null);wt([$e.validateTypesAsync("string"),Ie("design:type",Function),Ie("design:paramtypes",[String]),Ie("design:returntype",Promise)],nr.prototype,"get",null);wt([$e.validateTypesAsync("string","function",["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[String,Function,Object]),Ie("design:returntype",Promise)],nr.prototype,"mutate",null);wt([$e.validateTypesAsync("string",$e.pureObject,["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[String,Object,Object]),Ie("design:returntype",Promise)],nr.prototype,"update",null);wt([$e.validateTypesAsync("string"),Ie("design:type",Function),Ie("design:paramtypes",[String]),Ie("design:returntype",Promise)],nr.prototype,"remove",null);wt([$e.validateTypesAsync(["undefined",$e.objectSchema("query options",{from:["string","undefined"],pageSize:[$e.custom(function(e){return[_g(e),"a positive integer"]}),"undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[Object]),Ie("design:returntype",Promise)],nr.prototype,"getItems",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ie("design:type",Function),Ie("design:paramtypes",[Number]),Ie("design:returntype",Promise)],nr.prototype,"setTtl",null);wt([$e.validateTypesAsync("string",$e.nonNegativeInteger),Ie("design:type",Function),Ie("design:paramtypes",[String,Number]),Ie("design:returntype",Promise)],nr.prototype,"setItemTtl",null);function gC(e){var t=hY();return function(){var n=Xt.default(e),a;if(t){var i=Xt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return ki.default(this,a)}}function hY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Bu=function(e){xr.default(r,e);var t=gC(r);function r(n,a,i){var s;return gt.default(this,r),s=t.call(this,n,i),s.descriptor=a,s}return $t.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"stream"}},{key:"lastEventId",get:function(){return null}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"publishMessage",value:function(){var n=Me.default(V.default.mark(function i(s){var o,u,l,c;return V.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return o={data:s},w.next=3,this.services.network.post(this.links.messages,o);case 3:return u=w.sent,l=u.body,c=this._handleMessagePublished(l.sid,s,!1),w.abrupt("return",c);case 7:case"end":return w.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Me.default(V.default.mark(function i(s){var o,u;return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,o={ttl:s},c.next=4,this.services.network.post(this.uri,o);case 4:u=c.sent,this.descriptor.date_expires=u.body.date_expires,c.next=12;break;case 8:throw c.prev=8,c.t0=c.catch(0),c.t0.status===404&&this.onRemoved(!1),c.t0;case 12:case"end":return c.stop()}},i,this,[[0,8]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"removeStream",value:function(){var n=Me.default(V.default.mark(function i(){return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"_update",value:function(a){switch(a.type){case"stream_message_published":{this._handleMessagePublished(a.message_sid,a.message_data,!0);break}case"stream_removed":{this.onRemoved(!1);break}}}},{key:"_handleMessagePublished",value:function(a,i,s){var o={sid:a,data:i};return this.broadcastEventToListeners("messagePublished",{message:o,isLocal:!s}),o}},{key:"onRemoved",value:function(a){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:a})}}],[{key:"type",get:function(){return"stream"}}]),r}(yl);wt([$e.validateTypesAsync($e.pureObject),Ie("design:type",Function),Ie("design:paramtypes",[Object]),Ie("design:returntype",Promise)],Bu.prototype,"publishMessage",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ie("design:type",Function),Ie("design:paramtypes",[Number]),Ie("design:returntype",Promise)],Bu.prototype,"setTtl",null);var zn=function(e){xr.default(r,e);var t=gC(r);function r(n){var a;return gt.default(this,r),a=t.call(this),a.syncStreamImpl=n,a.syncStreamImpl.attach(Jn.default(a)),a}return $t.default(r,[{key:"uri",get:function(){return this.syncStreamImpl.uri}},{key:"links",get:function(){return this.syncStreamImpl.links}},{key:"dateExpires",get:function(){return this.syncStreamImpl.dateExpires}},{key:"type",get:function(){return Bu.type}},{key:"lastEventId",get:function(){return null}},{key:"sid",get:function(){return this.syncStreamImpl.sid}},{key:"uniqueName",get:function(){return this.syncStreamImpl.uniqueName}},{key:"publishMessage",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncStreamImpl.publishMessage(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncStreamImpl.setTtl(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"removeStream",value:function(){var n=Me.default(V.default.mark(function i(){return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncStreamImpl.removeStream());case 2:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"close",value:function(){vl.default(Xt.default(r.prototype),"close",this).call(this),this.syncStreamImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Bu.type}}]),r}(gl);Tt.default(zn,"messagePublished","messagePublished");Tt.default(zn,"removed","removed");wt([$e.validateTypesAsync($e.pureObject),Ie("design:type",Function),Ie("design:paramtypes",[Object]),Ie("design:returntype",Promise)],zn.prototype,"publishMessage",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ie("design:type",Function),Ie("design:paramtypes",[Number]),Ie("design:returntype",Promise)],zn.prototype,"setTtl",null);var yY=function e(t){gt.default(this,e),this.sdk="js",this.sdkVer=t,this.os=Zl.os.family,this.osVer=Zl.os.version,this.pl=Zl.name,this.plVer=Zl.version},gY=function(){function e(){gt.default(this,e),this.names=new Map,this.entities=new Map}return $t.default(e,[{key:"store",value:function(r){var n=this.entities.get(r.sid);return n||(this.entities.set(r.sid,r),r.uniqueName&&this.names.set(r.type+"::"+r.uniqueName,r.sid),r)}},{key:"getResolved",value:function(r,n){var a=this.names.get(n+"::"+r);return a?this.entities.get(a):null}},{key:"get",value:function(r,n){return this.entities.get(r)||this.getResolved(r,n)||null}},{key:"remove",value:function(r){var n=this.entities.get(r);n&&(this.entities.delete(r),n.uniqueName&&this.names.delete(n.type+"::"+n.uniqueName))}}]),e}();function Tg(e){var t=mY();return function(){var n=Xt.default(e),a;if(t){var i=Xt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return ki.default(this,a)}}function mY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var bY=function e(){gt.default(this,e)},vh=function(e){xr.default(r,e);var t=Tg(r);function r(n,a,i,s){var o;return gt.default(this,r),o=t.call(this,a,i),o.descriptor=n,o.cache=new $g,s&&s.forEach(function(u){o.cache.store(u.key,{key:u.key,value:u.data},u.revision)}),o}return $t.default(r,[{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return null}},{key:"type",get:function(){return r.type}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"indexName",get:function(){return this.descriptor.indexName}},{key:"queryString",get:function(){return this.descriptor.queryExpression}},{key:"queryUri",get:function(){return this.descriptor.queryUri}},{key:"liveQueryDescriptor",get:function(){return this.descriptor}},{key:"onRemoved",value:function(){}},{key:"getItems",value:function(){var a={};return this.cache.forEach(function(i,s){a[i]=s.value}),a}},{key:"_update",value:function(a,i){switch(a.type){case"live_query_item_updated":this.handleItemMutated(a.item_key,a.item_data,a.item_revision);break;case"live_query_item_removed":this.handleItemRemoved(a.item_key,a.item_revision);break;case"live_query_updated":this.handleBatchUpdate(a.items);break}i&&this._advanceLastEventId(a.last_event_id)}},{key:"handleItemMutated",value:function(a,i,s){if(this.shouldIgnoreEvent(a,s))_t.trace("Item ".concat(a," update skipped, revision: ").concat(s));else{var o={key:a,value:i};this.cache.store(a,o,s),this.broadcastEventToListeners("itemUpdated",o)}}},{key:"handleItemRemoved",value:function(a,i){var s=i===null;this.shouldIgnoreEvent(a,i)?_t.trace("Item ".concat(a," delete skipped, revision: ").concat(i)):(this.cache.delete(a,i,s),this.broadcastEventToListeners("itemRemoved",{key:a}))}},{key:"handleBatchUpdate",value:function(a){var i=this,s={};a!=null&&a.forEach(function(u){s[u.key]={data:u.data,revision:u.revision}}),this.cache.forEach(function(u,l){var c=s[u];c!=null?i.handleItemMutated(u,c.data,c.revision):i.handleItemRemoved(u,null),delete s[u]});for(var o in s)this.handleItemMutated(o,s[o].data,s[o].revision)}},{key:"shouldIgnoreEvent",value:function(a,i){return a!=null&&i!=null&&this.cache.isKnown(a,i)}},{key:"_advanceLastEventId",value:function(a,i){this.lastEventId<a&&(this.descriptor.last_event_id=a)}}],[{key:"type",get:function(){return"live_query"}}]),r}(yl);function mC(e){return hh.apply(this,arguments)}function hh(){return hh=Me.default(V.default.mark(function e(t){var r,n,a,i,s,o;return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(r=t.network,n=t.queryString,a=t.uri,i=t.type,n!=null){l.next=3;break}throw new Dr("Invalid query",400,54507);case 3:return s={query_string:n},i===ya.type&&(s.type=i),l.next=7,r.post(a,s,void 0,!0);case 7:return o=l.sent,l.abrupt("return",o.body);case 9:case"end":return l.stop()}},e)})),hh.apply(this,arguments)}var ya=function(e){xr.default(r,e);var t=Tg(r);function r(n){var a;return gt.default(this,r),a=t.call(this),a.liveQueryImpl=n,a.liveQueryImpl.attach(Jn.default(a)),a}return $t.default(r,[{key:"type",get:function(){return vh.type}},{key:"lastEventId",get:function(){return this.liveQueryImpl.lastEventId}},{key:"sid",get:function(){return this.liveQueryImpl.sid}},{key:"close",value:function(){vl.default(Xt.default(r.prototype),"close",this).call(this),this.liveQueryImpl.detach(this.listenerUuid)}},{key:"getItems",value:function(){return this.ensureNotClosed(),this.liveQueryImpl.getItems()}}],[{key:"type",get:function(){return vh.type}}]),r}(gl);Tt.default(ya,"itemUpdated","itemUpdated");Tt.default(ya,"itemRemoved","itemRemoved");var ml=function(e){xr.default(r,e);var t=Tg(r);function r(n){var a;return gt.default(this,r),a=t.call(this),Tt.default(Jn.default(a),"queryExpression",null),Tt.default(Jn.default(a),"items",{}),Object.assign(Jn.default(a),n),a.updateIndexName(n.indexName),a}return $t.default(r,[{key:"type",get:function(){return r.type}},{key:"search",value:function(){var n=Me.default(V.default.mark(function i(s){var o=this;return V.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.items={},l.abrupt("return",mC({network:this.network,uri:this.queryUri,queryString:s}).then(function(c){o.queryExpression=s,c.items&&c.items.forEach(function(h){o.items[h.key]=h.data}),o.emit("searchResult",o.getItems())}).catch(function(c){throw _t.error("Error '".concat(c.message,"' while executing query '").concat(s,"'")),o.queryExpression=null,c}));case 2:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"subscribe",value:function(){var n=Me.default(V.default.mark(function i(){return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.queryExpression!=null){o.next=2;break}return o.abrupt("return",Promise.reject(new Dr("Invalid query",400,54507)));case 2:return o.abrupt("return",this.liveQueryCreator(this.indexName,this.queryExpression));case 3:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){return this.items}},{key:"updateIndexName",value:function(a){this.indexName=a,this.queryUri=this.generateQueryUri(this.indexName)}},{key:"generateQueryUri",value:function(a){return new ho(this.insightsUri).pathSegment(a).pathSegment("Items").build()}}],[{key:"type",get:function(){return"instant_query"}}]),r}(Et);Tt.default(ml,"searchResult","searchResult");wt([$e.validateTypesAsync("string"),Ie("design:type",Function),Ie("design:paramtypes",[String]),Ie("design:returntype",Promise)],ml.prototype,"search",null);wt([$e.validateTypes($e.nonEmptyString),Ie("design:type",Function),Ie("design:paramtypes",[String]),Ie("design:returntype",void 0)],ml.prototype,"updateIndexName",null);var wY="3.1.0";function _Y(e){var t=SY();return function(){var n=Xt.default(e),a;if(t){var i=Xt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return ki.default(this,a)}}function SY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function NS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xS(Object(r),!0).forEach(function(n){Tt.default(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var $Y="data_sync",Op=wY;function ec(e){if(e){if(typeof e=="string")return{id:e,mode:"open_or_create"};var t=e.mode||(e.id?"open_or_create":"create_new");return NS(NS({},e),{},{mode:t})}else return{mode:"create_new"}}var LS="com.twilio.rtd.cds.document",jS="com.twilio.rtd.cds.list",US="com.twilio.rtd.cds.map",FS="twilio.sync.event",en=function(e){xr.default(r,e);var t=_Y(r);function r(n){var a,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(gt.default(this,r),a=t.call(this),!n)throw new Error("Sync library needs a valid Twilio token to be passed");i.hasOwnProperty("logLevel")?_t.setLevel(i.logLevel):_t.setLevel("silent");var s=i.productId=i.productId||$Y;i.clientMetadata=i.clientMetadata||{},i.clientMetadata.hasOwnProperty("type")||(i.clientMetadata.type="sync"),i.clientMetadata.hasOwnProperty("sdk")||(i.clientMetadata.sdk="JS",i.clientMetadata.sdkv=Op);var o=!i.twilsockClient;if(!i.initRegistrations){var u=new Wc.InitRegistration(s);r.populateInitRegistrations(u),i.initRegistrations=[u]}var l=i.twilsockClient=i.twilsockClient||new Wc.Twilsock(n,s,i);l.on("tokenAboutToExpire",function(b){return a.emit("tokenAboutToExpire",b)}),l.on("tokenExpired",function(){return a.emit("tokenExpired")}),l.on("connectionError",function(b){return a.emit("connectionError",b)}),l.on("stateChanged",function(b){a.emit("connectionStateChanged",b),a.services.subscriptions.onConnectionStateChanged(b==="connected")}),l.on("message",function(b,$){return a._routeMessage(b,$)});var c=new WJ(i),h=new XJ(new yY(Op),c,l),w=new ZJ(c);return a.services={config:c,twilsock:l,network:h,storage:w,router:Jn.default(a),subscriptions:null},a.services.subscriptions=new VJ(a.services),a.entities=new gY,o&&l.connect(),a}return $t.default(r,[{key:"_routeMessage",value:function(a,i){switch(_t.trace("Notification type:",a,"content:",i),a){case LS:case jS:case US:this.services.subscriptions.acceptMessage(i,!1);break;case FS:this.services.subscriptions.acceptMessage(i,!0);break}}},{key:"_subscribe",value:function(a,i){this.services.subscriptions.add(a,i)}},{key:"_unsubscribe",value:function(a){this.services.subscriptions.remove(a)}},{key:"connectionState",get:function(){return this.services.twilsock.state}},{key:"ensureReady",value:function(){var n=Me.default(V.default.mark(function i(){var s;return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.services.config.sessionStorageEnabled){u.next=2;break}return u.abrupt("return");case 2:return u.prev=2,u.next=5,this.services.twilsock.storageId();case 5:s=u.sent,this.services.storage.updateStorageId(s.id),u.next=12;break;case 9:u.prev=9,u.t0=u.catch(2),_t.warn("Failed to initialize storage",u.t0);case 12:case"end":return u.stop()}},i,this,[[2,9]])}));function a(){return n.apply(this,arguments)}return a}()},{key:"storeRootInSessionCache",value:function(a,i,s){if(!(!this.services.config.sessionStorageEnabled||!i)){var o=On(s);(a===tr.type||a===nr.type)&&(o.last_event_id=null,delete o.items),this.services.storage.store(a,i,o)}}},{key:"readRootFromSessionCache",value:function(a,i){return!this.services.config.sessionStorageEnabled||!i?null:this.services.storage.read(a,i)}},{key:"_get",value:function(){var n=Me.default(V.default.mark(function i(s,o){var u,l,c,h=arguments;return V.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(u=h.length>2&&h[2]!==void 0?h[2]:!1,o){b.next=3;break}throw new Dr("Cannot get entity without id",404);case 3:return l=new ho(s).pathSegment(o).queryParam("Include",u?"items":void 0).build(),b.next=6,this.services.network.get(l);case 6:return c=b.sent,b.abrupt("return",c.body);case 8:case"end":return b.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"_createDocument",value:function(a,i,s){var o={unique_name:a,data:i||{}};return s!==void 0&&(o.ttl=s),this.services.network.post(this.services.config.documentsUri,o).then(function(u){return u.body.data=o.data,u.body})}},{key:"_getDocument",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.readRootFromSessionCache(fn.type,s)||this._get(this.services.config.documentsUri,s));case 1:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_createList",value:function(a,i,s,o){var u={unique_name:a,purpose:i,context:s};return o!==void 0&&(u.ttl=o),this.services.network.post(this.services.config.listsUri,u).then(function(l){return l.body})}},{key:"_getList",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.readRootFromSessionCache(tr.type,s)||this._get(this.services.config.listsUri,s));case 1:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_createMap",value:function(a,i){var s={unique_name:a};return i!==void 0&&(s.ttl=i),this.services.network.post(this.services.config.mapsUri,s).then(function(o){return o.body})}},{key:"_getMap",value:function(){var n=Me.default(V.default.mark(function i(s){var o,u=arguments;return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=u.length>1&&u[1]!==void 0?u[1]:!1,c.abrupt("return",this.readRootFromSessionCache(nr.type,s)||this._get(this.services.config.mapsUri,s,o));case 2:case"end":return c.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_getStream",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.readRootFromSessionCache(zn.type,s)||this._get(this.services.config.streamsUri,s,!1));case 1:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_createStream",value:function(){var n=Me.default(V.default.mark(function i(s,o){var u,l;return V.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u={unique_name:s},o!==void 0&&(u.ttl=o),h.next=4,this.services.network.post(this.services.config.streamsUri,u);case 4:return l=h.sent,h.abrupt("return",l.body);case 6:case"end":return h.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"_getLiveQuery",value:function(a){return this.readRootFromSessionCache(ya.type,a)}},{key:"getCached",value:function(a,i){return a&&this.entities.get(a,i)||null}},{key:"removeFromCacheAndSession",value:function(a,i,s){this.entities.remove(i),this.services.config.sessionStorageEnabled&&this.services.storage.remove(a,i,s)}},{key:"document",value:function(){var n=Me.default(V.default.mark(function i(s){var o=this,u,l,c,h;return V.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(u=ec(s),u.mode!=="create_new"){b.next=9;break}return b.next=6,this._createDocument(u.id,u.data,u.ttl);case 6:l=b.sent,b.next=39;break;case 9:if(c=this.getCached(u.id,fn.type),!c){b.next=14;break}return b.abrupt("return",new fn(c));case 14:return b.prev=14,b.next=17,this._getDocument(u.id);case 17:l=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||u.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createDocument(u.id,u.data,u.ttl);case 29:l=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.document(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(fn.type,u.id,l),h=new ch(this.services,l,function($,A,x){return o.removeFromCacheAndSession($,A,x)}),h=this.entities.store(h),b.abrupt("return",new fn(h));case 43:case"end":return b.stop()}},i,this,[[14,20],[26,32]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"map",value:function(){var n=Me.default(V.default.mark(function i(s){var o=this,u,l,c,h;return V.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(u=ec(s),u.mode!=="create_new"){b.next=9;break}return b.next=6,this._createMap(u.id,u.ttl);case 6:l=b.sent,b.next=39;break;case 9:if(c=this.getCached(u.id,nr.type),!c){b.next=14;break}return b.abrupt("return",new nr(c));case 14:return b.prev=14,b.next=17,this._getMap(u.id,u.includeItems);case 17:l=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||u.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createMap(u.id,u.ttl);case 29:l=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.map(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(nr.type,u.id,l),h=new ph(this.services,l,function($,A,x){return o.removeFromCacheAndSession($,A,x)}),h=this.entities.store(h),b.abrupt("return",new nr(h));case 43:case"end":return b.stop()}},i,this,[[14,20],[26,32]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"list",value:function(){var n=Me.default(V.default.mark(function i(s){var o=this,u,l,c,h;return V.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(u=ec(s),u.mode!=="create_new"){b.next=9;break}return b.next=6,this._createList(u.id,u.purpose,u.context,u.ttl);case 6:l=b.sent,b.next=39;break;case 9:if(c=this.getCached(u.id,tr.type),!c){b.next=14;break}return b.abrupt("return",new tr(c));case 14:return b.prev=14,b.next=17,this._getList(u.id);case 17:l=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||u.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createList(u.id,u.purpose,u.context,u.ttl);case 29:l=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.list(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(tr.type,u.id,l),h=new dh(this.services,l,function($,A,x){return o.removeFromCacheAndSession($,A,x)}),h=this.entities.store(h),b.abrupt("return",new tr(h));case 43:case"end":return b.stop()}},i,this,[[14,20],[26,32]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"stream",value:function(){var n=Me.default(V.default.mark(function i(s){var o=this,u,l,c,h,w;return V.default.wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,this.ensureReady();case 2:if(u=ec(s),u.mode!=="create_new"){$.next=9;break}return $.next=6,this._createStream(u.id,u.ttl);case 6:l=$.sent,$.next=39;break;case 9:if(c=this.getCached(u.id,zn.type),!c){$.next=14;break}return $.abrupt("return",new zn(c));case 14:return $.prev=14,$.next=17,this._getStream(u.id);case 17:l=$.sent,$.next=39;break;case 20:if($.prev=20,$.t0=$.catch(14),!($.t0.status!==404||u.mode==="open_existing")){$.next=26;break}throw $.t0;case 26:return $.prev=26,$.next=29,this._createStream(u.id,u.ttl);case 29:l=$.sent,$.next=39;break;case 32:if($.prev=32,$.t1=$.catch(26),$.t1.status!==409){$.next=38;break}return $.abrupt("return",this.stream(s));case 38:throw $.t1;case 39:return this.storeRootInSessionCache(zn.type,u.id,l),h=function(x,U,B){return o.removeFromCacheAndSession(x,U,B)},w=new Bu(this.services,l,h),w=this.entities.store(w),$.abrupt("return",new zn(w));case 44:case"end":return $.stop()}},i,this,[[14,20],[26,32]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"shutdown",value:function(){var n=Me.default(V.default.mark(function i(){return V.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.services.subscriptions.shutdown();case 2:return o.next=4,this.services.twilsock.disconnect();case 4:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"updateToken",value:function(){var n=Me.default(V.default.mark(function i(s){return V.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.services.twilsock.updateToken(s).catch(function(l){var c,h=l==null||(c=l.reply)===null||c===void 0?void 0:c.status;throw(h==null?void 0:h.code)===401&&(h==null?void 0:h.status)==="UNAUTHORIZED"?new Dr("Updated token was rejected by server",400,51130):l}));case 1:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"liveQuery",value:function(){var n=Me.default(V.default.mark(function i(s,o){var u=this,l,c,h,w,b;return V.default.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this.ensureReady();case 2:return l=new ho(this.services.config.insightsUri).pathSegment(s).pathSegment("Items").build(),A.next=5,mC({network:this.services.network,uri:l,queryString:o,type:ya.type});case 5:return c=A.sent,h=this.getCached(c.query_id,ya.type),h||(w=this._getLiveQuery(c.query_id),w||(w={indexName:s,queryExpression:o,sid:c.query_id,queryUri:l,last_event_id:c.last_event_id}),b=function(U,B,ve){return u.removeFromCacheAndSession(U,B,ve)},h=new vh(w,this.services,b,c.items)),this.storeRootInSessionCache(ya.type,c.query_id,h.liveQueryDescriptor),h=this.entities.store(h),A.abrupt("return",new ya(h));case 11:case"end":return A.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"instantQuery",value:function(){var n=Me.default(V.default.mark(function i(s){var o=this,u;return V.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.ensureReady();case 2:return u=function(w,b){return o.liveQuery(w,b)},c.abrupt("return",new ml({indexName:s,network:this.services.network,insightsUri:this.services.config.insightsUri,liveQueryCreator:u}));case 4:case"end":return c.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()}],[{key:"populateInitRegistrations",value:function(a){a.populateInitRegistrations([FS,LS,jS,US])}},{key:"version",get:function(){return Op}}]),r}(Et);Tt.default(en,"connectionStateChanged","connectionStateChanged");Tt.default(en,"connectionError","connectionError");Tt.default(en,"tokenAboutToExpire","tokenAboutToExpire");Tt.default(en,"tokenExpired","tokenExpired");wt([$e.validateTypesAsync(["undefined","string",$e.objectSchema("open document options",{id:["string","undefined"],mode:[$e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[$e.nonNegativeInteger,"undefined"],data:[$e.pureObject,"undefined",$e.literal(null)]})]),Ie("design:type",Function),Ie("design:paramtypes",[Object]),Ie("design:returntype",Promise)],en.prototype,"document",null);wt([$e.validateTypesAsync(["undefined","string",$e.objectSchema("open map options",{id:["string","undefined"],mode:[$e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[$e.nonNegativeInteger,"undefined"],data:[$e.pureObject,"undefined",$e.literal(null)],includeItems:["boolean","undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[Object]),Ie("design:returntype",Promise)],en.prototype,"map",null);wt([$e.validateTypesAsync(["undefined","string",$e.objectSchema("open list options",{id:["string","undefined"],mode:[$e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[$e.nonNegativeInteger,"undefined"],data:[$e.pureObject,"undefined",$e.literal(null)],purpose:["string","undefined"],context:[$e.pureObject,"undefined"],includeItems:["boolean","undefined"]})]),Ie("design:type",Function),Ie("design:paramtypes",[Object]),Ie("design:returntype",Promise)],en.prototype,"list",null);wt([$e.validateTypesAsync(["undefined","string",$e.objectSchema("open stream options",{id:["string","undefined"],mode:[$e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[$e.nonNegativeInteger,"undefined"],data:[$e.pureObject,"undefined",$e.literal(null)]})]),Ie("design:type",Function),Ie("design:paramtypes",[Object]),Ie("design:returntype",Promise)],en.prototype,"stream",null);wt([$e.validateTypesAsync($e.nonEmptyString),Ie("design:type",Function),Ie("design:paramtypes",[String]),Ie("design:returntype",Promise)],en.prototype,"updateToken",null);wt([$e.validateTypesAsync($e.nonEmptyString,"string"),Ie("design:type",Function),Ie("design:paramtypes",[String,String]),Ie("design:returntype",Promise)],en.prototype,"liveQuery",null);wt([$e.validateTypesAsync($e.nonEmptyString),Ie("design:type",Function),Ie("design:paramtypes",[String]),Ie("design:returntype",Promise)],en.prototype,"instantQuery",null);Br.Client=en;Br.InsightsItem=bY;Br.InstantQuery=ml;Br.LiveQuery=ya;Br.Paginator=Sg;Br.SyncClient=en;Br.SyncDocument=fn;Br.SyncList=tr;Br.SyncListItem=fh;Br.SyncMap=nr;Br.SyncMapItem=fu;Br.SyncStream=zn;var bC={},TY=VE,kY=TypeError,wC=function(e){if(TY(e))throw kY("The method doesn't accept regular expressions");return e},EY=Pt,CY=EY("match"),_C=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[CY]=!1,"/./"[e](t)}catch{}}return!1},IY=ot,SC=et,RY=Xn.f,AY=Ia,DS=lr,OY=wC,PY=ea,MY=_C,BS=SC("".startsWith),xY=SC("".slice),NY=Math.min,$C=MY("startsWith"),LY=!$C&&!!function(){var e=RY(String.prototype,"startsWith");return e&&!e.writable}();IY({target:"String",proto:!0,forced:!LY&&!$C},{startsWith:function(t){var r=DS(PY(this));OY(t);var n=AY(NY(arguments.length>1?arguments[1]:void 0,r.length)),a=DS(t);return BS?BS(r,a,n):xY(r,n,n+a.length)===a}});var jY=ot,UY=vg.left,FY=cl,qS=us,DY=sl,BY=FY("reduce"),qY=!DY&&qS>79&&qS<83;jY({target:"Array",proto:!0,forced:!BY||qY},{reduce:function(t){var r=arguments.length;return UY(this,t,r,r>1?arguments[1]:void 0)}});var HY=nt,WY=Pt,GY=Dx,zY=WY("iterator"),TC=!HY(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach(function(n,a){t.delete("b"),r+=a+n}),GY&&!e.toJSON||!t.sort||e.href!=="http://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[zY]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||r!=="a1c3"||new URL("http://x",void 0).host!=="x"}),HS=Xh.exports,VY=er,KY=function(e,t,r){return r.get&&HS(r.get,t,{getter:!0}),r.set&&HS(r.set,t,{setter:!0}),VY.f(e,t,r)},gs=et,Pp=2147483647,Su=36,kC=1,yh=26,JY=38,YY=700,QY=72,XY=128,ZY="-",eQ=/[^\0-\u007E]/,EC=/[.\u3002\uFF0E\uFF61]/g,WS="Overflow: input needs wider integers to process",Mp=Su-kC,GS=RangeError,tQ=gs(EC.exec),Vs=Math.floor,xp=String.fromCharCode,zS=gs("".charCodeAt),CC=gs([].join),Xa=gs([].push),rQ=gs("".replace),nQ=gs("".split),aQ=gs("".toLowerCase),iQ=function(e){for(var t=[],r=0,n=e.length;r<n;){var a=zS(e,r++);if(a>=55296&&a<=56319&&r<n){var i=zS(e,r++);(i&64512)==56320?Xa(t,((a&1023)<<10)+(i&1023)+65536):(Xa(t,a),r--)}else Xa(t,a)}return t},VS=function(e){return e+22+75*(e<26)},sQ=function(e,t,r){var n=0;for(e=r?Vs(e/YY):e>>1,e+=Vs(e/t);e>Mp*yh>>1;)e=Vs(e/Mp),n+=Su;return Vs(n+(Mp+1)*e/(e+JY))},oQ=function(e){var t=[];e=iQ(e);var r=e.length,n=XY,a=0,i=QY,s,o;for(s=0;s<e.length;s++)o=e[s],o<128&&Xa(t,xp(o));var u=t.length,l=u;for(u&&Xa(t,ZY);l<r;){var c=Pp;for(s=0;s<e.length;s++)o=e[s],o>=n&&o<c&&(c=o);var h=l+1;if(c-n>Vs((Pp-a)/h))throw GS(WS);for(a+=(c-n)*h,n=c,s=0;s<e.length;s++){if(o=e[s],o<n&&++a>Pp)throw GS(WS);if(o==n){for(var w=a,b=Su;;){var $=b<=i?kC:b>=i+yh?yh:b-i;if(w<$)break;var A=w-$,x=Su-$;Xa(t,xp(VS($+A%x))),w=Vs(A/x),b+=Su}Xa(t,xp(VS(w))),i=sQ(a,h,l==u),a=0,l++}}a++,n++}return CC(t,"")},uQ=function(e){var t=[],r=nQ(rQ(aQ(e),EC,"."),"."),n,a;for(n=0;n<r.length;n++)a=r[n],Xa(t,tQ(eQ,a)?"xn--"+oQ(a):a);return CC(t,".")},gh=ot,yo=ct,tc=At,Qn=et,lQ=qt,IC=TC,RC=Tr,cQ=Vy,fQ=Ra,dQ=DT,kg=yn,AC=ps,Np=Ot,pQ=Vt,vQ=Oa,hQ=Aa,yQ=Jt,OC=zt,Vr=lr,gQ=gi,KS=ss,mh=If,mQ=ll,Ls=yy,bQ=Pt,wQ=yg,_Q=bQ("iterator"),bl="URLSearchParams",PC=bl+"Iterator",MC=kg.set,Tn=kg.getterFor(bl),SQ=kg.getterFor(PC),$Q=Object.getOwnPropertyDescriptor,Eg=function(e){if(!lQ)return yo[e];var t=$Q(yo,e);return t&&t.value},JS=Eg("fetch"),Gc=Eg("Request"),$u=Eg("Headers"),Lp=Gc&&Gc.prototype,YS=$u&&$u.prototype,TQ=yo.RegExp,kQ=yo.TypeError,xC=yo.decodeURIComponent,EQ=yo.encodeURIComponent,CQ=Qn("".charAt),QS=Qn([].join),Vi=Qn([].push),bh=Qn("".replace),IQ=Qn([].shift),XS=Qn([].splice),ZS=Qn("".split),RQ=Qn("".slice),AQ=/\+/g,e0=Array(4),OQ=function(e){return e0[e-1]||(e0[e-1]=TQ("((?:%[\\da-f]{2}){"+e+"})","gi"))},PQ=function(e){try{return xC(e)}catch{return e}},t0=function(e){var t=bh(e,AQ," "),r=4;try{return xC(t)}catch{for(;r;)t=bh(t,OQ(r--),PQ);return t}},MQ=/[!'()~]|%20/g,xQ={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},NQ=function(e){return xQ[e]},r0=function(e){return bh(EQ(e),MQ,NQ)},jp=dQ(function(t,r){MC(this,{type:PC,iterator:mh(Tn(t).entries),kind:r})},"Iterator",function(){var t=SQ(this),r=t.kind,n=t.iterator.next(),a=n.value;return n.done||(n.value=r==="keys"?a.key:r==="values"?a.value:[a.key,a.value]),n},!0),NC=function(e){this.entries=[],this.url=null,e!==void 0&&(OC(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?CQ(e,0)==="?"?RQ(e,1):e:Vr(e)))};NC.prototype={type:bl,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t=mQ(e),r,n,a,i,s,o,u;if(t)for(r=mh(e,t),n=r.next;!(a=tc(n,r)).done;){if(i=mh(yQ(a.value)),s=i.next,(o=tc(s,i)).done||(u=tc(s,i)).done||!tc(s,i).done)throw kQ("Expected sequence with length 2");Vi(this.entries,{key:Vr(o.value),value:Vr(u.value)})}else for(var l in e)pQ(e,l)&&Vi(this.entries,{key:l,value:Vr(e[l])})},parseQuery:function(e){if(e)for(var t=ZS(e,"&"),r=0,n,a;r<t.length;)n=t[r++],n.length&&(a=ZS(n,"="),Vi(this.entries,{key:t0(IQ(a)),value:t0(QS(a,"="))}))},serialize:function(){for(var e=this.entries,t=[],r=0,n;r<e.length;)n=e[r++],Vi(t,r0(n.key)+"="+r0(n.value));return QS(t,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Zf=function(){AC(this,qu);var t=arguments.length>0?arguments[0]:void 0;MC(this,new NC(t))},qu=Zf.prototype;cQ(qu,{append:function(t,r){Ls(arguments.length,2);var n=Tn(this);Vi(n.entries,{key:Vr(t),value:Vr(r)}),n.updateURL()},delete:function(e){Ls(arguments.length,1);for(var t=Tn(this),r=t.entries,n=Vr(e),a=0;a<r.length;)r[a].key===n?XS(r,a,1):a++;t.updateURL()},get:function(t){Ls(arguments.length,1);for(var r=Tn(this).entries,n=Vr(t),a=0;a<r.length;a++)if(r[a].key===n)return r[a].value;return null},getAll:function(t){Ls(arguments.length,1);for(var r=Tn(this).entries,n=Vr(t),a=[],i=0;i<r.length;i++)r[i].key===n&&Vi(a,r[i].value);return a},has:function(t){Ls(arguments.length,1);for(var r=Tn(this).entries,n=Vr(t),a=0;a<r.length;)if(r[a++].key===n)return!0;return!1},set:function(t,r){Ls(arguments.length,1);for(var n=Tn(this),a=n.entries,i=!1,s=Vr(t),o=Vr(r),u=0,l;u<a.length;u++)l=a[u],l.key===s&&(i?XS(a,u--,1):(i=!0,l.value=o));i||Vi(a,{key:s,value:o}),n.updateURL()},sort:function(){var t=Tn(this);wQ(t.entries,function(r,n){return r.key>n.key?1:-1}),t.updateURL()},forEach:function(t){for(var r=Tn(this).entries,n=vQ(t,arguments.length>1?arguments[1]:void 0),a=0,i;a<r.length;)i=r[a++],n(i.value,i.key,this)},keys:function(){return new jp(this,"keys")},values:function(){return new jp(this,"values")},entries:function(){return new jp(this,"entries")}},{enumerable:!0});RC(qu,_Q,qu.entries,{name:"entries"});RC(qu,"toString",function(){return Tn(this).serialize()},{enumerable:!0});fQ(Zf,bl);gh({global:!0,constructor:!0,forced:!IC},{URLSearchParams:Zf});if(!IC&&Np($u)){var LQ=Qn(YS.has),jQ=Qn(YS.set),n0=function(e){if(OC(e)){var t=e.body,r;if(hQ(t)===bl)return r=e.headers?new $u(e.headers):new $u,LQ(r,"content-type")||jQ(r,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),gQ(e,{body:KS(0,Vr(t)),headers:KS(0,r)})}return e};if(Np(JS)&&gh({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return JS(t,arguments.length>1?n0(arguments[1]):{})}}),Np(Gc)){var Up=function(t){return AC(this,Lp),new Gc(t,arguments.length>1?n0(arguments[1]):{})};Lp.constructor=Up,Up.prototype=Lp,gh({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Up})}}var UQ={URLSearchParams:Zf,getState:Tn},FQ=ot,Cg=qt,DQ=TC,Ig=ct,a0=Oa,gn=et,zc=Tr,sn=KY,BQ=ps,wh=Vt,Rg=ZE,js=jT,$n=tl,qQ=ky.codeAt,HQ=uQ,ua=lr,WQ=Ra,GQ=yy,LC=UQ,jC=yn,zQ=jC.set,Vc=jC.getterFor("URL"),VQ=LC.URLSearchParams,KQ=LC.getState,su=Ig.URL,_h=Ig.TypeError,Kc=Ig.parseInt,JQ=Math.floor,i0=Math.pow,cn=gn("".charAt),Cn=gn(/./.exec),du=gn([].join),YQ=gn(1 .toString),QQ=gn([].pop),Ws=gn([].push),s0=gn("".replace),XQ=gn([].shift),ZQ=gn("".split),Tu=gn("".slice),Jc=gn("".toLowerCase),eX=gn([].unshift),tX="Invalid authority",Fp="Invalid scheme",Ui="Invalid host",o0="Invalid port",UC=/[a-z]/i,rX=/[\d+-.a-z]/i,Sh=/\d/,nX=/^0x/i,aX=/^[0-7]+$/,iX=/^\d+$/,FC=/^[\da-f]+$/i,sX=/[\0\t\n\r #%/:<>?@[\\\]^|]/,oX=/[\0\t\n\r #/:<>?@[\\\]^|]/,uX=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,lX=/[\t\n\r]/g,on,cX=function(e){var t=ZQ(e,"."),r,n,a,i,s,o,u;if(t.length&&t[t.length-1]==""&&t.length--,r=t.length,r>4)return e;for(n=[],a=0;a<r;a++){if(i=t[a],i=="")return e;if(s=10,i.length>1&&cn(i,0)=="0"&&(s=Cn(nX,i)?16:8,i=Tu(i,s==8?1:2)),i==="")o=0;else{if(!Cn(s==10?iX:s==8?aX:FC,i))return e;o=Kc(i,s)}Ws(n,o)}for(a=0;a<r;a++)if(o=n[a],a==r-1){if(o>=i0(256,5-r))return null}else if(o>255)return null;for(u=QQ(n),a=0;a<n.length;a++)u+=n[a]*i0(256,3-a);return u},fX=function(e){var t=[0,0,0,0,0,0,0,0],r=0,n=null,a=0,i,s,o,u,l,c,h,w=function(){return cn(e,a)};if(w()==":"){if(cn(e,1)!=":")return;a+=2,r++,n=r}for(;w();){if(r==8)return;if(w()==":"){if(n!==null)return;a++,r++,n=r;continue}for(i=s=0;s<4&&Cn(FC,w());)i=i*16+Kc(w(),16),a++,s++;if(w()=="."){if(s==0||(a-=s,r>6))return;for(o=0;w();){if(u=null,o>0)if(w()=="."&&o<4)a++;else return;if(!Cn(Sh,w()))return;for(;Cn(Sh,w());){if(l=Kc(w(),10),u===null)u=l;else{if(u==0)return;u=u*10+l}if(u>255)return;a++}t[r]=t[r]*256+u,o++,(o==2||o==4)&&r++}if(o!=4)return;break}else if(w()==":"){if(a++,!w())return}else if(w())return;t[r++]=i}if(n!==null)for(c=r-n,r=7;r!=0&&c>0;)h=t[r],t[r--]=t[n+c-1],t[n+--c]=h;else if(r!=8)return;return t},dX=function(e){for(var t=null,r=1,n=null,a=0,i=0;i<8;i++)e[i]!==0?(a>r&&(t=n,r=a),n=null,a=0):(n===null&&(n=i),++a);return a>r&&(t=n,r=a),t},ou=function(e){var t,r,n,a;if(typeof e=="number"){for(t=[],r=0;r<4;r++)eX(t,e%256),e=JQ(e/256);return du(t,".")}else if(typeof e=="object"){for(t="",n=dX(e),r=0;r<8;r++)a&&e[r]===0||(a&&(a=!1),n===r?(t+=r?":":"::",a=!0):(t+=YQ(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},mc={},DC=Rg({},mc,{" ":1,'"':1,"<":1,">":1,"`":1}),BC=Rg({},DC,{"#":1,"?":1,"{":1,"}":1}),Dp=Rg({},BC,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),za=function(e,t){var r=qQ(e,0);return r>32&&r<127&&!wh(t,e)?e:encodeURIComponent(e)},rc={ftp:21,file:null,http:80,https:443,ws:80,wss:443},pu=function(e,t){var r;return e.length==2&&Cn(UC,cn(e,0))&&((r=cn(e,1))==":"||!t&&r=="|")},u0=function(e){var t;return e.length>1&&pu(Tu(e,0,2))&&(e.length==2||(t=cn(e,2))==="/"||t==="\\"||t==="?"||t==="#")},pX=function(e){return e==="."||Jc(e)==="%2e"},vX=function(e){return e=Jc(e),e===".."||e==="%2e."||e===".%2e"||e==="%2e%2e"},Bp={},l0={},qp={},c0={},f0={},Hp={},d0={},p0={},nc={},ac={},Wp={},Gp={},zp={},Vp={},v0={},Kp={},Us={},qn={},h0={},Fi={},oa={},Ag=function(e,t,r){var n=ua(e),a,i,s;if(t){if(i=this.parse(n),i)throw _h(i);this.searchParams=null}else{if(r!==void 0&&(a=new Ag(r,!0)),i=this.parse(n,null,a),i)throw _h(i);s=KQ(new VQ),s.bindURL(this),this.searchParams=s}};Ag.prototype={type:"URL",parse:function(e,t,r){var n=this,a=t||Bp,i=0,s="",o=!1,u=!1,l=!1,c,h,w,b;for(e=ua(e),t||(n.scheme="",n.username="",n.password="",n.host=null,n.port=null,n.path=[],n.query=null,n.fragment=null,n.cannotBeABaseURL=!1,e=s0(e,uX,"")),e=s0(e,lX,""),c=js(e);i<=c.length;){switch(h=c[i],a){case Bp:if(h&&Cn(UC,h))s+=Jc(h),a=l0;else{if(t)return Fp;a=qp;continue}break;case l0:if(h&&(Cn(rX,h)||h=="+"||h=="-"||h=="."))s+=Jc(h);else if(h==":"){if(t&&(n.isSpecial()!=wh(rc,s)||s=="file"&&(n.includesCredentials()||n.port!==null)||n.scheme=="file"&&!n.host))return;if(n.scheme=s,t){n.isSpecial()&&rc[n.scheme]==n.port&&(n.port=null);return}s="",n.scheme=="file"?a=Vp:n.isSpecial()&&r&&r.scheme==n.scheme?a=c0:n.isSpecial()?a=p0:c[i+1]=="/"?(a=f0,i++):(n.cannotBeABaseURL=!0,Ws(n.path,""),a=h0)}else{if(t)return Fp;s="",a=qp,i=0;continue}break;case qp:if(!r||r.cannotBeABaseURL&&h!="#")return Fp;if(r.cannotBeABaseURL&&h=="#"){n.scheme=r.scheme,n.path=$n(r.path),n.query=r.query,n.fragment="",n.cannotBeABaseURL=!0,a=oa;break}a=r.scheme=="file"?Vp:Hp;continue;case c0:if(h=="/"&&c[i+1]=="/")a=nc,i++;else{a=Hp;continue}break;case f0:if(h=="/"){a=ac;break}else{a=qn;continue}case Hp:if(n.scheme=r.scheme,h==on)n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=$n(r.path),n.query=r.query;else if(h=="/"||h=="\\"&&n.isSpecial())a=d0;else if(h=="?")n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=$n(r.path),n.query="",a=Fi;else if(h=="#")n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=$n(r.path),n.query=r.query,n.fragment="",a=oa;else{n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=$n(r.path),n.path.length--,a=qn;continue}break;case d0:if(n.isSpecial()&&(h=="/"||h=="\\"))a=nc;else if(h=="/")a=ac;else{n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,a=qn;continue}break;case p0:if(a=nc,h!="/"||cn(s,i+1)!="/")continue;i++;break;case nc:if(h!="/"&&h!="\\"){a=ac;continue}break;case ac:if(h=="@"){o&&(s="%40"+s),o=!0,w=js(s);for(var $=0;$<w.length;$++){var A=w[$];if(A==":"&&!l){l=!0;continue}var x=za(A,Dp);l?n.password+=x:n.username+=x}s=""}else if(h==on||h=="/"||h=="?"||h=="#"||h=="\\"&&n.isSpecial()){if(o&&s=="")return tX;i-=js(s).length+1,s="",a=Wp}else s+=h;break;case Wp:case Gp:if(t&&n.scheme=="file"){a=Kp;continue}else if(h==":"&&!u){if(s=="")return Ui;if(b=n.parseHost(s),b)return b;if(s="",a=zp,t==Gp)return}else if(h==on||h=="/"||h=="?"||h=="#"||h=="\\"&&n.isSpecial()){if(n.isSpecial()&&s=="")return Ui;if(t&&s==""&&(n.includesCredentials()||n.port!==null))return;if(b=n.parseHost(s),b)return b;if(s="",a=Us,t)return;continue}else h=="["?u=!0:h=="]"&&(u=!1),s+=h;break;case zp:if(Cn(Sh,h))s+=h;else if(h==on||h=="/"||h=="?"||h=="#"||h=="\\"&&n.isSpecial()||t){if(s!=""){var U=Kc(s,10);if(U>65535)return o0;n.port=n.isSpecial()&&U===rc[n.scheme]?null:U,s=""}if(t)return;a=Us;continue}else return o0;break;case Vp:if(n.scheme="file",h=="/"||h=="\\")a=v0;else if(r&&r.scheme=="file")if(h==on)n.host=r.host,n.path=$n(r.path),n.query=r.query;else if(h=="?")n.host=r.host,n.path=$n(r.path),n.query="",a=Fi;else if(h=="#")n.host=r.host,n.path=$n(r.path),n.query=r.query,n.fragment="",a=oa;else{u0(du($n(c,i),""))||(n.host=r.host,n.path=$n(r.path),n.shortenPath()),a=qn;continue}else{a=qn;continue}break;case v0:if(h=="/"||h=="\\"){a=Kp;break}r&&r.scheme=="file"&&!u0(du($n(c,i),""))&&(pu(r.path[0],!0)?Ws(n.path,r.path[0]):n.host=r.host),a=qn;continue;case Kp:if(h==on||h=="/"||h=="\\"||h=="?"||h=="#"){if(!t&&pu(s))a=qn;else if(s==""){if(n.host="",t)return;a=Us}else{if(b=n.parseHost(s),b)return b;if(n.host=="localhost"&&(n.host=""),t)return;s="",a=Us}continue}else s+=h;break;case Us:if(n.isSpecial()){if(a=qn,h!="/"&&h!="\\")continue}else if(!t&&h=="?")n.query="",a=Fi;else if(!t&&h=="#")n.fragment="",a=oa;else if(h!=on&&(a=qn,h!="/"))continue;break;case qn:if(h==on||h=="/"||h=="\\"&&n.isSpecial()||!t&&(h=="?"||h=="#")){if(vX(s)?(n.shortenPath(),h!="/"&&!(h=="\\"&&n.isSpecial())&&Ws(n.path,"")):pX(s)?h!="/"&&!(h=="\\"&&n.isSpecial())&&Ws(n.path,""):(n.scheme=="file"&&!n.path.length&&pu(s)&&(n.host&&(n.host=""),s=cn(s,0)+":"),Ws(n.path,s)),s="",n.scheme=="file"&&(h==on||h=="?"||h=="#"))for(;n.path.length>1&&n.path[0]==="";)XQ(n.path);h=="?"?(n.query="",a=Fi):h=="#"&&(n.fragment="",a=oa)}else s+=za(h,BC);break;case h0:h=="?"?(n.query="",a=Fi):h=="#"?(n.fragment="",a=oa):h!=on&&(n.path[0]+=za(h,mc));break;case Fi:!t&&h=="#"?(n.fragment="",a=oa):h!=on&&(h=="'"&&n.isSpecial()?n.query+="%27":h=="#"?n.query+="%23":n.query+=za(h,mc));break;case oa:h!=on&&(n.fragment+=za(h,DC));break}i++}},parseHost:function(e){var t,r,n;if(cn(e,0)=="["){if(cn(e,e.length-1)!="]"||(t=fX(Tu(e,1,-1)),!t))return Ui;this.host=t}else if(this.isSpecial()){if(e=HQ(e),Cn(sX,e)||(t=cX(e),t===null))return Ui;this.host=t}else{if(Cn(oX,e))return Ui;for(t="",r=js(e),n=0;n<r.length;n++)t+=za(r[n],mc);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return wh(rc,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;t&&(this.scheme!="file"||t!=1||!pu(e[0],!0))&&e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,a=e.host,i=e.port,s=e.path,o=e.query,u=e.fragment,l=t+":";return a!==null?(l+="//",e.includesCredentials()&&(l+=r+(n?":"+n:"")+"@"),l+=ou(a),i!==null&&(l+=":"+i)):t=="file"&&(l+="//"),l+=e.cannotBeABaseURL?s[0]:s.length?"/"+du(s,"/"):"",o!==null&&(l+="?"+o),u!==null&&(l+="#"+u),l},setHref:function(e){var t=this.parse(e);if(t)throw _h(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if(e=="blob")try{return new go(e.path[0]).origin}catch{return"null"}return e=="file"||!this.isSpecial()?"null":e+"://"+ou(this.host)+(t!==null?":"+t:"")},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(ua(e)+":",Bp)},getUsername:function(){return this.username},setUsername:function(e){var t=js(ua(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=za(t[r],Dp)}},getPassword:function(){return this.password},setPassword:function(e){var t=js(ua(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=za(t[r],Dp)}},getHost:function(){var e=this.host,t=this.port;return e===null?"":t===null?ou(e):ou(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Wp)},getHostname:function(){var e=this.host;return e===null?"":ou(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Gp)},getPort:function(){var e=this.port;return e===null?"":ua(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(e=ua(e),e==""?this.port=null:this.parse(e,zp))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+du(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Us))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){e=ua(e),e==""?this.query=null:(cn(e,0)=="?"&&(e=Tu(e,1)),this.query="",this.parse(e,Fi)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){if(e=ua(e),e==""){this.fragment=null;return}cn(e,0)=="#"&&(e=Tu(e,1)),this.fragment="",this.parse(e,oa)},update:function(){this.query=this.searchParams.serialize()||null}};var go=function(t){var r=BQ(this,Pr),n=GQ(arguments.length,1)>1?arguments[1]:void 0,a=zQ(r,new Ag(t,!1,n));Cg||(r.href=a.serialize(),r.origin=a.getOrigin(),r.protocol=a.getProtocol(),r.username=a.getUsername(),r.password=a.getPassword(),r.host=a.getHost(),r.hostname=a.getHostname(),r.port=a.getPort(),r.pathname=a.getPathname(),r.search=a.getSearch(),r.searchParams=a.getSearchParams(),r.hash=a.getHash())},Pr=go.prototype,un=function(e,t){return{get:function(){return Vc(this)[e]()},set:t&&function(r){return Vc(this)[t](r)},configurable:!0,enumerable:!0}};Cg&&(sn(Pr,"href",un("serialize","setHref")),sn(Pr,"origin",un("getOrigin")),sn(Pr,"protocol",un("getProtocol","setProtocol")),sn(Pr,"username",un("getUsername","setUsername")),sn(Pr,"password",un("getPassword","setPassword")),sn(Pr,"host",un("getHost","setHost")),sn(Pr,"hostname",un("getHostname","setHostname")),sn(Pr,"port",un("getPort","setPort")),sn(Pr,"pathname",un("getPathname","setPathname")),sn(Pr,"search",un("getSearch","setSearch")),sn(Pr,"searchParams",un("getSearchParams")),sn(Pr,"hash",un("getHash","setHash")));zc(Pr,"toJSON",function(){return Vc(this).serialize()},{enumerable:!0});zc(Pr,"toString",function(){return Vc(this).serialize()},{enumerable:!0});if(su){var y0=su.createObjectURL,g0=su.revokeObjectURL;y0&&zc(go,"createObjectURL",a0(y0,su)),g0&&zc(go,"revokeObjectURL",a0(g0,su))}WQ(go,"URL");FQ({global:!0,constructor:!0,forced:!DQ,sham:!Cg},{URL:go});var Ir={};/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(Ir,"__esModule",{value:!0});var hX=Un.exports,yX=wi.exports,gX=_i.exports,mX=ra.exports,bX=Fn.exports,wX=Ln.exports,_X=jn.exports,SX=Xr.exports;function Ei(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var ao=Ei(hX),Ta=Ei(yX),Jp=Ei(gX),$X=Ei(mX),TX=Ei(bX),kX=Ei(wX),EX=Ei(_X),m0=Ei(SX),La=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function CX(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=IX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function IX(e,t){if(!!e){if(typeof e=="string")return b0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b0(e,t)}}function b0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var qC=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return La(function(a){var i=!1,s=[],o=CX(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;if(typeof l=="string"){i=i||ao.default(a)===l,s.push("of type ".concat(l));continue}i=i||a instanceof l,s.push("an instance of ".concat(l.name))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function RX(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=AX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function AX(e,t){if(!!e){if(typeof e=="string")return w0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w0(e,t)}}function w0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var OX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return La(function(a){var i=!1,s=[],o=RX(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;i=i||a===l,s.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function PX(e){var t=MX();return function(){var n=m0.default(e),a;if(t){var i=m0.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return EX.default(this,a)}}function MX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hu(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=xX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function xX(e,t){if(!!e){if(typeof e=="string")return _0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _0(e,t)}}function _0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ed=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=Hu(r.entries()),a;try{for(n.s();!(a=n.n()).done;){var i=Ta.default(a.value,2),s=i[0],o=i[1],u=rd(t[s],o),l=Ta.default(u,4),c=l[0],h=l[1],w=l[2],b=l[3];if(!c){var $=s+1;throw new Error("Argument ".concat($," is expected to be ").concat(w).concat(b," but got ").concat(h))}}}catch(A){n.e(A)}finally{n.f()}},HC=function(t){var r,n,a=["undefined","boolean","number","bigint","string"];if(a.includes(ao.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),ao.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var i;n=t===null?"null":"instance of ".concat(t==null||(i=t.constructor)===null||i===void 0?void 0:i.name)}return n||(n=ao.default(t)),n},NX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Og(r);return function(i){return function(s){kX.default(u,s);var o=PX(u);function u(){TX.default(this,u);for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return ed(a,c),o.call.apply(o,[this].concat(c))}return $X.default(u)}(i)}},LX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Og(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return ed(a,c),u.apply(this,c)}}},jX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Og(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];try{ed(a,c)}catch(w){return Promise.reject(w)}return u.apply(this,c)}}},Og=function(t){var r=[],n=Hu(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.push(td(i))}}catch(s){n.e(s)}finally{n.f()}return r},td=function(t){var r=[],n=Array.isArray(t)?t:[t],a=Hu(n),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;if(typeof s=="string"||typeof s=="function"){r.push(qC(s));continue}r.push(s)}}catch(o){a.e(o)}finally{a.f()}return r},rd=function(t,r){var n=[],a,i=!1,s=Hu(t),o;try{for(s.s();!(o=s.n()).done;){var u=o.value,l=Hu(u.checks),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,w=h(r),b=Ta.default(w,3),$=b[0],A=b[1],x=b[2];i=i||$,!a&&x&&(a=x),A&&(n=typeof A=="string"?[].concat(Jp.default(n),[A]):[].concat(Jp.default(n),Jp.default(A)))}}catch(se){l.e(se)}finally{l.f()}}}catch(se){s.e(se)}finally{s.f()}if(i)return[!0];var U=a||HC(r),B=n.length-1,ve=B>0?"".concat(n.slice(0,B).join(", ")," or ").concat(n[B]):n.join(", ");return[!1,U,ve,B>1?";":","]};function UX(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=FX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function FX(e,t){if(!!e){if(typeof e=="string")return S0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S0(e,t)}}function S0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var DX=function(t,r){return La(function(n){if(!Array.isArray(n)||n.length<1)return[!1,"a non-empty array of ".concat(t)];var a=UX(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=Ta.default(i.value,2),o=s[0],u=s[1],l=rd(td(r),u),c=Ta.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid non-empty array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})},BX=La(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),qX=La(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),HX=La(function(e){return[ao.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]}),WX=function(t,r){return La(function(n){if(ao.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var a=0,i=Object.entries(r);a<i.length;a++){var s=Ta.default(i[a],2),o=s[0],u=s[1],l=rd(td(u),n[o]),c=Ta.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"valid ".concat(t,' (key "').concat(o,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(o,'" is ').concat(w,")")]}return[!0]})};function GX(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=zX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function zX(e,t){if(!!e){if(typeof e=="string")return $0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $0(e,t)}}function $0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var VX=function(t,r){return La(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var a=GX(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=Ta.default(i.value,2),o=s[0],u=s[1],l=rd(td(r),u),c=Ta.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})};Ir.array=VX;Ir.custom=La;Ir.literal=OX;Ir.nonEmptyArray=DX;Ir.nonEmptyString=BX;Ir.nonNegativeInteger=qX;Ir.objectSchema=WX;Ir.pureObject=HX;Ir.runtimeTypeValidation=ed;Ir.stringifyReceivedType=HC;Ir.type=qC;Ir.validateConstructorTypes=NX;Ir.validateTypes=LX;Ir.validateTypesAsync=jX;/*
@license
Copyright (c) 2018, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/(function(e){var t=typeof t<"u"?t:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(e,"__esModule",{value:!0});var r=bi.exports,n=To.exports,a=fl,i=vs.exports,s=xa,o=Ir;function u(oe){return oe&&typeof oe=="object"&&"default"in oe?oe:{default:oe}}function l(oe){if(oe&&oe.__esModule)return oe;var F=Object.create(null);return oe&&Object.keys(oe).forEach(function(G){if(G!=="default"){var Q=Object.getOwnPropertyDescriptor(oe,G);Object.defineProperty(F,G,Q.get?Q:{enumerable:!0,get:function(){return oe[G]}})}}),F.default=oe,Object.freeze(F)}var c=u(r),h=u(n),w=u(a),b=l(i),$={exports:{}},A=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(A){var x=new Uint8Array(16);$.exports=function(){return A(x),x}}else{var U=new Array(16);$.exports=function(){for(var F=0,G;F<16;F++)(F&3)===0&&(G=Math.random()*4294967296),U[F]=G>>>((F&3)<<3)&255;return U}}for(var B=[],ve=0;ve<256;++ve)B[ve]=(ve+256).toString(16).substr(1);function se(oe,F){var G=F||0,Q=B;return[Q[oe[G++]],Q[oe[G++]],Q[oe[G++]],Q[oe[G++]],"-",Q[oe[G++]],Q[oe[G++]],"-",Q[oe[G++]],Q[oe[G++]],"-",Q[oe[G++]],Q[oe[G++]],"-",Q[oe[G++]],Q[oe[G++]],Q[oe[G++]],Q[oe[G++]],Q[oe[G++]],Q[oe[G++]]].join("")}var Re=se,ke=$.exports,de=Re,P,te,le=0,J=0;function xe(oe,F,G){var Q=F&&G||0,ye=F||[];oe=oe||{};var Ne=oe.node||P,qe=oe.clockseq!==void 0?oe.clockseq:te;if(Ne==null||qe==null){var ze=ke();Ne==null&&(Ne=P=[ze[0]|1,ze[1],ze[2],ze[3],ze[4],ze[5]]),qe==null&&(qe=te=(ze[6]<<8|ze[7])&16383)}var De=oe.msecs!==void 0?oe.msecs:new Date().getTime(),He=oe.nsecs!==void 0?oe.nsecs:J+1,Le=De-le+(He-J)/1e4;if(Le<0&&oe.clockseq===void 0&&(qe=qe+1&16383),(Le<0||De>le)&&oe.nsecs===void 0&&(He=0),He>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");le=De,J=He,te=qe,De+=122192928e5;var Z=((De&268435455)*1e4+He)%4294967296;ye[Q++]=Z>>>24&255,ye[Q++]=Z>>>16&255,ye[Q++]=Z>>>8&255,ye[Q++]=Z&255;var ae=De/4294967296*1e4&268435455;ye[Q++]=ae>>>8&255,ye[Q++]=ae&255,ye[Q++]=ae>>>24&15|16,ye[Q++]=ae>>>16&255,ye[Q++]=qe>>>8|128,ye[Q++]=qe&255;for(var q=0;q<6;++q)ye[Q+q]=Ne[q];return F||de(ye)}var re=xe,H=$.exports,ue=Re;function W(oe,F,G){var Q=F&&G||0;typeof oe=="string"&&(F=oe==="binary"?new Array(16):null,oe=null),oe=oe||{};var ye=oe.random||(oe.rng||H)();if(ye[6]=ye[6]&15|64,ye[8]=ye[8]&63|128,F)for(var Ne=0;Ne<16;++Ne)F[Q+Ne]=ye[Ne];return F||ue(ye)}var me=W,_e=re,N=me,ft=N;ft.v1=_e,ft.v4=N;var dt=ft;class Ee extends Promise{constructor(F){var G=dt.v4(),Q;super((ye,Ne)=>(Q=Ne,F(qe=>{Ee.cancellationMap.delete(G),ye(qe)},qe=>{Ee.cancellationMap.delete(G),Ne(qe)},qe=>{Ee.cancellationMap.set(G,qe)}))),this.id=G,this.rejectPromise=Q}cancel(){var F=Ee.cancellationMap.get(this.id);return F==null||F(),this.rejectPromise&&(this.catch(()=>{}),this.rejectPromise(new Error("Promise was cancelled"))),this}}c.default(Ee,"cancellationMap",new Map);function Xe(oe,F,G,Q){var ye=arguments.length,Ne=ye<3?F:Q===null?Q=Object.getOwnPropertyDescriptor(F,G):Q,qe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Ne=Reflect.decorate(oe,F,G,Q);else for(var ze=oe.length-1;ze>=0;ze--)(qe=oe[ze])&&(Ne=(ye<3?qe(Ne):ye>3?qe(F,G,Ne):qe(F,G))||Ne);return ye>3&&Ne&&Object.defineProperty(F,G,Ne),Ne}function Ye(oe,F){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(oe,F)}function D(oe,F){return["".concat(new Date().toISOString()," MCS Client ").concat(oe,":")].concat(Array.from(F))}class T{constructor(F){c.default(this,"prefix",""),this.prefix=F!=null&&F.length>0?F+" ":""}static scope(F){return new T(F)}setLevel(F){b.setLevel(F)}static setLevel(F){b.setLevel(F)}trace(){for(var F=arguments.length,G=new Array(F),Q=0;Q<F;Q++)G[Q]=arguments[Q];b.trace.apply(null,D(this.prefix+"T",G))}debug(){for(var F=arguments.length,G=new Array(F),Q=0;Q<F;Q++)G[Q]=arguments[Q];b.debug.apply(null,D(this.prefix+"D",G))}info(){for(var F=arguments.length,G=new Array(F),Q=0;Q<F;Q++)G[Q]=arguments[Q];b.info.apply(null,D(this.prefix+"I",G))}warn(){for(var F=arguments.length,G=new Array(F),Q=0;Q<F;Q++)G[Q]=arguments[Q];b.warn.apply(null,D(this.prefix+"W",G))}error(){for(var F=arguments.length,G=new Array(F),Q=0;Q<F;Q++)G[Q]=arguments[Q];b.error.apply(null,D(this.prefix+"E",G))}static trace(){for(var F=arguments.length,G=new Array(F),Q=0;Q<F;Q++)G[Q]=arguments[Q];b.trace.apply(null,D("T",G))}static debug(){for(var F=arguments.length,G=new Array(F),Q=0;Q<F;Q++)G[Q]=arguments[Q];b.debug.apply(null,D("D",G))}static info(){for(var F=arguments.length,G=new Array(F),Q=0;Q<F;Q++)G[Q]=arguments[Q];b.info.apply(null,D("I",G))}static warn(){for(var F=arguments.length,G=new Array(F),Q=0;Q<F;Q++)G[Q]=arguments[Q];b.warn.apply(null,D("W",G))}static error(){for(var F=arguments.length,G=new Array(F),Q=0;Q<F;Q++)G[Q]=arguments[Q];b.error.apply(null,D("E",G))}}var Te=1e3,he=4e3,Ke=3,Qe=!0,Se=oe=>"https://mcs.".concat(oe!=null?oe:"us1",".twilio.com"),Ge=oe=>oe.startsWith("http"),R=(oe,F)=>"".concat(Ge(oe)?"":Se(F)).concat(oe);class C{constructor(F,G,Q,ye){var Ne,qe,ze,De,He,Le,Z=(Ne=(qe=ye.MCS)!==null&&qe!==void 0?qe:ye)!==null&&Ne!==void 0?Ne:{};this.region=(ze=(De=Z.region)!==null&&De!==void 0?De:ye.region)!==null&&ze!==void 0?ze:"us1",this.mediaUrl=R(G,this.region),this.mediaSetUrl=Q?R(Q):"".concat(this.mediaUrl,"Set"),this.token=F,this.retryWhenThrottledOverride=(He=Z.retryWhenThrottledOverride)!==null&&He!==void 0?He:Qe,this.backoffConfigOverride=(Le=Z.backoffConfigOverride)!==null&&Le!==void 0?Le:C.backoffConfigDefault}static get backoffConfigDefault(){return{min:Te,max:he,maxAttemptsCount:Ke}}static get retryWhenThrottledDefault(){return Qe}updateToken(F){this.token=F}}class Y{constructor(F,G,Q){this.config=F,this.network=G,this._update(Q)}get sid(){return this.state.sid}get serviceSid(){return this.state.serviceSid}get dateCreated(){return this.state.dateCreated}get dateUpdated(){return this.state.dateUpdated}get contentType(){return this.state.contentType}get size(){return this.state.size}get fileName(){return this.state.filename}get filename(){return this.state.filename}get category(){return this.state.category}getContentUrl(){var F=this;return new Ee(function(){var G=h.default(w.default.mark(function Q(ye,Ne,qe){var ze,De;return w.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return ze=F.network.get("".concat(F.config.mediaUrl,"/").concat(F.sid)),qe(()=>ze.cancel()),Le.prev=2,Le.next=5,ze;case 5:De=Le.sent,F._update(De.body),ye(F.state.contentDirectUrl),Le.next=13;break;case 10:Le.prev=10,Le.t0=Le.catch(2),Ne(Le.t0);case 13:case"end":return Le.stop()}},Q,null,[[2,10]])}));return function(Q,ye,Ne){return G.apply(this,arguments)}}())}_update(F){var G,Q,ye,Ne;this.state={sid:F.sid,serviceSid:F.service_sid,channelSid:F.channel_sid,messageSid:F.message_sid,dateCreated:F.date_created?new Date(F.date_created):null,dateUploadUpdated:F.date_upload_updated?new Date(F.date_upload_updated):null,dateUpdated:F.date_updated?new Date(F.date_updated):null,size:F.size,contentType:F.content_type,author:F.author,url:F.url,contentUrl:F.links.content,contentDirectUrl:(G=F.links.content_direct_temporary)!==null&&G!==void 0?G:null,filename:(Q=F.filename)!==null&&Q!==void 0?Q:null,category:(ye=F.category)!==null&&ye!==void 0?ye:"media",isMultipartUpstream:(Ne=F.is_multipart_upstream)!==null&&Ne!==void 0?Ne:!1}}}class pe extends Error{constructor(F,G,Q,ye,Ne){super(F),this.code=G,this.body=Q,this.status=ye,this.headers=Ne}}var z=t.XMLHttpRequest||{};function Oe(oe){return oe?oe.split(`\r
`).map(F=>F.split(": ")).filter(F=>F.length===2&&F[1].length>0).reduce((F,G)=>(F[G[0]]=G[1],F),{}):{}}function be(oe){var F=oe.getResponseHeader("Content-Type");if(!F||F.indexOf("application/json")!==0||oe.responseText.length===0)return oe.responseText;try{return JSON.parse(oe.responseText)}catch{return oe.responseText}}class we{static request(F,G,Q,ye){return new Ee((Ne,qe,ze)=>{var De=new z,He=!1;ze(()=>{De.abort(),He=!0}),De.open(F,G,!0),De.onreadystatechange=function(){if(!(De.readyState!==4||He)){var ae=Oe(De.getAllResponseHeaders()),q=be(De);if(200<=De.status&&De.status<300)Ne({status:De.status,headers:ae,body:q});else{var K,ne=(K=De.statusText)!==null&&K!==void 0?K:"NONE",ge;if(typeof q=="string")if(q&&q.split(`
`,2).length===1)ge=q;else{var ce,je=(ce=q.replace(/<.*?>/g,"").split(/\r\n/g).filter(at=>at.length)[0])===null||ce===void 0?void 0:ce.split(" ");ge=(je==null?void 0:je.length)>2?je==null?void 0:je.slice(1).join(" "):""}else ge=JSON.stringify(q);var Ve="".concat(De.status,": [").concat(ne,"] ").concat(ge);qe(new pe(Ve,De.status,q,ne,ae))}}};for(var Le in Q)De.setRequestHeader(Le,Q[Le]),Le==="Content-Type"&&Q[Le]==="application/json"&&(ye=JSON.stringify(ye));De.send(ye)})}get(F,G){return we.request("GET",F,G)}post(F,G,Q){return we.request("POST",F,G,Q)}}var Ae=T.scope("Network");class ee{constructor(F,G){this.config=F,this.transport=G}backoffConfig(){return Object.assign(C.backoffConfigDefault,this.config.backoffConfigOverride)}retryWhenThrottled(){var F,G;return(F=(G=this.config.retryWhenThrottledOverride)!==null&&G!==void 0?G:C.retryWhenThrottledDefault)!==null&&F!==void 0?F:!1}executeWithRetry(F,G){var Q=this;return new Ee(function(){var ye=h.default(w.default.mark(function Ne(qe,ze,De){var He,Le;return w.default.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:He=new s.Retrier(Q.backoffConfig()),Le=[502,503,504],G&&Le.push(429),De(()=>{He.cancel(),He.removeAllListeners()}),He.on("attempt",h.default(w.default.mark(function q(){var K,ne;return w.default.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.prev=0,K=F(),De(()=>{K.cancel(),He.cancel(),He.removeAllListeners()}),ce.next=5,K;case 5:ne=ce.sent,He.succeeded(ne),ce.next=12;break;case 9:ce.prev=9,ce.t0=ce.catch(0),Le.indexOf(ce.t0.status)>-1||ce.t0.message==="Twilsock disconnected"?He.failed(ce.t0):(He.removeAllListeners(),He.cancel(),ze(ce.t0));case 12:case"end":return ce.stop()}},q,null,[[0,9]])}))),He.on("succeeded",q=>{qe(q)}),He.on("cancelled",q=>ze(q)),He.on("failed",q=>ze(q)),He.start();case 9:case"end":return ae.stop()}},Ne)}));return function(Ne,qe,ze){return ye.apply(this,arguments)}}())}get(F){var G=this;return new Ee(function(){var Q=h.default(w.default.mark(function ye(Ne,qe,ze){var De,He,Le;return w.default.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return De={"X-Twilio-Token":G.config.token},He=G.executeWithRetry(()=>G.transport.get(F,De),G.retryWhenThrottled()),Ae.trace("sending GET request to ",F," headers ",De),ze(()=>He.cancel()),ae.prev=4,ae.next=7,He;case 7:Le=ae.sent,Ae.trace("response",Le),Ne(Le),ae.next=16;break;case 12:ae.prev=12,ae.t0=ae.catch(4),Ae.debug("get() error ".concat(ae.t0)),qe(ae.t0);case 16:case"end":return ae.stop()}},ye,null,[[4,12]])}));return function(ye,Ne,qe){return Q.apply(this,arguments)}}())}post(F,G,Q,ye,Ne){var qe=this,ze={"X-Twilio-Token":this.config.token};(typeof FormData>"u"||!(Q instanceof FormData))&&ye&&Object.assign(ze,{"Content-Type":ye});var De=new URL(F);return G&&De.searchParams.append("Category",G),Ne&&De.searchParams.append("Filename",Ne),new Ee(function(){var He=h.default(w.default.mark(function Le(Z,ae,q){var K,ne;return w.default.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return K=qe.transport.post(De.href,ze,Q),q(()=>K.cancel()),Ae.trace("sending POST request to ".concat(F," with headers ").concat(ze)),ce.prev=3,ce.next=6,K;case 6:ne=ce.sent,ce.next=17;break;case 9:if(ce.prev=9,ce.t0=ce.catch(3),!(t.XMLHttpRequest===void 0&&Q instanceof FormData)){ce.next=14;break}return ae(new TypeError("Posting FormData supported only with browser engine's FormData")),ce.abrupt("return");case 14:return Ae.debug("post() error ".concat(ce.t0)),ae(ce.t0),ce.abrupt("return");case 17:Ae.trace("response",ne),Z(ne);case 19:case"end":return ce.stop()}},Le,null,[[3,9]])}));return function(Le,Z,ae){return He.apply(this,arguments)}}())}}var Fe="0.6.1",Ue,Pe=T.scope("");e.default=(Ue=class{constructor(F,G,Q){var ye,Ne,qe=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.options=qe,this.options.logLevel=(ye=this.options.logLevel)!==null&&ye!==void 0?ye:"silent",this.config=new C(F,G,Q,this.options),Pe.setLevel(this.options.logLevel),this.options.transport=(Ne=this.options.transport)!==null&&Ne!==void 0?Ne:new we,this.transport=this.options.transport,this.network=new ee(this.config,this.transport)}updateToken(F){Pe.info("updateToken"),this.config.updateToken(F)}get(F){var G=this;return new Ee(function(){var Q=h.default(w.default.mark(function ye(Ne,qe,ze){var De,He;return w.default.wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return De=G.network.get("".concat(G.config.mediaUrl,"/").concat(F)),ze(()=>De.cancel()),Z.prev=2,Z.next=5,De;case 5:He=Z.sent,Ne(new Y(G.config,G.network,He.body)),Z.next=12;break;case 9:Z.prev=9,Z.t0=Z.catch(2),qe(Z.t0);case 12:case"end":return Z.stop()}},ye,null,[[2,9]])}));return function(ye,Ne,qe){return Q.apply(this,arguments)}}())}post(F,G,Q,ye){var Ne=this;return new Ee(function(){var qe=h.default(w.default.mark(function ze(De,He,Le){var Z,ae;return w.default.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return Z=Ne.network.post(Ne.config.mediaUrl,Q!=null?Q:"media",G,F,ye),Le(()=>Z.cancel()),K.prev=2,K.next=5,Z;case 5:ae=K.sent,De(new Y(Ne.config,Ne.network,ae.body)),K.next=12;break;case 9:K.prev=9,K.t0=K.catch(2),He(K.t0);case 12:case"end":return K.stop()}},ze,null,[[2,9]])}));return function(ze,De,He){return qe.apply(this,arguments)}}())}postFormData(F,G){var Q=this;return new Ee(function(){var ye=h.default(w.default.mark(function Ne(qe,ze,De){var He,Le;return w.default.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return He=Q.network.post(Q.config.mediaUrl,G!=null?G:"media",F),De(()=>He.cancel()),ae.prev=2,ae.next=5,He;case 5:Le=ae.sent,qe(new Y(Q.config,Q.network,Le.body)),ae.next=12;break;case 9:ae.prev=9,ae.t0=ae.catch(2),ze(ae.t0);case 12:case"end":return ae.stop()}},Ne,null,[[2,9]])}));return function(Ne,qe,ze){return ye.apply(this,arguments)}}())}mediaSetGet(F){var G=this;return new Ee(function(){var Q=h.default(w.default.mark(function ye(Ne,qe,ze){var De,He,Le,Z;return w.default.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return De={command:"get",list:F.map(K=>({media_sid:K}))},He=G.network.post("".concat(G.config.mediaSetUrl),null,De,"application/json"),ze(()=>He.cancel()),q.prev=3,q.next=6,He;case 6:Le=q.sent,Z=Le.body.map(K=>{if(K.code!==200){qe("Failed to obtain detailed information about Media items (failed SID ".concat(K.media_record.sid,")"));return}return new Y(G.config,G.network,K.media_record)}),Ne(Z),q.next=14;break;case 11:q.prev=11,q.t0=q.catch(3),qe(q.t0);case 14:case"end":return q.stop()}},ye,null,[[3,11]])}));return function(ye,Ne,qe){return Q.apply(this,arguments)}}())}mediaSetGetContentUrls(F){var G=this;return new Ee(function(){var Q=h.default(w.default.mark(function ye(Ne,qe,ze){var De,He,Le,Z;return w.default.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return De={command:"get",list:F.map(K=>({media_sid:K}))},He=G.network.post("".concat(G.config.mediaSetUrl),null,De,"application/json"),ze(()=>He.cancel()),q.prev=3,q.next=6,He;case 6:Le=q.sent,Z=new Map,Le.body.forEach(K=>{if(K.code!==200){qe("Failed to obtain detailed information about Media items (failed SID ".concat(K.media_record.sid,")"));return}Z.set(K.media_record.sid,K.media_record.links.content_direct_temporary)}),Ne(Z),q.next=15;break;case 12:q.prev=12,q.t0=q.catch(3),qe(q.t0);case 15:case"end":return q.stop()}},ye,null,[[3,12]])}));return function(ye,Ne,qe){return Q.apply(this,arguments)}}())}},c.default(Ue,"version",Fe),Ue),Xe([o.validateTypes(o.nonEmptyString),Ye("design:type",Function),Ye("design:paramtypes",[String]),Ye("design:returntype",void 0)],e.default.prototype,"updateToken",null),Xe([o.validateTypesAsync(o.nonEmptyString),Ye("design:type",Function),Ye("design:paramtypes",[String]),Ye("design:returntype",Ee)],e.default.prototype,"get",null),e.default=Xe([o.validateConstructorTypes(o.nonEmptyString,o.nonEmptyString,[o.nonEmptyString,o.literal(null)],[o.pureObject,"undefined"]),Ye("design:paramtypes",[String,String,Object,Object])],e.default),e.CancellablePromise=Ee,e.Client=e.default,e.McsClient=e.default,e.McsMedia=Y,e.Media=Y})(bC);var WC=Nt,KX=pr,JX=ta,YX=WC.aTypedArray,QX=WC.exportTypedArrayMethod;QX("at",function(t){var r=YX(this),n=KX(r),a=JX(t),i=a>=0?a:n+a;return i<0||i>=n?void 0:r[i]});var XX=ot,ZX=ct,eZ=aE,tZ=kf,Pg="ArrayBuffer",T0=eZ[Pg],rZ=ZX[Pg];XX({global:!0,constructor:!0,forced:rZ!==T0},{ArrayBuffer:T0});tZ(Pg);var nZ=ot,GC=et,aZ=Nn,iZ=$r,k0=pr,sZ=lg,E0=lr,Mg=nt,oZ=yg,uZ=cl,C0=DE,lZ=BE,I0=us,R0=qE,Za=[],A0=GC(Za.sort),cZ=GC(Za.push),fZ=Mg(function(){Za.sort(void 0)}),dZ=Mg(function(){Za.sort(null)}),pZ=uZ("sort"),zC=!Mg(function(){if(I0)return I0<70;if(!(C0&&C0>3)){if(lZ)return!0;if(R0)return R0<603;var e="",t,r,n,a;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(a=0;a<47;a++)Za.push({k:r+a,v:n})}for(Za.sort(function(i,s){return s.v-i.v}),a=0;a<Za.length;a++)r=Za[a].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),vZ=fZ||!dZ||!pZ||!zC,hZ=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:E0(t)>E0(r)?1:-1}};nZ({target:"Array",proto:!0,forced:vZ},{sort:function(t){t!==void 0&&aZ(t);var r=iZ(this);if(zC)return t===void 0?A0(r):A0(r,t);var n=[],a=k0(r),i,s;for(s=0;s<a;s++)s in r&&cZ(n,r[s]);for(oZ(n,hZ(t)),i=k0(n),s=0;s<i;)r[s]=n[s++];for(;s<a;)sZ(r,s++);return r}});var yZ=ot,gZ=et,mZ=wC,bZ=ea,O0=lr,wZ=_C,_Z=gZ("".indexOf);yZ({target:"String",proto:!0,forced:!wZ("includes")},{includes:function(t){return!!~_Z(O0(bZ(this)),O0(mZ(t)),arguments.length>1?arguments[1]:void 0)}});var nd={};/*
@license
Copyright (c) 2022 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(nd,"__esModule",{value:!0});var SZ=vs.exports;function $Z(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var ic=$Z(SZ),TZ=function(t,r,n){return function(a,i,s){if(typeof s.value!="function"&&(s==null?void 0:s.get)===void 0)throw new Error("The deprecated decorator can only be applied to methods or getters");if(typeof s.value=="function"){var o=s.value;s.value=function(){$h("The method ".concat(t," is deprecated").concat(r?", use "+r+" instead":"").concat(n?", "+n:"."));for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return o.apply(this,c)};return}var u=s.get;s.get=function(){return $h("The getter ".concat(t," is deprecated").concat(r?", use "+r+" instead":"").concat(n?", "+n:".")),u==null?void 0:u.apply(this)}}},$h=function(t){var r=ic.default.getLevel();ic.default.setLevel("warn"),ic.default.warn(t),ic.default.setLevel(r)};nd.deprecated=TZ;nd.deprecationWarning=$h;var kZ=ot,EZ=Qr.find,CZ=Ay,Th="find",VC=!0;Th in[]&&Array(1)[Th](function(){VC=!1});kZ({target:"Array",proto:!0,forced:VC},{find:function(t){return EZ(this,t,arguments.length>1?arguments[1]:void 0)}});CZ(Th);/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2019, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes q under the following license.

    Copyright 2009–2014 Kristopher Michael Kowal. All rights reserved.
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.

This software includes platform.js under the following license.

    Copyright 2014 Benjamin Tan <https://d10.github.io/>
    Copyright 2011-2015 John-David Dalton <http://allyoucanleet.com/>

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=To.exports,r=mi.exports,n=Ln.exports,a=jn.exports,i=Xr.exports,s=bi.exports,o=ra.exports,u=Fn.exports,l=fl,c=Un.exports,h=vs.exports,w=F4,b=kr,$=qy,A=Yv.exports,x=wi.exports,U=xa,B=Bf,ve=XE,se=Br,Re=bC,ke=_i.exports,de=nd,P=Hf;function te(I){return I&&typeof I=="object"&&"default"in I?I:{default:I}}function le(I){if(I&&I.__esModule)return I;var O=Object.create(null);return I&&Object.keys(I).forEach(function(S){if(S!=="default"){var _=Object.getOwnPropertyDescriptor(I,S);Object.defineProperty(O,S,_.get?_:{enumerable:!0,get:function(){return I[S]}})}}),O.default=I,Object.freeze(O)}var J=te(t),xe=te(r),re=te(n),H=te(a),ue=te(i),W=te(s),me=te(o),_e=te(u),N=te(l),ft=te(c),dt=le(h),Ee=te(A),Xe=te(x),Ye=te(ke);function D(I,O,S,_){var v=arguments.length,g=v<3?O:_===null?_=Object.getOwnPropertyDescriptor(O,S):_,d;if((typeof Reflect>"u"?"undefined":ft.default(Reflect))==="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(I,O,S,_);else for(var p=I.length-1;p>=0;p--)(d=I[p])&&(g=(v<3?d(g):v>3?d(O,S,g):d(O,S))||g);return v>3&&g&&Object.defineProperty(O,S,g),g}function T(I,O){if((typeof Reflect>"u"?"undefined":ft.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(I,O)}function Te(I,O){return["".concat(new Date().toISOString()," Conversations ").concat(I,":")].concat(Array.from(O))}var he=dt.getLogger("twilio-conversations"),Ke=function(){function I(O){_e.default(this,I),W.default(this,"prefix",""),this.prefix=O!=null&&O.length>0?O+" ":""}return me.default(I,[{key:"setLevel",value:function(S){he.setLevel(S)}},{key:"trace",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];he.trace.apply(null,Te(this.prefix+"T",_))}},{key:"debug",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];he.debug.apply(null,Te(this.prefix+"D",_))}},{key:"info",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];he.info.apply(null,Te(this.prefix+"I",_))}},{key:"warn",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];he.warn.apply(null,Te(this.prefix+"W",_))}},{key:"error",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];he.error.apply(null,Te(this.prefix+"E",_))}}],[{key:"scope",value:function(S){return new I(S)}},{key:"setLevel",value:function(S){he.setLevel(S)}},{key:"trace",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];he.trace.apply(null,Te("T",_))}},{key:"debug",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];he.debug.apply(null,Te("D",_))}},{key:"info",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];he.info.apply(null,Te("I",_))}},{key:"warn",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];he.warn.apply(null,Te("W",_))}},{key:"error",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];he.error.apply(null,Te("E",_))}}]),I}();function Qe(I,O){var S=Object.keys(I);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(I);O&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(I,v).enumerable})),S.push.apply(S,_)}return S}function Se(I){for(var O=1;O<arguments.length;O++){var S=arguments[O]!=null?arguments[O]:{};O%2?Qe(Object(S),!0).forEach(function(_){W.default(I,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(S)):Qe(Object(S)).forEach(function(_){Object.defineProperty(I,_,Object.getOwnPropertyDescriptor(S,_))})}return I}var Ge=5,R="PT5S",C="PT5S",Y=100,pe=1e3,z=4e3,Oe=3,be=!0,we=me.default(function I(){var O,S,_,v,g,d,p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=arguments.length>1?arguments[1]:void 0,m=arguments.length>2?arguments[2]:void 0;_e.default(this,I),W.default(this,"typingIndicatorTimeoutDefault",Ge*1e3);var y=p.Chat||p.IPMessaging||p||{};this.productId=y.productId,this.links={myConversations:f.links.my_conversations,conversations:f.links.conversations,users:f.links.users,currentUser:f.links.current_user,typing:f.links.typing,mediaService:f.links.media_service,mediaSetService:f.links.media_set_service,messagesReceipts:f.links.messages_receipts},this.limits={mediaAttachmentsCountLimit:f.options.media_attachments_count_limit,mediaAttachmentSizeLimitInMb:f.options.media_attachment_size_limit_in_mb,mediaAttachmentsTotalSizeLimitInMb:f.options.media_attachments_total_size_limit_in_mb,emailHistoriesAllowedContentTypes:f.options.email_histories_allowed_mime_types,emailBodiesAllowedContentTypes:f.options.email_bodies_allowed_mime_types},this.typingIndicatorTimeoutOverride=y.typingIndicatorTimeoutOverride,this.backoffConfiguration=Se({min:pe,max:z,maxAttemptsCount:Oe},y.backoffConfigOverride),this.retryWhenThrottled=y.retryWhenThrottledOverride!==void 0?y.retryWhenThrottledOverride:be,this.userInfosToSubscribe=(O=(S=y.userInfosToSubscribeOverride)!==null&&S!==void 0?S:f.options.user_infos_to_subscribe)!==null&&O!==void 0?O:Y,this.reachabilityEnabled=f.options.reachability_enabled,this.userIdentity=f.identity,this.userInfo=f.sync_objects.my_user_info,this.myConversations=f.sync_objects.my_conversations;var k=(_=(v=y.httpCacheIntervalOverride)!==null&&v!==void 0?v:f.options.http_cache_interval)!==null&&_!==void 0?_:R;try{this.httpCacheInterval=w.toSeconds(w.parse(k))}catch{m.error("Failed to parse http cache interval ".concat(k,", using default value ").concat(R)),this.httpCacheInterval=w.toSeconds(w.parse(R))}var E=(g=(d=y.consumptionReportIntervalOverride)!==null&&d!==void 0?d:f.options.consumption_report_interval)!==null&&g!==void 0?g:C;try{this.consumptionReportInterval=w.toSeconds(w.parse(E))}catch{m.error("Failed to parse consumption report interval ".concat(E,", using default value ").concat(C)),this.consumptionReportInterval=w.toSeconds(w.parse(C))}});function Ae(I){return JSON.parse(JSON.stringify(I))}function ee(I){return typeof I<"u"&&!isNaN(Number(I))?Number(I):null}function Fe(I){try{return new Date(I)}catch{return null}}function Ue(I,O,S){var _={};if(I)try{_=JSON.parse(I)}catch(v){S.warn(O,v)}return _}var Pe=function(){function I(O){_e.default(this,I),this.base=O.replace(/\/$/,""),this.args=[],this.paths=[]}return me.default(I,[{key:"arg",value:function(S,_){return typeof _<"u"&&this.args.push(encodeURIComponent(S)+"="+encodeURIComponent(_)),this}},{key:"path",value:function(S){return this.paths.push(encodeURIComponent(S)),this}},{key:"build",value:function(){var S=this.base;return this.paths.length&&(S+="/"+this.paths.join("/")),this.args.length&&(S+="?"+this.args.join("&")),S}}]),I}(),oe=b.custom(function(I){return[["string","number","boolean","object"].includes(ft.default(I)),"a JSON type"]}),F=b.custom(function(I){return[["undefined","string","number","boolean","object"].includes(ft.default(I)),"an optional JSON type"]});function G(I){var O=Q();return function(){var _=ue.default(I),v;if(O){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return H.default(this,v)}}function Q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ye=Ke.scope("User"),Ne=function(I){re.default(S,I);var O=G(S);function S(_,v,g,d){var p;return _e.default(this,S),p=O.call(this),W.default(xe.default(p),"promiseToFetch",null),W.default(xe.default(p),"updated","updated"),W.default(xe.default(p),"userSubscribed","userSubscribed"),W.default(xe.default(p),"userUnsubscribed","userUnsubscribed"),p.services=d,p.subscribed="initializing",p.setMaxListeners(0),p.state={identity:_,entityName:v,friendlyName:null,attributes:{},online:null,notifiable:null},p._initializationPromise=new Promise(function(f){p._resolveInitializationPromise=f}),g!==null&&p._resolveInitialization(g,_,v,!1),p}return me.default(S,[{key:"identity",get:function(){return this.state.identity},set:function(v){this.state.identity=v}},{key:"entityName",set:function(v){this.state.entityName=v}},{key:"attributes",get:function(){return this.state.attributes}},{key:"friendlyName",get:function(){return this.state.friendlyName}},{key:"isOnline",get:function(){return this.state.online}},{key:"isNotifiable",get:function(){return this.state.notifiable}},{key:"isSubscribed",get:function(){return this.subscribed=="subscribed"}},{key:"_update",value:function(){var _=J.default(N.default.mark(function g(d,p){var f,m;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,this._initializationPromise;case 2:f=[],ye.debug("User for",this.state.identity,"updated:",d,p),k.t0=d,k.next=k.t0==="friendlyName"?7:k.t0==="attributes"?9:k.t0==="reachability"?12:15;break;case 7:return this.state.friendlyName!==p.value&&(f.push("friendlyName"),this.state.friendlyName=p.value),k.abrupt("break",16);case 9:return m=Ue(p.value,"Retrieved malformed attributes from the server for user: ".concat(this.state.identity),ye),Ee.default(this.state.attributes,m)||(this.state.attributes=m,f.push("attributes")),k.abrupt("break",16);case 12:return this.state.online!==p.online&&(this.state.online=p.online,f.push("reachabilityOnline")),this.state.notifiable!==p.notifiable&&(this.state.notifiable=p.notifiable,f.push("reachabilityNotifiable")),k.abrupt("break",16);case 15:return k.abrupt("return");case 16:f.length>0&&this.emit("updated",{user:this,updateReasons:f});case 17:case"end":return k.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"_updateReachabilityInfo",value:function(){var _=J.default(N.default.mark(function g(d,p){var f=this;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this._initializationPromise;case 2:if(this.configuration.reachabilityEnabled){y.next=4;break}return y.abrupt("return",Promise.resolve());case 4:return y.abrupt("return",d.get("reachability").then(p).catch(function(k){ye.warn("Failed to get reachability info for ",f.state.identity,k)}));case 5:case"end":return y.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"_fetch",value:function(){var _=J.default(N.default.mark(function g(){var d=this;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._initializationPromise;case 2:if(this.state.entityName){f.next=4;break}return f.abrupt("return",this);case 4:return this.promiseToFetch=this.services.syncClient.map({id:this.state.entityName,mode:"open_existing",includeItems:!0}).then(function(m){return d.entity=m,m.on("itemUpdated",function(y){return ye.debug(d.state.entityName+" ("+d.state.identity+") itemUpdated: "+y.item.key),d._update(y.item.key,y.item.data)}),Promise.all([m.get("friendlyName").then(function(y){return d._update(y.key,y.data)}),m.get("attributes").then(function(y){return d._update(y.key,y.data)}),d._updateReachabilityInfo(m,function(y){return d._update(y.key,y.data)})])}).then(function(){return ye.debug("Fetched for",d.identity),d.subscribed="subscribed",d.emit("userSubscribed",d),d}).catch(function(m){throw d.promiseToFetch=null,m}),f.abrupt("return",this.promiseToFetch);case 6:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_ensureFetched",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._initializationPromise;case 2:return p.abrupt("return",this.promiseToFetch||this._fetch());case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"updateAttributes",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){f.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return f.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(d)});case 6:return f.abrupt("return",this);case 7:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateFriendlyName",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){f.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return f.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:d});case 6:return f.abrupt("return",this);case 7:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"unsubscribe",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._initializationPromise;case 2:if(!this.promiseToFetch){p.next=9;break}return p.next=5,this.promiseToFetch;case 5:this.entity.close(),this.promiseToFetch=null,this.subscribed="unsubscribed",this.emit("userUnsubscribed",this);case 9:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_resolveInitialization",value:function(v,g,d,p){this.configuration=v,this.identity=g,this.entityName=d,this.links={self:"".concat(this.configuration.links.users,"/").concat(encodeURIComponent(this.identity))},this._resolveInitializationPromise(),p&&this.emit("updated",{user:this,updateReasons:["friendlyName","attributes","reachabilityOnline","reachabilityNotifiable"]})}}]),S}($.ReplayEventEmitter);D([b.validateTypesAsync(oe),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],Ne.prototype,"updateAttributes",null),D([b.validateTypesAsync(["string"]),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],Ne.prototype,"updateFriendlyName",null);function qe(I,O){var S=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!S){if(Array.isArray(I)||(S=ze(I))||O&&I&&typeof I.length=="number"){S&&(I=S);var _=0,v=function(){};return{s:v,n:function(){return _>=I.length?{done:!0}:{done:!1,value:I[_++]}},e:function(m){throw m},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,d=!1,p;return{s:function(){S=S.call(I)},n:function(){var m=S.next();return g=m.done,m},e:function(m){d=!0,p=m},f:function(){try{!g&&S.return!=null&&S.return()}finally{if(d)throw p}}}}function ze(I,O){if(!!I){if(typeof I=="string")return De(I,O);var S=Object.prototype.toString.call(I).slice(8,-1);if(S==="Object"&&I.constructor&&(S=I.constructor.name),S==="Map"||S==="Set")return Array.from(I);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return De(I,O)}}function De(I,O){(O==null||O>I.length)&&(O=I.length);for(var S=0,_=new Array(O);S<O;S++)_[S]=I[S];return _}var He=function(){function I(O,S){_e.default(this,I),this.configuration=O,this.services=S,this.cache=new Map,this.cacheLifetime=this.configuration.httpCacheInterval*100,this.cleanupCache()}return me.default(I,[{key:"isExpired",value:function(S){return!this.cacheLifetime||Date.now()-S>this.cacheLifetime}},{key:"cleanupCache",value:function(){var S=qe(this.cache),_;try{for(S.s();!(_=S.n()).done;){var v=Xe.default(_.value,2),g=v[0],d=v[1];this.isExpired(d.timestamp)&&this.cache.delete(g)}}catch(p){S.e(p)}finally{S.f()}this.cache.size===0&&clearInterval(this.timer)}},{key:"pokeTimer",value:function(){var S=this;this.timer=this.timer||setInterval(function(){return S.cleanupCache()},this.cacheLifetime*2)}},{key:"executeWithRetry",value:function(S){var _=this,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return new Promise(function(g,d){var p=[502,503,504];v&&p.push(429);var f=new U.Retrier(_.configuration.backoffConfiguration);f.on("attempt",function(){S().then(function(m){return f.succeeded(m)}).catch(function(m){p.indexOf(m.status)>-1||m.message==="Twilsock disconnected"?f.failed(m):(f.removeAllListeners(),f.cancel(),d(m))})}),f.on("succeeded",function(m){g(m)}),f.on("cancelled",function(m){return d(m)}),f.on("failed",function(m){return d(m)}),f.start()})}},{key:"get",value:function(){var O=J.default(N.default.mark(function _(v){var g=this,d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(d=this.cache.get(v),!(d&&!this.isExpired(d.timestamp))){y.next=3;break}return y.abrupt("return",d.response);case 3:return p={},y.next=6,this.executeWithRetry(function(){return g.services.transport.get(v,p,g.configuration.productId)},this.configuration.retryWhenThrottled);case 6:return f=y.sent,this.cache.set(v,{response:f,timestamp:Date.now()}),this.pokeTimer(),y.abrupt("return",f);case 10:case"end":return y.stop()}},_,this)}));function S(_){return O.apply(this,arguments)}return S}()}]),I}(),Le=me.default(function I(){_e.default(this,I)});W.default(Le,"TYPING_INDICATOR","twilio.ipmsg.typing_indicator"),W.default(Le,"NEW_MESSAGE","twilio.conversations.new_message"),W.default(Le,"ADDED_TO_CONVERSATION","twilio.conversations.added_to_conversation"),W.default(Le,"REMOVED_FROM_CONVERSATION","twilio.conversations.removed_from_conversation"),W.default(Le,"CONSUMPTION_UPDATE","twilio.channel.consumption_update");function Z(I){var O=ae();return function(){var _=ue.default(I),v;if(O){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return H.default(this,v)}}function ae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var q=Ke.scope("Participant"),K=function(I){re.default(S,I);var O=Z(S);function S(_,v,g,d,p){var f,m,y;if(_e.default(this,S),y=O.call(this),y.conversation=g,y.links=d,y.services=p,y.state={attributes:Ue(_.attributes,"Retrieved malformed attributes from the server for participant: "+v,q),dateCreated:_.dateCreated?Fe(_.dateCreated):null,dateUpdated:_.dateCreated?Fe(_.dateUpdated):null,sid:v,typingTimeout:null,isTyping:!1,identity:_.identity,roleSid:(f=_.roleSid)!==null&&f!==void 0?f:"",lastReadMessageIndex:Number.isInteger(_.lastConsumedMessageIndex)?_.lastConsumedMessageIndex:null,lastReadTimestamp:_.lastConsumptionTimestamp?Fe(_.lastConsumptionTimestamp):null,type:_.type||"chat",userInfo:_.userInfo,bindings:(m=_.bindings)!==null&&m!==void 0?m:{}},!_.identity&&!_.type)throw new Error("Received invalid Participant object from server: Missing identity or type of Participant.");return y}return me.default(S,[{key:"sid",get:function(){return this.state.sid}},{key:"attributes",get:function(){return this.state.attributes}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"identity",get:function(){return this.state.identity}},{key:"isTyping",get:function(){return this.state.isTyping}},{key:"lastReadMessageIndex",get:function(){return this.state.lastReadMessageIndex}},{key:"lastReadTimestamp",get:function(){return this.state.lastReadTimestamp}},{key:"roleSid",get:function(){return this.state.roleSid}},{key:"type",get:function(){return this.state.type}},{key:"bindings",get:function(){var v;return(v=this.state.bindings)!==null&&v!==void 0?v:{}}},{key:"_startTyping",value:function(v){var g=this;return this.state.typingTimeout&&clearTimeout(this.state.typingTimeout),this.state.isTyping=!0,this.emit("typingStarted",this),this.conversation.emit("typingStarted",this),this.state.typingTimeout=Number(setTimeout(function(){return g._endTyping()},v)),this}},{key:"_endTyping",value:function(){!this.state.typingTimeout||(this.state.isTyping=!1,this.emit("typingEnded",this),this.conversation.emit("typingEnded",this),clearInterval(this.state.typingTimeout),this.state.typingTimeout=null)}},{key:"_update",value:function(v){var g=[],d=Ue(v.attributes,"Retrieved malformed attributes from the server for participant: "+this.state.sid,q);v.attributes&&!Ee.default(this.state.attributes,d)&&(this.state.attributes=d,g.push("attributes"));var p=Fe(v.dateUpdated);v.dateUpdated&&(p==null?void 0:p.getTime())!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=p,g.push("dateUpdated"));var f=Fe(v.dateCreated);if(v.dateCreated&&(f==null?void 0:f.getTime())!==(this.state.dateCreated&&this.state.dateCreated.getTime())&&(this.state.dateCreated=f,g.push("dateCreated")),v.roleSid&&this.state.roleSid!==v.roleSid&&(this.state.roleSid=v.roleSid,g.push("roleSid")),(Number.isInteger(v.lastConsumedMessageIndex)||v.lastConsumedMessageIndex===null)&&this.state.lastReadMessageIndex!==v.lastConsumedMessageIndex&&(this.state.lastReadMessageIndex=v.lastConsumedMessageIndex,g.push("lastReadMessageIndex")),v.lastConsumptionTimestamp){var m=new Date(v.lastConsumptionTimestamp);(!this.state.lastReadTimestamp||this.state.lastReadTimestamp.getTime()!==m.getTime())&&(this.state.lastReadTimestamp=m,g.push("lastReadTimestamp"))}return v.bindings&&!Ee.default(this.state.bindings,v.bindings)&&(this.state.bindings=v.bindings,g.push("bindings")),g.length>0&&this.emit("updated",{participant:this,updateReasons:g}),this}},{key:"getUser",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this.type=="chat"){p.next=2;break}throw new Error("Getting User is not supported for this Participant type: "+this.type);case 2:return p.abrupt("return",this.services.users.getUser(this.state.identity,this.state.userInfo));case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"remove",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.conversation.removeParticipant(this));case 1:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"updateAttributes",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(d)});case 2:return f.abrupt("return",this);case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()}]),S}($.ReplayEventEmitter);W.default(K,"typingStarted","typingStarted"),W.default(K,"typingEnded","typingEnded"),W.default(K,"updated","updated"),D([b.validateTypesAsync(oe),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],K.prototype,"updateAttributes",null);function ne(I){var O=ge();return function(){var _=ue.default(I),v;if(O){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return H.default(this,v)}}function ge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ce=Ke.scope("Participants"),je=function(I){re.default(S,I);var O=ne(S);function S(_,v,g,d,p){var f;return _e.default(this,S),f=O.call(this),W.default(xe.default(f),"rosterEntityPromise",null),f.conversation=_,f.participants=v,f.links=g,f.configuration=d,f.services=p,f}return me.default(S,[{key:"unsubscribe",value:function(){var _=J.default(N.default.mark(function g(){var d;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!this.rosterEntityPromise){f.next=6;break}return f.next=3,this.rosterEntityPromise;case 3:d=f.sent,d.close(),this.rosterEntityPromise=null;case 6:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"subscribe",value:function(v){var g=this,d=typeof v=="string"?this.services.syncClient.map({id:v,mode:"open_existing"}):Promise.resolve(v);return this.rosterEntityPromise=this.rosterEntityPromise||d.then(function(p){p.on("itemAdded",function(y){ce.debug(g.conversation.sid+" itemAdded: "+y.item.key),g.upsertParticipant(y.item.key,y.item.data).then(function(k){g.emit("participantJoined",k)})}),p.on("itemRemoved",function(y){ce.debug(g.conversation.sid+" itemRemoved: "+y.key);var k=y.key;if(!!g.participants.has(k)){var E=g.participants.get(k);g.participants.delete(k),E&&g.emit("participantLeft",E)}}),p.on("itemUpdated",function(y){ce.debug(g.conversation.sid+" itemUpdated: "+y.item.key),g.upsertParticipant(y.item.key,y.item.data)});var f=[],m=function y(k){return k.items.forEach(function(E){f.push(g.upsertParticipant(E.key,E.data))}),k.hasNextPage?k.nextPage().then(y):null};return p.getItems().then(m).then(function(){return Promise.all(f)}).then(function(){return p})}).catch(function(p){throw g.rosterEntityPromise=null,g.services.syncClient.connectionState!="disconnected"&&ce.error("Failed to get roster object for conversation",g.conversation.sid,p),ce.debug("ERROR: Failed to get roster object for conversation",g.conversation.sid,p),p})}},{key:"upsertParticipantFromResponse",value:function(){var _=J.default(N.default.mark(function g(d){var p,f,m,y,k,E,L,j;return N.default.wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:return f=d.sid,m=d.attributes,y=d.date_created,k=d.date_updated,E=d.identity,L=d.role_sid,j=d.messaging_binding,Je.next=3,this.upsertParticipant(f,{attributes:m,dateCreated:new Date(y),dateUpdated:new Date(k),identity:E,roleSid:L,lastConsumedMessageIndex:null,lastConsumptionTimestamp:null,type:(p=j==null?void 0:j.type)!==null&&p!==void 0?p:"chat"});case 3:return Je.abrupt("return",Je.sent);case 4:case"end":return Je.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"upsertParticipant",value:function(){var _=J.default(N.default.mark(function g(d,p){var f=this,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(m=this.participants.get(d),!m){E.next=3;break}return E.abrupt("return",m._update(p));case 3:return y={self:"".concat(this.links.participants,"/").concat(d)},m=new K(p,d,this.conversation,y,this.services),this.participants.set(d,m),m.on("updated",function(L){return f.emit("participantUpdated",L)}),E.abrupt("return",m);case 8:case"end":return E.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"getParticipants",value:function(){var _=J.default(N.default.mark(function g(){var d=this;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var m=[];return d.participants.forEach(function(y){return m.push(y)}),m}):[]);case 1:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getParticipantBySid",value:function(){var _=J.default(N.default.mark(function g(d){var p=this;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var y=p.participants.get(d);if(!y)throw new Error("Participant with SID "+d+" was not found");return y}):null);case 1:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getParticipantByIdentity",value:function(){var _=J.default(N.default.mark(function g(d){var p=this,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return f=null,y.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){if(p.participants.forEach(function(k){k.identity===d&&(f=k)}),!f)throw new Error("Participant with identity "+d+" was not found");return f}):null);case 2:case"end":return y.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"add",value:function(){var _=J.default(N.default.mark(function g(d,p){return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:d,attributes:typeof p<"u"?JSON.stringify(p):void 0});case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"addNonChatParticipant",value:function(){var _=J.default(N.default.mark(function g(d,p){var f,m,y,k,E=arguments;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return y=E.length>2&&E[2]!==void 0?E[2]:{},k=E.length>3&&E[3]!==void 0?E[3]:{},j.next=4,this.services.commandExecutor.mutateResource("post",this.links.participants,{attributes:typeof y<"u"?JSON.stringify(y):void 0,messaging_binding:{address:p,proxy_address:d,name:k==null||(f=k.email)===null||f===void 0?void 0:f.name,level:k==null||(m=k.email)===null||m===void 0?void 0:m.level}});case 4:return j.abrupt("return",j.sent);case 5:case"end":return j.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"remove",value:function(v){return this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(v))}}]),S}($.ReplayEventEmitter),Ve=function(){function I(O,S){_e.default(this,I),W.default(this,"mcsMedia",null),this.services=S,O instanceof Re.McsMedia&&(this.mcsMedia=O),this.state={sid:O.sid,category:O.category,filename:O.filename,contentType:O.contentType,size:O.size}}return me.default(I,[{key:"sid",get:function(){return this.state.sid}},{key:"filename",get:function(){return this.state.filename}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}},{key:"category",get:function(){return this.state.category}},{key:"getContentTemporaryUrl",value:function(){var S=this;return new Re.CancellablePromise(function(){var _=J.default(N.default.mark(function v(g,d,p){var f,m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(m=S._fetchMcsMedia(),y=(f=S.mcsMedia)===null||f===void 0?void 0:f.getContentUrl(),p(function(){m.cancel(),y&&y.cancel()}),L.prev=3,S.mcsMedia){L.next=9;break}return L.next=7,m;case 7:k=L.sent,y=k.getContentUrl();case 9:if(L.t0=g,!y){L.next=16;break}return L.next=13,y;case 13:L.t1=L.sent,L.next=17;break;case 16:L.t1=null;case 17:L.t2=L.t1,(0,L.t0)(L.t2),L.next=24;break;case 21:L.prev=21,L.t3=L.catch(3),d(L.t3);case 24:case"end":return L.stop()}},v,null,[[3,21]])}));return function(v,g,d){return _.apply(this,arguments)}}())}},{key:"_fetchMcsMedia",value:function(){var S=this;return new Re.CancellablePromise(function(){var _=J.default(N.default.mark(function v(g,d,p){var f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(f=S.services.mcsClient.get(S.state.sid),!S.services.mcsClient){y.next=14;break}return p(function(){return f.cancel()}),y.prev=3,y.next=6,f;case 6:S.mcsMedia=y.sent,g(S.mcsMedia),y.next=13;break;case 10:y.prev=10,y.t0=y.catch(3),d(y.t0);case 13:return y.abrupt("return");case 14:d(new Error("Media Content Service is unavailable"));case 15:case"end":return y.stop()}},v,null,[[3,10]])}));return function(v,g,d){return _.apply(this,arguments)}}())}}]),I}(),at=function(){function I(O){_e.default(this,I),this.state=O}return me.default(I,[{key:"total",get:function(){return this.state.total}},{key:"sent",get:function(){return this.state.sent}},{key:"delivered",get:function(){return this.state.delivered}},{key:"read",get:function(){return this.state.read}},{key:"undelivered",get:function(){return this.state.undelivered}},{key:"failed",get:function(){return this.state.failed}},{key:"_update",value:function(S){this.state=S}},{key:"_isEquals",value:function(S){var _=this.total===S.total,v=this.sent===S.sent,g=this.delivered===S.delivered,d=this.read===S.read,p=this.undelivered===S.undelivered,f=this.failed===S.failed;return _&&v&&g&&d&&p&&f}}]),I}(),tt=function(){function I(O,S,_,v){_e.default(this,I),this.state={prevToken:_,nextToken:v,source:S,items:O}}return me.default(I,[{key:"hasNextPage",get:function(){return!!this.state.nextToken}},{key:"hasPrevPage",get:function(){return!!this.state.prevToken}},{key:"items",get:function(){return this.state.items}},{key:"nextPage",value:function(){return this.hasNextPage?this.state.source(this.state.nextToken):Promise.reject(new Error("No next page"))}},{key:"prevPage",value:function(){return this.hasPrevPage?this.state.source(this.state.prevToken):Promise.reject(new Error("No previous page"))}}]),I}(),We=me.default(function I(O){_e.default(this,I),this.sid=O.sid,this.messageSid=O.message_sid,this.conversationSid=O.conversation_sid,this.channelMessageSid=O.channel_message_sid,this.participantSid=O.participant_sid,this.status=O.status||"queued",this.errorCode=O.error_code||0,this.dateCreated=O.date_created,this.dateUpdated=O.date_updated});function vr(I,O){var S=Object.keys(I);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(I);O&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(I,v).enumerable})),S.push.apply(S,_)}return S}function rt(I){for(var O=1;O<arguments.length;O++){var S=arguments[O]!=null?arguments[O]:{};O%2?vr(Object(S),!0).forEach(function(_){W.default(I,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(S)):vr(Object(S)).forEach(function(_){Object.defineProperty(I,_,Object.getOwnPropertyDescriptor(S,_))})}return I}function Rr(I){var O=Ut();return function(){var _=ue.default(I),v;if(O){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return H.default(this,v)}}function Ut(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mn=Ke.scope("Message"),rr=function(I){re.default(S,I);var O=Rr(S);function S(_,v,g,d,p,f){var m,y,k,E,L;return _e.default(this,S),L=O.call(this),L.conversation=g,L.links=d,L.configuration=p,L.services=f,L.state={sid:v.sid,index:_,author:v.author,subject:v.subject,body:(m=v.text)!==null&&m!==void 0?m:null,timestamp:v.timestamp?new Date(v.timestamp):null,dateUpdated:v.dateUpdated?new Date(v.dateUpdated):null,lastUpdatedBy:(y=v.lastUpdatedBy)!==null&&y!==void 0?y:null,attributes:Ue(v.attributes,"Got malformed attributes for the message ".concat(v.sid),mn),type:(k=v.type)!==null&&k!==void 0?k:"text",media:v.type==="media"&&v.media?new Ve(v.media,L.services):null,medias:v.type==="media"&&v.medias?v.medias.map(function(j){return new Ve(j,L.services)}):v.type==="media"&&v.media&&!v.medias?[new Ve(rt(rt({},v.media),{},{category:"media"}),L.services)]:null,participantSid:(E=v.memberSid)!==null&&E!==void 0?E:null,aggregatedDeliveryReceipt:v.delivery?new at(v.delivery):null},L}return me.default(S,[{key:"sid",get:function(){return this.state.sid}},{key:"author",get:function(){return this.state.author}},{key:"subject",get:function(){return this.state.subject}},{key:"body",get:function(){return this.state.body}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"index",get:function(){return this.state.index}},{key:"lastUpdatedBy",get:function(){return this.state.lastUpdatedBy}},{key:"dateCreated",get:function(){return this.state.timestamp}},{key:"attributes",get:function(){return this.state.attributes}},{key:"type",get:function(){return this.state.type}},{key:"media",get:function(){return this.state.media}},{key:"attachedMedia",get:function(){return this.getMediaByCategories(["media"])}},{key:"participantSid",get:function(){return this.state.participantSid}},{key:"aggregatedDeliveryReceipt",get:function(){return this.state.aggregatedDeliveryReceipt}},{key:"getMediaByCategory",value:function(v){return this.getMediaByCategories(v)}},{key:"getMediaByCategories",value:function(v){var g;return((g=this.state.medias)!==null&&g!==void 0?g:[]).filter(function(d){return v.includes(d.category)})}},{key:"getEmailBody",value:function(){var v,g,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(v=(g=this.getMediaByCategories(["body"]))===null||g===void 0?void 0:g.filter(function(p){return p.contentType==d}).shift())!==null&&v!==void 0?v:null}},{key:"getEmailHistory",value:function(){var v,g,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(v=(g=this.getMediaByCategories(["history"]))===null||g===void 0?void 0:g.filter(function(p){return p.contentType==d}).shift())!==null&&v!==void 0?v:null}},{key:"_update",value:function(v){var g=[];(v.text||typeof v.text=="string")&&v.text!==this.state.body&&(this.state.body=v.text,g.push("body")),v.subject&&v.subject!==this.state.subject&&(this.state.subject=v.subject,g.push("subject")),v.lastUpdatedBy&&v.lastUpdatedBy!==this.state.lastUpdatedBy&&(this.state.lastUpdatedBy=v.lastUpdatedBy,g.push("lastUpdatedBy")),v.author&&v.author!==this.state.author&&(this.state.author=v.author,g.push("author")),v.dateUpdated&&new Date(v.dateUpdated).getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=new Date(v.dateUpdated),g.push("dateUpdated")),v.timestamp&&new Date(v.timestamp).getTime()!==(this.state.timestamp&&this.state.timestamp.getTime())&&(this.state.timestamp=new Date(v.timestamp),g.push("dateCreated"));var d=Ue(v.attributes,"Got malformed attributes for the message ".concat(this.sid),mn);Ee.default(this.state.attributes,d)||(this.state.attributes=d,g.push("attributes"));var p=v.delivery,f=this.state.aggregatedDeliveryReceipt,m=!!p&&!!p.total&&!!p.delivered&&!!p.failed&&!!p.read&&!!p.sent&&!!p.undelivered;m&&(f?f._isEquals(p)||(f._update(p),g.push("deliveryReceipt")):(this.state.aggregatedDeliveryReceipt=new at(p),g.push("deliveryReceipt"))),g.length>0&&this.emit("updated",{message:this,updateReasons:g})}},{key:"getParticipant",value:function(){var _=J.default(N.default.mark(function g(){var d=this,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(p=null,!this.state.participantSid){y.next=5;break}return y.next=4,this.conversation.getParticipantBySid(this.state.participantSid).catch(function(){return mn.debug('Participant with sid "'.concat(d.participantSid,'" not found for message ').concat(d.sid)),null});case 4:p=y.sent;case 5:if(!(!p&&this.state.author)){y.next=9;break}return y.next=8,this.conversation.getParticipantByIdentity(this.state.author).catch(function(){return mn.debug('Participant with identity "'.concat(d.author,'" not found for message ').concat(d.sid)),null});case 8:p=y.sent;case 9:if(!p){y.next=11;break}return y.abrupt("return",p);case 11:throw f="Participant with ",this.state.participantSid&&(f+="SID '"+this.state.participantSid+"' "),this.state.author&&(this.state.participantSid&&(f+="or "),f+="identity '"+this.state.author+"' "),f==="Participant with "&&(f="Participant "),f+="was not found",new Error(f);case 17:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getDetailedDeliveryReceipts",value:function(){var _=J.default(N.default.mark(function g(){var d,p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._getDetailedDeliveryReceiptsPaginator();case 2:d=m.sent,p=d.items;case 4:if(!d.hasNextPage){m.next=11;break}return m.next=7,d.nextPage();case 7:d=m.sent,p=[].concat(Ye.default(p),Ye.default(d.items)),m.next=4;break;case 11:return m.abrupt("return",p);case 12:case"end":return m.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"remove",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return p.abrupt("return",this);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"updateBody",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{body:d});case 2:return f.abrupt("return",this);case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateAttributes",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:typeof d<"u"?JSON.stringify(d):void 0});case 2:return f.abrupt("return",this);case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"attachTemporaryUrlsFor",value:function(){var _=J.default(N.default.mark(function g(d){var p=this,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(f=d==null?void 0:d.map(function(k){return k.sid}),!(this.services.mcsClient&&f)){y.next=7;break}return y.next=4,this.services.mcsClient.mediaSetGet(f);case 4:return y.abrupt("return",y.sent.map(function(k){return new Ve(k,p.services)}));case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return y.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getTemporaryContentUrlsForMedia",value:function(v){var g=v.map(function(d){return d.sid});return this.getTemporaryContentUrlsForMediaSids(g)}},{key:"getTemporaryContentUrlsForMediaSids",value:function(v){var g=this;return new Re.CancellablePromise(function(){var d=J.default(N.default.mark(function p(f,m,y){var k,E;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(k=g.services.mcsClient.mediaSetGetContentUrls(v!=null?v:[]),!(!g.services.mcsClient||!v)){j.next=4;break}return m(new Error("Media Content Service is unavailable")),j.abrupt("return");case 4:return y(function(){k.cancel()}),j.prev=5,j.next=8,k;case 8:E=j.sent,f(E),j.next=15;break;case 12:j.prev=12,j.t0=j.catch(5),m(j.t0);case 15:case"end":return j.stop()}},p,null,[[5,12]])}));return function(p,f,m){return d.apply(this,arguments)}}())}},{key:"getTemporaryContentUrlsForAttachedMedia",value:function(){var v,g=this.attachedMedia,d=(v=g==null?void 0:g.map(function(p){return p.sid}))!==null&&v!==void 0?v:[];return this.getTemporaryContentUrlsForMediaSids(d)}},{key:"_getDetailedDeliveryReceiptsPaginator",value:function(){var _=J.default(N.default.mark(function g(d){var p=this,f,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return f=this.configuration.links.messagesReceipts.replace("%s",this.conversation.sid).replace("%s",this.sid),m=new Pe(f).arg("PageToken",d==null?void 0:d.pageToken).arg("PageSize",d==null?void 0:d.pageSize).build(),E.next=4,this.services.network.get(m);case 4:return y=E.sent,E.abrupt("return",new tt(y.body.delivery_receipts.map(function(L){return new We(L)}),function(L,j){return p._getDetailedDeliveryReceiptsPaginator({pageToken:L,pageSize:j})},y.body.meta.previous_token,y.body.meta.next_token));case 6:case"end":return E.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()}]),S}($.ReplayEventEmitter);W.default(rr,"updated","updated"),D([de.deprecated("getMediaByCategory","getMediaByCategories"),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Array)],rr.prototype,"getMediaByCategory",null),D([b.validateTypes([b.nonEmptyString,"undefined"]),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Ve)],rr.prototype,"getEmailBody",null),D([b.validateTypes([b.nonEmptyString,"undefined"]),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Ve)],rr.prototype,"getEmailHistory",null),D([b.validateTypesAsync("string"),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],rr.prototype,"updateBody",null),D([b.validateTypesAsync(oe),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],rr.prototype,"updateAttributes",null),D([de.deprecated("attachTemporaryUrlsFor","getTemporaryContentUrlsForMedia"),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Promise)],rr.prototype,"attachTemporaryUrlsFor",null),D([b.validateTypesAsync(b.nonEmptyArray("media",Ve)),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Re.CancellablePromise)],rr.prototype,"getTemporaryContentUrlsForMedia",null),D([b.validateTypesAsync(b.nonEmptyArray("strings","string")),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Re.CancellablePromise)],rr.prototype,"getTemporaryContentUrlsForMediaSids",null);function Dn(I,O){var S=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!S){if(Array.isArray(I)||(S=Ct(I))||O&&I&&typeof I.length=="number"){S&&(I=S);var _=0,v=function(){};return{s:v,n:function(){return _>=I.length?{done:!0}:{done:!1,value:I[_++]}},e:function(m){throw m},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,d=!1,p;return{s:function(){S=S.call(I)},n:function(){var m=S.next();return g=m.done,m},e:function(m){d=!0,p=m},f:function(){try{!g&&S.return!=null&&S.return()}finally{if(d)throw p}}}}function Ct(I,O){if(!!I){if(typeof I=="string")return hr(I,O);var S=Object.prototype.toString.call(I).slice(8,-1);if(S==="Object"&&I.constructor&&(S=I.constructor.name),S==="Map"||S==="Set")return Array.from(I);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return hr(I,O)}}function hr(I,O){(O==null||O>I.length)&&(O=I.length);for(var S=0,_=new Array(O);S<O;S++)_[S]=I[S];return _}function qr(I){var O=Hr();return function(){var _=ue.default(I),v;if(O){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return H.default(this,v)}}function Hr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var yr=Ke.scope("Messages"),ms=function(I){re.default(S,I);var O=qr(S);function S(_,v,g){var d;return _e.default(this,S),d=O.call(this),d.conversation=_,d.configuration=v,d.services=g,d.messagesByIndex=new Map,d.messagesListPromise=null,d}return me.default(S,[{key:"subscribe",value:function(){var _=J.default(N.default.mark(function g(d){var p=this,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!this.messagesListPromise){y.next=2;break}return y.abrupt("return",this.messagesListPromise);case 2:return this.messagesListPromise=typeof d=="string"?this.services.syncClient.list({id:d,mode:"open_existing"}):Promise.resolve(d),y.prev=3,y.next=6,this.messagesListPromise;case 6:return f=y.sent,f.on("itemAdded",function(k){yr.debug("".concat(p.conversation.sid," itemAdded: ").concat(k.item.index));var E={self:"".concat(p.conversation._links.messages,"/").concat(k.item.data.sid),conversation:p.conversation._links.self,messages_receipts:"".concat(p.conversation._links.messages,"/").concat(k.item.data.sid,"/Receipts")},L=new rr(k.item.index,k.item.data,p.conversation,E,p.configuration,p.services);if(p.messagesByIndex.has(L.index)){yr.debug("Message arrived, but is already known and ignored",p.conversation.sid,L.index);return}p.messagesByIndex.set(L.index,L),L.on("updated",function(j){return p.emit("messageUpdated",j)}),p.emit("messageAdded",L)}),f.on("itemRemoved",function(k){yr.debug("#{this.conversation.sid} itemRemoved: ".concat(k.index));var E=k.index;if(p.messagesByIndex.has(E)){var L=p.messagesByIndex.get(E);if(!L)return;p.messagesByIndex.delete(L.index),L.removeAllListeners("updated"),p.emit("messageRemoved",L)}}),f.on("itemUpdated",function(k){yr.debug("".concat(p.conversation.sid," itemUpdated: ").concat(k.item.index));var E=p.messagesByIndex.get(k.item.index);E&&E._update(k.item.data)}),y.abrupt("return",f);case 13:throw y.prev=13,y.t0=y.catch(3),this.messagesListPromise=null,this.services.syncClient.connectionState!=="disconnected"&&yr.error("Failed to get messages object for conversation",this.conversation.sid,y.t0),yr.debug("ERROR: Failed to get messages object for conversation",this.conversation.sid,y.t0),y.t0;case 19:case"end":return y.stop()}},g,this,[[3,13]])}));function v(g){return _.apply(this,arguments)}return v}()},{key:"unsubscribe",value:function(){var _=J.default(N.default.mark(function g(){var d;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.messagesListPromise){f.next=2;break}return f.abrupt("return");case 2:return f.next=4,this.messagesListPromise;case 4:d=f.sent,d.close(),this.messagesListPromise=null;case 7:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"sendV2",value:function(v){var g=this;return yr.debug("Sending message V2",v.mediaContent,v.attributes,v.emailOptions),new Re.CancellablePromise(function(){var d=J.default(N.default.mark(function p(f,m,y){var k,E,L,j,Ce,Je,Ft,Ze,mr,cr,Ar,M;return N.default.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:E=[],L=[],y(function(){L.forEach(function(Be){return Be.cancel()})}),j=Dn(v.mediaContent),ie.prev=4,j.s();case 6:if((Ce=j.n()).done){ie.next=25;break}return Je=Xe.default(Ce.value,2),Ft=Je[0],Ze=Je[1],ie.prev=8,yr.debug("Adding media to a message as ".concat(Ze instanceof FormData?"FormData":"SendMediaOptions"),Ze),Ar=Ze instanceof FormData?g.services.mcsClient.postFormData(Ze,Ft):g.services.mcsClient.post((mr=Ze.contentType)!==null&&mr!==void 0?mr:"",(cr=Ze.media)!==null&&cr!==void 0?cr:"",Ft,Ze.filename),L.push(Ar),ie.t0=E,ie.next=15,Ar;case 15:ie.t1=ie.sent,ie.t0.push.call(ie.t0,ie.t1),ie.next=23;break;case 19:return ie.prev=19,ie.t2=ie.catch(8),m(ie.t2),ie.abrupt("return");case 23:ie.next=6;break;case 25:ie.next=30;break;case 27:ie.prev=27,ie.t3=ie.catch(4),j.e(ie.t3);case 30:return ie.prev=30,j.f(),ie.finish(30);case 33:return M=g.services.commandExecutor.mutateResource("post",g.conversation._links.messages,{body:v.text,subject:(k=v.emailOptions)===null||k===void 0?void 0:k.subject,media_sids:E.map(function(Be){return Be.sid}),attributes:typeof v.attributes<"u"?JSON.stringify(v.attributes):void 0}),ie.prev=34,ie.t4=f,ie.next=38,M;case 38:ie.t5=ie.sent,(0,ie.t4)(ie.t5),ie.next=45;break;case 42:ie.prev=42,ie.t6=ie.catch(34),m(ie.t6);case 45:case"end":return ie.stop()}},p,null,[[4,27,30,33],[8,19],[34,42]])}));return function(p,f,m){return d.apply(this,arguments)}}())}},{key:"send",value:function(){var _=J.default(N.default.mark(function g(d){var p,f,m=arguments;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return p=m.length>1&&m[1]!==void 0?m[1]:{},f=m.length>2?m[2]:void 0,yr.debug("Sending text message",d,p,f),k.abrupt("return",this.services.commandExecutor.mutateResource("post",this.conversation._links.messages,{body:d!=null?d:"",attributes:typeof p<"u"?JSON.stringify(p):void 0,subject:f==null?void 0:f.subject}));case 4:case"end":return k.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"sendMedia",value:function(){var _=J.default(N.default.mark(function g(d){var p,f,m,y,k,E=arguments;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(m=E.length>1&&E[1]!==void 0?E[1]:{},y=E.length>2?E[2]:void 0,yr.debug("Sending media message",d,m,y),yr.debug("Sending media message as ".concat(d instanceof FormData?"FormData":"SendMediaOptions"),d,m),!(d instanceof FormData)){j.next=10;break}return j.next=7,this.services.mcsClient.postFormData(d);case 7:j.t0=j.sent,j.next=13;break;case 10:return j.next=12,this.services.mcsClient.post((p=d.contentType)!==null&&p!==void 0?p:"",(f=d.media)!==null&&f!==void 0?f:"","media",d.filename);case 12:j.t0=j.sent;case 13:return k=j.t0,j.next=16,this.services.commandExecutor.mutateResource("post",this.conversation._links.messages,{media_sids:[k.sid],attributes:typeof m<"u"?JSON.stringify(m):void 0});case 16:return j.abrupt("return",j.sent);case 17:case"end":return j.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getMessages",value:function(){var _=J.default(N.default.mark(function g(d,p){var f,m=arguments;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return f=m.length>2&&m[2]!==void 0?m[2]:"backwards",k.abrupt("return",this._getMessages(d,p,f));case 2:case"end":return k.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"_wrapPaginator",value:function(v,g,d){var p=this,f=v==="desc",m=function(){return g.nextPage().then(function(E){return p._wrapPaginator(v,E,d)})},y=function(){return g.prevPage().then(function(E){return p._wrapPaginator(v,E,d)})};return d(g.items).then(function(k){return{items:k.sort(function(E,L){return E.index-L.index}),hasPrevPage:f?g.hasNextPage:g.hasPrevPage,hasNextPage:f?g.hasPrevPage:g.hasNextPage,prevPage:f?m:y,nextPage:f?y:m}})}},{key:"_upsertMessage",value:function(v,g){var d=this,p=this.messagesByIndex.get(v);if(p)return p;var f={self:"".concat(this.conversation._links.messages,"/").concat(g.sid),conversation:this.conversation._links.self,messages_receipts:"".concat(this.conversation._links.messages,"/").concat(g.sid,"/Receipts")},m=new rr(v,g,this.conversation,f,this.configuration,this.services);return this.messagesByIndex.set(m.index,m),m.on("updated",function(y){return d.emit("messageUpdated",y)}),m}},{key:"_getMessages",value:function(){var _=J.default(N.default.mark(function g(){var d=this,p,f,m,y,k,E,L=arguments;return N.default.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return p=L.length>0&&L[0]!==void 0?L[0]:30,f=L.length>1&&L[1]!==void 0?L[1]:"end",m=L.length>2&&L[2]!==void 0?L[2]:"forward",y=m==="backwards"?"desc":"asc",Ce.next=6,this.messagesListPromise;case 6:return k=Ce.sent,Ce.next=9,k==null?void 0:k.getItems({from:f!=="end"?f:void 0,pageSize:p,order:y,limit:p});case 9:return E=Ce.sent,Ce.next=12,this._wrapPaginator(y,E,function(Je){return Promise.all(Je.map(function(Ft){return d._upsertMessage(Ft.index,Ft.data)}))});case 12:return Ce.abrupt("return",Ce.sent);case 13:case"end":return Ce.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()}]),S}($.ReplayEventEmitter),Nr=function(){function I(O){_e.default(this,I),W.default(this,"attributes",{}),W.default(this,"mediaContent",[]),W.default(this,"emailOptions",{}),this.messagesEntity=O}return me.default(I,[{key:"send",value:function(){var S=this;return new Re.CancellablePromise(function(){var _=J.default(N.default.mark(function v(g,d,p){var f,m;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return f=S.messagesEntity.sendV2(S),p(function(){return f.cancel()}),k.prev=2,k.next=5,f;case 5:m=k.sent,g(ee(m.index)),k.next=12;break;case 9:k.prev=9,k.t0=k.catch(2),d(k.t0);case 12:case"end":return k.stop()}},v,null,[[2,9]])}));return function(v,g,d){return _.apply(this,arguments)}}())}}]),I}(),bs=function(){function I(O,S){_e.default(this,I),this.limits=O,this.message=new Nr(S),this.emailBodies=new Map,this.emailHistories=new Map}return me.default(I,[{key:"setBody",value:function(S){return this.message.text=S,this}},{key:"setSubject",value:function(S){return this.message.emailOptions.subject=S,this}},{key:"setAttributes",value:function(S){return this.message.attributes=S,this}},{key:"setEmailBody",value:function(S,_){return this.emailBodies.set(S,_),this}},{key:"setEmailHistory",value:function(S,_){return this.emailHistories.set(S,_),this}},{key:"addMedia",value:function(S){if(typeof FormData>"u"&&S instanceof FormData)throw new Error("Could not add FormData content whilst not in a browser");if(!(S instanceof FormData)){var _=S;if(!_.contentType||!_.media)throw new Error("Media content in SendMediaOptions must contain non-empty contentType and media")}return this.message.mediaContent.push(["media",S]),this}},{key:"build",value:function(){var S=this;if(this.emailBodies.forEach(function(_,v){if(!S.limits.emailBodiesAllowedContentTypes.includes(v))throw new Error("Unsupported email body content type ".concat(v))}),this.emailHistories.forEach(function(_,v){if(!S.limits.emailHistoriesAllowedContentTypes.includes(v))throw new Error("Unsupported email history content type ".concat(v))}),this.emailBodies.size>this.limits.emailBodiesAllowedContentTypes.length)throw new Error("Too many email bodies attached to the message (".concat(this.emailBodies.size," > ").concat(this.limits.emailBodiesAllowedContentTypes.length,")"));if(this.emailHistories.size>this.limits.emailHistoriesAllowedContentTypes.length)throw new Error("Too many email histories attached to the message (".concat(this.emailHistories.size," > ").concat(this.limits.emailHistoriesAllowedContentTypes.length,")"));if(this.message.mediaContent.length>this.limits.mediaAttachmentsCountLimit)throw new Error("Too many media attachments in the message (".concat(this.message.mediaContent.length," > ").concat(this.limits.mediaAttachmentsCountLimit,")"));return this.emailBodies.forEach(function(_){S.message.mediaContent.push(["body",_])}),this.emailHistories.forEach(function(_){S.message.mediaContent.push(["history",_])}),this.message}},{key:"buildAndSend",value:function(){return this.build().send()}},{key:"getPayloadContentType",value:function(S){return typeof FormData<"u"&&S instanceof FormData?S.get("Content-Type"):S.contentType}}]),I}();function Ro(I,O){var S=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!S){if(Array.isArray(I)||(S=Ao(I))||O&&I&&typeof I.length=="number"){S&&(I=S);var _=0,v=function(){};return{s:v,n:function(){return _>=I.length?{done:!0}:{done:!1,value:I[_++]}},e:function(m){throw m},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,d=!1,p;return{s:function(){S=S.call(I)},n:function(){var m=S.next();return g=m.done,m},e:function(m){d=!0,p=m},f:function(){try{!g&&S.return!=null&&S.return()}finally{if(d)throw p}}}}function Ao(I,O){if(!!I){if(typeof I=="string")return ws(I,O);var S=Object.prototype.toString.call(I).slice(8,-1);if(S==="Object"&&I.constructor&&(S=I.constructor.name),S==="Map"||S==="Set")return Array.from(I);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return ws(I,O)}}function ws(I,O){(O==null||O>I.length)&&(O=I.length);for(var S=0,_=new Array(O);S<O;S++)_[S]=I[S];return _}function Oo(I){var O=bn();return function(){var _=ue.default(I),v;if(O){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return H.default(this,v)}}function bn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var wn={lastMessage:"lastMessage",attributes:"attributes",createdBy:"createdBy",dateCreated:"dateCreated",dateUpdated:"dateUpdated",friendlyName:"friendlyName",lastConsumedMessageIndex:"lastConsumedMessageIndex",notificationLevel:"notificationLevel",sid:"sid",status:"status",uniqueName:"uniqueName",state:"state",bindings:"bindings"},St=function(I){re.default(S,I);var O=Oo(S);function S(_,v,g,d,p){var f,m,y;_e.default(this,S),y=O.call(this),y.sid=v,y._links=g,y._configuration=d,y._services=p,y._entityName=_.channel,y._internalState={uniqueName:_.uniqueName||null,status:"notParticipating",attributes:(f=_.attributes)!==null&&f!==void 0?f:{},createdBy:_.createdBy,dateCreated:Fe(_.dateCreated),dateUpdated:Fe(_.dateUpdated),friendlyName:_.friendlyName||null,lastReadMessageIndex:Number.isInteger(_.lastConsumedMessageIndex)?_.lastConsumedMessageIndex:null,bindings:(m=_.bindings)!==null&&m!==void 0?m:{}},_.notificationLevel&&(y._internalState.notificationLevel=_.notificationLevel);var k={participants:y._links.participants};return y._participants=new Map,y._participantsEntity=new je(xe.default(y),y._participants,k,y._configuration,y._services),y._participantsEntity.on("participantJoined",function(E){return y.emit("participantJoined",E)}),y._participantsEntity.on("participantLeft",function(E){return y.emit("participantLeft",E)}),y._participantsEntity.on("participantUpdated",function(E){return y.emit("participantUpdated",E)}),y._messagesEntity=new ms(xe.default(y),d,p),y._messagesEntity.on("messageAdded",function(E){return y._onMessageAdded(E)}),y._messagesEntity.on("messageUpdated",function(E){return y.emit("messageUpdated",E)}),y._messagesEntity.on("messageRemoved",function(E){return y.emit("messageRemoved",E)}),y}return me.default(S,[{key:"uniqueName",get:function(){return this._internalState.uniqueName}},{key:"status",get:function(){return this._internalState.status}},{key:"friendlyName",get:function(){return this._internalState.friendlyName}},{key:"dateUpdated",get:function(){return this._internalState.dateUpdated}},{key:"dateCreated",get:function(){return this._internalState.dateCreated}},{key:"createdBy",get:function(){var v;return(v=this._internalState.createdBy)!==null&&v!==void 0?v:""}},{key:"attributes",get:function(){return this._internalState.attributes}},{key:"lastReadMessageIndex",get:function(){return this._internalState.lastReadMessageIndex}},{key:"lastMessage",get:function(){var v;return(v=this._internalState.lastMessage)!==null&&v!==void 0?v:void 0}},{key:"notificationLevel",get:function(){var v;return(v=this._internalState.notificationLevel)!==null&&v!==void 0?v:"default"}},{key:"bindings",get:function(){return this._internalState.bindings}},{key:"limits",get:function(){return this._configuration.limits}},{key:"state",get:function(){return this._internalState.state}},{key:"_statusSource",get:function(){return this._dataSource}},{key:"add",value:function(){var _=J.default(N.default.mark(function g(d,p){return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",this._participantsEntity.add(d,p!=null?p:{}));case 1:case"end":return m.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"addNonChatParticipant",value:function(){var _=J.default(N.default.mark(function g(d,p){var f,m,y=arguments;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return f=y.length>2&&y[2]!==void 0?y[2]:{},m=y.length>3&&y[3]!==void 0?y[3]:{},E.abrupt("return",this._participantsEntity.addNonChatParticipant(d,p,f!=null?f:{},m!=null?m:{}));case 3:case"end":return E.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"advanceLastReadMessageIndex",value:function(){var _=J.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._subscribeStreams();case 2:if(!(d<((p=this.lastReadMessageIndex)!==null&&p!==void 0?p:0))){m.next=6;break}return m.next=5,this._setLastReadMessageIndex(this.lastReadMessageIndex);case 5:return m.abrupt("return",m.sent);case 6:return m.next=8,this._setLastReadMessageIndex(d);case 8:return m.abrupt("return",m.sent);case 9:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"delete",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._services.commandExecutor.mutateResource("delete",this._links.self);case 2:return p.abrupt("return",this);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getAttributes",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._subscribe();case 2:return p.abrupt("return",this.attributes);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getMessages",value:function(){var _=J.default(N.default.mark(function g(d,p,f){return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this._subscribeStreams();case 2:return y.abrupt("return",this._messagesEntity.getMessages(d,p,f));case 3:case"end":return y.stop()}},g,this)}));function v(g,d,p){return _.apply(this,arguments)}return v}()},{key:"getParticipants",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._subscribeStreams();case 2:return p.abrupt("return",this._participantsEntity.getParticipants());case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getParticipantsCount",value:function(){var _=J.default(N.default.mark(function g(){var d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return p=new Pe(this._configuration.links.conversations).path(this.sid).build(),y.next=3,this._services.network.get(p);case 3:return f=y.sent,y.abrupt("return",(d=f.body.participants_count)!==null&&d!==void 0?d:0);case 5:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getParticipantBySid",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this._participantsEntity.getParticipantBySid(d));case 1:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getParticipantByIdentity",value:function(){var _=J.default(N.default.mark(function g(){var d,p=arguments;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return d=p.length>0&&p[0]!==void 0?p[0]:"",m.abrupt("return",this._participantsEntity.getParticipantByIdentity(d!=null?d:""));case 2:case"end":return m.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getMessagesCount",value:function(){var _=J.default(N.default.mark(function g(){var d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return p=new Pe(this._configuration.links.conversations).path(this.sid).build(),y.next=3,this._services.network.get(p);case 3:return f=y.sent,y.abrupt("return",(d=f.body.messages_count)!==null&&d!==void 0?d:0);case 5:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getUnreadMessagesCount",value:function(){var _=J.default(N.default.mark(function g(){var d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return d=new Pe(this._configuration.links.myConversations).path(this.sid).build(),y.next=3,this._services.network.get(d);case 3:if(p=y.sent,p.body.conversation_sid===this.sid){y.next=6;break}throw new Error("Conversation was not found in the user conversations list");case 6:if(f=p.body.unread_messages_count,typeof f!="number"){y.next=9;break}return y.abrupt("return",f);case 9:return y.abrupt("return",null);case 10:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"join",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._services.commandExecutor.mutateResource("post",this._links.participants,{identity:this._configuration.userIdentity});case 2:return p.abrupt("return",this);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"leave",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this._internalState.status!=="joined"){p.next=3;break}return p.next=3,this._services.commandExecutor.mutateResource("delete","".concat(this._links.participants,"/").concat(this._configuration.userIdentity));case 3:return p.abrupt("return",this);case 4:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"removeParticipant",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._participantsEntity.remove(typeof d=="string"?d:d.sid);case 2:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"sendMessage",value:function(){var _=J.default(N.default.mark(function g(d,p,f){var m,y,k,E;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!(typeof d=="string"||d===null)){j.next=5;break}return j.next=3,this._messagesEntity.send(d,p,f);case 3:return k=j.sent,j.abrupt("return",(y=ee(k.index))!==null&&y!==void 0?y:0);case 5:return j.next=7,this._messagesEntity.sendMedia(d,p,f);case 7:return E=j.sent,j.abrupt("return",(m=ee(E.index))!==null&&m!==void 0?m:0);case 9:case"end":return j.stop()}},g,this)}));function v(g,d,p){return _.apply(this,arguments)}return v}()},{key:"prepareMessage",value:function(){return new bs(this.limits,this._messagesEntity)}},{key:"setAllMessagesRead",value:function(){var _=J.default(N.default.mark(function g(){var d;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._subscribeStreams();case 2:return f.next=4,this.getMessages(1);case 4:if(d=f.sent,!(d.items.length>0)){f.next=7;break}return f.abrupt("return",this.advanceLastReadMessageIndex(d.items[0].index));case 7:return f.abrupt("return",0);case 8:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"setAllMessagesUnread",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._subscribeStreams();case 2:return p.next=4,this._setLastReadMessageIndex(null);case 4:return p.abrupt("return",p.sent);case 5:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"setUserNotificationLevel",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._services.commandExecutor.mutateResource("post","".concat(this._configuration.links.myConversations,"/").concat(this.sid),{notification_level:d});case 2:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"typing",value:function(){return this._services.typingIndicator.send(this.sid)}},{key:"updateAttributes",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._services.commandExecutor.mutateResource("post",this._links.self,{attributes:d!==void 0?JSON.stringify(d):void 0});case 2:return f.abrupt("return",this);case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateFriendlyName",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this._internalState.friendlyName===d){f.next=3;break}return f.next=3,this._services.commandExecutor.mutateResource("post",this._links.self,{friendly_name:d});case 3:return f.abrupt("return",this);case 4:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateLastReadMessageIndex",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._subscribeStreams();case 2:return f.abrupt("return",this._setLastReadMessageIndex(d));case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateUniqueName",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this._internalState.uniqueName===d){f.next=4;break}return d||(d=""),f.next=4,this._services.commandExecutor.mutateResource("post",this._links.self,{unique_name:d});case 4:return f.abrupt("return",this);case 5:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"_subscribe",value:function(){var _=J.default(N.default.mark(function g(){var d=this;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!this._entityPromise){f.next=2;break}return f.abrupt("return",this._entityPromise);case 2:return this._entityPromise=this._services.syncClient.document({id:this._entityName,mode:"open_existing"}),f.prev=3,f.next=6,this._entityPromise;case 6:return this._entity=f.sent,this._entity.on("updated",function(m){return d._update(m.data)}),this._entity.on("removed",function(){return d.emit("removed",d)}),this._update(this._entity.data),f.abrupt("return",this._entity);case 13:throw f.prev=13,f.t0=f.catch(3),this._entity=null,this._entityPromise=null,this._services.syncClient.connectionState!="disconnected"&&S._logger.error("Failed to get conversation object",f.t0),S._logger.debug("ERROR: Failed to get conversation object",f.t0),f.t0;case 20:case"end":return f.stop()}},g,this,[[3,13]])}));function v(){return _.apply(this,arguments)}return v}()},{key:"_fetchStreams",value:function(){var _=J.default(N.default.mark(function g(){var d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this._subscribe();case 2:return S._logger.trace("_streamsAvailable, this.entity.data=",(d=this._entity)===null||d===void 0?void 0:d.data),f=(p=this._entity)===null||p===void 0?void 0:p.data,y.next=6,this._services.syncClient.list({id:f.messages,mode:"open_existing"});case 6:return this._messagesList=y.sent,y.next=9,this._services.syncClient.map({id:f.roster,mode:"open_existing"});case 9:this._participantsMap=y.sent;case 10:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_subscribeStreams",value:function(){var _=J.default(N.default.mark(function g(){var d,p,f,m,y,k,E;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.prev=0,j.next=3,this._subscribe();case 3:return S._logger.trace("_subscribeStreams, this.entity.data=",(d=this._entity)===null||d===void 0?void 0:d.data),y=(p=this._entity)===null||p===void 0?void 0:p.data,k=y.messages,E=y.roster,j.next=9,Promise.all([this._messagesEntity.subscribe((f=this._messagesList)!==null&&f!==void 0?f:k),this._participantsEntity.subscribe((m=this._participantsMap)!==null&&m!==void 0?m:E)]);case 9:j.next=16;break;case 11:throw j.prev=11,j.t0=j.catch(0),this._services.syncClient.connectionState!=="disconnected"&&S._logger.error("Failed to subscribe on conversation objects",this.sid,j.t0),S._logger.debug("ERROR: Failed to subscribe on conversation objects",this.sid,j.t0),j.t0;case 16:case"end":return j.stop()}},g,this,[[0,11]])}));function v(){return _.apply(this,arguments)}return v}()},{key:"_unsubscribe",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!this._entity){p.next=5;break}return p.next=3,this._entity.close();case 3:this._entity=null,this._entityPromise=null;case 5:return p.abrupt("return",Promise.all([this._participantsEntity.unsubscribe(),this._messagesEntity.unsubscribe()]));case 6:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_setStatus",value:function(v,g){var d=this;if(this._dataSource=g,this._internalState.status!==v){if(this._internalState.status=v,v==="joined"){this._subscribeStreams().catch(function(p){if(S._logger.debug("ERROR while setting conversation status "+v,p),d._services.syncClient.connectionState!=="disconnected")throw p});return}this._entityPromise&&this._unsubscribe().catch(function(p){if(S._logger.debug("ERROR while setting conversation status "+v,p),d._services.syncClient.connectionState!=="disconnected")throw p})}}},{key:"_update",value:function(v){var g,d,p,f,m;S._logger.trace("_update",v),S.preprocessUpdate(v,this.sid);for(var y=new Set,k=0,E=Object.keys(v);k<E.length;k++){var L=E[k],j=wn[L];if(!!j)switch(j){case wn.status:if(!v.status||v.status==="unknown"||this._internalState.status===v.status)break;this._internalState.status=v.status,y.add(j);break;case wn.attributes:if(Ee.default(this._internalState.attributes,v.attributes))break;this._internalState.attributes=v.attributes,y.add(j);break;case wn.lastConsumedMessageIndex:if(v.lastConsumedMessageIndex===void 0||v.lastConsumedMessageIndex===this._internalState.lastReadMessageIndex)break;this._internalState.lastReadMessageIndex=v.lastConsumedMessageIndex,y.add("lastReadMessageIndex");break;case wn.lastMessage:if(this._internalState.lastMessage&&!v.lastMessage){delete this._internalState.lastMessage,y.add(j);break}this._internalState.lastMessage=this._internalState.lastMessage||{},((g=v.lastMessage)===null||g===void 0?void 0:g.index)!==void 0&&v.lastMessage.index!==this._internalState.lastMessage.index&&(this._internalState.lastMessage.index=v.lastMessage.index,y.add(j)),((d=v.lastMessage)===null||d===void 0?void 0:d.timestamp)!==void 0&&((p=this._internalState.lastMessage)===null||p===void 0||(f=p.dateCreated)===null||f===void 0?void 0:f.getTime())!==v.lastMessage.timestamp.getTime()&&(this._internalState.lastMessage.dateCreated=v.lastMessage.timestamp,y.add(j)),Ee.default(this._internalState.lastMessage,{})&&delete this._internalState.lastMessage;break;case wn.state:var Ce=v.state||void 0;if(Ce!==void 0&&(Ce.dateUpdated=new Date(Ce.dateUpdated)),Ee.default(this._internalState.state,Ce))break;this._internalState.state=Ce,y.add(j);break;case wn.bindings:if(Ee.default(this._internalState.bindings,v.bindings))break;this._internalState.bindings=v.bindings,y.add(j);break;default:var Je=v[L]instanceof Date,Ft=Je&&((m=this._internalState[j])===null||m===void 0?void 0:m.getTime())===v[L].getTime(),Ze=!Je&&this[j]===v[L];if(Ft||Ze)break;this._internalState[j]=v[L],y.add(j)}}y.size>0&&this.emit("updated",{conversation:this,updateReasons:Ye.default(y)})}},{key:"_onMessageAdded",value:function(v){var g=Ro(this._participants.values()),d;try{for(g.s();!(d=g.n()).done;){var p=d.value;if(p.identity===v.author){p._endTyping();break}}}catch(f){g.e(f)}finally{g.f()}this.emit("messageAdded",v)}},{key:"_setLastReadMessageIndex",value:function(){var _=J.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._services.commandExecutor.mutateResource("post","".concat(this._configuration.links.myConversations,"/").concat(this.sid),{last_read_message_index:d});case 2:return p=m.sent,m.abrupt("return",p.unread_messages_count);case 4:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()}],[{key:"preprocessUpdate",value:function(v,g){try{typeof v.attributes=="string"?v.attributes=JSON.parse(v.attributes):v.attributes&&JSON.stringify(v.attributes)}catch{S._logger.warn("Retrieved malformed attributes from the server for conversation: "+g),v.attributes={}}try{v.dateCreated&&(v.dateCreated=new Date(v.dateCreated))}catch{S._logger.warn("Retrieved malformed dateCreated from the server for conversation: "+g),delete v.dateCreated}try{v.dateUpdated&&(v.dateUpdated=new Date(v.dateUpdated))}catch{S._logger.warn("Retrieved malformed dateUpdated from the server for conversation: "+g),delete v.dateUpdated}try{v.lastMessage&&v.lastMessage.timestamp&&(v.lastMessage.timestamp=new Date(v.lastMessage.timestamp))}catch{S._logger.warn("Retrieved malformed lastMessage.timestamp from the server for conversation: "+g),delete v.lastMessage.timestamp}}}]),S}($.ReplayEventEmitter);W.default(St,"participantJoined","participantJoined"),W.default(St,"participantLeft","participantLeft"),W.default(St,"participantUpdated","participantUpdated"),W.default(St,"messageAdded","messageAdded"),W.default(St,"messageRemoved","messageRemoved"),W.default(St,"messageUpdated","messageUpdated"),W.default(St,"typingEnded","typingEnded"),W.default(St,"typingStarted","typingStarted"),W.default(St,"updated","updated"),W.default(St,"removed","removed"),W.default(St,"_logger",Ke.scope("Conversation")),D([b.validateTypesAsync(b.nonEmptyString,F),T("design:type",Function),T("design:paramtypes",[String,Object]),T("design:returntype",Promise)],St.prototype,"add",null),D([b.validateTypesAsync(b.nonEmptyString,b.nonEmptyString,F),T("design:type",Function),T("design:paramtypes",[String,String,Object,Object]),T("design:returntype",Promise)],St.prototype,"addNonChatParticipant",null),D([b.validateTypesAsync(b.nonNegativeInteger),T("design:type",Function),T("design:paramtypes",[Number]),T("design:returntype",Promise)],St.prototype,"advanceLastReadMessageIndex",null),D([b.validateTypesAsync(["undefined",b.nonNegativeInteger],["undefined",b.nonNegativeInteger],["undefined",b.literal("backwards","forward")]),T("design:type",Function),T("design:paramtypes",[Number,Number,String]),T("design:returntype",Promise)],St.prototype,"getMessages",null),D([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],St.prototype,"getParticipantBySid",null),D([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],St.prototype,"getParticipantByIdentity",null),D([b.validateTypesAsync([b.nonEmptyString,K]),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],St.prototype,"removeParticipant",null),D([b.validateTypesAsync(["string",FormData,b.literal(null),b.objectSchema("media options",{contentType:b.nonEmptyString,media:b.custom(function(I){var O=typeof I=="string"&&I.length>0||I instanceof Uint8Array||I instanceof ArrayBuffer;return typeof Blob=="function"&&(O=O||I instanceof Blob),[O,"a non-empty string, an instance of Buffer or an instance of Blob"]})})],F,["undefined",b.literal(null),b.objectSchema("email attributes",{subject:[b.nonEmptyString,"undefined"]})]),T("design:type",Function),T("design:paramtypes",[Object,Object,Object]),T("design:returntype",Promise)],St.prototype,"sendMessage",null),D([b.validateTypesAsync(b.literal("default","muted")),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],St.prototype,"setUserNotificationLevel",null),D([b.validateTypesAsync(oe),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],St.prototype,"updateAttributes",null),D([b.validateTypesAsync("string"),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],St.prototype,"updateFriendlyName",null),D([b.validateTypesAsync([b.literal(null),b.nonNegativeInteger]),T("design:type",Function),T("design:paramtypes",[Number]),T("design:returntype",Promise)],St.prototype,"updateLastReadMessageIndex",null),D([b.validateTypesAsync(["string",b.literal(null)]),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],St.prototype,"updateUniqueName",null);var Po=function(){function I(){var O=this;_e.default(this,I),this._promise=new Promise(function(S,_){O._resolve=S,O._reject=_})}return me.default(I,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(S){this._resolve(S)}},{key:"set",value:function(S){this.current=S,this._resolve(S)}},{key:"fail",value:function(S){this._reject(S)}}]),I}();function Mo(I,O){var S=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!S){if(Array.isArray(I)||(S=xo(I))||O&&I&&typeof I.length=="number"){S&&(I=S);var _=0,v=function(){};return{s:v,n:function(){return _>=I.length?{done:!0}:{done:!1,value:I[_++]}},e:function(m){throw m},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,d=!1,p;return{s:function(){S=S.call(I)},n:function(){var m=S.next();return g=m.done,m},e:function(m){d=!0,p=m},f:function(){try{!g&&S.return!=null&&S.return()}finally{if(d)throw p}}}}function xo(I,O){if(!!I){if(typeof I=="string")return na(I,O);var S=Object.prototype.toString.call(I).slice(8,-1);if(S==="Object"&&I.constructor&&(S=I.constructor.name),S==="Map"||S==="Set")return Array.from(I);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return na(I,O)}}function na(I,O){(O==null||O>I.length)&&(O=I.length);for(var S=0,_=new Array(O);S<O;S++)_[S]=I[S];return _}function _s(I,O){var S=Object.keys(I);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(I);O&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(I,v).enumerable})),S.push.apply(S,_)}return S}function No(I){for(var O=1;O<arguments.length;O++){var S=arguments[O]!=null?arguments[O]:{};O%2?_s(Object(S),!0).forEach(function(_){W.default(I,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(S)):_s(Object(S)).forEach(function(_){Object.defineProperty(I,_,Object.getOwnPropertyDescriptor(S,_))})}return I}function tn(I){var O=Lo();return function(){var _=ue.default(I),v;if(O){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return H.default(this,v)}}function Lo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var gr=Ke.scope("Conversations"),jo=function(I){re.default(S,I);var O=tn(S);function S(_,v){var g;return _e.default(this,S),g=O.call(this),W.default(xe.default(g),"conversations",new Map),W.default(xe.default(g),"myConversationsRead",new Po),W.default(xe.default(g),"tombstones",new Set),W.default(xe.default(g),"myConversationsFetched",!1),g.configuration=_,g.services=v,g}return me.default(S,[{key:"addConversation",value:function(){var _=J.default(N.default.mark(function g(d){var p,f,m,y,k,E,L,j,Ce,Je;return N.default.wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return y=typeof(d==null?void 0:d.attributes)<"u"?d.attributes:{},Ze.next=3,this.services.commandExecutor.mutateResource("post",this.configuration.links.conversations,{friendly_name:d.friendlyName,unique_name:d.uniqueName,attributes:typeof y<"u"?JSON.stringify(y):void 0});case 3:if(k=Ze.sent,E=(p=k.sid)!==null&&p!==void 0?p:null,L=(f=(m=k.sync_objects)===null||m===void 0?void 0:m.conversation)!==null&&f!==void 0?f:null,j=No({self:k.url},k.links),Ce=this.conversations.get(E),!Ce){Ze.next=12;break}return Ze.next=11,Ce._subscribe();case 11:return Ze.abrupt("return",Ce);case 12:return Je=new St({channel:L,entityName:"",uniqueName:"",attributes:null,createdBy:"",friendlyName:"",lastConsumedMessageIndex:0,dateCreated:null,dateUpdated:null},E,j,this.configuration,this.services),this.conversations.set(Je.sid,Je),this._registerForEvents(Je),Ze.next=17,Je._subscribe();case 17:return this.emit("conversationAdded",Je),Ze.abrupt("return",Je);case 19:case"end":return Ze.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"fetchConversations",value:function(){var _=J.default(N.default.mark(function g(){var d=this,p,f,m,y,k,E,L;return N.default.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return Ce.prev=0,Ce.next=3,this._getMap();case 3:return p=Ce.sent,p.on("itemAdded",function(Je){gr.debug("itemAdded: ".concat(Je.item.key)),d._upsertConversation("sync",Je.item.key,Je.item.data)}),p.on("itemRemoved",function(Je){gr.debug("itemRemoved: ".concat(Je.key));var Ft=Je.key;d.myConversationsFetched||d.tombstones.add(Ft);var Ze=d.conversations.get(Ft);!Ze||(Ze.status==="joined"&&(Ze._setStatus("notParticipating","sync"),d.emit("conversationLeft",Ze)),d.conversations.delete(Ft),d.emit("conversationRemoved",Ze),Ze.emit("removed",Ze))}),p.on("itemUpdated",function(Je){gr.debug("itemUpdated: ".concat(Je.item.key)),d._upsertConversation("sync",Je.item.key,Je.item.data)}),Ce.next=9,this._fetchMyConversations();case 9:f=Ce.sent,m=[],y=Mo(f);try{for(y.s();!(k=y.n()).done;)E=k.value,m.push(this._upsertConversation("rest",E.channel_sid,E))}catch(Je){y.e(Je)}finally{y.f()}return this.myConversationsRead.set(!0),Ce.next=16,Promise.all(m);case 16:return this.myConversationsFetched=!0,this.tombstones.clear(),gr.debug("The conversations list has been successfully fetched"),Ce.abrupt("return",this);case 22:throw Ce.prev=22,Ce.t0=Ce.catch(0),L="Failed to fetch the conversations list",this.services.syncClient.connectionState!=="disconnected"&&gr.error(L,Ce.t0),gr.debug("ERROR: ".concat(L),Ce.t0),Ce.t0;case 28:case"end":return Ce.stop()}},g,this,[[0,22]])}));function v(){return _.apply(this,arguments)}return v}()},{key:"getConversations",value:function(){var _=J.default(N.default.mark(function g(){var d=this,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this._getMap();case 2:return p=y.sent,y.next=5,p.getItems();case 5:return f=y.sent,y.abrupt("return",this._wrapPaginator(f,function(k){return Promise.all(k.map(function(E){return d._upsertConversation("sync",E.key,E.data)}))}));case 7:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getConversation",value:function(){var _=J.default(N.default.mark(function g(d){var p=this,f,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._getMap();case 2:return f=E.sent,E.next=5,f.getItems({key:d});case 5:return m=E.sent,y=m.items.map(function(L){return p._upsertConversation("sync",L.key,L.data)}),E.abrupt("return",y.length>0?y[0]:null);case 8:case"end":return E.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getConversationByUniqueName",value:function(){var _=J.default(N.default.mark(function g(d){var p,f,m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return p=new Pe(this.configuration.links.myConversations).path(d).build(),L.next=3,this.services.network.get(p);case 3:return f=L.sent,m=f.body,y=m.conversation_sid,k={entityName:null,lastConsumedMessageIndex:m.last_read_message_index,status:(m==null?void 0:m.status)||"unknown",friendlyName:m.friendly_name,dateUpdated:m.date_updated,dateCreated:m.date_created,uniqueName:m.unique_name,createdBy:m.created_by,attributes:m.attributes,channel:m.sync_objects.conversation,notificationLevel:m==null?void 0:m.notification_level,sid:y},L.abrupt("return",y?this._upsertConversation("sync",y,k):null);case 8:case"end":return L.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"peekConversation",value:function(){var _=J.default(N.default.mark(function g(d){var p,f,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return p=new Pe(this.configuration.links.conversations).path(d).build(),E.next=3,this.services.network.get(p);case 3:return f=E.sent,m=f.body,y={entityName:null,status:(m==null?void 0:m.status)||"unknown",friendlyName:m.friendly_name,dateUpdated:m.date_updated,dateCreated:m.date_created,uniqueName:m.unique_name,createdBy:m.created_by,attributes:m.attributes,channel:"".concat(d,".channel"),sid:d},E.abrupt("return",this._upsertConversation("sync",d,y));case 7:case"end":return E.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"_getMap",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.services.syncClient.map({id:this.configuration.myConversations,mode:"open_existing"});case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_wrapPaginator",value:function(){var _=J.default(N.default.mark(function g(d,p){var f=this,m;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,p(d.items);case 2:return m=k.sent,k.abrupt("return",{items:m.filter(function(E){return E!==null}),hasNextPage:d.hasNextPage,hasPrevPage:d.hasPrevPage,nextPage:function(){return d.nextPage().then(function(L){return f._wrapPaginator(L,p)})},prevPage:function(){return d.prevPage().then(function(L){return f._wrapPaginator(L,p)})}});case 4:case"end":return k.stop()}},g)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"_updateConversation",value:function(){var _=J.default(N.default.mark(function g(d,p,f){var m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(m=p._statusSource!==void 0&&d!==p._statusSource,y=d!=="rest"||p._statusSource==="sync",!(m&&y&&d!=="sync")){L.next=5;break}return gr.trace("upsertConversation: conversation is known from sync and came from REST, ignoring",{sid:p.sid,data:f.status,conversation:p.status}),L.abrupt("return");case 5:if(!(f.status==="joined"&&p.status!=="joined")){L.next=15;break}return p._setStatus("joined",d),k={},typeof f.notificationLevel<"u"&&(k.notificationLevel=f.notificationLevel),typeof f.lastConsumedMessageIndex<"u"&&(k.lastConsumedMessageIndex=f.lastConsumedMessageIndex),Ee.default(k,{})||p._update(k),L.next=13,p._subscribe();case 13:return this.emit("conversationJoined",p),L.abrupt("return");case 15:if(!(f.status==="notParticipating"&&p.status==="joined")){L.next=22;break}return p._setStatus("notParticipating",d),p._update(f),L.next=20,p._subscribe();case 20:return this.emit("conversationLeft",p),L.abrupt("return");case 22:if(f.status!=="notParticipating"){L.next=26;break}return L.next=25,p._subscribe();case 25:return L.abrupt("return");case 26:p._update(f);case 27:case"end":return L.stop()}},g,this)}));function v(g,d,p){return _.apply(this,arguments)}return v}()},{key:"_upsertConversation",value:function(){var _=J.default(N.default.mark(function g(d,p,f){var m,y,k,E;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(gr.trace("upsertConversation called for ".concat(p),f),m=this.conversations.get(p),!m){j.next=9;break}return gr.trace("upsertConversation: the conversation ".concat(m.sid," is known;")+"its status is known from the source ".concat(m._statusSource," ")+"and the update came from the source ".concat(d),m),j.next=6,this._updateConversation(d,m,f);case 6:return j.next=8,m._subscribe();case 8:return j.abrupt("return",m);case 9:if(!(d==="rest"&&this.tombstones.has(p))){j.next=12;break}return gr.trace("upsertChannel: the conversation is deleted but reappeared again from REST, ignoring",p),j.abrupt("return",null);case 12:return gr.trace("upsertConversation: creating a local conversation object with sid "+p,f),y="".concat(this.configuration.links.conversations,"/").concat(p),k={self:y,messages:"".concat(y,"/Messages"),participants:"".concat(y,"/Participants")},E=new St(f,p,k,this.configuration,this.services),this.conversations.set(p,E),j.prev=17,j.next=20,E._subscribe();case 20:if(f.status!=="joined"){j.next=23;break}return j.next=23,E._fetchStreams();case 23:j.next=32;break;case 25:if(j.prev=25,j.t0=j.catch(17),j.t0.name==="SyncError"){j.next=29;break}throw j.t0;case 29:return gr.trace("upsertChannel: the conversation is missing some Sync entity(ies), ignoring",p,j.t0),this.conversations.delete(p),j.abrupt("return",null);case 32:return this._registerForEvents(E),this.emit("conversationAdded",E),f.status==="joined"&&(E._setStatus("joined",d),this.emit("conversationJoined",E)),j.abrupt("return",E);case 36:case"end":return j.stop()}},g,this,[[17,25]])}));function v(g,d,p){return _.apply(this,arguments)}return v}()},{key:"_fetchMyConversations",value:function(){var _=J.default(N.default.mark(function g(){var d,p,f,m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:d=[],p=null;case 2:return m=new Pe(this.configuration.links.myConversations),p&&m.arg("PageToken",p),L.next=6,this.services.network.get(m.build());case 6:y=L.sent,k=(f=y.body)===null||f===void 0?void 0:f.conversations.map(function(j){return{descriptor:j,channel_sid:j.conversation_sid,status:j.status,channel:j.sync_objects.conversation,messages:j.sync_objects.messages,roster:"".concat(j.conversation_sid,".roster"),lastConsumedMessageIndex:j.last_read_message_index,notificationLevel:j.notification_level}}),p=y.body.meta.next_token,d=[].concat(Ye.default(d),Ye.default(k));case 10:if(p){L.next=2;break}case 11:return L.abrupt("return",d);case 12:case"end":return L.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_onConversationRemoved",value:function(v){var g=this.conversations.get(v);g&&(this.conversations.delete(v),this.emit("conversationRemoved",g))}},{key:"_registerForEvents",value:function(v){var g=this;v.on("removed",function(){return g._onConversationRemoved(v.sid)}),v.on("updated",function(d){return g.emit("conversationUpdated",d)}),v.on("participantJoined",function(d){return g.emit("participantJoined",d)}),v.on("participantLeft",function(d){return g.emit("participantLeft",d)}),v.on("participantUpdated",function(d){return g.emit("participantUpdated",d)}),v.on("messageAdded",function(d){return g.emit("messageAdded",d)}),v.on("messageUpdated",function(d){return g.emit("messageUpdated",d)}),v.on("messageRemoved",function(d){return g.emit("messageRemoved",d)}),v.on("typingStarted",function(d){return g.emit("typingStarted",d)}),v.on("typingEnded",function(d){return g.emit("typingEnded",d)})}}]),S}($.ReplayEventEmitter);function Uo(I){var O=Fo();return function(){var _=ue.default(I),v;if(O){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return H.default(this,v)}}function Fo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Do=function(I){re.default(S,I);var O=Uo(S);function S(_,v,g){var d;return _e.default(this,S),d=O.call(this),d.configuration=v,d.services=g,d.fifoStack=[],d.myself=_,d.myself.on("updated",function(p){return d.emit("userUpdated",p)}),d.myself.on("userSubscribed",function(){return d.emit("userSubscribed",d.myself)}),d.myself.on("userUnsubscribed",function(){d.emit("userUnsubscribed",d.myself),d.myself._ensureFetched()}),d.subscribedUsers=new Map,d}return me.default(S,[{key:"handleUnsubscribeUser",value:function(v){this.subscribedUsers.has(v.identity)&&this.subscribedUsers.delete(v.identity);var g=0,d=this.fifoStack.find(function(p,f){return p==v.identity?(g=f,!0):!1});d&&this.fifoStack.splice(g,1),this.emit("userUnsubscribed",v)}},{key:"handleSubscribeUser",value:function(v){if(!this.subscribedUsers.has(v.identity)){if(this.fifoStack.length>=this.configuration.userInfosToSubscribe){var g,d,p=this.fifoStack.shift();(g=this.subscribedUsers)===null||g===void 0||(d=g.get(p))===null||d===void 0||d.unsubscribe()}this.fifoStack.push(v.identity),this.subscribedUsers.set(v.identity,v),this.emit("userSubscribed",v)}}},{key:"getUser",value:function(){var _=J.default(N.default.mark(function g(d,p){var f,m=this,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,this.myself._ensureFetched();case 2:if(d!=this.myself.identity){L.next=4;break}return L.abrupt("return",this.myself);case 4:if(y=this.subscribedUsers.get(d),!y){L.next=7;break}return L.abrupt("return",y);case 7:if(!((f=p)!==null&&f!==void 0)){L.next=11;break}L.next=14;break;case 11:return L.next=13,this.getSyncUniqueName(d);case 13:p=L.sent;case 14:return k=new Ne(d,p,this.configuration,this.services),k.on("updated",function(j){return m.emit("userUpdated",j)}),k.on("userSubscribed",function(){return m.handleSubscribeUser(k)}),k.on("userUnsubscribed",function(){return m.handleUnsubscribeUser(k)}),L.next=20,k._ensureFetched();case 20:return L.abrupt("return",k);case 21:case"end":return L.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"getSubscribedUsers",value:function(){var _=J.default(N.default.mark(function g(){var d;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.myself._ensureFetched();case 2:return d=[this.myself],this.subscribedUsers.forEach(function(m){return d.push(m)}),f.abrupt("return",d);case 5:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getSyncUniqueName",value:function(){var _=J.default(N.default.mark(function g(d){var p,f,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return m=new Pe(this.configuration.links.users).path(d).build(),E.next=3,this.services.network.get(m);case 3:return y=E.sent,E.abrupt("return",(p=(f=y.body)===null||f===void 0?void 0:f.sync_objects.user_info_map)!==null&&p!==void 0?p:"");case 5:case"end":return E.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()}]),S}($.ReplayEventEmitter),_n=Ke.scope("TypingIndicator"),Bo=function(){function I(O,S,_){_e.default(this,I),this.configuration=S,this.services=_,this.getConversation=O,this.serviceTypingTimeout=null,this.sentUpdates=new Map}return me.default(I,[{key:"typingTimeout",get:function(){return this.configuration.typingIndicatorTimeoutOverride||this.serviceTypingTimeout||this.configuration.typingIndicatorTimeoutDefault}},{key:"initialize",value:function(){var S=this;this.services.notificationClient.on("message",function(){var _=J.default(N.default.mark(function v(g,d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(g!==Le.TYPING_INDICATOR){f.next=3;break}return f.next=3,S._handleRemoteTyping(d);case 3:case"end":return f.stop()}},v)}));return function(v,g){return _.apply(this,arguments)}}())}},{key:"_handleRemoteTyping",value:function(){var O=J.default(N.default.mark(function _(v){var g=this;return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:_n.trace("Got new typing indicator ",v),this.getConversation(v.channel_sid).then(function(f){!f||f._participants.forEach(function(m){if(m.identity===v.identity){var y=g.configuration.typingIndicatorTimeoutOverride?g.configuration.typingIndicatorTimeoutOverride+1e3:v.typing_timeout*1e3;m._startTyping(y)}})}).catch(function(f){throw _n.error(f),f});case 2:case"end":return p.stop()}},_,this)}));function S(_){return O.apply(this,arguments)}return S}()},{key:"send",value:function(S){var _=this.sentUpdates.get(S);return _&&_>Date.now()-this.typingTimeout?Promise.resolve():(this.sentUpdates.set(S,Date.now()),this._send(S))}},{key:"_send",value:function(S){var _=this;_n.trace("Sending typing indicator");var v=this.configuration.links.typing,g={"Content-Type":"application/x-www-form-urlencoded"},d="ChannelSid=".concat(S);return this.services.twilsockClient.post(v,g,d,this.configuration.productId).then(function(p){p.body.hasOwnProperty("typing_timeout")&&(_.serviceTypingTimeout=p.body.typing_timeout*1e3)}).catch(function(p){throw _n.error("Failed to send typing indicator:",p),p})}}]),I}(),Lr=me.default(function I(O){_e.default(this,I),this.title=O.title||null,this.body=O.body||null,this.sound=O.sound||null,this.badge=O.badge||null,this.action=O.action||null,this.type=O.type||null,this.data=O.data||{}}),Ua="2.2.0";function Ci(I,O){var S=Object.keys(I);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(I);O&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(I,v).enumerable})),S.push.apply(S,_)}return S}function qo(I){for(var O=1;O<arguments.length;O++){var S=arguments[O]!=null?arguments[O]:{};O%2?Ci(Object(S),!0).forEach(function(_){W.default(I,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(S)):Ci(Object(S)).forEach(function(_){Object.defineProperty(I,_,Object.getOwnPropertyDescriptor(S,_))})}return I}var Ss=function(O){return O.replace(/(^\/+|\/+$)/g,"")},Ho=function(O){return O.status.code===202},Wo=function(){function I(O,S,_){_e.default(this,I),this._serviceUrl=O,this._services=S,this._productId=_}return me.default(I,[{key:"_preProcessUrl",value:function(S){var _=Ss(S);return/^https?:\/\//.test(S)?_:"".concat(Ss(this._serviceUrl),"/").concat(_)}},{key:"_makeRequest",value:function(){var O=J.default(N.default.mark(function _(v,g,d,p){var f,m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:f=this._preProcessUrl(g),m=qo({"Content-Type":"application/json; charset=utf-8"},p||{}),L.t0=v,L.next=L.t0==="get"?5:L.t0==="post"?11:L.t0==="delete"?15:19;break;case 5:return k=f,d&&(k+="?"+Object.entries(d).map(function(j){return j.map(encodeURIComponent).join("=")}).join("&")),L.next=9,this._services.transport.get(k,m,this._productId);case 9:return y=L.sent,L.abrupt("break",19);case 11:return L.next=13,this._services.transport.post(f,m,JSON.stringify(d),this._productId);case 13:return y=L.sent,L.abrupt("break",19);case 15:return L.next=17,this._services.transport.delete(f,m,{},this._productId);case 17:return y=L.sent,L.abrupt("break",19);case 19:if(!(y.status.code<200||y.status.code>=300)){L.next=21;break}throw new Error("Request responded with a non-success code ".concat(y.status.code));case 21:return L.abrupt("return",y);case 22:case"end":return L.stop()}},_,this)}));function S(_,v,g,d){return O.apply(this,arguments)}return S}()},{key:"fetchResource",value:function(){var O=J.default(N.default.mark(function _(v,g){var d=this,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return p=6,y.prev=1,y.next=4,new U.AsyncRetrier({min:50,max:1600,maxAttemptsCount:p}).run(function(){return d._makeRequest("get",v,g)});case 4:return f=y.sent,y.abrupt("return",f.body);case 8:throw y.prev=8,y.t0=y.catch(1),new Error('Fetch resource from "'.concat(v,'" failed.'));case 11:case"end":return y.stop()}},_,null,[[1,8]])}));function S(_,v){return O.apply(this,arguments)}return S}()},{key:"mutateResource",value:function(){var O=J.default(N.default.mark(function _(v,g,d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._makeRequest(v,g,d,{"X-Twilio-Mutation-Id":P.v4()});case 2:if(p=m.sent,!Ho(p)){m.next=7;break}return m.next=6,this.fetchResource(p.body.resource_url);case 6:return m.abrupt("return",m.sent);case 7:return m.abrupt("return",p.body);case 8:case"end":return m.stop()}},_,this)}));function S(_,v,g){return O.apply(this,arguments)}return S}()}]),I}(),ht;function $s(I,O){var S=Object.keys(I);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(I);O&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(I,v).enumerable})),S.push.apply(S,_)}return S}function Fa(I){for(var O=1;O<arguments.length;O++){var S=arguments[O]!=null?arguments[O]:{};O%2?$s(Object(S),!0).forEach(function(_){W.default(I,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(S)):$s(Object(S)).forEach(function(_){Object.defineProperty(I,_,Object.getOwnPropertyDescriptor(S,_))})}return I}function Ii(I){var O=aa();return function(){var _=ue.default(I),v;if(O){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return H.default(this,v)}}function aa(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var pt,Ts=me.default(function I(){_e.default(this,I)});e.Client=pt=(ht=function(I){re.default(S,I);var O=Ii(S);function S(_){var v,g,d,p,f,m,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(_e.default(this,S),m=O.call(this),W.default(xe.default(m),"version",Ua),W.default(xe.default(m),"connectionState","unknown"),W.default(xe.default(m),"parsePushNotification",pt.parsePushNotification),m._fpaToken=_!=null?_:"",m._options=y!=null?y:{},!m._options.disableDeepClone){var k=Fa(Fa({},m._options),{},{transport:void 0,twilsockClient:void 0});k=Ae(k),k.transport=m._options.transport,k.twilsockClient=m._options.twilsockClient,m._options=k}m._options.logLevel=(v=m._options.logLevel)!==null&&v!==void 0?v:"silent",pt._logger.setLevel(m._options.logLevel);var E=m._options.productId="ip_messaging";if(m._options.clientMetadata=m._options.clientMetadata||{},m._options.clientMetadata.hasOwnProperty("type")||(m._options.clientMetadata.type="conversations"),m._options.clientMetadata.hasOwnProperty("sdk")||(m._options.clientMetadata.sdk="JS",m._options.clientMetadata.sdkv=Ua),m._options.Sync=m._options.Sync||{},typeof m._options.Sync.enableSessionStorage>"u"&&(m._options.Sync.enableSessionStorage=!0),m._options.region&&(m._options.Sync.region=m._options.region),!_)throw new Error("A valid Twilio token should be provided");m._services=new Ts,m._myself=new Ne("","",null,m._services);var L=!m._options.twilsockClient;if(!m._options.initRegistrations){var j=new B.InitRegistration(E);pt.populateInitRegistrations(j),m._options.initRegistrations=[j]}m._services.twilsockClient=m._options.twilsockClient=(g=m._options.twilsockClient)!==null&&g!==void 0?g:new B.TwilsockClient(_,E,m._options),m._services.twilsockClient.on("tokenAboutToExpire",function(){return m.emit("tokenAboutToExpire")}),m._services.twilsockClient.on("tokenExpired",function(){return m.emit("tokenExpired")}),m._services.twilsockClient.on("connectionError",function(cr){return m.emit("connectionError",cr)}),m._services.twilsockClient.on("stateChanged",function(cr){pt._logger.debug("Handling stateChanged for ConversationsClient: new state ".concat(cr)),cr!==m.connectionState&&(m.connectionState=cr,m.emit("connectionStateChanged",m.connectionState))}),m._services.transport=m._options.transport=(d=m._options.transport)!==null&&d!==void 0?d:m._options.twilsockClient,m._services.notificationClient=m._options.notificationsClient=(p=m._options.notificationsClient)!==null&&p!==void 0?p:new ve.Notifications(_,m._options),m._services.syncClient=m._options.syncClient=(f=m._options.syncClient)!==null&&f!==void 0?f:new se.SyncClient(_,m._options);var Ce=(y==null?void 0:y.Chat)||(y==null?void 0:y.IPMessaging)||y||{},Je=Ce.region||(y==null?void 0:y.region),Ft=Ce.apiUri||Ce.typingUri||"https://aim.".concat(Je||"us1",".twilio.com");m._services.commandExecutor=new Wo(Ft,{transport:m._options.transport},E);var Ze=function(Ar){m._rejectEnsureReady(Ar),m.emit("stateChanged","failed"),m.emit("initFailed",{error:Ar})},mr=function(){Ze({terminal:!0,message:"Twilsock has disconnected."})};return m._services.twilsockClient.once("connectionError",Ze),m._services.twilsockClient.once("disconnected",mr),m._services.twilsockClient.once("connected",J.default(N.default.mark(function cr(){var Ar,M;return N.default.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return pt._logger.debug("ConversationsClient started INITIALIZING"),m._services.twilsockClient.off("connectionError",Ze),m._services.twilsockClient.off("disconnected",mr),ie.prev=3,Ar="conversations.client.startup",m._services.twilsockClient.addPartialTelemetryEvent(new B.TelemetryEventDescription(Ar,"Conversations client startup",new Date),Ar,B.TelemetryPoint.Start),ie.next=8,m._initialize();case 8:m._services.twilsockClient.addPartialTelemetryEvent(new B.TelemetryEventDescription("","",new Date),Ar,B.TelemetryPoint.End),ie.next=17;break;case 11:ie.prev=11,ie.t0=ie.catch(3),M={terminal:!0,message:ie.t0.message},m._rejectEnsureReady(M),m.emit("stateChanged","failed"),m.emit("initFailed",{error:M});case 17:case"end":return ie.stop()}},cr,null,[[3,11]])}))),m._ensureReady=new Promise(function(cr,Ar){m._resolveEnsureReady=cr,m._rejectEnsureReady=Ar}).catch(function(){}),L&&m._services.twilsockClient.connect(),m}return me.default(S,[{key:"user",get:function(){return this._myself}},{key:"reachabilityEnabled",get:function(){if(!this._configuration)throw new Error("Reachability information could not yet be accessed as the client has not yet been initialized. Subscribe to the 'stateChanged' event to properly react to the client initialization.");return this._configuration.reachabilityEnabled}},{key:"token",get:function(){return this._fpaToken}},{key:"shutdown",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._ensureReady;case 2:return p.next=4,this._services.twilsockClient.disconnect();case 4:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"updateToken",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:if(pt._logger.info("updateToken"),this._fpaToken!==d){f.next=5;break}return f.abrupt("return",this);case 5:return f.next=7,this._services.twilsockClient.updateToken(d);case 7:return f.next=9,this._services.notificationClient.updateToken(d);case 9:return f.next=11,this._services.mcsClient.updateToken(d);case 11:return this._fpaToken=d,f.abrupt("return",this);case 13:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getConversationBySid",value:function(){var _=J.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._ensureReady;case 2:return m.next=4,this._conversationsEntity.myConversationsRead.promise;case 4:return m.next=6,this._conversationsEntity.getConversation(d);case 6:if(p=m.sent,p){m.next=12;break}return de.deprecationWarning("The method getConversationBySid is deprecated to retrieve conversations you're not part of. Use peekConversationBySid instead."),m.next=11,this.peekConversationBySid(d);case 11:p=m.sent;case 12:if(p){m.next=14;break}throw new Error("Conversation with SID ".concat(d," was not found."));case 14:return m.abrupt("return",p);case 15:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"peekConversationBySid",value:function(){var _=J.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._ensureReady;case 2:return m.next=4,this._conversationsEntity.peekConversation(d);case 4:if(p=m.sent,p){m.next=7;break}throw new Error("Conversation with SID ".concat(d," was not found."));case 7:return m.abrupt("return",p);case 8:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getConversationByUniqueName",value:function(){var _=J.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._ensureReady;case 2:return m.next=4,this._conversationsEntity.myConversationsRead.promise;case 4:return m.next=6,this._conversationsEntity.getConversationByUniqueName(d);case 6:if(p=m.sent,p){m.next=9;break}throw new Error("Conversation with unique name ".concat(d," was not found."));case 9:return m.abrupt("return",p);case 10:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getSubscribedConversations",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._ensureReady;case 2:return p.abrupt("return",this._conversationsPromise.then(function(f){return f.getConversations()}));case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"createConversation",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:return d=d||{},f.abrupt("return",this._conversationsPromise.then(function(m){return m.addConversation(d)}));case 4:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"setPushRegistrationId",value:function(){var _=J.default(N.default.mark(function g(d,p){return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._ensureReady;case 2:return this._subscribeToPushNotifications(d),this._services.notificationClient.setPushRegistrationId(d,p),m.next=6,this._services.notificationClient.commitChanges();case 6:case"end":return m.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"unsetPushRegistrationId",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:return this._unsubscribeFromPushNotifications(d),f.next=5,this._services.notificationClient.commitChanges();case 5:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"removePushRegistrations",value:function(){var _=J.default(N.default.mark(function g(d,p){return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._services.notificationClient.removeRegistrations(d,p);case 2:case"end":return m.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"handlePushNotification",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:pt._logger.debug("handlePushNotification, notificationPayload=",d),this.emit("pushNotification",pt.parsePushNotification(d));case 4:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getUser",value:function(){var _=J.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:return f.abrupt("return",this._services.users.getUser(d));case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getSubscribedUsers",value:function(){var _=J.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._ensureReady;case 2:return p.abrupt("return",this._services.users.getSubscribedUsers());case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getTemporaryContentUrlsForMediaSids",value:function(v){var g=this;return new Re.CancellablePromise(function(){var d=J.default(N.default.mark(function p(f,m,y){var k,E;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!(!g._services.mcsClient||!v)){j.next=3;break}return m(new Error("Media Content Service is unavailable")),j.abrupt("return");case 3:return k=g._services.mcsClient.mediaSetGetContentUrls(v),y(function(){k.cancel()}),j.prev=5,j.next=8,k;case 8:E=j.sent,f(E),j.next=15;break;case 12:j.prev=12,j.t0=j.catch(5),m(j.t0);case 15:case"end":return j.stop()}},p,null,[[5,12]])}));return function(p,f,m){return d.apply(this,arguments)}}())}},{key:"getTemporaryContentUrlsForMedia",value:function(v){var g=v.map(function(d){return d.sid});return this.getTemporaryContentUrlsForMediaSids(g)}},{key:"_initialize",value:function(){var _=J.default(N.default.mark(function g(){var d=this,p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._services.commandExecutor.fetchResource("Client/v2/Configuration");case 2:return p=m.sent,this._configuration=new we(this._options,p,pt._logger),this._myself._resolveInitialization(this._configuration,this._configuration.userIdentity,this._configuration.userInfo,!0),this._services.typingIndicator=new Bo(this.getConversationBySid.bind(this),this._configuration,this._services),this._services.network=new He(this._configuration,this._services),this._services.users=new Do(this._myself,this._configuration,this._services),this._services.users.on("userSubscribed",function(y){d.emit("userSubscribed",y)}),this._services.users.on("userUpdated",function(y){return d.emit("userUpdated",y)}),this._services.users.on("userUnsubscribed",function(y){d.emit("userUnsubscribed",y)}),this._conversationsEntity=new jo(this._configuration,this._services),this._conversationsEntity.on("conversationAdded",function(y){d.emit("conversationAdded",y)}),this._conversationsEntity.on("conversationRemoved",function(y){d.emit("conversationRemoved",y)}),this._conversationsEntity.on("conversationJoined",function(y){d.emit("conversationJoined",y)}),this._conversationsEntity.on("conversationLeft",function(y){d.emit("conversationLeft",y)}),this._conversationsEntity.on("conversationUpdated",function(y){return d.emit("conversationUpdated",y)}),this._conversationsEntity.on("participantJoined",function(y){d.emit("participantJoined",y)}),this._conversationsEntity.on("participantLeft",function(y){d.emit("participantLeft",y)}),this._conversationsEntity.on("participantUpdated",function(y){return d.emit("participantUpdated",y)}),this._conversationsEntity.on("messageAdded",function(y){return d.emit("messageAdded",y)}),this._conversationsEntity.on("messageUpdated",function(y){return d.emit("messageUpdated",y)}),this._conversationsEntity.on("messageRemoved",function(y){return d.emit("messageRemoved",y)}),this._conversationsEntity.on("typingStarted",function(y){return d.emit("typingStarted",y)}),this._conversationsEntity.on("typingEnded",function(y){return d.emit("typingEnded",y)}),this._conversationsPromise=this._conversationsEntity.fetchConversations().then(function(){return d._conversationsEntity}).catch(function(y){throw y}),m.next=28,this._services.users.myself._ensureFetched();case 28:pt._supportedPushChannels.forEach(function(y){return d._subscribeToPushNotifications(y)}),this._services.typingIndicator.initialize(),this._services.mcsClient=new Re.McsClient(this._fpaToken,this._configuration.links.mediaService,this._configuration.links.mediaSetService,Fa(Fa({},this._options),{},{transport:void 0})),this._resolveEnsureReady(),this.emit("stateChanged","initialized"),this.emit("initialized");case 34:case"end":return m.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_subscribeToPushNotifications",value:function(v){var g=this;[Le.NEW_MESSAGE,Le.ADDED_TO_CONVERSATION,Le.REMOVED_FROM_CONVERSATION,Le.TYPING_INDICATOR,Le.CONSUMPTION_UPDATE].forEach(function(d){g._services.notificationClient.subscribe(v,d)})}},{key:"_unsubscribeFromPushNotifications",value:function(v){var g=this;[Le.NEW_MESSAGE,Le.ADDED_TO_CONVERSATION,Le.REMOVED_FROM_CONVERSATION,Le.TYPING_INDICATOR,Le.CONSUMPTION_UPDATE].forEach(function(d){g._services.notificationClient.unsubscribe(v,d)})}}],[{key:"create",value:function(){var _=J.default(N.default.mark(function g(d,p){var f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(p!=null&&p.twilsockClient)){y.next=2;break}throw new Error("Obsolete usage of ConversationsClient.create() factory method: if you pass twilsock from the outside then you must use ConversationsClient constructor and be prepared to work with uninitialized client.");case 2:return f=new pt(d,p),y.next=5,f._ensureReady;case 5:return y.abrupt("return",f);case 6:case"end":return y.stop()}},g)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"parsePushNotification",value:function(v){if(pt._logger.debug("parsePushNotification, notificationPayload=",v),typeof v.aps<"u"){if(!v.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var g=pt._parsePushNotificationChatData(v),d=v.aps,p,f=null;if(typeof d.alert=="string")p=d.alert||null;else{var m,y;p=((m=d.alert)===null||m===void 0?void 0:m.body)||null,f=((y=d.alert)===null||y===void 0?void 0:y.title)||null}return new Lr({title:f,body:p,sound:d.sound||null,badge:d.badge||null,action:d.category||null,type:v.twi_message_type,data:g})}if(typeof v.data<"u"){var k=v.data;if(!k.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var E=pt._parsePushNotificationChatData(v.data);return new Lr({title:k.twi_title||null,body:k.twi_body||null,sound:k.twi_sound||null,badge:null,action:k.twi_action||null,type:k.twi_message_type,data:E})}throw new Error("Provided push notification payload is not Programmable Chat notification")}},{key:"_parsePushNotificationChatData",value:function(v){var g={};for(var d in pt._supportedPushDataFields){var p=v[d];if(!(typeof p>"u"||p===null)){if(d==="message_index"||d==="media_count"){var f=ee(p);f!==null&&(g[pt._supportedPushDataFields[d]]=f);continue}if(d==="media"){if(typeof p=="string")try{g[pt._supportedPushDataFields[d]]=JSON.parse(p)}catch{pt._logger.debug("Media message notification parsing error")}continue}g[pt._supportedPushDataFields[d]]=p}}return g}},{key:"populateInitRegistrations",value:function(v){v.populateInitRegistrations([Le.TYPING_INDICATOR]),se.SyncClient.populateInitRegistrations(v)}}]),S}($.ReplayEventEmitter),W.default(ht,"conversationAdded","conversationAdded"),W.default(ht,"conversationJoined","conversationJoined"),W.default(ht,"conversationLeft","conversationLeft"),W.default(ht,"conversationRemoved","conversationRemoved"),W.default(ht,"conversationUpdated","conversationUpdated"),W.default(ht,"participantJoined","participantJoined"),W.default(ht,"participantLeft","participantLeft"),W.default(ht,"participantUpdated","participantUpdated"),W.default(ht,"messageAdded","messageAdded"),W.default(ht,"messageRemoved","messageRemoved"),W.default(ht,"messageUpdated","messageUpdated"),W.default(ht,"tokenAboutToExpire","tokenAboutToExpire"),W.default(ht,"tokenExpired","tokenExpired"),W.default(ht,"typingEnded","typingEnded"),W.default(ht,"typingStarted","typingStarted"),W.default(ht,"pushNotification","pushNotification"),W.default(ht,"userSubscribed","userSubscribed"),W.default(ht,"userUnsubscribed","userUnsubscribed"),W.default(ht,"userUpdated","userUpdated"),W.default(ht,"stateChanged","stateChanged"),W.default(ht,"initialized","initialized"),W.default(ht,"initFailed","initFailed"),W.default(ht,"connectionStateChanged","connectionStateChanged"),W.default(ht,"connectionError","connectionError"),W.default(ht,"version",Ua),W.default(ht,"_logger",Ke.scope("Client")),W.default(ht,"_supportedPushChannels",["fcm","apn"]),W.default(ht,"_supportedPushDataFields",{conversation_sid:"conversationSid",conversation_title:"conversationTitle",message_sid:"messageSid",message_index:"messageIndex",media_count:"mediaCount",media:"media"}),ht),D([de.deprecated("token"),T("design:type",String),T("design:paramtypes",[])],e.Client.prototype,"token",null),D([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"updateToken",null),D([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"getConversationBySid",null),D([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"peekConversationBySid",null),D([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"getConversationByUniqueName",null),D([b.validateTypesAsync(["undefined",b.objectSchema("conversation options",{friendlyName:["string","undefined"],isPrivate:["boolean","undefined"],uniqueName:["string","undefined"]})]),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],e.Client.prototype,"createConversation",null),D([b.validateTypesAsync(b.literal("fcm","apn"),"string"),T("design:type",Function),T("design:paramtypes",[String,String]),T("design:returntype",Promise)],e.Client.prototype,"setPushRegistrationId",null),D([b.validateTypesAsync(b.literal("fcm","apn")),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"unsetPushRegistrationId",null),D([b.validateTypesAsync(b.literal("fcm","apn"),b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String,String]),T("design:returntype",Promise)],e.Client.prototype,"removePushRegistrations",null),D([b.validateTypesAsync(b.pureObject),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],e.Client.prototype,"handlePushNotification",null),D([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"getUser",null),D([b.validateTypesAsync(b.nonEmptyArray("strings","string")),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Re.CancellablePromise)],e.Client.prototype,"getTemporaryContentUrlsForMediaSids",null),D([b.validateTypesAsync(b.nonEmptyArray("media",Ve)),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Re.CancellablePromise)],e.Client.prototype,"getTemporaryContentUrlsForMedia",null),D([de.deprecated("Client.create()","new Client()"),b.validateTypesAsync("string",["undefined",b.pureObject]),T("design:type",Function),T("design:paramtypes",[String,Object]),T("design:returntype",Promise)],e.Client,"create",null),D([b.validateTypes(b.pureObject),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Lr)],e.Client,"parsePushNotification",null),e.Client=pt=D([b.validateConstructorTypes(b.nonEmptyString,[b.pureObject,"undefined"]),T("design:paramtypes",[String,Object])],e.Client),Object.defineProperty(e,"CancellablePromise",{enumerable:!0,get:function(){return Re.CancellablePromise}}),e.AggregatedDeliveryReceipt=at,e.Conversation=St,e.DetailedDeliveryReceipt=We,e.Media=Ve,e.Message=rr,e.MessageBuilder=bs,e.NotificationTypes=Le,e.Participant=K,e.PushNotification=Lr,e.RestPaginator=tt,e.UnsentMessage=Nr,e.User=Ne})(n1);function KC(e){return e.replace("EndUser:","")}async function JC(e){try{let t=`/conversations/conversation-message-media-url?mediaSid=${e}`;const r=await fetch(t,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(r.ok)return(await r.json()).contentUrl}catch(t){console.log("getMediaUrl error => ",t)}}function YC(e,t,r,n,a,i){const s=Bt(()=>Object.keys(r).length===0?!1:!!(r.mType!==void 0&&r.mType.startsWith("chatButton"))),o=Bt(()=>!!(e!=null&&e.enduser!=null&&e.enduser||(t.startsWith("+")||t.startsWith("whatsapp"))&&!e.agent||r.mType!==void 0&&r.mType==="clientChat")),u=Bt(()=>!!(e!=null&&e.chat!=null&&e.chat||r.mType!==void 0&&r.mType==="agentChat"||r.mType!==void 0&&r.mType==="clientChat")),l=Bt(()=>t===n),c=Bt(()=>e!=null&&e.agent!=null&&e.agent==!0||r.mType!==void 0&&r.agentMessage===!0),h=Bt(()=>!!(e!=null&&e.sms!=null&&e.sms||t.startsWith("+"))),w=Bt(()=>!!(e!=null&&e.whatsapp!=null&&e.whatsapp||t.startsWith("whatsapp"))),b=Bt(()=>a===null&&i!==null);return{isChatButton:s,isCustomer:o,isChat:u,isBot:l,isAgent:c,isSms:h,isWhatsapp:w,isMedia:b}}const IZ={props:["author","content","dateCreated","cSid","participant","mSid","pSid","media","mAttributes"],setup(e,t){const r=pf(),n=e.author,a=e.content,i=e.media,s=e.dateCreated,o=e.cSid,u=e.mSid,l=e.pSid,c=e.mAttributes,h=e.participant,w=vt("/placeholder.png");let{isChatButton:b,isCustomer:$,isChat:A,isBot:x,isAgent:U,isSms:B,isWhatsapp:ve,isMedia:se}=YC(h,n,c,o,a,i);of(async()=>{if(a===null&&i!==null){let ke=null,de=bt(i);de[0]!==void 0?ke=de[0].sid:de.state!==void 0&&(ke=de.state.sid),ke!=null&&(w.value=await JC(ke))}});function Re(ke,de,P,te,le){console.log({mAttributes:c}),t.emit("sendAnswer",{id:ke,title:de,answer:P,person:r.endUser.name,style:te,messageSid:le})}return{author:n,content:a,dateCreated:s,participant:h,mSid:u,pSid:l,isMedia:se,mAttributes:c,imageUrl:w,isChatButton:b,isSms:B,isChat:A,isCustomer:$,isBot:x,isWhatsapp:ve,isAgent:U,formatDate:r1,formatAuthor:KC,answerQuestion:Re}}},RZ={key:0},AZ={key:1},OZ=["src"],PZ={class:"mt-1"},MZ={key:0,class:"fst-italic"},xZ={key:1,class:"fst-italic"},NZ={key:1,class:"button-message text-start mb-4 p-4"},LZ={key:0},jZ=R$('<div class="mb-4" data-v-51d12b80><div class="mb-4" data-v-51d12b80><p class="text-secondary" data-v-51d12b80>Item out of stock:</p><img class="product-image" src="https://images.albertsons-media.com/is/image/ABS/960041097-ECOM?$ng-ecom-pdp-tn$&amp;defaultImage=Not_Available" data-v-51d12b80><p class="p-4 d-inline" data-v-51d12b80>Pepperidge Farm Goldfish Cheddar Cheese Crackers - 9-1 Oz</p></div><div class="mb-2" data-v-51d12b80><p class="text-secondary" data-v-51d12b80>Substitute with:</p><img class="product-image" src="https://images.albertsons-media.com/is/image/ABS/960049994?$ng-ecom-pdp-tn$&amp;defaultImage=Not_Available" data-v-51d12b80><p class="p-4 d-inline" data-v-51d12b80>Pepperidge Farm Goldfish Cheddar Cheese Crackers - 30 Oz</p></div></div>',1),UZ={key:0,class:"btn-group d-flex",role:"group","aria-label":"..."},FZ=["onClick"],DZ={key:1};function BZ(e,t,r,n,a,i){return st(),yt("div",null,[n.isChatButton?ir("",!0):(st(),yt("div",{key:0,class:Vn(["text-start mb-2",{"text-start":n.isCustomer,"text-end":!n.isCustomer}])},[fe("span",{class:Vn(["message fs-4 badge text-wrap",{"text-start":n.isCustomer,"text-end":!n.isCustomer,customer:n.isCustomer,customer:n.isCustomer,agent:n.isAgent,"bg-secondary":n.isBot}])},[n.isMedia?ir("",!0):(st(),yt("span",RZ,Yt(n.content),1)),n.isMedia?(st(),yt("span",AZ,[fe("img",{src:n.imageUrl,style:{"max-height":"300px","max-width":"300px"},class:"ms-2 img-fluid rounded"},null,8,OZ)])):ir("",!0)],2),fe("p",PZ,[fe("small",null,[n.isCustomer?(st(),yt("span",MZ,Yt(n.author)+" - "+Yt(n.formatDate(n.dateCreated)),1)):(st(),yt("span",xZ,"Shopper - "+Yt(n.formatDate(n.dateCreated)),1))])])],2)),n.isChatButton?(st(),yt("div",NZ,[n.mAttributes.mType==="chatButton"?(st(),yt("div",LZ,[fe("h5",null,Yt(n.mAttributes.question),1),jZ,n.mAttributes.showButtons!==!1?(st(),yt("div",UZ,[(st(!0),yt(dr,null,Ru(n.mAttributes.options,s=>(st(),yt("button",{onClick:o=>n.answerQuestion(n.mAttributes.id,n.mAttributes.question,s.value,s.style,n.mSid),key:s.value,class:Vn(["btn border",[s.style]])},Yt(s.label),11,FZ))),128))])):ir("",!0)])):ir("",!0),n.mAttributes.mType==="chatButtonResponse"?(st(),yt("div",DZ,[fe("h5",null,[Zt(Yt(n.mAttributes.person)+" replied: ",1),fe("button",{disabled:"",class:Vn(["btn",[n.mAttributes.style]])},Yt(n.mAttributes.answer),3)])])):ir("",!0)])):ir("",!0)])}const qZ=pi(IZ,[["render",BZ],["__scopeId","data-v-51d12b80"]]);function HZ(e){return new Date(e).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})}const WZ={props:["author","content","dateCreated","cSid","participant","mSid","pSid","media","mAttributes"],setup(e,t){const r=pf(),n=e.author,a=e.content,i=e.media,s=e.dateCreated,o=e.cSid,u=e.mSid,l=e.pSid,c=e.mAttributes,h=e.participant,w=vt("/placeholder.png");let{isChatButton:b,isCustomer:$,isChat:A,isBot:x,isAgent:U,isSms:B,isWhatsapp:ve,isMedia:se}=YC(h,n,c,o,a,i);of(async()=>{if(a===null&&i!==null){let de=null,P=bt(i);P[0]!==void 0?de=P[0].sid:P.state!==void 0&&(de=P.state.sid),de!=null&&(w.value=await JC(de))}});function Re(de,P,te,le,J){console.log({mAttributes:J}),console.log("ChatMessage - Answer Question"),t.emit("sendAnswer",{id:de,title:P,answer:te,person:r.endUser.name,style:le})}const ke=Bt(()=>h!==void 0&&h.avatar!==void 0&&h.avatar!==""?h.avatar:"https://picsum.photos/id/237/50");return{author:n,content:a,dateCreated:s,participant:h,mSid:u,pSid:l,isMedia:se,mAttributes:c,imageUrl:w,isChatButton:b,isSms:B,isChat:A,isCustomer:$,isBot:x,isWhatsapp:ve,isAgent:U,formatJustTime:HZ,formatAuthor:KC,answerQuestion:Re,getAvatar:ke}}},GZ={key:0,class:"mb-2 ms-4"},zZ={class:"table align-top"},VZ={class:"align-top",style:{width:"50px"}},KZ=["src"],JZ={class:"align-top pt-0"},YZ={class:"pt-0 pb-0 mb-1 lh-1"},QZ={class:"pt-0 fw-bold fs-4"},XZ={class:"pt-0 fs-5 ms-2"},ZZ={key:0,class:"pt-0 lead"},eee={key:1,class:"pt-0 lead"},tee=["src"],ree={key:1,class:"text-start ms-4 mb-4"},nee={key:0},aee=R$('<div class="mb-4"><div class="mb-4"><p class="text-secondary">Item out of stock:</p><img class="product-image" src="https://images.albertsons-media.com/is/image/ABS/960041097-ECOM?$ng-ecom-pdp-tn$&amp;defaultImage=Not_Available"><p class="p-4 d-inline">Pepperidge Farm Goldfish Cheddar Cheese Crackers - 9-1 Oz</p></div><div class="mb-2"><p class="text-secondary">Substitute with:</p><img class="product-image" src="https://images.albertsons-media.com/is/image/ABS/960049994?$ng-ecom-pdp-tn$&amp;defaultImage=Not_Available"><p class="p-4 d-inline">Pepperidge Farm Goldfish Cheddar Cheese Crackers - 30 Oz</p></div></div>',1),iee={class:"btn-group d-flex",role:"group","aria-label":"..."},see=["onClick"],oee={key:1},uee={class:"fst-italic"};function lee(e,t,r,n,a,i){return st(),yt("div",null,[n.isChatButton?ir("",!0):(st(),yt("div",GZ,[fe("table",zZ,[fe("tr",null,[fe("td",VZ,[fe("img",{src:n.getAvatar,class:"rounded p-0"},null,8,KZ)]),fe("td",JZ,[fe("p",YZ,[fe("span",QZ,Yt(n.author),1),fe("span",XZ,Yt(n.formatJustTime(n.dateCreated)),1)]),n.isMedia?ir("",!0):(st(),yt("p",ZZ,Yt(n.content),1)),n.isMedia?(st(),yt("p",eee,[fe("img",{src:n.imageUrl,style:{"max-height":"300px","max-width":"300px"},class:"img-fluid rounded"},null,8,tee)])):ir("",!0)])])])])),n.isChatButton?(st(),yt("div",ree,[n.mAttributes.mType==="chatButton"?(st(),yt("div",nee,[fe("h5",null,Yt(n.mAttributes.question),1),aee,fe("div",iee,[(st(!0),yt(dr,null,Ru(n.mAttributes.options,s=>(st(),yt("button",{onClick:o=>n.answerQuestion(n.mAttributes.sid,n.mAttributes.question,s.value,s.style,n.mAttributes),key:s.value,class:Vn(["btn border",[s.style]])},Yt(s.label),11,see))),128))])])):ir("",!0),n.mAttributes.mType==="chatButtonResponse"?(st(),yt("div",oee,[fe("h5",null,[fe("span",uee,Yt(n.mAttributes.title),1),Zt(" "+Yt(n.mAttributes.person)+" replied: ",1),fe("button",{disabled:"",class:Vn(["btn",[n.mAttributes.style]])},Yt(n.mAttributes.answer),3)])])):ir("",!0)])):ir("",!0)])}const cee=pi(WZ,[["render",lee]]);const ja=e=>(QI("data-v-caba2c46"),e=e(),XI(),e),fee={class:"container-fluid"},dee={class:"row row-height mt-2"},pee={class:"col-12"},vee={class:"pb-5"},hee={key:0},yee={class:"alert alert-danger"},gee=ja(()=>fe("i",{class:"bi-plug"},null,-1)),mee=Zt(" Connect"),bee=[gee,mee],wee=ja(()=>fe("h5",{class:"alert-heading"},"Not Connected",-1)),_ee=Zt(" Trouble connecting? "),See=Zt("Refresh Token"),$ee=ja(()=>fe("p",null,[fe("b",null,"Your token has expired!")],-1)),Tee=ja(()=>fe("i",{class:"bi-recycle"},null,-1)),kee=Zt(" Refresh Token "),Eee=[Tee,kee],Cee={class:"spinner-border text-info mt-5",role:"status"},Iee=ja(()=>fe("span",{class:"visually-hidden"},"Loading...",-1)),Ree=[Iee],Aee={class:"alert alert-danger"},Oee=ja(()=>fe("h2",{class:"alert-heading mb-3"},"This conversation has ended!",-1)),Pee=ja(()=>fe("h5",{class:"alert-heading mb-5"}," You can return to the home page to start a new Conversation. ",-1)),Mee=ja(()=>fe("i",{class:"bi-house"},null,-1)),xee=Zt(" Home "),Nee={class:"message-container"},Lee={class:"text-center"},jee={class:"pb-0 mb-0 fst-italic"},Uee={key:0,ref:"messagesDiv",class:"container-fluid pt-3 pb-3"},Fee={key:1,ref:"messagesDiv",class:"container-fluid pt-3 pb-3"},Dee={key:1,class:"mt-4"},Bee={class:"input-group input-group-lg"},qee=ja(()=>fe("i",{class:"bi-send-fill"},null,-1)),Hee=[qee],Wee={class:"mt-3"},Gee={class:"text-end"},zee={__name:"Conversation",setup(e){const t=pf(),r=jO(),n=r.params.sid?r.params.sid:"Not Found",a=vt([]),i=is({details:{}}),s=vt(!0),o=vt(!1),u=vt(!1),l=vt(!1),c=vt(!1),h=vt("");let w=null,b=null;vt(!0),vt(""),vt("");const $=vt(!1),A=vt(null),x=async()=>{try{w=await new n1.Client(t.endUser.accessToken)}catch(re){console.log("failed to connect to conversation => ",re);return}if(w.connectionState==="denied"){U();return}w.on("initialized",async()=>{try{b=await w.getConversationBySid(n)}catch(re){console.log("failed to getConversation => ",re),o.value=!0,l.value=!0,t.logout();return}o.value=!0,b.on("messageAdded",re=>{console.log("New Message Added ==> ",re);let H=P.value[re.participantSid];H==null&&(H=JSON.parse(bv("bot","bot","Webhook"))),re.participantAttributes=H,a.value.push(re),A.value.scrollIntoView()}),b.on("messageUpdated",re=>{console.log("Message updated..."),le()}),b.on("messageRemoved",re=>{console.log("Message Removed from conversation..."),le()})}),w.on("tokenExpired",re=>{console.log("Token Expired!"),o.value=!1,u.value=!0,U()}),w.on("disconnected",re=>{console.log("Conversations disconnected!"),o.value=!1,u.value=!0}),w.on("conversationRemoved",re=>{console.log("Conversations removed!"),l.value=!0,t.logout()}),await le()},U=async()=>{console.log("in refreshToken..."),c.value=!0;try{await t.getToken(),await x(),c.value=!1}catch(re){console.log("failed to refresh token => ",re)}},B=async()=>{let re=h.value;h.value="...";let H={mType:"clientChat",author:t.endUser.name};await b.prepareMessage().setBody(re).setAttributes(H).build().send(),h.value="",console.log("Sent Message...")},ve=vt(!1),se=vt(null),Re=async()=>{let re={mType:"clientChat",author:t.endUser.name};const H={contentType:se.value.files[0].type,filename:se.value.files[0].name,media:se.value.files[0]};await b.prepareMessage().setAttributes(re).addMedia(H).build().send(),ve.value=!1,se.value=vt(null)},ke=async()=>{try{let re=`/conversations/conversation-details?sid=${n}`;const H=await fetch(re,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(H.ok){let ue=await H.json();i.details=ue,typeof JSON.parse(i.details.attributes)=="object"?i.details.attributes=JSON.parse(i.details.attributes):i.details.attributes=JSON.parse(JSON.parse(i.details.attributes)),i.details.attributes.conversationType==="ChatChannel"&&($.value=!0)}}catch(re){console.log("getConversationDetails error => ",re)}},de=vt([]),P=vt({}),te=async()=>{try{let re=`/conversations/conversation-participants?sid=${n}`;const H=await fetch(re,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(H.ok){let ue=await H.json();de.value=ue;for(let W=0;W<de.value.length;W++)typeof JSON.parse(de.value[W].attributes)=="object"?de.value[W].attributes=JSON.parse(de.value[W].attributes):de.value[W].attributes=JSON.parse(JSON.parse(de.value[W].attributes)),P.value[de.value[W].sid]=de.value[W].attributes}}catch(re){console.log("getConversationParticipants error => ",re)}},le=async()=>{console.log("Getting conversation messages...");try{let re=`/conversations/conversation-messages?sid=${n}`;const H=await fetch(re,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(H.ok){let ue=await H.json();a.value=ue;for(let W=0;W<a.value.length;W++){Object.keys(a.value[W].attributes).length===0?a.value[W].attributes={attributes:"none"}:a.value[W].attributes=JSON.parse(a.value[W].attributes);let me=P.value[a.value[W].participantSid];me==null&&(me=JSON.parse(bv("bot","bot","Webhook"))),a.value[W].participantAttributes=me}}}catch(re){console.log("getConversationMessages error => ",re)}},J=async re=>{try{let H={mType:"chatButtonResponse",id:re.id,title:re.title,answer:re.answer,person:re.person,style:re.style};console.log(re),await b.prepareMessage().setBody("<Chat Button Response>").setAttributes(H).build().send();let ue=[],W=await b.getMessages();for(;ue.length<1;){let _e=0;ue=W.items.filter(N=>N.state.sid===re.messageSid),_e+=30,W=await b.getMessages(30,_e)}let me=ue[0].attributes;me.showButtons=!1,await ue[0].updateAttributes(me),await le(),console.log(ue[0],"DONE")}catch(H){o.value=!1,console.log("Chat Button Response Error => ",H)}},xe=async()=>{await ke(),await te(),await le()};return h$(async()=>{await xe(),await x()}),(re,H)=>{const ue=li("router-link");return st(),yt("div",fee,[fe("div",dee,[fe("div",pee,[fe("div",vee,[s.value?(st(),yt("div",hee,[It(fe("div",yee,[It(fe("button",{type:"button",class:"btn btn-sm btn-danger float-end",onClick:H[0]||(H[0]=W=>x())},bee,512),[[Lt,!u.value]]),wee,It(fe("p",null,"Connecting automatically...",512),[[Lt,!u.value]]),It(fe("p",null,[_ee,Ht(ue,{to:"/"},{default:ui(()=>[See]),_:1})],512),[[Lt,!u.value]]),It(fe("div",null,[$ee,It(fe("button",{class:"btn btn-lg btn-danger",onClick:H[1]||(H[1]=W=>U())},Eee,512),[[Lt,!c.value]]),It(fe("div",Cee,Ree,512),[[Lt,c.value]])],512),[[Lt,u.value]])],512),[[Lt,!o.value]]),It(fe("div",Aee,[Oee,Pee,Ht(ue,{class:"btn btn-primary",to:"/"},{default:ui(()=>[Mee,xee]),_:1})],512),[[Lt,o.value&&l.value]])])):ir("",!0),fe("div",Nee,[fe("div",Lee,[fe("p",jee,"You are now chatting with your Safeway shopper about "+Yt(i.details.friendlyName),1)]),$.value?ir("",!0):(st(),yt("div",Uee,[(st(!0),yt(dr,null,Ru(a.value,W=>(st(),es(qZ,{onSendAnswer:H[2]||(H[2]=me=>J(me)),participant:W.participantAttributes,mAttributes:W.attributes,key:W.sid,mSid:W.sid,pSid:W.participantSid,dateCreated:W.dateCreated,author:W.author,content:W.body,media:W.media,cSid:i.details.sid},null,8,["participant","mAttributes","mSid","pSid","dateCreated","author","content","media","cSid"]))),128))],512)),fe("div",{class:"mt-5",ref_key:"bottomEl",ref:A},null,512),$.value?(st(),yt("div",Fee,[(st(!0),yt(dr,null,Ru(a.value,W=>(st(),es(cee,{onSendAnswer:H[3]||(H[3]=me=>J(me)),participant:W.participantAttributes,mAttributes:W.attributes,key:W.sid,mSid:W.sid,pSid:W.participantSid,dateCreated:W.dateCreated,author:W.author,content:W.body,media:W.media,cSid:i.details.sid},null,8,["participant","mAttributes","mSid","pSid","dateCreated","author","content","media","cSid"]))),128))],512)):ir("",!0)]),o.value&&!l.value?(st(),yt("div",Dee,[fe("form",{onSubmit:H[7]||(H[7]=wA((...W)=>re.submitForm&&re.submitForm(...W),["prevent"]))},[fe("div",Bee,[It(fe("input",{onKeyup:H[4]||(H[4]=SA(W=>B(),["enter"])),type:"text",placeholder:"Type a message...",class:"form-control","onUpdate:modelValue":H[5]||(H[5]=W=>h.value=W),"aria-describedby":"btnGroupAddon"},null,544),[[x$,h.value]]),fe("button",{type:"button",class:"btn btn-primary",onClick:H[6]||(H[6]=W=>B())},Hee)])],32),It(fe("div",Wee,[fe("input",{ref_key:"file",ref:se,onChange:H[8]||(H[8]=W=>Re()),class:"form-control form-control-sm",id:"formFileSm",type:"file"},null,544)],512),[[Lt,ve.value]]),It(fe("div",Gee,[fe("button",{onClick:H[9]||(H[9]=W=>ve.value=!1),class:"btn btn-sm btn-link"}," Cancel ")],512),[[Lt,ve.value]])])):ir("",!0)])])])])}}},Vee=pi(zee,[["__scopeId","data-v-caba2c46"]]),Kee={name:"App",components:{Layout:Q$,Conversation:Vee}};function Jee(e,t,r,n,a,i){const s=li("Conversation"),o=li("Layout");return st(),es(o,null,{default:ui(()=>[Ht(s)]),_:1})}const Yee=pi(Kee,[["render",Jee]]),Qee=xO({history:XA(),routes:[{path:"/",name:"home",component:ex},{name:"conversation",path:"/conversation/:sid",component:Yee}]}),xg=kA(UO);xg.use(IA());xg.use(Qee);xg.mount("#app");
