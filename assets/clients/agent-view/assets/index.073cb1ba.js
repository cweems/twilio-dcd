(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();function Yh(e,t){const r=Object.create(null),n=e.split(",");for(let i=0;i<n.length;i++)r[n[i]]=!0;return t?i=>!!r[i.toLowerCase()]:i=>!!r[i]}const EE="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",CE=Yh(EE);function TS(e){return!!e||e===""}function Qh(e){if(Ke(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],i=lr(n)?OE(n):Qh(n);if(i)for(const a in i)t[a]=i[a]}return t}else{if(lr(e))return e;if(Lt(e))return e}}const IE=/;(?![^(]*\))/g,RE=/:(.+)/;function OE(e){const t={};return e.split(IE).forEach(r=>{if(r){const n=r.split(RE);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function La(e){let t="";if(lr(e))t=e;else if(Ke(e))for(let r=0;r<e.length;r++){const n=La(e[r]);n&&(t+=n+" ")}else if(Lt(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}function AE(e,t){if(e.length!==t.length)return!1;let r=!0;for(let n=0;r&&n<e.length;n++)r=Bc(e[n],t[n]);return r}function Bc(e,t){if(e===t)return!0;let r=iy(e),n=iy(t);if(r||n)return r&&n?e.getTime()===t.getTime():!1;if(r=vu(e),n=vu(t),r||n)return e===t;if(r=Ke(e),n=Ke(t),r||n)return r&&n?AE(e,t):!1;if(r=Lt(e),n=Lt(t),r||n){if(!r||!n)return!1;const i=Object.keys(e).length,a=Object.keys(t).length;if(i!==a)return!1;for(const s in e){const u=e.hasOwnProperty(s),o=t.hasOwnProperty(s);if(u&&!o||!u&&o||!Bc(e[s],t[s]))return!1}}return String(e)===String(t)}function PE(e,t){return e.findIndex(r=>Bc(r,t))}const Bt=e=>lr(e)?e:e==null?"":Ke(e)||Lt(e)&&(e.toString===IS||!ut(e.toString))?JSON.stringify(e,ES,2):String(e),ES=(e,t)=>t&&t.__v_isRef?ES(e,t.value):Fs(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,i])=>(r[`${n} =>`]=i,r),{})}:Hc(t)?{[`Set(${t.size})`]:[...t.values()]}:Lt(t)&&!Ke(t)&&!RS(t)?String(t):t,Nt={},Ds=[],In=()=>{},ME=()=>!1,NE=/^on[^a-z]/,qc=e=>NE.test(e),Xh=e=>e.startsWith("onUpdate:"),yr=Object.assign,Zh=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},xE=Object.prototype.hasOwnProperty,ht=(e,t)=>xE.call(e,t),Ke=Array.isArray,Fs=e=>Au(e)==="[object Map]",Hc=e=>Au(e)==="[object Set]",iy=e=>Au(e)==="[object Date]",ut=e=>typeof e=="function",lr=e=>typeof e=="string",vu=e=>typeof e=="symbol",Lt=e=>e!==null&&typeof e=="object",CS=e=>Lt(e)&&ut(e.then)&&ut(e.catch),IS=Object.prototype.toString,Au=e=>IS.call(e),LE=e=>Au(e).slice(8,-1),RS=e=>Au(e)==="[object Object]",ev=e=>lr(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Kl=Yh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Wc=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},jE=/-(\w)/g,qn=Wc(e=>e.replace(jE,(t,r)=>r?r.toUpperCase():"")),UE=/\B([A-Z])/g,Va=Wc(e=>e.replace(UE,"-$1").toLowerCase()),Gc=Wc(e=>e.charAt(0).toUpperCase()+e.slice(1)),Df=Wc(e=>e?`on${Gc(e)}`:""),gu=(e,t)=>!Object.is(e,t),Jl=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},oc=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},uc=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let ay;const DE=()=>ay||(ay=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let xn;class OS{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&xn&&(this.parent=xn,this.index=(xn.scopes||(xn.scopes=[])).push(this)-1)}run(t){if(this.active){const r=xn;try{return xn=this,t()}finally{xn=r}}}on(){xn=this}off(){xn=this.parent}stop(t){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.active=!1}}}function AS(e){return new OS(e)}function FE(e,t=xn){t&&t.active&&t.effects.push(e)}const tv=e=>{const t=new Set(e);return t.w=0,t.n=0,t},PS=e=>(e.w&Yi)>0,MS=e=>(e.n&Yi)>0,BE=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Yi},qE=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const i=t[n];PS(i)&&!MS(i)?i.delete(e):t[r++]=i,i.w&=~Yi,i.n&=~Yi}t.length=r}},Cp=new WeakMap;let Qo=0,Yi=1;const Ip=30;let Sn;const Da=Symbol(""),Rp=Symbol("");class rv{constructor(t,r=null,n){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,FE(this,n)}run(){if(!this.active)return this.fn();let t=Sn,r=Hi;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Sn,Sn=this,Hi=!0,Yi=1<<++Qo,Qo<=Ip?BE(this):sy(this),this.fn()}finally{Qo<=Ip&&qE(this),Yi=1<<--Qo,Sn=this.parent,Hi=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Sn===this?this.deferStop=!0:this.active&&(sy(this),this.onStop&&this.onStop(),this.active=!1)}}function sy(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let Hi=!0;const NS=[];function so(){NS.push(Hi),Hi=!1}function oo(){const e=NS.pop();Hi=e===void 0?!0:e}function qr(e,t,r){if(Hi&&Sn){let n=Cp.get(e);n||Cp.set(e,n=new Map);let i=n.get(r);i||n.set(r,i=tv()),xS(i)}}function xS(e,t){let r=!1;Qo<=Ip?MS(e)||(e.n|=Yi,r=!PS(e)):r=!e.has(Sn),r&&(e.add(Sn),Sn.deps.push(e))}function li(e,t,r,n,i,a){const s=Cp.get(e);if(!s)return;let u=[];if(t==="clear")u=[...s.values()];else if(r==="length"&&Ke(e))s.forEach((o,c)=>{(c==="length"||c>=n)&&u.push(o)});else switch(r!==void 0&&u.push(s.get(r)),t){case"add":Ke(e)?ev(r)&&u.push(s.get("length")):(u.push(s.get(Da)),Fs(e)&&u.push(s.get(Rp)));break;case"delete":Ke(e)||(u.push(s.get(Da)),Fs(e)&&u.push(s.get(Rp)));break;case"set":Fs(e)&&u.push(s.get(Da));break}if(u.length===1)u[0]&&Op(u[0]);else{const o=[];for(const c of u)c&&o.push(...c);Op(tv(o))}}function Op(e,t){const r=Ke(e)?e:[...e];for(const n of r)n.computed&&oy(n);for(const n of r)n.computed||oy(n)}function oy(e,t){(e!==Sn||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const HE=Yh("__proto__,__v_isRef,__isVue"),LS=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(vu)),WE=nv(),GE=nv(!1,!0),zE=nv(!0),uy=VE();function VE(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const n=mt(this);for(let a=0,s=this.length;a<s;a++)qr(n,"get",a+"");const i=n[t](...r);return i===-1||i===!1?n[t](...r.map(mt)):i}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){so();const n=mt(this)[t].apply(this,r);return oo(),n}}),e}function nv(e=!1,t=!1){return function(n,i,a){if(i==="__v_isReactive")return!e;if(i==="__v_isReadonly")return e;if(i==="__v_isShallow")return t;if(i==="__v_raw"&&a===(e?t?lC:BS:t?FS:DS).get(n))return n;const s=Ke(n);if(!e&&s&&ht(uy,i))return Reflect.get(uy,i,a);const u=Reflect.get(n,i,a);return(vu(i)?LS.has(i):HE(i))||(e||qr(n,"get",i),t)?u:Yt(u)?s&&ev(i)?u:u.value:Lt(u)?e?qS(u):Ka(u):u}}const KE=jS(),JE=jS(!0);function jS(e=!1){return function(r,n,i,a){let s=r[n];if(Ks(s)&&Yt(s)&&!Yt(i))return!1;if(!e&&(!lc(i)&&!Ks(i)&&(s=mt(s),i=mt(i)),!Ke(r)&&Yt(s)&&!Yt(i)))return s.value=i,!0;const u=Ke(r)&&ev(n)?Number(n)<r.length:ht(r,n),o=Reflect.set(r,n,i,a);return r===mt(a)&&(u?gu(i,s)&&li(r,"set",n,i):li(r,"add",n,i)),o}}function YE(e,t){const r=ht(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&r&&li(e,"delete",t,void 0),n}function QE(e,t){const r=Reflect.has(e,t);return(!vu(t)||!LS.has(t))&&qr(e,"has",t),r}function XE(e){return qr(e,"iterate",Ke(e)?"length":Da),Reflect.ownKeys(e)}const US={get:WE,set:KE,deleteProperty:YE,has:QE,ownKeys:XE},ZE={get:zE,set(e,t){return!0},deleteProperty(e,t){return!0}},eC=yr({},US,{get:GE,set:JE}),iv=e=>e,zc=e=>Reflect.getPrototypeOf(e);function fl(e,t,r=!1,n=!1){e=e.__v_raw;const i=mt(e),a=mt(t);r||(t!==a&&qr(i,"get",t),qr(i,"get",a));const{has:s}=zc(i),u=n?iv:r?ov:yu;if(s.call(i,t))return u(e.get(t));if(s.call(i,a))return u(e.get(a));e!==i&&e.get(t)}function dl(e,t=!1){const r=this.__v_raw,n=mt(r),i=mt(e);return t||(e!==i&&qr(n,"has",e),qr(n,"has",i)),e===i?r.has(e):r.has(e)||r.has(i)}function pl(e,t=!1){return e=e.__v_raw,!t&&qr(mt(e),"iterate",Da),Reflect.get(e,"size",e)}function ly(e){e=mt(e);const t=mt(this);return zc(t).has.call(t,e)||(t.add(e),li(t,"add",e,e)),this}function cy(e,t){t=mt(t);const r=mt(this),{has:n,get:i}=zc(r);let a=n.call(r,e);a||(e=mt(e),a=n.call(r,e));const s=i.call(r,e);return r.set(e,t),a?gu(t,s)&&li(r,"set",e,t):li(r,"add",e,t),this}function fy(e){const t=mt(this),{has:r,get:n}=zc(t);let i=r.call(t,e);i||(e=mt(e),i=r.call(t,e)),n&&n.call(t,e);const a=t.delete(e);return i&&li(t,"delete",e,void 0),a}function dy(){const e=mt(this),t=e.size!==0,r=e.clear();return t&&li(e,"clear",void 0,void 0),r}function hl(e,t){return function(n,i){const a=this,s=a.__v_raw,u=mt(s),o=t?iv:e?ov:yu;return!e&&qr(u,"iterate",Da),s.forEach((c,d)=>n.call(i,o(c),o(d),a))}}function vl(e,t,r){return function(...n){const i=this.__v_raw,a=mt(i),s=Fs(a),u=e==="entries"||e===Symbol.iterator&&s,o=e==="keys"&&s,c=i[e](...n),d=r?iv:t?ov:yu;return!t&&qr(a,"iterate",o?Rp:Da),{next(){const{value:y,done:_}=c.next();return _?{value:y,done:_}:{value:u?[d(y[0]),d(y[1])]:d(y),done:_}},[Symbol.iterator](){return this}}}}function Ri(e){return function(...t){return e==="delete"?!1:this}}function tC(){const e={get(a){return fl(this,a)},get size(){return pl(this)},has:dl,add:ly,set:cy,delete:fy,clear:dy,forEach:hl(!1,!1)},t={get(a){return fl(this,a,!1,!0)},get size(){return pl(this)},has:dl,add:ly,set:cy,delete:fy,clear:dy,forEach:hl(!1,!0)},r={get(a){return fl(this,a,!0)},get size(){return pl(this,!0)},has(a){return dl.call(this,a,!0)},add:Ri("add"),set:Ri("set"),delete:Ri("delete"),clear:Ri("clear"),forEach:hl(!0,!1)},n={get(a){return fl(this,a,!0,!0)},get size(){return pl(this,!0)},has(a){return dl.call(this,a,!0)},add:Ri("add"),set:Ri("set"),delete:Ri("delete"),clear:Ri("clear"),forEach:hl(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{e[a]=vl(a,!1,!1),r[a]=vl(a,!0,!1),t[a]=vl(a,!1,!0),n[a]=vl(a,!0,!0)}),[e,r,t,n]}const[rC,nC,iC,aC]=tC();function av(e,t){const r=t?e?aC:iC:e?nC:rC;return(n,i,a)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?n:Reflect.get(ht(r,i)&&i in n?r:n,i,a)}const sC={get:av(!1,!1)},oC={get:av(!1,!0)},uC={get:av(!0,!1)},DS=new WeakMap,FS=new WeakMap,BS=new WeakMap,lC=new WeakMap;function cC(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function fC(e){return e.__v_skip||!Object.isExtensible(e)?0:cC(LE(e))}function Ka(e){return Ks(e)?e:sv(e,!1,US,sC,DS)}function dC(e){return sv(e,!1,eC,oC,FS)}function qS(e){return sv(e,!0,ZE,uC,BS)}function sv(e,t,r,n,i){if(!Lt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=i.get(e);if(a)return a;const s=fC(e);if(s===0)return e;const u=new Proxy(e,s===2?n:r);return i.set(e,u),u}function Wi(e){return Ks(e)?Wi(e.__v_raw):!!(e&&e.__v_isReactive)}function Ks(e){return!!(e&&e.__v_isReadonly)}function lc(e){return!!(e&&e.__v_isShallow)}function HS(e){return Wi(e)||Ks(e)}function mt(e){const t=e&&e.__v_raw;return t?mt(t):e}function Js(e){return oc(e,"__v_skip",!0),e}const yu=e=>Lt(e)?Ka(e):e,ov=e=>Lt(e)?qS(e):e;function WS(e){Hi&&Sn&&(e=mt(e),xS(e.dep||(e.dep=tv())))}function GS(e,t){e=mt(e),e.dep&&Op(e.dep)}function Yt(e){return!!(e&&e.__v_isRef===!0)}function Ve(e){return zS(e,!1)}function pC(e){return zS(e,!0)}function zS(e,t){return Yt(e)?e:new hC(e,t)}class hC{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:mt(t),this._value=r?t:yu(t)}get value(){return WS(this),this._value}set value(t){const r=this.__v_isShallow||lc(t)||Ks(t);t=r?t:mt(t),gu(t,this._rawValue)&&(this._rawValue=t,this._value=r?t:yu(t),GS(this))}}function Ot(e){return Yt(e)?e.value:e}const vC={get:(e,t,r)=>Ot(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const i=e[t];return Yt(i)&&!Yt(r)?(i.value=r,!0):Reflect.set(e,t,r,n)}};function VS(e){return Wi(e)?e:new Proxy(e,vC)}function gC(e){const t=Ke(e)?new Array(e.length):{};for(const r in e)t[r]=mC(e,r);return t}class yC{constructor(t,r,n){this._object=t,this._key=r,this._defaultValue=n,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}}function mC(e,t,r){const n=e[t];return Yt(n)?n:new yC(e,t,r)}var KS;class bC{constructor(t,r,n,i){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[KS]=!1,this._dirty=!0,this.effect=new rv(t,()=>{this._dirty||(this._dirty=!0,GS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=n}get value(){const t=mt(this);return WS(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}KS="__v_isReadonly";function wC(e,t,r=!1){let n,i;const a=ut(e);return a?(n=e,i=In):(n=e.get,i=e.set),new bC(n,i,a||!i,r)}function Gi(e,t,r,n){let i;try{i=n?e(...n):e()}catch(a){Vc(a,t,r)}return i}function un(e,t,r,n){if(ut(e)){const a=Gi(e,t,r,n);return a&&CS(a)&&a.catch(s=>{Vc(s,t,r)}),a}const i=[];for(let a=0;a<e.length;a++)i.push(un(e[a],t,r,n));return i}function Vc(e,t,r,n=!0){const i=t?t.vnode:null;if(t){let a=t.parent;const s=t.proxy,u=r;for(;a;){const c=a.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](e,s,u)===!1)return}a=a.parent}const o=t.appContext.config.errorHandler;if(o){Gi(o,null,10,[e,s,u]);return}}_C(e,r,i,n)}function _C(e,t,r,n=!0){console.error(e)}let mu=!1,Ap=!1;const vr=[];let Un=0;const Bs=[];let ri=null,Oa=0;const JS=Promise.resolve();let uv=null;function lv(e){const t=uv||JS;return e?t.then(this?e.bind(this):e):t}function SC(e){let t=Un+1,r=vr.length;for(;t<r;){const n=t+r>>>1;bu(vr[n])<e?t=n+1:r=n}return t}function cv(e){(!vr.length||!vr.includes(e,mu&&e.allowRecurse?Un+1:Un))&&(e.id==null?vr.push(e):vr.splice(SC(e.id),0,e),YS())}function YS(){!mu&&!Ap&&(Ap=!0,uv=JS.then(XS))}function $C(e){const t=vr.indexOf(e);t>Un&&vr.splice(t,1)}function kC(e){Ke(e)?Bs.push(...e):(!ri||!ri.includes(e,e.allowRecurse?Oa+1:Oa))&&Bs.push(e),YS()}function py(e,t=mu?Un+1:0){for(;t<vr.length;t++){const r=vr[t];r&&r.pre&&(vr.splice(t,1),t--,r())}}function QS(e){if(Bs.length){const t=[...new Set(Bs)];if(Bs.length=0,ri){ri.push(...t);return}for(ri=t,ri.sort((r,n)=>bu(r)-bu(n)),Oa=0;Oa<ri.length;Oa++)ri[Oa]();ri=null,Oa=0}}const bu=e=>e.id==null?1/0:e.id,TC=(e,t)=>{const r=bu(e)-bu(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function XS(e){Ap=!1,mu=!0,vr.sort(TC);const t=In;try{for(Un=0;Un<vr.length;Un++){const r=vr[Un];r&&r.active!==!1&&Gi(r,null,14)}}finally{Un=0,vr.length=0,QS(),mu=!1,uv=null,(vr.length||Bs.length)&&XS()}}function EC(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||Nt;let i=r;const a=t.startsWith("update:"),s=a&&t.slice(7);if(s&&s in n){const d=`${s==="modelValue"?"model":s}Modifiers`,{number:y,trim:_}=n[d]||Nt;_&&(i=r.map(b=>b.trim())),y&&(i=r.map(uc))}let u,o=n[u=Df(t)]||n[u=Df(qn(t))];!o&&a&&(o=n[u=Df(Va(t))]),o&&un(o,e,6,i);const c=n[u+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,un(c,e,6,i)}}function ZS(e,t,r=!1){const n=t.emitsCache,i=n.get(e);if(i!==void 0)return i;const a=e.emits;let s={},u=!1;if(!ut(e)){const o=c=>{const d=ZS(c,t,!0);d&&(u=!0,yr(s,d))};!r&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}return!a&&!u?(Lt(e)&&n.set(e,null),null):(Ke(a)?a.forEach(o=>s[o]=null):yr(s,a),Lt(e)&&n.set(e,s),s)}function Kc(e,t){return!e||!qc(t)?!1:(t=t.slice(2).replace(/Once$/,""),ht(e,t[0].toLowerCase()+t.slice(1))||ht(e,Va(t))||ht(e,t))}let gr=null,Jc=null;function cc(e){const t=gr;return gr=e,Jc=e&&e.type.__scopeId||null,t}function CC(e){Jc=e}function IC(){Jc=null}function tr(e,t=gr,r){if(!t||e._n)return e;const n=(...i)=>{n._d&&ky(-1);const a=cc(t),s=e(...i);return cc(a),n._d&&ky(1),s};return n._n=!0,n._c=!0,n._d=!0,n}function Ff(e){const{type:t,vnode:r,proxy:n,withProxy:i,props:a,propsOptions:[s],slots:u,attrs:o,emit:c,render:d,renderCache:y,data:_,setupState:b,ctx:T,inheritAttrs:x}=e;let N,D;const H=cc(e);try{if(r.shapeFlag&4){const ae=i||n;N=Ln(d.call(ae,ae,y,a,b,_,T)),D=o}else{const ae=t;N=Ln(ae.length>1?ae(a,{attrs:o,slots:u,emit:c}):ae(a,null)),D=t.props?o:RC(o)}}catch(ae){au.length=0,Vc(ae,e,1),N=vt(ln)}let ve=N;if(D&&x!==!1){const ae=Object.keys(D),{shapeFlag:Ae}=ve;ae.length&&Ae&7&&(s&&ae.some(Xh)&&(D=OC(D,s)),ve=Qi(ve,D))}return r.dirs&&(ve=Qi(ve),ve.dirs=ve.dirs?ve.dirs.concat(r.dirs):r.dirs),r.transition&&(ve.transition=r.transition),N=ve,cc(H),N}const RC=e=>{let t;for(const r in e)(r==="class"||r==="style"||qc(r))&&((t||(t={}))[r]=e[r]);return t},OC=(e,t)=>{const r={};for(const n in e)(!Xh(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function AC(e,t,r){const{props:n,children:i,component:a}=e,{props:s,children:u,patchFlag:o}=t,c=a.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&o>=0){if(o&1024)return!0;if(o&16)return n?hy(n,s,c):!!s;if(o&8){const d=t.dynamicProps;for(let y=0;y<d.length;y++){const _=d[y];if(s[_]!==n[_]&&!Kc(c,_))return!0}}}else return(i||u)&&(!u||!u.$stable)?!0:n===s?!1:n?s?hy(n,s,c):!0:!!s;return!1}function hy(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let i=0;i<n.length;i++){const a=n[i];if(t[a]!==e[a]&&!Kc(r,a))return!0}return!1}function PC({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const MC=e=>e.__isSuspense;function NC(e,t){t&&t.pendingBranch?Ke(e)?t.effects.push(...e):t.effects.push(e):kC(e)}function Yl(e,t){if(or){let r=or.provides;const n=or.parent&&or.parent.provides;n===r&&(r=or.provides=Object.create(n)),r[e]=t}}function Rn(e,t,r=!1){const n=or||gr;if(n){const i=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(i&&e in i)return i[e];if(arguments.length>1)return r&&ut(t)?t.call(n.proxy):t}}const vy={};function nu(e,t,r){return e$(e,t,r)}function e$(e,t,{immediate:r,deep:n,flush:i,onTrack:a,onTrigger:s}=Nt){const u=or;let o,c=!1,d=!1;if(Yt(e)?(o=()=>e.value,c=lc(e)):Wi(e)?(o=()=>e,n=!0):Ke(e)?(d=!0,c=e.some(D=>Wi(D)||lc(D)),o=()=>e.map(D=>{if(Yt(D))return D.value;if(Wi(D))return ja(D);if(ut(D))return Gi(D,u,2)})):ut(e)?t?o=()=>Gi(e,u,2):o=()=>{if(!(u&&u.isUnmounted))return y&&y(),un(e,u,3,[_])}:o=In,t&&n){const D=o;o=()=>ja(D())}let y,_=D=>{y=N.onStop=()=>{Gi(D,u,4)}};if(_u)return _=In,t?r&&un(t,u,3,[o(),d?[]:void 0,_]):o(),In;let b=d?[]:vy;const T=()=>{if(!!N.active)if(t){const D=N.run();(n||c||(d?D.some((H,ve)=>gu(H,b[ve])):gu(D,b)))&&(y&&y(),un(t,u,3,[D,b===vy?void 0:b,_]),b=D)}else N.run()};T.allowRecurse=!!t;let x;i==="sync"?x=T:i==="post"?x=()=>Ar(T,u&&u.suspense):(T.pre=!0,u&&(T.id=u.uid),x=()=>cv(T));const N=new rv(o,x);return t?r?T():b=N.run():i==="post"?Ar(N.run.bind(N),u&&u.suspense):N.run(),()=>{N.stop(),u&&u.scope&&Zh(u.scope.effects,N)}}function xC(e,t,r){const n=this.proxy,i=lr(e)?e.includes(".")?t$(n,e):()=>n[e]:e.bind(n,n);let a;ut(t)?a=t:(a=t.handler,r=t);const s=or;Ys(this);const u=e$(i,a.bind(n),r);return s?Ys(s):Fa(),u}function t$(e,t){const r=t.split(".");return()=>{let n=e;for(let i=0;i<r.length&&n;i++)n=n[r[i]];return n}}function ja(e,t){if(!Lt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Yt(e))ja(e.value,t);else if(Ke(e))for(let r=0;r<e.length;r++)ja(e[r],t);else if(Hc(e)||Fs(e))e.forEach(r=>{ja(r,t)});else if(RS(e))for(const r in e)ja(e[r],t);return e}function LC(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return uo(()=>{e.isMounted=!0}),o$(()=>{e.isUnmounting=!0}),e}const Zr=[Function,Array],jC={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Zr,onEnter:Zr,onAfterEnter:Zr,onEnterCancelled:Zr,onBeforeLeave:Zr,onLeave:Zr,onAfterLeave:Zr,onLeaveCancelled:Zr,onBeforeAppear:Zr,onAppear:Zr,onAfterAppear:Zr,onAppearCancelled:Zr},setup(e,{slots:t}){const r=gv(),n=LC();let i;return()=>{const a=t.default&&n$(t.default(),!0);if(!a||!a.length)return;let s=a[0];if(a.length>1){for(const x of a)if(x.type!==ln){s=x;break}}const u=mt(e),{mode:o}=u;if(n.isLeaving)return Bf(s);const c=gy(s);if(!c)return Bf(s);const d=Pp(c,u,n,r);Mp(c,d);const y=r.subTree,_=y&&gy(y);let b=!1;const{getTransitionKey:T}=c.type;if(T){const x=T();i===void 0?i=x:x!==i&&(i=x,b=!0)}if(_&&_.type!==ln&&(!Aa(c,_)||b)){const x=Pp(_,u,n,r);if(Mp(_,x),o==="out-in")return n.isLeaving=!0,x.afterLeave=()=>{n.isLeaving=!1,r.update()},Bf(s);o==="in-out"&&c.type!==ln&&(x.delayLeave=(N,D,H)=>{const ve=r$(n,_);ve[String(_.key)]=_,N._leaveCb=()=>{D(),N._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=H})}return s}}},UC=jC;function r$(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function Pp(e,t,r,n){const{appear:i,mode:a,persisted:s=!1,onBeforeEnter:u,onEnter:o,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:y,onLeave:_,onAfterLeave:b,onLeaveCancelled:T,onBeforeAppear:x,onAppear:N,onAfterAppear:D,onAppearCancelled:H}=t,ve=String(e.key),ae=r$(r,e),Ae=(L,oe)=>{L&&un(L,n,9,oe)},Re=(L,oe)=>{const B=oe[1];Ae(L,oe),Ke(L)?L.every(ke=>ke.length<=1)&&B():L.length<=1&&B()},Ie={mode:a,persisted:s,beforeEnter(L){let oe=u;if(!r.isMounted)if(i)oe=x||u;else return;L._leaveCb&&L._leaveCb(!0);const B=ae[ve];B&&Aa(e,B)&&B.el._leaveCb&&B.el._leaveCb(),Ae(oe,[L])},enter(L){let oe=o,B=c,ke=d;if(!r.isMounted)if(i)oe=N||o,B=D||c,ke=H||d;else return;let Se=!1;const se=L._enterCb=ee=>{Se||(Se=!0,ee?Ae(ke,[L]):Ae(B,[L]),Ie.delayedLeave&&Ie.delayedLeave(),L._enterCb=void 0)};oe?Re(oe,[L,se]):se()},leave(L,oe){const B=String(e.key);if(L._enterCb&&L._enterCb(!0),r.isUnmounting)return oe();Ae(y,[L]);let ke=!1;const Se=L._leaveCb=se=>{ke||(ke=!0,oe(),se?Ae(T,[L]):Ae(b,[L]),L._leaveCb=void 0,ae[B]===e&&delete ae[B])};ae[B]=e,_?Re(_,[L,Se]):Se()},clone(L){return Pp(L,t,r,n)}};return Ie}function Bf(e){if(Yc(e))return e=Qi(e),e.children=null,e}function gy(e){return Yc(e)?e.children?e.children[0]:void 0:e}function Mp(e,t){e.shapeFlag&6&&e.component?Mp(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function n$(e,t=!1,r){let n=[],i=0;for(let a=0;a<e.length;a++){let s=e[a];const u=r==null?s.key:String(r)+String(s.key!=null?s.key:a);s.type===Ht?(s.patchFlag&128&&i++,n=n.concat(n$(s.children,t,u))):(t||s.type!==ln)&&n.push(u!=null?Qi(s,{key:u}):s)}if(i>1)for(let a=0;a<n.length;a++)n[a].patchFlag=-2;return n}function i$(e){return ut(e)?{setup:e,name:e.name}:e}const iu=e=>!!e.type.__asyncLoader,Yc=e=>e.type.__isKeepAlive;function DC(e,t){a$(e,"a",t)}function FC(e,t){a$(e,"da",t)}function a$(e,t,r=or){const n=e.__wdc||(e.__wdc=()=>{let i=r;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(Qc(t,n,r),r){let i=r.parent;for(;i&&i.parent;)Yc(i.parent.vnode)&&BC(n,t,r,i),i=i.parent}}function BC(e,t,r,n){const i=Qc(t,e,n,!0);fv(()=>{Zh(n[t],i)},r)}function Qc(e,t,r=or,n=!1){if(r){const i=r[e]||(r[e]=[]),a=t.__weh||(t.__weh=(...s)=>{if(r.isUnmounted)return;so(),Ys(r);const u=un(t,r,e,s);return Fa(),oo(),u});return n?i.unshift(a):i.push(a),a}}const hi=e=>(t,r=or)=>(!_u||e==="sp")&&Qc(e,t,r),s$=hi("bm"),uo=hi("m"),qC=hi("bu"),HC=hi("u"),o$=hi("bum"),fv=hi("um"),WC=hi("sp"),GC=hi("rtg"),zC=hi("rtc");function VC(e,t=or){Qc("ec",e,t)}function rt(e,t){const r=gr;if(r===null)return e;const n=Zc(r)||r.proxy,i=e.dirs||(e.dirs=[]);for(let a=0;a<t.length;a++){let[s,u,o,c=Nt]=t[a];ut(s)&&(s={mounted:s,updated:s}),s.deep&&ja(u),i.push({dir:s,instance:n,value:u,oldValue:void 0,arg:o,modifiers:c})}return e}function ba(e,t,r,n){const i=e.dirs,a=t&&t.dirs;for(let s=0;s<i.length;s++){const u=i[s];a&&(u.oldValue=a[s].value);let o=u.dir[n];o&&(so(),un(o,r,8,[e.el,u,e,t]),oo())}}const u$="components";function fr(e,t){return JC(u$,e,!0,t)||e}const KC=Symbol();function JC(e,t,r=!0,n=!1){const i=gr||or;if(i){const a=i.type;if(e===u$){const u=EI(a,!1);if(u&&(u===t||u===qn(t)||u===Gc(qn(t))))return a}const s=yy(i[e]||a[e],t)||yy(i.appContext[e],t);return!s&&n?a:s}}function yy(e,t){return e&&(e[t]||e[qn(t)]||e[Gc(qn(t))])}function wn(e,t,r,n){let i;const a=r&&r[n];if(Ke(e)||lr(e)){i=new Array(e.length);for(let s=0,u=e.length;s<u;s++)i[s]=t(e[s],s,void 0,a&&a[s])}else if(typeof e=="number"){i=new Array(e);for(let s=0;s<e;s++)i[s]=t(s+1,s,void 0,a&&a[s])}else if(Lt(e))if(e[Symbol.iterator])i=Array.from(e,(s,u)=>t(s,u,void 0,a&&a[u]));else{const s=Object.keys(e);i=new Array(s.length);for(let u=0,o=s.length;u<o;u++){const c=s[u];i[u]=t(e[c],c,u,a&&a[u])}}else i=[];return r&&(r[n]=i),i}function YC(e,t,r={},n,i){if(gr.isCE||gr.parent&&iu(gr.parent)&&gr.parent.isCE)return vt("slot",t==="default"?null:{name:t},n&&n());let a=e[t];a&&a._c&&(a._d=!1),He();const s=a&&l$(a(r)),u=cn(Ht,{key:r.key||s&&s.key||`_${t}`},s||(n?n():[]),s&&e._===1?64:-2);return!i&&u.scopeId&&(u.slotScopeIds=[u.scopeId+"-s"]),a&&a._c&&(a._d=!0),u}function l$(e){return e.some(t=>pc(t)?!(t.type===ln||t.type===Ht&&!l$(t.children)):!0)?e:null}const Np=e=>e?w$(e)?Zc(e)||e.proxy:Np(e.parent):null,fc=yr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Np(e.parent),$root:e=>Np(e.root),$emit:e=>e.emit,$options:e=>dv(e),$forceUpdate:e=>e.f||(e.f=()=>cv(e.update)),$nextTick:e=>e.n||(e.n=lv.bind(e.proxy)),$watch:e=>xC.bind(e)}),QC={get({_:e},t){const{ctx:r,setupState:n,data:i,props:a,accessCache:s,type:u,appContext:o}=e;let c;if(t[0]!=="$"){const b=s[t];if(b!==void 0)switch(b){case 1:return n[t];case 2:return i[t];case 4:return r[t];case 3:return a[t]}else{if(n!==Nt&&ht(n,t))return s[t]=1,n[t];if(i!==Nt&&ht(i,t))return s[t]=2,i[t];if((c=e.propsOptions[0])&&ht(c,t))return s[t]=3,a[t];if(r!==Nt&&ht(r,t))return s[t]=4,r[t];xp&&(s[t]=0)}}const d=fc[t];let y,_;if(d)return t==="$attrs"&&qr(e,"get",t),d(e);if((y=u.__cssModules)&&(y=y[t]))return y;if(r!==Nt&&ht(r,t))return s[t]=4,r[t];if(_=o.config.globalProperties,ht(_,t))return _[t]},set({_:e},t,r){const{data:n,setupState:i,ctx:a}=e;return i!==Nt&&ht(i,t)?(i[t]=r,!0):n!==Nt&&ht(n,t)?(n[t]=r,!0):ht(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:i,propsOptions:a}},s){let u;return!!r[s]||e!==Nt&&ht(e,s)||t!==Nt&&ht(t,s)||(u=a[0])&&ht(u,s)||ht(n,s)||ht(fc,s)||ht(i.config.globalProperties,s)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:ht(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let xp=!0;function XC(e){const t=dv(e),r=e.proxy,n=e.ctx;xp=!1,t.beforeCreate&&my(t.beforeCreate,e,"bc");const{data:i,computed:a,methods:s,watch:u,provide:o,inject:c,created:d,beforeMount:y,mounted:_,beforeUpdate:b,updated:T,activated:x,deactivated:N,beforeDestroy:D,beforeUnmount:H,destroyed:ve,unmounted:ae,render:Ae,renderTracked:Re,renderTriggered:Ie,errorCaptured:L,serverPrefetch:oe,expose:B,inheritAttrs:ke,components:Se,directives:se,filters:ee}=t;if(c&&ZC(c,n,null,e.appContext.config.unwrapInjectedRef),s)for(const me in s){const A=s[me];ut(A)&&(n[me]=A.bind(r))}if(i){const me=i.call(r,r);Lt(me)&&(e.data=Ka(me))}if(xp=!0,a)for(const me in a){const A=a[me],Ne=ut(A)?A.bind(r,r):ut(A.get)?A.get.bind(r,r):In,ft=!ut(A)&&ut(A.set)?A.set.bind(r):In,ze=Jt({get:Ne,set:ft});Object.defineProperty(n,me,{enumerable:!0,configurable:!0,get:()=>ze.value,set:le=>ze.value=le})}if(u)for(const me in u)c$(u[me],n,r,me);if(o){const me=ut(o)?o.call(r):o;Reflect.ownKeys(me).forEach(A=>{Yl(A,me[A])})}d&&my(d,e,"c");function te(me,A){Ke(A)?A.forEach(Ne=>me(Ne.bind(r))):A&&me(A.bind(r))}if(te(s$,y),te(uo,_),te(qC,b),te(HC,T),te(DC,x),te(FC,N),te(VC,L),te(zC,Re),te(GC,Ie),te(o$,H),te(fv,ae),te(WC,oe),Ke(B))if(B.length){const me=e.exposed||(e.exposed={});B.forEach(A=>{Object.defineProperty(me,A,{get:()=>r[A],set:Ne=>r[A]=Ne})})}else e.exposed||(e.exposed={});Ae&&e.render===In&&(e.render=Ae),ke!=null&&(e.inheritAttrs=ke),Se&&(e.components=Se),se&&(e.directives=se)}function ZC(e,t,r=In,n=!1){Ke(e)&&(e=Lp(e));for(const i in e){const a=e[i];let s;Lt(a)?"default"in a?s=Rn(a.from||i,a.default,!0):s=Rn(a.from||i):s=Rn(a),Yt(s)&&n?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:u=>s.value=u}):t[i]=s}}function my(e,t,r){un(Ke(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function c$(e,t,r,n){const i=n.includes(".")?t$(r,n):()=>r[n];if(lr(e)){const a=t[e];ut(a)&&nu(i,a)}else if(ut(e))nu(i,e.bind(r));else if(Lt(e))if(Ke(e))e.forEach(a=>c$(a,t,r,n));else{const a=ut(e.handler)?e.handler.bind(r):t[e.handler];ut(a)&&nu(i,a,e)}}function dv(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:i,optionsCache:a,config:{optionMergeStrategies:s}}=e.appContext,u=a.get(t);let o;return u?o=u:!i.length&&!r&&!n?o=t:(o={},i.length&&i.forEach(c=>dc(o,c,s,!0)),dc(o,t,s)),Lt(t)&&a.set(t,o),o}function dc(e,t,r,n=!1){const{mixins:i,extends:a}=t;a&&dc(e,a,r,!0),i&&i.forEach(s=>dc(e,s,r,!0));for(const s in t)if(!(n&&s==="expose")){const u=eI[s]||r&&r[s];e[s]=u?u(e[s],t[s]):t[s]}return e}const eI={data:by,props:Ra,emits:Ra,methods:Ra,computed:Ra,beforeCreate:kr,created:kr,beforeMount:kr,mounted:kr,beforeUpdate:kr,updated:kr,beforeDestroy:kr,beforeUnmount:kr,destroyed:kr,unmounted:kr,activated:kr,deactivated:kr,errorCaptured:kr,serverPrefetch:kr,components:Ra,directives:Ra,watch:rI,provide:by,inject:tI};function by(e,t){return t?e?function(){return yr(ut(e)?e.call(this,this):e,ut(t)?t.call(this,this):t)}:t:e}function tI(e,t){return Ra(Lp(e),Lp(t))}function Lp(e){if(Ke(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function kr(e,t){return e?[...new Set([].concat(e,t))]:t}function Ra(e,t){return e?yr(yr(Object.create(null),e),t):t}function rI(e,t){if(!e)return t;if(!t)return e;const r=yr(Object.create(null),e);for(const n in t)r[n]=kr(e[n],t[n]);return r}function nI(e,t,r,n=!1){const i={},a={};oc(a,Xc,1),e.propsDefaults=Object.create(null),f$(e,t,i,a);for(const s in e.propsOptions[0])s in i||(i[s]=void 0);r?e.props=n?i:dC(i):e.type.props?e.props=i:e.props=a,e.attrs=a}function iI(e,t,r,n){const{props:i,attrs:a,vnode:{patchFlag:s}}=e,u=mt(i),[o]=e.propsOptions;let c=!1;if((n||s>0)&&!(s&16)){if(s&8){const d=e.vnode.dynamicProps;for(let y=0;y<d.length;y++){let _=d[y];if(Kc(e.emitsOptions,_))continue;const b=t[_];if(o)if(ht(a,_))b!==a[_]&&(a[_]=b,c=!0);else{const T=qn(_);i[T]=jp(o,u,T,b,e,!1)}else b!==a[_]&&(a[_]=b,c=!0)}}}else{f$(e,t,i,a)&&(c=!0);let d;for(const y in u)(!t||!ht(t,y)&&((d=Va(y))===y||!ht(t,d)))&&(o?r&&(r[y]!==void 0||r[d]!==void 0)&&(i[y]=jp(o,u,y,void 0,e,!0)):delete i[y]);if(a!==u)for(const y in a)(!t||!ht(t,y)&&!0)&&(delete a[y],c=!0)}c&&li(e,"set","$attrs")}function f$(e,t,r,n){const[i,a]=e.propsOptions;let s=!1,u;if(t)for(let o in t){if(Kl(o))continue;const c=t[o];let d;i&&ht(i,d=qn(o))?!a||!a.includes(d)?r[d]=c:(u||(u={}))[d]=c:Kc(e.emitsOptions,o)||(!(o in n)||c!==n[o])&&(n[o]=c,s=!0)}if(a){const o=mt(r),c=u||Nt;for(let d=0;d<a.length;d++){const y=a[d];r[y]=jp(i,o,y,c[y],e,!ht(c,y))}}return s}function jp(e,t,r,n,i,a){const s=e[r];if(s!=null){const u=ht(s,"default");if(u&&n===void 0){const o=s.default;if(s.type!==Function&&ut(o)){const{propsDefaults:c}=i;r in c?n=c[r]:(Ys(i),n=c[r]=o.call(null,t),Fa())}else n=o}s[0]&&(a&&!u?n=!1:s[1]&&(n===""||n===Va(r))&&(n=!0))}return n}function d$(e,t,r=!1){const n=t.propsCache,i=n.get(e);if(i)return i;const a=e.props,s={},u=[];let o=!1;if(!ut(e)){const d=y=>{o=!0;const[_,b]=d$(y,t,!0);yr(s,_),b&&u.push(...b)};!r&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}if(!a&&!o)return Lt(e)&&n.set(e,Ds),Ds;if(Ke(a))for(let d=0;d<a.length;d++){const y=qn(a[d]);wy(y)&&(s[y]=Nt)}else if(a)for(const d in a){const y=qn(d);if(wy(y)){const _=a[d],b=s[y]=Ke(_)||ut(_)?{type:_}:_;if(b){const T=$y(Boolean,b.type),x=$y(String,b.type);b[0]=T>-1,b[1]=x<0||T<x,(T>-1||ht(b,"default"))&&u.push(y)}}}const c=[s,u];return Lt(e)&&n.set(e,c),c}function wy(e){return e[0]!=="$"}function _y(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function Sy(e,t){return _y(e)===_y(t)}function $y(e,t){return Ke(t)?t.findIndex(r=>Sy(r,e)):ut(t)&&Sy(t,e)?0:-1}const p$=e=>e[0]==="_"||e==="$stable",pv=e=>Ke(e)?e.map(Ln):[Ln(e)],aI=(e,t,r)=>{if(t._n)return t;const n=tr((...i)=>pv(t(...i)),r);return n._c=!1,n},h$=(e,t,r)=>{const n=e._ctx;for(const i in e){if(p$(i))continue;const a=e[i];if(ut(a))t[i]=aI(i,a,n);else if(a!=null){const s=pv(a);t[i]=()=>s}}},v$=(e,t)=>{const r=pv(t);e.slots.default=()=>r},sI=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=mt(t),oc(t,"_",r)):h$(t,e.slots={})}else e.slots={},t&&v$(e,t);oc(e.slots,Xc,1)},oI=(e,t,r)=>{const{vnode:n,slots:i}=e;let a=!0,s=Nt;if(n.shapeFlag&32){const u=t._;u?r&&u===1?a=!1:(yr(i,t),!r&&u===1&&delete i._):(a=!t.$stable,h$(t,i)),s=t}else t&&(v$(e,t),s={default:1});if(a)for(const u in i)!p$(u)&&!(u in s)&&delete i[u]};function g$(){return{app:null,config:{isNativeTag:ME,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uI=0;function lI(e,t){return function(n,i=null){ut(n)||(n=Object.assign({},n)),i!=null&&!Lt(i)&&(i=null);const a=g$(),s=new Set;let u=!1;const o=a.app={_uid:uI++,_component:n,_props:i,_container:null,_context:a,_instance:null,version:II,get config(){return a.config},set config(c){},use(c,...d){return s.has(c)||(c&&ut(c.install)?(s.add(c),c.install(o,...d)):ut(c)&&(s.add(c),c(o,...d))),o},mixin(c){return a.mixins.includes(c)||a.mixins.push(c),o},component(c,d){return d?(a.components[c]=d,o):a.components[c]},directive(c,d){return d?(a.directives[c]=d,o):a.directives[c]},mount(c,d,y){if(!u){const _=vt(n,i);return _.appContext=a,d&&t?t(_,c):e(_,c,y),u=!0,o._container=c,c.__vue_app__=o,Zc(_.component)||_.component.proxy}},unmount(){u&&(e(null,o._container),delete o._container.__vue_app__)},provide(c,d){return a.provides[c]=d,o}};return o}}function Up(e,t,r,n,i=!1){if(Ke(e)){e.forEach((_,b)=>Up(_,t&&(Ke(t)?t[b]:t),r,n,i));return}if(iu(n)&&!i)return;const a=n.shapeFlag&4?Zc(n.component)||n.component.proxy:n.el,s=i?null:a,{i:u,r:o}=e,c=t&&t.r,d=u.refs===Nt?u.refs={}:u.refs,y=u.setupState;if(c!=null&&c!==o&&(lr(c)?(d[c]=null,ht(y,c)&&(y[c]=null)):Yt(c)&&(c.value=null)),ut(o))Gi(o,u,12,[s,d]);else{const _=lr(o),b=Yt(o);if(_||b){const T=()=>{if(e.f){const x=_?d[o]:o.value;i?Ke(x)&&Zh(x,a):Ke(x)?x.includes(a)||x.push(a):_?(d[o]=[a],ht(y,o)&&(y[o]=d[o])):(o.value=[a],e.k&&(d[e.k]=o.value))}else _?(d[o]=s,ht(y,o)&&(y[o]=s)):b&&(o.value=s,e.k&&(d[e.k]=s))};s?(T.id=-1,Ar(T,r)):T()}}}const Ar=NC;function cI(e){return fI(e)}function fI(e,t){const r=DE();r.__VUE__=!0;const{insert:n,remove:i,patchProp:a,createElement:s,createText:u,createComment:o,setText:c,setElementText:d,parentNode:y,nextSibling:_,setScopeId:b=In,cloneNode:T,insertStaticContent:x}=e,N=(E,$,q,P=null,U=null,_e=null,de=!1,ye=null,Ce=!!$.dynamicChildren)=>{if(E===$)return;E&&!Aa(E,$)&&(P=Z(E),G(E,U,_e,!0),E=null),$.patchFlag===-2&&(Ce=!1,$.dynamicChildren=null);const{type:K,ref:je,shapeFlag:Me}=$;switch(K){case hv:D(E,$,q,P);break;case ln:H(E,$,q,P);break;case Ql:E==null&&ve($,q,P,de);break;case Ht:se(E,$,q,P,U,_e,de,ye,Ce);break;default:Me&1?Re(E,$,q,P,U,_e,de,ye,Ce):Me&6?ee(E,$,q,P,U,_e,de,ye,Ce):(Me&64||Me&128)&&K.process(E,$,q,P,U,_e,de,ye,Ce,De)}je!=null&&U&&Up(je,E&&E.ref,_e,$||E,!$)},D=(E,$,q,P)=>{if(E==null)n($.el=u($.children),q,P);else{const U=$.el=E.el;$.children!==E.children&&c(U,$.children)}},H=(E,$,q,P)=>{E==null?n($.el=o($.children||""),q,P):$.el=E.el},ve=(E,$,q,P)=>{[E.el,E.anchor]=x(E.children,$,q,P,E.el,E.anchor)},ae=({el:E,anchor:$},q,P)=>{let U;for(;E&&E!==$;)U=_(E),n(E,q,P),E=U;n($,q,P)},Ae=({el:E,anchor:$})=>{let q;for(;E&&E!==$;)q=_(E),i(E),E=q;i($)},Re=(E,$,q,P,U,_e,de,ye,Ce)=>{de=de||$.type==="svg",E==null?Ie($,q,P,U,_e,de,ye,Ce):B(E,$,U,_e,de,ye,Ce)},Ie=(E,$,q,P,U,_e,de,ye)=>{let Ce,K;const{type:je,props:Me,shapeFlag:Oe,transition:xe,patchFlag:Ue,dirs:Le}=E;if(E.el&&T!==void 0&&Ue===-1)Ce=E.el=T(E.el);else{if(Ce=E.el=s(E.type,_e,Me&&Me.is,Me),Oe&8?d(Ce,E.children):Oe&16&&oe(E.children,Ce,null,P,U,_e&&je!=="foreignObject",de,ye),Le&&ba(E,null,P,"created"),Me){for(const et in Me)et!=="value"&&!Kl(et)&&a(Ce,et,null,Me[et],_e,E.children,P,U,X);"value"in Me&&a(Ce,"value",null,Me.value),(K=Me.onVnodeBeforeMount)&&Mn(K,P,E)}L(Ce,E,E.scopeId,de,P)}Le&&ba(E,null,P,"beforeMount");const Ge=(!U||U&&!U.pendingBranch)&&xe&&!xe.persisted;Ge&&xe.beforeEnter(Ce),n(Ce,$,q),((K=Me&&Me.onVnodeMounted)||Ge||Le)&&Ar(()=>{K&&Mn(K,P,E),Ge&&xe.enter(Ce),Le&&ba(E,null,P,"mounted")},U)},L=(E,$,q,P,U)=>{if(q&&b(E,q),P)for(let _e=0;_e<P.length;_e++)b(E,P[_e]);if(U){let _e=U.subTree;if($===_e){const de=U.vnode;L(E,de,de.scopeId,de.slotScopeIds,U.parent)}}},oe=(E,$,q,P,U,_e,de,ye,Ce=0)=>{for(let K=Ce;K<E.length;K++){const je=E[K]=ye?Li(E[K]):Ln(E[K]);N(null,je,$,q,P,U,_e,de,ye)}},B=(E,$,q,P,U,_e,de)=>{const ye=$.el=E.el;let{patchFlag:Ce,dynamicChildren:K,dirs:je}=$;Ce|=E.patchFlag&16;const Me=E.props||Nt,Oe=$.props||Nt;let xe;q&&wa(q,!1),(xe=Oe.onVnodeBeforeUpdate)&&Mn(xe,q,$,E),je&&ba($,E,q,"beforeUpdate"),q&&wa(q,!0);const Ue=U&&$.type!=="foreignObject";if(K?ke(E.dynamicChildren,K,ye,q,P,Ue,_e):de||Ne(E,$,ye,null,q,P,Ue,_e,!1),Ce>0){if(Ce&16)Se(ye,$,Me,Oe,q,P,U);else if(Ce&2&&Me.class!==Oe.class&&a(ye,"class",null,Oe.class,U),Ce&4&&a(ye,"style",Me.style,Oe.style,U),Ce&8){const Le=$.dynamicProps;for(let Ge=0;Ge<Le.length;Ge++){const et=Le[Ge],er=Me[et],_r=Oe[et];(_r!==er||et==="value")&&a(ye,et,er,_r,U,E.children,q,P,X)}}Ce&1&&E.children!==$.children&&d(ye,$.children)}else!de&&K==null&&Se(ye,$,Me,Oe,q,P,U);((xe=Oe.onVnodeUpdated)||je)&&Ar(()=>{xe&&Mn(xe,q,$,E),je&&ba($,E,q,"updated")},P)},ke=(E,$,q,P,U,_e,de)=>{for(let ye=0;ye<$.length;ye++){const Ce=E[ye],K=$[ye],je=Ce.el&&(Ce.type===Ht||!Aa(Ce,K)||Ce.shapeFlag&70)?y(Ce.el):q;N(Ce,K,je,null,P,U,_e,de,!0)}},Se=(E,$,q,P,U,_e,de)=>{if(q!==P){for(const ye in P){if(Kl(ye))continue;const Ce=P[ye],K=q[ye];Ce!==K&&ye!=="value"&&a(E,ye,K,Ce,de,$.children,U,_e,X)}if(q!==Nt)for(const ye in q)!Kl(ye)&&!(ye in P)&&a(E,ye,q[ye],null,de,$.children,U,_e,X);"value"in P&&a(E,"value",q.value,P.value)}},se=(E,$,q,P,U,_e,de,ye,Ce)=>{const K=$.el=E?E.el:u(""),je=$.anchor=E?E.anchor:u("");let{patchFlag:Me,dynamicChildren:Oe,slotScopeIds:xe}=$;xe&&(ye=ye?ye.concat(xe):xe),E==null?(n(K,q,P),n(je,q,P),oe($.children,q,je,U,_e,de,ye,Ce)):Me>0&&Me&64&&Oe&&E.dynamicChildren?(ke(E.dynamicChildren,Oe,q,U,_e,de,ye),($.key!=null||U&&$===U.subTree)&&y$(E,$,!0)):Ne(E,$,q,je,U,_e,de,ye,Ce)},ee=(E,$,q,P,U,_e,de,ye,Ce)=>{$.slotScopeIds=ye,E==null?$.shapeFlag&512?U.ctx.activate($,q,P,de,Ce):ne($,q,P,U,_e,de,Ce):te(E,$,Ce)},ne=(E,$,q,P,U,_e,de)=>{const ye=E.component=_I(E,P,U);if(Yc(E)&&(ye.ctx.renderer=De),SI(ye),ye.asyncDep){if(U&&U.registerDep(ye,me),!E.el){const Ce=ye.subTree=vt(ln);H(null,Ce,$,q)}return}me(ye,E,$,q,U,_e,de)},te=(E,$,q)=>{const P=$.component=E.component;if(AC(E,$,q))if(P.asyncDep&&!P.asyncResolved){A(P,$,q);return}else P.next=$,$C(P.update),P.update();else $.el=E.el,P.vnode=$},me=(E,$,q,P,U,_e,de)=>{const ye=()=>{if(E.isMounted){let{next:je,bu:Me,u:Oe,parent:xe,vnode:Ue}=E,Le=je,Ge;wa(E,!1),je?(je.el=Ue.el,A(E,je,de)):je=Ue,Me&&Jl(Me),(Ge=je.props&&je.props.onVnodeBeforeUpdate)&&Mn(Ge,xe,je,Ue),wa(E,!0);const et=Ff(E),er=E.subTree;E.subTree=et,N(er,et,y(er.el),Z(er),E,U,_e),je.el=et.el,Le===null&&PC(E,et.el),Oe&&Ar(Oe,U),(Ge=je.props&&je.props.onVnodeUpdated)&&Ar(()=>Mn(Ge,xe,je,Ue),U)}else{let je;const{el:Me,props:Oe}=$,{bm:xe,m:Ue,parent:Le}=E,Ge=iu($);if(wa(E,!1),xe&&Jl(xe),!Ge&&(je=Oe&&Oe.onVnodeBeforeMount)&&Mn(je,Le,$),wa(E,!0),Me&&Te){const et=()=>{E.subTree=Ff(E),Te(Me,E.subTree,E,U,null)};Ge?$.type.__asyncLoader().then(()=>!E.isUnmounted&&et()):et()}else{const et=E.subTree=Ff(E);N(null,et,q,P,E,U,_e),$.el=et.el}if(Ue&&Ar(Ue,U),!Ge&&(je=Oe&&Oe.onVnodeMounted)){const et=$;Ar(()=>Mn(je,Le,et),U)}($.shapeFlag&256||Le&&iu(Le.vnode)&&Le.vnode.shapeFlag&256)&&E.a&&Ar(E.a,U),E.isMounted=!0,$=q=P=null}},Ce=E.effect=new rv(ye,()=>cv(K),E.scope),K=E.update=()=>Ce.run();K.id=E.uid,wa(E,!0),K()},A=(E,$,q)=>{$.component=E;const P=E.vnode.props;E.vnode=$,E.next=null,iI(E,$.props,P,q),oI(E,$.children,q),so(),py(),oo()},Ne=(E,$,q,P,U,_e,de,ye,Ce=!1)=>{const K=E&&E.children,je=E?E.shapeFlag:0,Me=$.children,{patchFlag:Oe,shapeFlag:xe}=$;if(Oe>0){if(Oe&128){ze(K,Me,q,P,U,_e,de,ye,Ce);return}else if(Oe&256){ft(K,Me,q,P,U,_e,de,ye,Ce);return}}xe&8?(je&16&&X(K,U,_e),Me!==K&&d(q,Me)):je&16?xe&16?ze(K,Me,q,P,U,_e,de,ye,Ce):X(K,U,_e,!0):(je&8&&d(q,""),xe&16&&oe(Me,q,P,U,_e,de,ye,Ce))},ft=(E,$,q,P,U,_e,de,ye,Ce)=>{E=E||Ds,$=$||Ds;const K=E.length,je=$.length,Me=Math.min(K,je);let Oe;for(Oe=0;Oe<Me;Oe++){const xe=$[Oe]=Ce?Li($[Oe]):Ln($[Oe]);N(E[Oe],xe,q,null,U,_e,de,ye,Ce)}K>je?X(E,U,_e,!0,!1,Me):oe($,q,P,U,_e,de,ye,Ce,Me)},ze=(E,$,q,P,U,_e,de,ye,Ce)=>{let K=0;const je=$.length;let Me=E.length-1,Oe=je-1;for(;K<=Me&&K<=Oe;){const xe=E[K],Ue=$[K]=Ce?Li($[K]):Ln($[K]);if(Aa(xe,Ue))N(xe,Ue,q,null,U,_e,de,ye,Ce);else break;K++}for(;K<=Me&&K<=Oe;){const xe=E[Me],Ue=$[Oe]=Ce?Li($[Oe]):Ln($[Oe]);if(Aa(xe,Ue))N(xe,Ue,q,null,U,_e,de,ye,Ce);else break;Me--,Oe--}if(K>Me){if(K<=Oe){const xe=Oe+1,Ue=xe<je?$[xe].el:P;for(;K<=Oe;)N(null,$[K]=Ce?Li($[K]):Ln($[K]),q,Ue,U,_e,de,ye,Ce),K++}}else if(K>Oe)for(;K<=Me;)G(E[K],U,_e,!0),K++;else{const xe=K,Ue=K,Le=new Map;for(K=Ue;K<=Oe;K++){const jt=$[K]=Ce?Li($[K]):Ln($[K]);jt.key!=null&&Le.set(jt.key,K)}let Ge,et=0;const er=Oe-Ue+1;let _r=!1,hn=0;const Ir=new Array(er);for(K=0;K<er;K++)Ir[K]=0;for(K=xe;K<=Me;K++){const jt=E[K];if(et>=er){G(jt,U,_e,!0);continue}let ie;if(jt.key!=null)ie=Le.get(jt.key);else for(Ge=Ue;Ge<=Oe;Ge++)if(Ir[Ge-Ue]===0&&Aa(jt,$[Ge])){ie=Ge;break}ie===void 0?G(jt,U,_e,!0):(Ir[ie-Ue]=K+1,ie>=hn?hn=ie:_r=!0,N(jt,$[ie],q,null,U,_e,de,ye,Ce),et++)}const bt=_r?dI(Ir):Ds;for(Ge=bt.length-1,K=er-1;K>=0;K--){const jt=Ue+K,ie=$[jt],ce=jt+1<je?$[jt+1].el:P;Ir[K]===0?N(null,ie,q,ce,U,_e,de,ye,Ce):_r&&(Ge<0||K!==bt[Ge]?le(ie,q,ce,2):Ge--)}}},le=(E,$,q,P,U=null)=>{const{el:_e,type:de,transition:ye,children:Ce,shapeFlag:K}=E;if(K&6){le(E.component.subTree,$,q,P);return}if(K&128){E.suspense.move($,q,P);return}if(K&64){de.move(E,$,q,De);return}if(de===Ht){n(_e,$,q);for(let Me=0;Me<Ce.length;Me++)le(Ce[Me],$,q,P);n(E.anchor,$,q);return}if(de===Ql){ae(E,$,q);return}if(P!==2&&K&1&&ye)if(P===0)ye.beforeEnter(_e),n(_e,$,q),Ar(()=>ye.enter(_e),U);else{const{leave:Me,delayLeave:Oe,afterLeave:xe}=ye,Ue=()=>n(_e,$,q),Le=()=>{Me(_e,()=>{Ue(),xe&&xe()})};Oe?Oe(_e,Ue,Le):Le()}else n(_e,$,q)},G=(E,$,q,P=!1,U=!1)=>{const{type:_e,props:de,ref:ye,children:Ce,dynamicChildren:K,shapeFlag:je,patchFlag:Me,dirs:Oe}=E;if(ye!=null&&Up(ye,null,q,E,!0),je&256){$.ctx.deactivate(E);return}const xe=je&1&&Oe,Ue=!iu(E);let Le;if(Ue&&(Le=de&&de.onVnodeBeforeUnmount)&&Mn(Le,$,E),je&6)C(E.component,q,P);else{if(je&128){E.suspense.unmount(q,P);return}xe&&ba(E,null,$,"beforeUnmount"),je&64?E.type.remove(E,$,q,U,De,P):K&&(_e!==Ht||Me>0&&Me&64)?X(K,$,q,!1,!0):(_e===Ht&&Me&384||!U&&je&16)&&X(Ce,$,q),P&&J(E)}(Ue&&(Le=de&&de.onVnodeUnmounted)||xe)&&Ar(()=>{Le&&Mn(Le,$,E),xe&&ba(E,null,$,"unmounted")},q)},J=E=>{const{type:$,el:q,anchor:P,transition:U}=E;if($===Ht){k(q,P);return}if($===Ql){Ae(E);return}const _e=()=>{i(q),U&&!U.persisted&&U.afterLeave&&U.afterLeave()};if(E.shapeFlag&1&&U&&!U.persisted){const{leave:de,delayLeave:ye}=U,Ce=()=>de(q,_e);ye?ye(E.el,_e,Ce):Ce()}else _e()},k=(E,$)=>{let q;for(;E!==$;)q=_(E),i(E),E=q;i($)},C=(E,$,q)=>{const{bum:P,scope:U,update:_e,subTree:de,um:ye}=E;P&&Jl(P),U.stop(),_e&&(_e.active=!1,G(de,E,$,q)),ye&&Ar(ye,$),Ar(()=>{E.isUnmounted=!0},$),$&&$.pendingBranch&&!$.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===$.pendingId&&($.deps--,$.deps===0&&$.resolve())},X=(E,$,q,P=!1,U=!1,_e=0)=>{for(let de=_e;de<E.length;de++)G(E[de],$,q,P,U)},Z=E=>E.shapeFlag&6?Z(E.component.subTree):E.shapeFlag&128?E.suspense.next():_(E.anchor||E.el),$e=(E,$,q)=>{E==null?$._vnode&&G($._vnode,null,null,!0):N($._vnode||null,E,$,null,null,null,q),py(),QS(),$._vnode=E},De={p:N,um:G,m:le,r:J,mt:ne,mc:oe,pc:Ne,pbc:ke,n:Z,o:e};let ue,Te;return t&&([ue,Te]=t(De)),{render:$e,hydrate:ue,createApp:lI($e,ue)}}function wa({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function y$(e,t,r=!1){const n=e.children,i=t.children;if(Ke(n)&&Ke(i))for(let a=0;a<n.length;a++){const s=n[a];let u=i[a];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=i[a]=Li(i[a]),u.el=s.el),r||y$(s,u))}}function dI(e){const t=e.slice(),r=[0];let n,i,a,s,u;const o=e.length;for(n=0;n<o;n++){const c=e[n];if(c!==0){if(i=r[r.length-1],e[i]<c){t[n]=i,r.push(n);continue}for(a=0,s=r.length-1;a<s;)u=a+s>>1,e[r[u]]<c?a=u+1:s=u;c<e[r[a]]&&(a>0&&(t[n]=r[a-1]),r[a]=n)}}for(a=r.length,s=r[a-1];a-- >0;)r[a]=s,s=t[s];return r}const pI=e=>e.__isTeleport,Ht=Symbol(void 0),hv=Symbol(void 0),ln=Symbol(void 0),Ql=Symbol(void 0),au=[];let kn=null;function He(e=!1){au.push(kn=e?null:[])}function hI(){au.pop(),kn=au[au.length-1]||null}let wu=1;function ky(e){wu+=e}function m$(e){return e.dynamicChildren=wu>0?kn||Ds:null,hI(),wu>0&&kn&&kn.push(e),e}function Ye(e,t,r,n,i,a){return m$(R(e,t,r,n,i,a,!0))}function cn(e,t,r,n,i){return m$(vt(e,t,r,n,i,!0))}function pc(e){return e?e.__v_isVNode===!0:!1}function Aa(e,t){return e.type===t.type&&e.key===t.key}const Xc="__vInternal",b$=({key:e})=>e!=null?e:null,Xl=({ref:e,ref_key:t,ref_for:r})=>e!=null?lr(e)||Yt(e)||ut(e)?{i:gr,r:e,k:t,f:!!r}:e:null;function R(e,t=null,r=null,n=0,i=null,a=e===Ht?0:1,s=!1,u=!1){const o={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&b$(t),ref:t&&Xl(t),scopeId:Jc,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null};return u?(vv(o,r),a&128&&e.normalize(o)):r&&(o.shapeFlag|=lr(r)?8:16),wu>0&&!s&&kn&&(o.patchFlag>0||a&6)&&o.patchFlag!==32&&kn.push(o),o}const vt=vI;function vI(e,t=null,r=null,n=0,i=null,a=!1){if((!e||e===KC)&&(e=ln),pc(e)){const u=Qi(e,t,!0);return r&&vv(u,r),wu>0&&!a&&kn&&(u.shapeFlag&6?kn[kn.indexOf(e)]=u:kn.push(u)),u.patchFlag|=-2,u}if(CI(e)&&(e=e.__vccOpts),t){t=gI(t);let{class:u,style:o}=t;u&&!lr(u)&&(t.class=La(u)),Lt(o)&&(HS(o)&&!Ke(o)&&(o=yr({},o)),t.style=Qh(o))}const s=lr(e)?1:MC(e)?128:pI(e)?64:Lt(e)?4:ut(e)?2:0;return R(e,t,r,n,i,s,a,!0)}function gI(e){return e?HS(e)||Xc in e?yr({},e):e:null}function Qi(e,t,r=!1){const{props:n,ref:i,patchFlag:a,children:s}=e,u=t?mI(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:u,key:u&&b$(u),ref:t&&t.ref?r&&i?Ke(i)?i.concat(Xl(t)):[i,Xl(t)]:Xl(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ht?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Qi(e.ssContent),ssFallback:e.ssFallback&&Qi(e.ssFallback),el:e.el,anchor:e.anchor}}function Qe(e=" ",t=0){return vt(hv,null,e,t)}function yI(e,t){const r=vt(Ql,null,e);return r.staticCount=t,r}function nr(e="",t=!1){return t?(He(),cn(ln,null,e)):vt(ln,null,e)}function Ln(e){return e==null||typeof e=="boolean"?vt(ln):Ke(e)?vt(Ht,null,e.slice()):typeof e=="object"?Li(e):vt(hv,null,String(e))}function Li(e){return e.el===null||e.memo?e:Qi(e)}function vv(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(Ke(t))r=16;else if(typeof t=="object")if(n&65){const i=t.default;i&&(i._c&&(i._d=!1),vv(e,i()),i._c&&(i._d=!0));return}else{r=32;const i=t._;!i&&!(Xc in t)?t._ctx=gr:i===3&&gr&&(gr.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ut(t)?(t={default:t,_ctx:gr},r=32):(t=String(t),n&64?(r=16,t=[Qe(t)]):r=8);e.children=t,e.shapeFlag|=r}function mI(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const i in n)if(i==="class")t.class!==n.class&&(t.class=La([t.class,n.class]));else if(i==="style")t.style=Qh([t.style,n.style]);else if(qc(i)){const a=t[i],s=n[i];s&&a!==s&&!(Ke(a)&&a.includes(s))&&(t[i]=a?[].concat(a,s):s)}else i!==""&&(t[i]=n[i])}return t}function Mn(e,t,r,n=null){un(e,t,7,[r,n])}const bI=g$();let wI=0;function _I(e,t,r){const n=e.type,i=(t?t.appContext:e.appContext)||bI,a={uid:wI++,vnode:e,type:n,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new OS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:d$(n,i),emitsOptions:ZS(n,i),emit:null,emitted:null,propsDefaults:Nt,inheritAttrs:n.inheritAttrs,ctx:Nt,data:Nt,props:Nt,attrs:Nt,slots:Nt,refs:Nt,setupState:Nt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=EC.bind(null,a),e.ce&&e.ce(a),a}let or=null;const gv=()=>or||gr,Ys=e=>{or=e,e.scope.on()},Fa=()=>{or&&or.scope.off(),or=null};function w$(e){return e.vnode.shapeFlag&4}let _u=!1;function SI(e,t=!1){_u=t;const{props:r,children:n}=e.vnode,i=w$(e);nI(e,r,i,t),sI(e,n);const a=i?$I(e,t):void 0;return _u=!1,a}function $I(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=Js(new Proxy(e.ctx,QC));const{setup:n}=r;if(n){const i=e.setupContext=n.length>1?TI(e):null;Ys(e),so();const a=Gi(n,e,0,[e.props,i]);if(oo(),Fa(),CS(a)){if(a.then(Fa,Fa),t)return a.then(s=>{Ty(e,s,t)}).catch(s=>{Vc(s,e,0)});e.asyncDep=a}else Ty(e,a,t)}else _$(e,t)}function Ty(e,t,r){ut(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Lt(t)&&(e.setupState=VS(t)),_$(e,r)}let Ey;function _$(e,t,r){const n=e.type;if(!e.render){if(!t&&Ey&&!n.render){const i=n.template||dv(e).template;if(i){const{isCustomElement:a,compilerOptions:s}=e.appContext.config,{delimiters:u,compilerOptions:o}=n,c=yr(yr({isCustomElement:a,delimiters:u},s),o);n.render=Ey(i,c)}}e.render=n.render||In}Ys(e),so(),XC(e),oo(),Fa()}function kI(e){return new Proxy(e.attrs,{get(t,r){return qr(e,"get","$attrs"),t[r]}})}function TI(e){const t=n=>{e.exposed=n||{}};let r;return{get attrs(){return r||(r=kI(e))},slots:e.slots,emit:e.emit,expose:t}}function Zc(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(VS(Js(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in fc)return fc[r](e)}}))}function EI(e,t=!0){return ut(e)?e.displayName||e.name:e.name||t&&e.__name}function CI(e){return ut(e)&&"__vccOpts"in e}const Jt=(e,t)=>wC(e,t,_u);function S$(e,t,r){const n=arguments.length;return n===2?Lt(t)&&!Ke(t)?pc(t)?vt(e,null,[t]):vt(e,t):vt(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&pc(r)&&(r=[r]),vt(e,t,r))}const II="3.2.39",RI="http://www.w3.org/2000/svg",Pa=typeof document<"u"?document:null,Cy=Pa&&Pa.createElement("template"),OI={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const i=t?Pa.createElementNS(RI,e):Pa.createElement(e,r?{is:r}:void 0);return e==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:e=>Pa.createTextNode(e),createComment:e=>Pa.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Pa.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,r,n,i,a){const s=r?r.previousSibling:t.lastChild;if(i&&(i===a||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),r),!(i===a||!(i=i.nextSibling)););else{Cy.innerHTML=n?`<svg>${e}</svg>`:e;const u=Cy.content;if(n){const o=u.firstChild;for(;o.firstChild;)u.appendChild(o.firstChild);u.removeChild(o)}t.insertBefore(u,r)}return[s?s.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function AI(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function PI(e,t,r){const n=e.style,i=lr(r);if(r&&!i){for(const a in r)Dp(n,a,r[a]);if(t&&!lr(t))for(const a in t)r[a]==null&&Dp(n,a,"")}else{const a=n.display;i?t!==r&&(n.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=a)}}const Iy=/\s*!important$/;function Dp(e,t,r){if(Ke(r))r.forEach(n=>Dp(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=MI(e,t);Iy.test(r)?e.setProperty(Va(n),r.replace(Iy,""),"important"):e[n]=r}}const Ry=["Webkit","Moz","ms"],qf={};function MI(e,t){const r=qf[t];if(r)return r;let n=qn(t);if(n!=="filter"&&n in e)return qf[t]=n;n=Gc(n);for(let i=0;i<Ry.length;i++){const a=Ry[i]+n;if(a in e)return qf[t]=a}return t}const Oy="http://www.w3.org/1999/xlink";function NI(e,t,r,n,i){if(n&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(Oy,t.slice(6,t.length)):e.setAttributeNS(Oy,t,r);else{const a=CE(t);r==null||a&&!TS(r)?e.removeAttribute(t):e.setAttribute(t,a?"":r)}}function xI(e,t,r,n,i,a,s){if(t==="innerHTML"||t==="textContent"){n&&s(n,i,a),e[t]=r==null?"":r;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const o=r==null?"":r;(e.value!==o||e.tagName==="OPTION")&&(e.value=o),r==null&&e.removeAttribute(t);return}let u=!1;if(r===""||r==null){const o=typeof e[t];o==="boolean"?r=TS(r):r==null&&o==="string"?(r="",u=!0):o==="number"&&(r=0,u=!0)}try{e[t]=r}catch{}u&&e.removeAttribute(t)}const[$$,LI]=(()=>{let e=Date.now,t=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const r=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(r&&Number(r[1])<=53)}return[e,t]})();let Fp=0;const jI=Promise.resolve(),UI=()=>{Fp=0},DI=()=>Fp||(jI.then(UI),Fp=$$());function Ma(e,t,r,n){e.addEventListener(t,r,n)}function FI(e,t,r,n){e.removeEventListener(t,r,n)}function BI(e,t,r,n,i=null){const a=e._vei||(e._vei={}),s=a[t];if(n&&s)s.value=n;else{const[u,o]=qI(t);if(n){const c=a[t]=HI(n,i);Ma(e,u,c,o)}else s&&(FI(e,u,s,o),a[t]=void 0)}}const Ay=/(?:Once|Passive|Capture)$/;function qI(e){let t;if(Ay.test(e)){t={};let n;for(;n=e.match(Ay);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Va(e.slice(2)),t]}function HI(e,t){const r=n=>{const i=n.timeStamp||$$();(LI||i>=r.attached-1)&&un(WI(n,r.value),t,5,[n])};return r.value=e,r.attached=DI(),r}function WI(e,t){if(Ke(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>i=>!i._stopped&&n&&n(i))}else return t}const Py=/^on[a-z]/,GI=(e,t,r,n,i=!1,a,s,u,o)=>{t==="class"?AI(e,n,i):t==="style"?PI(e,r,n):qc(t)?Xh(t)||BI(e,t,r,n,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):zI(e,t,n,i))?xI(e,t,n,a,s,u,o):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),NI(e,t,n,i))};function zI(e,t,r,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&Py.test(t)&&ut(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||Py.test(t)&&lr(r)?!1:t in e}const VI={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};UC.props;const hc=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Ke(t)?r=>Jl(t,r):t};function KI(e){e.target.composing=!0}function My(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const xs={created(e,{modifiers:{lazy:t,trim:r,number:n}},i){e._assign=hc(i);const a=n||i.props&&i.props.type==="number";Ma(e,t?"change":"input",s=>{if(s.target.composing)return;let u=e.value;r&&(u=u.trim()),a&&(u=uc(u)),e._assign(u)}),r&&Ma(e,"change",()=>{e.value=e.value.trim()}),t||(Ma(e,"compositionstart",KI),Ma(e,"compositionend",My),Ma(e,"change",My))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:n,number:i}},a){if(e._assign=hc(a),e.composing||document.activeElement===e&&e.type!=="range"&&(r||n&&e.value.trim()===t||(i||e.type==="number")&&uc(e.value)===t))return;const s=t==null?"":t;e.value!==s&&(e.value=s)}},vc={deep:!0,created(e,{value:t,modifiers:{number:r}},n){const i=Hc(t);Ma(e,"change",()=>{const a=Array.prototype.filter.call(e.options,s=>s.selected).map(s=>r?uc(gc(s)):gc(s));e._assign(e.multiple?i?new Set(a):a:a[0])}),e._assign=hc(n)},mounted(e,{value:t}){Ny(e,t)},beforeUpdate(e,t,r){e._assign=hc(r)},updated(e,{value:t}){Ny(e,t)}};function Ny(e,t){const r=e.multiple;if(!(r&&!Ke(t)&&!Hc(t))){for(let n=0,i=e.options.length;n<i;n++){const a=e.options[n],s=gc(a);if(r)Ke(t)?a.selected=PE(t,s)>-1:a.selected=t.has(s);else if(Bc(gc(a),t)){e.selectedIndex!==n&&(e.selectedIndex=n);return}}!r&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function gc(e){return"_value"in e?e._value:e.value}const JI=["ctrl","shift","alt","meta"],YI={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>JI.some(r=>e[`${r}Key`]&&!t.includes(r))},QI=(e,t)=>(r,...n)=>{for(let i=0;i<t.length;i++){const a=YI[t[i]];if(a&&a(r,t))return}return e(r,...n)},XI={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ZI=(e,t)=>r=>{if(!("key"in r))return;const n=Va(r.key);if(t.some(i=>i===n||XI[i]===n))return e(r)},dt={beforeMount(e,{value:t},{transition:r}){e._vod=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):No(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),No(e,!0),n.enter(e)):n.leave(e,()=>{No(e,!1)}):No(e,t))},beforeUnmount(e,{value:t}){No(e,t)}};function No(e,t){e.style.display=t?e._vod:"none"}const eR=yr({patchProp:GI},OI);let xy;function tR(){return xy||(xy=cI(eR))}const rR=(...e)=>{const t=tR().createApp(...e),{mount:r}=t;return t.mount=n=>{const i=nR(n);if(!i)return;const a=t._component;!ut(a)&&!a.render&&!a.template&&(a.template=i.innerHTML),i.innerHTML="";const s=r(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),s},t};function nR(e){return lr(e)?document.querySelector(e):e}var iR=!1;/*!
  * pinia v2.0.22
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let k$;const ef=e=>k$=e,T$=Symbol();function Bp(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var su;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(su||(su={}));function aR(){const e=AS(!0),t=e.run(()=>Ve({}));let r=[],n=[];const i=Js({install(a){ef(i),i._a=a,a.provide(T$,i),a.config.globalProperties.$pinia=i,n.forEach(s=>r.push(s)),n=[]},use(a){return!this._a&&!iR?n.push(a):r.push(a),this},_p:r,_a:null,_e:e,_s:new Map,state:t});return i}const E$=()=>{};function Ly(e,t,r,n=E$){e.push(t);const i=()=>{const a=e.indexOf(t);a>-1&&(e.splice(a,1),n())};return!r&&gv()&&fv(i),i}function vs(e,...t){e.slice().forEach(r=>{r(...t)})}function qp(e,t){e instanceof Map&&t instanceof Map&&t.forEach((r,n)=>e.set(n,r)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const r in t){if(!t.hasOwnProperty(r))continue;const n=t[r],i=e[r];Bp(i)&&Bp(n)&&e.hasOwnProperty(r)&&!Yt(n)&&!Wi(n)?e[r]=qp(i,n):e[r]=n}return e}const sR=Symbol();function oR(e){return!Bp(e)||!e.hasOwnProperty(sR)}const{assign:ni}=Object;function uR(e){return!!(Yt(e)&&e.effect)}function lR(e,t,r,n){const{state:i,actions:a,getters:s}=t,u=r.state.value[e];let o;function c(){u||(r.state.value[e]=i?i():{});const d=gC(r.state.value[e]);return ni(d,a,Object.keys(s||{}).reduce((y,_)=>(y[_]=Js(Jt(()=>{ef(r);const b=r._s.get(e);return s[_].call(b,b)})),y),{}))}return o=C$(e,c,t,r,n,!0),o.$reset=function(){const y=i?i():{};this.$patch(_=>{ni(_,y)})},o}function C$(e,t,r={},n,i,a){let s;const u=ni({actions:{}},r),o={deep:!0};let c,d,y=Js([]),_=Js([]),b;const T=n.state.value[e];!a&&!T&&(n.state.value[e]={}),Ve({});let x;function N(Ie){let L;c=d=!1,typeof Ie=="function"?(Ie(n.state.value[e]),L={type:su.patchFunction,storeId:e,events:b}):(qp(n.state.value[e],Ie),L={type:su.patchObject,payload:Ie,storeId:e,events:b});const oe=x=Symbol();lv().then(()=>{x===oe&&(c=!0)}),d=!0,vs(y,L,n.state.value[e])}const D=E$;function H(){s.stop(),y=[],_=[],n._s.delete(e)}function ve(Ie,L){return function(){ef(n);const oe=Array.from(arguments),B=[],ke=[];function Se(ne){B.push(ne)}function se(ne){ke.push(ne)}vs(_,{args:oe,name:Ie,store:Ae,after:Se,onError:se});let ee;try{ee=L.apply(this&&this.$id===e?this:Ae,oe)}catch(ne){throw vs(ke,ne),ne}return ee instanceof Promise?ee.then(ne=>(vs(B,ne),ne)).catch(ne=>(vs(ke,ne),Promise.reject(ne))):(vs(B,ee),ee)}}const ae={_p:n,$id:e,$onAction:Ly.bind(null,_),$patch:N,$reset:D,$subscribe(Ie,L={}){const oe=Ly(y,Ie,L.detached,()=>B()),B=s.run(()=>nu(()=>n.state.value[e],ke=>{(L.flush==="sync"?d:c)&&Ie({storeId:e,type:su.direct,events:b},ke)},ni({},o,L)));return oe},$dispose:H},Ae=Ka(ni({},ae));n._s.set(e,Ae);const Re=n._e.run(()=>(s=AS(),s.run(()=>t())));for(const Ie in Re){const L=Re[Ie];if(Yt(L)&&!uR(L)||Wi(L))a||(T&&oR(L)&&(Yt(L)?L.value=T[Ie]:qp(L,T[Ie])),n.state.value[e][Ie]=L);else if(typeof L=="function"){const oe=ve(Ie,L);Re[Ie]=oe,u.actions[Ie]=L}}return ni(Ae,Re),ni(mt(Ae),Re),Object.defineProperty(Ae,"$state",{get:()=>n.state.value[e],set:Ie=>{N(L=>{ni(L,Ie)})}}),n._p.forEach(Ie=>{ni(Ae,s.run(()=>Ie({store:Ae,app:n._a,pinia:n,options:u})))}),T&&a&&r.hydrate&&r.hydrate(Ae.$state,T),c=!0,d=!0,Ae}function tf(e,t,r){let n,i;const a=typeof t=="function";typeof e=="string"?(n=e,i=a?r:t):(i=e,n=e.id);function s(u,o){const c=gv();return u=u||c&&Rn(T$),u&&ef(u),u=k$,u._s.has(n)||(a?C$(n,t,i,u):lR(n,i,u)),u._s.get(n)}return s.$id=n,s}/*!
  * vue-router v4.1.5
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Os=typeof window<"u";function cR(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Ct=Object.assign;function Hf(e,t){const r={};for(const n in t){const i=t[n];r[n]=On(i)?i.map(e):e(i)}return r}const ou=()=>{},On=Array.isArray,fR=/\/$/,dR=e=>e.replace(fR,"");function Wf(e,t,r="/"){let n,i={},a="",s="";const u=t.indexOf("#");let o=t.indexOf("?");return u<o&&u>=0&&(o=-1),o>-1&&(n=t.slice(0,o),a=t.slice(o+1,u>-1?u:t.length),i=e(a)),u>-1&&(n=n||t.slice(0,u),s=t.slice(u,t.length)),n=gR(n!=null?n:t,r),{fullPath:n+(a&&"?")+a+s,path:n,query:i,hash:s}}function pR(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function jy(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function hR(e,t,r){const n=t.matched.length-1,i=r.matched.length-1;return n>-1&&n===i&&Qs(t.matched[n],r.matched[i])&&I$(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function Qs(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function I$(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!vR(e[r],t[r]))return!1;return!0}function vR(e,t){return On(e)?Uy(e,t):On(t)?Uy(t,e):e===t}function Uy(e,t){return On(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function gR(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/");let i=r.length-1,a,s;for(a=0;a<n.length;a++)if(s=n[a],s!==".")if(s==="..")i>1&&i--;else break;return r.slice(0,i).join("/")+"/"+n.slice(a-(a===n.length?1:0)).join("/")}var Su;(function(e){e.pop="pop",e.push="push"})(Su||(Su={}));var uu;(function(e){e.back="back",e.forward="forward",e.unknown=""})(uu||(uu={}));function yR(e){if(!e)if(Os){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),dR(e)}const mR=/^[^#]+#/;function bR(e,t){return e.replace(mR,"#")+t}function wR(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const rf=()=>({left:window.pageXOffset,top:window.pageYOffset});function _R(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),i=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!i)return;t=wR(i,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function Dy(e,t){return(history.state?history.state.position-t:-1)+e}const Hp=new Map;function SR(e,t){Hp.set(e,t)}function $R(e){const t=Hp.get(e);return Hp.delete(e),t}let kR=()=>location.protocol+"//"+location.host;function R$(e,t){const{pathname:r,search:n,hash:i}=t,a=e.indexOf("#");if(a>-1){let u=i.includes(e.slice(a))?e.slice(a).length:1,o=i.slice(u);return o[0]!=="/"&&(o="/"+o),jy(o,"")}return jy(r,e)+n+i}function TR(e,t,r,n){let i=[],a=[],s=null;const u=({state:_})=>{const b=R$(e,location),T=r.value,x=t.value;let N=0;if(_){if(r.value=b,t.value=_,s&&s===T){s=null;return}N=x?_.position-x.position:0}else n(b);i.forEach(D=>{D(r.value,T,{delta:N,type:Su.pop,direction:N?N>0?uu.forward:uu.back:uu.unknown})})};function o(){s=r.value}function c(_){i.push(_);const b=()=>{const T=i.indexOf(_);T>-1&&i.splice(T,1)};return a.push(b),b}function d(){const{history:_}=window;!_.state||_.replaceState(Ct({},_.state,{scroll:rf()}),"")}function y(){for(const _ of a)_();a=[],window.removeEventListener("popstate",u),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",u),window.addEventListener("beforeunload",d),{pauseListeners:o,listen:c,destroy:y}}function Fy(e,t,r,n=!1,i=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:i?rf():null}}function ER(e){const{history:t,location:r}=window,n={value:R$(e,r)},i={value:t.state};i.value||a(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(o,c,d){const y=e.indexOf("#"),_=y>-1?(r.host&&document.querySelector("base")?e:e.slice(y))+o:kR()+e+o;try{t[d?"replaceState":"pushState"](c,"",_),i.value=c}catch(b){console.error(b),r[d?"replace":"assign"](_)}}function s(o,c){const d=Ct({},t.state,Fy(i.value.back,o,i.value.forward,!0),c,{position:i.value.position});a(o,d,!0),n.value=o}function u(o,c){const d=Ct({},i.value,t.state,{forward:o,scroll:rf()});a(d.current,d,!0);const y=Ct({},Fy(n.value,o,null),{position:d.position+1},c);a(o,y,!1),n.value=o}return{location:n,state:i,push:u,replace:s}}function CR(e){e=yR(e);const t=ER(e),r=TR(e,t.state,t.location,t.replace);function n(a,s=!0){s||r.pauseListeners(),history.go(a)}const i=Ct({location:"",base:e,go:n,createHref:bR.bind(null,e)},t,r);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>t.state.value}),i}function IR(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),CR(e)}function RR(e){return typeof e=="string"||e&&typeof e=="object"}function O$(e){return typeof e=="string"||typeof e=="symbol"}const Oi={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},A$=Symbol("");var By;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(By||(By={}));function Xs(e,t){return Ct(new Error,{type:e,[A$]:!0},t)}function Zn(e,t){return e instanceof Error&&A$ in e&&(t==null||!!(e.type&t))}const qy="[^/]+?",OR={sensitive:!1,strict:!1,start:!0,end:!0},AR=/[.+*?^${}()[\]/\\]/g;function PR(e,t){const r=Ct({},OR,t),n=[];let i=r.start?"^":"";const a=[];for(const c of e){const d=c.length?[]:[90];r.strict&&!c.length&&(i+="/");for(let y=0;y<c.length;y++){const _=c[y];let b=40+(r.sensitive?.25:0);if(_.type===0)y||(i+="/"),i+=_.value.replace(AR,"\\$&"),b+=40;else if(_.type===1){const{value:T,repeatable:x,optional:N,regexp:D}=_;a.push({name:T,repeatable:x,optional:N});const H=D||qy;if(H!==qy){b+=10;try{new RegExp(`(${H})`)}catch(ae){throw new Error(`Invalid custom RegExp for param "${T}" (${H}): `+ae.message)}}let ve=x?`((?:${H})(?:/(?:${H}))*)`:`(${H})`;y||(ve=N&&c.length<2?`(?:/${ve})`:"/"+ve),N&&(ve+="?"),i+=ve,b+=20,N&&(b+=-8),x&&(b+=-20),H===".*"&&(b+=-50)}d.push(b)}n.push(d)}if(r.strict&&r.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}r.strict||(i+="/?"),r.end?i+="$":r.strict&&(i+="(?:/|$)");const s=new RegExp(i,r.sensitive?"":"i");function u(c){const d=c.match(s),y={};if(!d)return null;for(let _=1;_<d.length;_++){const b=d[_]||"",T=a[_-1];y[T.name]=b&&T.repeatable?b.split("/"):b}return y}function o(c){let d="",y=!1;for(const _ of e){(!y||!d.endsWith("/"))&&(d+="/"),y=!1;for(const b of _)if(b.type===0)d+=b.value;else if(b.type===1){const{value:T,repeatable:x,optional:N}=b,D=T in c?c[T]:"";if(On(D)&&!x)throw new Error(`Provided param "${T}" is an array but it is not repeatable (* or + modifiers)`);const H=On(D)?D.join("/"):D;if(!H)if(N)_.length<2&&(d.endsWith("/")?d=d.slice(0,-1):y=!0);else throw new Error(`Missing required param "${T}"`);d+=H}}return d||"/"}return{re:s,score:n,keys:a,parse:u,stringify:o}}function MR(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function NR(e,t){let r=0;const n=e.score,i=t.score;for(;r<n.length&&r<i.length;){const a=MR(n[r],i[r]);if(a)return a;r++}if(Math.abs(i.length-n.length)===1){if(Hy(n))return 1;if(Hy(i))return-1}return i.length-n.length}function Hy(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const xR={type:0,value:""},LR=/[a-zA-Z0-9_]/;function jR(e){if(!e)return[[]];if(e==="/")return[[xR]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(b){throw new Error(`ERR (${r})/"${c}": ${b}`)}let r=0,n=r;const i=[];let a;function s(){a&&i.push(a),a=[]}let u=0,o,c="",d="";function y(){!c||(r===0?a.push({type:0,value:c}):r===1||r===2||r===3?(a.length>1&&(o==="*"||o==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),a.push({type:1,value:c,regexp:d,repeatable:o==="*"||o==="+",optional:o==="*"||o==="?"})):t("Invalid state to consume buffer"),c="")}function _(){c+=o}for(;u<e.length;){if(o=e[u++],o==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:o==="/"?(c&&y(),s()):o===":"?(y(),r=1):_();break;case 4:_(),r=n;break;case 1:o==="("?r=2:LR.test(o)?_():(y(),r=0,o!=="*"&&o!=="?"&&o!=="+"&&u--);break;case 2:o===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+o:r=3:d+=o;break;case 3:y(),r=0,o!=="*"&&o!=="?"&&o!=="+"&&u--,d="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${c}"`),y(),s(),i}function UR(e,t,r){const n=PR(jR(e.path),r),i=Ct(n,{record:e,parent:t,children:[],alias:[]});return t&&!i.record.aliasOf==!t.record.aliasOf&&t.children.push(i),i}function DR(e,t){const r=[],n=new Map;t=zy({strict:!1,end:!0,sensitive:!1},t);function i(d){return n.get(d)}function a(d,y,_){const b=!_,T=FR(d);T.aliasOf=_&&_.record;const x=zy(t,d),N=[T];if("alias"in d){const ve=typeof d.alias=="string"?[d.alias]:d.alias;for(const ae of ve)N.push(Ct({},T,{components:_?_.record.components:T.components,path:ae,aliasOf:_?_.record:T}))}let D,H;for(const ve of N){const{path:ae}=ve;if(y&&ae[0]!=="/"){const Ae=y.record.path,Re=Ae[Ae.length-1]==="/"?"":"/";ve.path=y.record.path+(ae&&Re+ae)}if(D=UR(ve,y,x),_?_.alias.push(D):(H=H||D,H!==D&&H.alias.push(D),b&&d.name&&!Gy(D)&&s(d.name)),T.children){const Ae=T.children;for(let Re=0;Re<Ae.length;Re++)a(Ae[Re],D,_&&_.children[Re])}_=_||D,o(D)}return H?()=>{s(H)}:ou}function s(d){if(O$(d)){const y=n.get(d);y&&(n.delete(d),r.splice(r.indexOf(y),1),y.children.forEach(s),y.alias.forEach(s))}else{const y=r.indexOf(d);y>-1&&(r.splice(y,1),d.record.name&&n.delete(d.record.name),d.children.forEach(s),d.alias.forEach(s))}}function u(){return r}function o(d){let y=0;for(;y<r.length&&NR(d,r[y])>=0&&(d.record.path!==r[y].record.path||!P$(d,r[y]));)y++;r.splice(y,0,d),d.record.name&&!Gy(d)&&n.set(d.record.name,d)}function c(d,y){let _,b={},T,x;if("name"in d&&d.name){if(_=n.get(d.name),!_)throw Xs(1,{location:d});x=_.record.name,b=Ct(Wy(y.params,_.keys.filter(H=>!H.optional).map(H=>H.name)),d.params&&Wy(d.params,_.keys.map(H=>H.name))),T=_.stringify(b)}else if("path"in d)T=d.path,_=r.find(H=>H.re.test(T)),_&&(b=_.parse(T),x=_.record.name);else{if(_=y.name?n.get(y.name):r.find(H=>H.re.test(y.path)),!_)throw Xs(1,{location:d,currentLocation:y});x=_.record.name,b=Ct({},y.params,d.params),T=_.stringify(b)}const N=[];let D=_;for(;D;)N.unshift(D.record),D=D.parent;return{name:x,path:T,params:b,matched:N,meta:qR(N)}}return e.forEach(d=>a(d)),{addRoute:a,resolve:c,removeRoute:s,getRoutes:u,getRecordMatcher:i}}function Wy(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function FR(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:BR(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function BR(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="boolean"?r:r[n];return t}function Gy(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function qR(e){return e.reduce((t,r)=>Ct(t,r.meta),{})}function zy(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function P$(e,t){return t.children.some(r=>r===e||P$(e,r))}const M$=/#/g,HR=/&/g,WR=/\//g,GR=/=/g,zR=/\?/g,N$=/\+/g,VR=/%5B/g,KR=/%5D/g,x$=/%5E/g,JR=/%60/g,L$=/%7B/g,YR=/%7C/g,j$=/%7D/g,QR=/%20/g;function yv(e){return encodeURI(""+e).replace(YR,"|").replace(VR,"[").replace(KR,"]")}function XR(e){return yv(e).replace(L$,"{").replace(j$,"}").replace(x$,"^")}function Wp(e){return yv(e).replace(N$,"%2B").replace(QR,"+").replace(M$,"%23").replace(HR,"%26").replace(JR,"`").replace(L$,"{").replace(j$,"}").replace(x$,"^")}function ZR(e){return Wp(e).replace(GR,"%3D")}function eO(e){return yv(e).replace(M$,"%23").replace(zR,"%3F")}function tO(e){return e==null?"":eO(e).replace(WR,"%2F")}function yc(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function rO(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<n.length;++i){const a=n[i].replace(N$," "),s=a.indexOf("="),u=yc(s<0?a:a.slice(0,s)),o=s<0?null:yc(a.slice(s+1));if(u in t){let c=t[u];On(c)||(c=t[u]=[c]),c.push(o)}else t[u]=o}return t}function Vy(e){let t="";for(let r in e){const n=e[r];if(r=ZR(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(On(n)?n.map(a=>a&&Wp(a)):[n&&Wp(n)]).forEach(a=>{a!==void 0&&(t+=(t.length?"&":"")+r,a!=null&&(t+="="+a))})}return t}function nO(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=On(n)?n.map(i=>i==null?null:""+i):n==null?n:""+n)}return t}const iO=Symbol(""),Ky=Symbol(""),nf=Symbol(""),mv=Symbol(""),Gp=Symbol("");function xo(){let e=[];function t(n){return e.push(n),()=>{const i=e.indexOf(n);i>-1&&e.splice(i,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function ji(e,t,r,n,i){const a=n&&(n.enterCallbacks[i]=n.enterCallbacks[i]||[]);return()=>new Promise((s,u)=>{const o=y=>{y===!1?u(Xs(4,{from:r,to:t})):y instanceof Error?u(y):RR(y)?u(Xs(2,{from:t,to:y})):(a&&n.enterCallbacks[i]===a&&typeof y=="function"&&a.push(y),s())},c=e.call(n&&n.instances[i],t,r,o);let d=Promise.resolve(c);e.length<3&&(d=d.then(o)),d.catch(y=>u(y))})}function Gf(e,t,r,n){const i=[];for(const a of e)for(const s in a.components){let u=a.components[s];if(!(t!=="beforeRouteEnter"&&!a.instances[s]))if(aO(u)){const c=(u.__vccOpts||u)[t];c&&i.push(ji(c,r,n,a,s))}else{let o=u();i.push(()=>o.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${s}" at "${a.path}"`));const d=cR(c)?c.default:c;a.components[s]=d;const _=(d.__vccOpts||d)[t];return _&&ji(_,r,n,a,s)()}))}}return i}function aO(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Jy(e){const t=Rn(nf),r=Rn(mv),n=Jt(()=>t.resolve(Ot(e.to))),i=Jt(()=>{const{matched:o}=n.value,{length:c}=o,d=o[c-1],y=r.matched;if(!d||!y.length)return-1;const _=y.findIndex(Qs.bind(null,d));if(_>-1)return _;const b=Yy(o[c-2]);return c>1&&Yy(d)===b&&y[y.length-1].path!==b?y.findIndex(Qs.bind(null,o[c-2])):_}),a=Jt(()=>i.value>-1&&uO(r.params,n.value.params)),s=Jt(()=>i.value>-1&&i.value===r.matched.length-1&&I$(r.params,n.value.params));function u(o={}){return oO(o)?t[Ot(e.replace)?"replace":"push"](Ot(e.to)).catch(ou):Promise.resolve()}return{route:n,href:Jt(()=>n.value.href),isActive:a,isExactActive:s,navigate:u}}const sO=i$({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Jy,setup(e,{slots:t}){const r=Ka(Jy(e)),{options:n}=Rn(nf),i=Jt(()=>({[Qy(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[Qy(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const a=t.default&&t.default(r);return e.custom?a:S$("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:i.value},a)}}}),qs=sO;function oO(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function uO(e,t){for(const r in t){const n=t[r],i=e[r];if(typeof n=="string"){if(n!==i)return!1}else if(!On(i)||i.length!==n.length||n.some((a,s)=>a!==i[s]))return!1}return!0}function Yy(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Qy=(e,t,r)=>e!=null?e:t!=null?t:r,lO=i$({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=Rn(Gp),i=Jt(()=>e.route||n.value),a=Rn(Ky,0),s=Jt(()=>{let c=Ot(a);const{matched:d}=i.value;let y;for(;(y=d[c])&&!y.components;)c++;return c}),u=Jt(()=>i.value.matched[s.value]);Yl(Ky,Jt(()=>s.value+1)),Yl(iO,u),Yl(Gp,i);const o=Ve();return nu(()=>[o.value,u.value,e.name],([c,d,y],[_,b,T])=>{d&&(d.instances[y]=c,b&&b!==d&&c&&c===_&&(d.leaveGuards.size||(d.leaveGuards=b.leaveGuards),d.updateGuards.size||(d.updateGuards=b.updateGuards))),c&&d&&(!b||!Qs(d,b)||!_)&&(d.enterCallbacks[y]||[]).forEach(x=>x(c))},{flush:"post"}),()=>{const c=i.value,d=e.name,y=u.value,_=y&&y.components[d];if(!_)return Xy(r.default,{Component:_,route:c});const b=y.props[d],T=b?b===!0?c.params:typeof b=="function"?b(c):b:null,N=S$(_,Ct({},T,t,{onVnodeUnmounted:D=>{D.component.isUnmounted&&(y.instances[d]=null)},ref:o}));return Xy(r.default,{Component:N,route:c})||N}}});function Xy(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const U$=lO;function cO(e){const t=DR(e.routes,e),r=e.parseQuery||rO,n=e.stringifyQuery||Vy,i=e.history,a=xo(),s=xo(),u=xo(),o=pC(Oi);let c=Oi;Os&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=Hf.bind(null,k=>""+k),y=Hf.bind(null,tO),_=Hf.bind(null,yc);function b(k,C){let X,Z;return O$(k)?(X=t.getRecordMatcher(k),Z=C):Z=k,t.addRoute(Z,X)}function T(k){const C=t.getRecordMatcher(k);C&&t.removeRoute(C)}function x(){return t.getRoutes().map(k=>k.record)}function N(k){return!!t.getRecordMatcher(k)}function D(k,C){if(C=Ct({},C||o.value),typeof k=="string"){const Te=Wf(r,k,C.path),E=t.resolve({path:Te.path},C),$=i.createHref(Te.fullPath);return Ct(Te,E,{params:_(E.params),hash:yc(Te.hash),redirectedFrom:void 0,href:$})}let X;if("path"in k)X=Ct({},k,{path:Wf(r,k.path,C.path).path});else{const Te=Ct({},k.params);for(const E in Te)Te[E]==null&&delete Te[E];X=Ct({},k,{params:y(k.params)}),C.params=y(C.params)}const Z=t.resolve(X,C),$e=k.hash||"";Z.params=d(_(Z.params));const De=pR(n,Ct({},k,{hash:XR($e),path:Z.path})),ue=i.createHref(De);return Ct({fullPath:De,hash:$e,query:n===Vy?nO(k.query):k.query||{}},Z,{redirectedFrom:void 0,href:ue})}function H(k){return typeof k=="string"?Wf(r,k,o.value.path):Ct({},k)}function ve(k,C){if(c!==k)return Xs(8,{from:C,to:k})}function ae(k){return Ie(k)}function Ae(k){return ae(Ct(H(k),{replace:!0}))}function Re(k){const C=k.matched[k.matched.length-1];if(C&&C.redirect){const{redirect:X}=C;let Z=typeof X=="function"?X(k):X;return typeof Z=="string"&&(Z=Z.includes("?")||Z.includes("#")?Z=H(Z):{path:Z},Z.params={}),Ct({query:k.query,hash:k.hash,params:"path"in Z?{}:k.params},Z)}}function Ie(k,C){const X=c=D(k),Z=o.value,$e=k.state,De=k.force,ue=k.replace===!0,Te=Re(X);if(Te)return Ie(Ct(H(Te),{state:typeof Te=="object"?Ct({},$e,Te.state):$e,force:De,replace:ue}),C||X);const E=X;E.redirectedFrom=C;let $;return!De&&hR(n,Z,X)&&($=Xs(16,{to:E,from:Z}),ft(Z,Z,!0,!1)),($?Promise.resolve($):oe(E,Z)).catch(q=>Zn(q)?Zn(q,2)?q:Ne(q):me(q,E,Z)).then(q=>{if(q){if(Zn(q,2))return Ie(Ct({replace:ue},H(q.to),{state:typeof q.to=="object"?Ct({},$e,q.to.state):$e,force:De}),C||E)}else q=ke(E,Z,!0,ue,$e);return B(E,Z,q),q})}function L(k,C){const X=ve(k,C);return X?Promise.reject(X):Promise.resolve()}function oe(k,C){let X;const[Z,$e,De]=fO(k,C);X=Gf(Z.reverse(),"beforeRouteLeave",k,C);for(const Te of Z)Te.leaveGuards.forEach(E=>{X.push(ji(E,k,C))});const ue=L.bind(null,k,C);return X.push(ue),gs(X).then(()=>{X=[];for(const Te of a.list())X.push(ji(Te,k,C));return X.push(ue),gs(X)}).then(()=>{X=Gf($e,"beforeRouteUpdate",k,C);for(const Te of $e)Te.updateGuards.forEach(E=>{X.push(ji(E,k,C))});return X.push(ue),gs(X)}).then(()=>{X=[];for(const Te of k.matched)if(Te.beforeEnter&&!C.matched.includes(Te))if(On(Te.beforeEnter))for(const E of Te.beforeEnter)X.push(ji(E,k,C));else X.push(ji(Te.beforeEnter,k,C));return X.push(ue),gs(X)}).then(()=>(k.matched.forEach(Te=>Te.enterCallbacks={}),X=Gf(De,"beforeRouteEnter",k,C),X.push(ue),gs(X))).then(()=>{X=[];for(const Te of s.list())X.push(ji(Te,k,C));return X.push(ue),gs(X)}).catch(Te=>Zn(Te,8)?Te:Promise.reject(Te))}function B(k,C,X){for(const Z of u.list())Z(k,C,X)}function ke(k,C,X,Z,$e){const De=ve(k,C);if(De)return De;const ue=C===Oi,Te=Os?history.state:{};X&&(Z||ue?i.replace(k.fullPath,Ct({scroll:ue&&Te&&Te.scroll},$e)):i.push(k.fullPath,$e)),o.value=k,ft(k,C,X,ue),Ne()}let Se;function se(){Se||(Se=i.listen((k,C,X)=>{if(!J.listening)return;const Z=D(k),$e=Re(Z);if($e){Ie(Ct($e,{replace:!0}),Z).catch(ou);return}c=Z;const De=o.value;Os&&SR(Dy(De.fullPath,X.delta),rf()),oe(Z,De).catch(ue=>Zn(ue,12)?ue:Zn(ue,2)?(Ie(ue.to,Z).then(Te=>{Zn(Te,20)&&!X.delta&&X.type===Su.pop&&i.go(-1,!1)}).catch(ou),Promise.reject()):(X.delta&&i.go(-X.delta,!1),me(ue,Z,De))).then(ue=>{ue=ue||ke(Z,De,!1),ue&&(X.delta&&!Zn(ue,8)?i.go(-X.delta,!1):X.type===Su.pop&&Zn(ue,20)&&i.go(-1,!1)),B(Z,De,ue)}).catch(ou)}))}let ee=xo(),ne=xo(),te;function me(k,C,X){Ne(k);const Z=ne.list();return Z.length?Z.forEach($e=>$e(k,C,X)):console.error(k),Promise.reject(k)}function A(){return te&&o.value!==Oi?Promise.resolve():new Promise((k,C)=>{ee.add([k,C])})}function Ne(k){return te||(te=!k,se(),ee.list().forEach(([C,X])=>k?X(k):C()),ee.reset()),k}function ft(k,C,X,Z){const{scrollBehavior:$e}=e;if(!Os||!$e)return Promise.resolve();const De=!X&&$R(Dy(k.fullPath,0))||(Z||!X)&&history.state&&history.state.scroll||null;return lv().then(()=>$e(k,C,De)).then(ue=>ue&&_R(ue)).catch(ue=>me(ue,k,C))}const ze=k=>i.go(k);let le;const G=new Set,J={currentRoute:o,listening:!0,addRoute:b,removeRoute:T,hasRoute:N,getRoutes:x,resolve:D,options:e,push:ae,replace:Ae,go:ze,back:()=>ze(-1),forward:()=>ze(1),beforeEach:a.add,beforeResolve:s.add,afterEach:u.add,onError:ne.add,isReady:A,install(k){const C=this;k.component("RouterLink",qs),k.component("RouterView",U$),k.config.globalProperties.$router=C,Object.defineProperty(k.config.globalProperties,"$route",{enumerable:!0,get:()=>Ot(o)}),Os&&!le&&o.value===Oi&&(le=!0,ae(i.location).catch($e=>{}));const X={};for(const $e in Oi)X[$e]=Jt(()=>o.value[$e]);k.provide(nf,C),k.provide(mv,Ka(X)),k.provide(Gp,o);const Z=k.unmount;G.add(k),k.unmount=function(){G.delete(k),G.size<1&&(c=Oi,Se&&Se(),Se=null,o.value=Oi,le=!1,te=!1),Z()}}};return J}function gs(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function fO(e,t){const r=[],n=[],i=[],a=Math.max(t.matched.length,e.matched.length);for(let s=0;s<a;s++){const u=t.matched[s];u&&(e.matched.find(c=>Qs(c,u))?n.push(u):r.push(u));const o=e.matched[s];o&&(t.matched.find(c=>Qs(c,o))||i.push(o))}return[r,n,i]}function bv(){return Rn(nf)}function D$(){return Rn(mv)}const dO={__name:"App",setup(e){return(t,r)=>(He(),cn(Ot(U$)))}},Ja=tf("list",{state:()=>({lists:[]}),getters:{},actions:{async getAllSyncLists(){try{const t=await fetch("/sync/list-all",{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(t.ok){let r=await t.json();this.lists=r}}catch(e){console.log("getAllSyncLists error => ",e)}}}}),Ya=tf("agent",{state:()=>({agent:{identity:null,accessToken:""},agents:[]}),getters:{},actions:{async getToken(){try{let e=`/auth/token?identity=${this.agent.identity}`;const t=await fetch(e,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(t.ok){let r=await t.json();this.agent.accessToken=r.accessToken,console.log("token value set...")}}catch(e){console.log("getToken error => ",e)}},async getAgents(){const t=Ja().lists.find(r=>r.uniqueName==="AgentList");try{let r=`/sync/list-item-get-array?targetList=${t.sid}`;const n=await fetch(r,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(n.ok){let i=await n.json();this.agents=i.map(a=>a.data.Identity).sort((a,s)=>a.localeCompare(s,void 0,{sensitivity:"base"}))}}catch(r){console.log("getAgents error => ",r)}}}}),Wn=(e,t)=>{const r=e.__vccOpts||e;for(const[n,i]of t)r[n]=i;return r},pO={name:"Header",setup(){return{agentStore:Ya()}}},hO={class:"container-fluid"},vO={class:"d-flex flex-wrap justify-content-center py-3 mb-2 border-bottom"},gO=R("img",{class:"me-4",width:"60",height:"32",src:"https://logos-world.net/wp-content/uploads/2022/01/Safeway-Symbol.png"},null,-1),yO=R("span",{class:"fs-4"},"Shopper Inbox",-1),mO={class:"nav nav-pills"},bO={class:"nav-item"},wO=R("i",{class:"bi-house"},null,-1),_O=Qe(" Home"),SO={key:0,class:"nav-item"},$O=R("i",{class:"bi-basket-fill"},null,-1),kO=Qe(" Current Order"),TO={key:1,class:"nav-item"},EO=R("i",{class:"bi-chat-left-dots-fill"},null,-1),CO=Qe(" Conversations"),IO={key:2,class:"nav-item"},RO=R("i",{class:"bi-person"},null,-1),OO={key:3,class:"nav-item"},AO=R("i",{class:"bi-box-arrow-in-right"},null,-1),PO=Qe(" Login");function MO(e,t,r,n,i,a){const s=fr("router-link");return He(),Ye("div",hO,[R("header",vO,[vt(s,{class:"d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none",to:"/"},{default:tr(()=>[gO,yO]),_:1}),R("ul",mO,[R("li",bO,[vt(s,{class:"nav-link",to:"/"},{default:tr(()=>[wO,_O]),_:1})]),n.agentStore.agent.identity!=null?(He(),Ye("li",SO,[vt(s,{class:"nav-link",to:"/current-order"},{default:tr(()=>[$O,kO]),_:1})])):nr("",!0),n.agentStore.agent.identity!=null?(He(),Ye("li",TO,[vt(s,{class:"nav-link",to:"/conversations"},{default:tr(()=>[EO,CO]),_:1})])):nr("",!0),n.agentStore.agent.identity!=null?(He(),Ye("li",IO,[vt(s,{class:"nav-link",to:"/agent"},{default:tr(()=>[RO,Qe(" "+Bt(n.agentStore.agent.identity),1)]),_:1})])):nr("",!0),n.agentStore.agent.identity===null?(He(),Ye("li",OO,[vt(s,{class:"btn btn-warning btn-sm",to:"/login"},{default:tr(()=>[AO,PO]),_:1})])):nr("",!0)])])])}const NO=Wn(pO,[["render",MO]]),xO={name:"Footer"},LO={class:"footer mt-auto py-3 pb-5"},jO=R("div",{class:"container text-center pb-5"},[R("img",{class:"",width:"107",height:"32",src:"https://www.twilio.com/docs/static/dist/img/559bc7cf.svg"})],-1),UO=[jO];function DO(e,t,r,n,i,a){return He(),Ye("footer",LO,UO)}const FO=Wn(xO,[["render",DO]]),BO={name:"Layout",components:{Header:NO,Footer:FO}};function qO(e,t,r,n,i,a){const s=fr("Header"),u=fr("Footer");return He(),Ye("div",null,[vt(s),YC(e.$slots,"default"),vt(u)])}const lo=Wn(BO,[["render",qO]]),HO={class:"container-fluid"},WO={class:"row"},GO={class:"col pt-5"},zO=R("h2",null,"Twilio Conversations",-1),VO=R("p",{class:"mt-5 fs-3"},[R("b",null,"A single API for seamless conversational messaging"),R("br"),Qe(" Integrate once and extend across customers\u2019 preferred channels to support scalable, multiparty conversations. ")],-1),KO=R("p",{class:"lead fs-3 mb-5"}," This demo gives demonstrates an agent or administrator view into an multi channel communication tool powered by Twilio Conversations. ",-1),JO={class:"text-center mt-5"},YO=R("i",{class:"bi-chat-left-dots-fill"},null,-1),QO=Qe(" Conversations "),XO=R("i",{class:"bi-box-arrow-in-right"},null,-1),ZO=Qe(" Login "),eA=R("div",{class:"col"},[R("div",{class:"text-center pt-5 pb-5"},[R("img",{class:"img-fluid",style:{"max-width":"600px"},src:"https://twilio-cms-prod.s3.amazonaws.com/images/diagram-conversat.width-1200.format-webp.webpquality-75.webp"})])],-1),tA={__name:"Home",setup(e){const t=Ja(),r=Ya();return s$(async()=>{t.lists.length===0&&await t.getAllSyncLists()}),(n,i)=>(He(),Ye("div",HO,[R("div",WO,[R("div",GO,[zO,VO,KO,R("div",JO,[Ot(r).agent.identity!=null?(He(),cn(Ot(qs),{key:0,class:"btn btn-lg btn-primary",to:"/conversations"},{default:tr(()=>[YO,QO]),_:1})):nr("",!0),Ot(r).agent.identity===null?(He(),cn(Ot(qs),{key:1,class:"btn btn-lg btn-warning",to:"/login"},{default:tr(()=>[XO,ZO]),_:1})):nr("",!0)])]),eA])]))}},rA={name:"App",components:{Layout:lo,Home:tA}};function nA(e,t,r,n,i,a){const s=fr("Home"),u=fr("Layout");return He(),cn(u,null,{default:tr(()=>[vt(s)]),_:1})}const iA=Wn(rA,[["render",nA]]),F$=tf("webhooks",{state:()=>({webhooks:[]}),getters:{},actions:{async getWebhooks(){const t=Ja().lists.find(r=>r.uniqueName==="WebhookList");try{let r=`/sync/list-item-get-array?targetList=${t.sid}`;const n=await fetch(r,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(n.ok){let i=await n.json();this.webhooks=i}}catch(r){console.log("in webhookStore getWebhooks error => ",r)}}}}),B$=tf("chatButtons",{state:()=>({chatbuttons:[]}),getters:{},actions:{async getChatButtons(){const t=Ja().lists.find(r=>r.uniqueName==="ChatButtonList");try{let r=`/sync/list-item-get-array?targetList=${t.sid}`;const n=await fetch(r,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(n.ok){let i=await n.json();this.chatbuttons=i}}catch(r){console.log("in chatButtonStore getChatButtons error => ",r)}}}}),aA={class:"container-fluid pt-5 pb-5"},sA={class:"alert alert-success text-center fw-bold mb-5"},oA=R("i",{class:"bi-house"},null,-1),uA=Qe(" Home "),lA=R("i",{class:"bi-chat-left-dots-fill"},null,-1),cA=Qe(" Conversations "),fA=R("i",{class:"bi-person"},null,-1),dA=Qe(" Agent "),pA={class:"d-flex justify-content-center mt-3 mb-5"},hA=R("ul",{class:"nav nav-pills mb-3",id:"myTab",role:"tablist"},[R("li",{class:"nav-item",role:"presentation"},[R("button",{class:"nav-link active",id:"login-tab","data-bs-toggle":"tab","data-bs-target":"#login",type:"button",role:"tab","aria-controls":"login","aria-selected":"false"},"Existing Agent Login")]),R("li",{class:"nav-item",role:"presentation"},[R("button",{class:"nav-link",id:"create-tab","data-bs-toggle":"tab","data-bs-target":"#create",type:"button",role:"tab","aria-controls":"create","aria-selected":"true"},"Create Agent")])],-1),vA={class:"tab-content"},gA={class:"tab-pane",id:"create",role:"tabpanel","aria-labelledby":"create-tab"},yA={class:"card p-5",style:{width:"36rem"}},mA={class:"mb-3"},bA=R("label",{for:"exampleFormControlInput1",class:"form-label"},"Agent",-1),wA={class:"d-grid"},_A=R("i",{class:"bi-person-plus"},null,-1),SA=Qe(" Create Agent "),$A=[_A,SA],kA={class:"tab-pane active",id:"login",role:"tabpanel","aria-labelledby":"login-tab"},TA={class:"card p-5",style:{width:"36rem"}},EA={class:"mb-3"},CA=R("label",{for:"exampleFormControlInput1",class:"form-label"},"Agent",-1),IA=["value"],RA={class:"d-grid"},OA=R("i",{class:"bi-box-arrow-in-right"},null,-1),AA=Qe(" Login "),PA=[OA,AA],MA={__name:"Login",setup(e){const t=Ja(),r=F$(),n=B$(),i=Ya(),a=bv(),s=t.lists.find(_=>_.uniqueName==="AgentList"),u=Ve(""),o=Ve(""),c=async()=>{let _={Identity:u.value},b=`/sync/list-item-create?targetList=${s.sid}`;const T=await fetch(b,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:_})});if(T.ok)await T.json(),i.agent.identity=u.value,await i.getToken(),y();else return!1},d=async()=>{i.agent.identity=o.value,await i.getToken(),y()};function y(){a.replace({name:"conversations"})}return uo(async()=>{await i.getAgents(),await r.getWebhooks(),await n.getChatButtons()}),(_,b)=>(He(),Ye("div",aA,[rt(R("div",sA,[Qe(" You are logged in as "+Bt(Ot(i).agent.identity)+" ",1),vt(Ot(qs),{class:"btn btn-sm btn-primary",to:"/"},{default:tr(()=>[oA,uA]),_:1}),vt(Ot(qs),{class:"btn btn-sm btn-primary ms-2",to:"/conversations"},{default:tr(()=>[lA,cA]),_:1}),vt(Ot(qs),{class:"btn btn-sm btn-primary ms-2",to:"/agent"},{default:tr(()=>[fA,dA]),_:1})],512),[[dt,Ot(i).agent.identity!==null]]),rt(R("div",null,[R("div",pA,[R("div",null,[hA,R("div",vA,[R("div",gA,[R("div",yA,[R("div",mA,[bA,rt(R("input",{type:"text","onUpdate:modelValue":b[0]||(b[0]=T=>u.value=T),class:"form-control",id:"exampleFormControlInput1",placeholder:""},null,512),[[xs,u.value]])]),R("div",wA,[R("button",{onClick:b[1]||(b[1]=T=>c()),class:"btn btn-primary btn-lg"},$A)])])]),R("div",kA,[R("div",TA,[R("div",EA,[CA,rt(R("select",{class:"form-select","onUpdate:modelValue":b[2]||(b[2]=T=>o.value=T)},[(He(!0),Ye(Ht,null,wn(Ot(i).agents,T=>(He(),Ye("option",{key:T,value:T},Bt(T),9,IA))),128))],512),[[vc,o.value]])]),R("div",RA,[R("button",{onClick:b[3]||(b[3]=T=>d()),class:"btn btn-success btn-lg"},PA)])])])])])])],512),[[dt,Ot(i).agent.identity===null]])]))}},NA={name:"App",components:{Layout:lo,Login:MA}};function xA(e,t,r,n,i,a){const s=fr("Login"),u=fr("Layout");return He(),cn(u,null,{default:tr(()=>[vt(s)]),_:1})}const LA=Wn(NA,[["render",xA]]),jA={class:"container-fluid"},UA={class:"card text-dark bg-light mt-5 mb-5"},DA=R("div",{class:"card-header fs-4"},[R("i",{class:"bi-person-workspace me-2"}),R("b",null,"Agent")],-1),FA={class:"card-body"},BA={class:"card-title fs-2 mb-5"},qA=R("p",{class:"card-text fs-5 mb-5"}," In order order to enter a conversation, you need a valid access token. ",-1),HA={class:"card-text fs-5 mb-5"},WA=R("i",{class:"bi-recycle"},null,-1),GA=Qe(" Refresh Token "),zA=[WA,GA],VA={class:"spinner-border",role:"status"},KA=R("span",{class:"visually-hidden"},"Loading...",-1),JA=[KA],YA={disabled:"",class:"btn btn-success"},QA=R("i",{class:"bi-check"},null,-1),XA=Qe(" Token Refreshed "),ZA=[QA,XA],eP=R("i",{class:"bi-eye"},null,-1),tP=Qe(" View Token "),rP=[eP,tP],nP={class:"text-break mb-5 p-2 bg-warning"},iP=R("i",{class:"bi-box-arrow-left"},null,-1),aP=Qe(" Logout "),sP=[iP,aP],oP={__name:"Agent",setup(e){const t=Ya(),r=Jt(()=>t.agent.accessToken!=""),n=Ve(!1),i=Ve(!1),a=Ve(!1),s=async()=>{i.value=!0,await t.getToken(),i.value=!1,a.value=!0};function u(){t.$reset(),n.value=!1,i.value=!1,a.value=!1}return(o,c)=>(He(),Ye("div",jA,[R("div",UA,[DA,R("div",FA,[R("h5",BA,[R("b",null,Bt(Ot(t).agent.identity),1)]),qA,R("p",HA,[rt(R("button",{onClick:c[0]||(c[0]=d=>s()),class:"btn btn-primary"},[rt(R("span",null,zA,512),[[dt,!i.value]]),rt(R("div",VA,JA,512),[[dt,i.value]])],512),[[dt,Ot(r)&&!a.value]]),rt(R("button",YA,ZA,512),[[dt,a.value]]),rt(R("button",{onClick:c[1]||(c[1]=d=>n.value=!n.value),class:"btn btn-warning ms-2"},rP,512),[[dt,Ot(r)]])]),rt(R("p",nP,[R("i",null,Bt(Ot(t).agent.accessToken),1)],512),[[dt,n.value]]),R("p",null,[rt(R("button",{onClick:c[2]||(c[2]=d=>u()),class:"btn btn-danger float-end"},sP,512),[[dt,Ot(r)]])])])])]))}},uP={name:"App",components:{Layout:lo,Agent:oP}};function lP(e,t,r,n,i,a){const s=fr("Agent"),u=fr("Layout");return He(),cn(u,null,{default:tr(()=>[vt(s)]),_:1})}const cP=Wn(uP,[["render",lP]]);function q$(e){let t=new Date(e);return`${t.getMonth()+1}/${t.getDate()} @ ${t.getHours()}:${String(t.getMinutes()).padStart(2,"0")}`}const fP={class:"container-fluid pt-4"},dP=R("i",{class:"bi bi-arrow-clockwise"},null,-1),pP=Qe(" Refresh "),hP=[dP,pP],vP=R("h3",null,"Conversations",-1),gP={class:"table table-striped mt-4 mb-5 fs-4"},yP=R("thead",null,[R("tr",null,[R("th",{class:"text-center"},"Order"),R("th",{class:"text-center"},"Date Created"),R("th",{class:"text-center"},"\xA0")])],-1),mP={class:"text-center"},bP={class:"text-center"},wP={class:"text-center"},_P=["onClick"],SP=R("i",{class:"bi-play-fill"},null,-1),$P=Qe(" Enter "),kP=[SP,$P],TP=["onClick"],EP=R("i",{class:"bi-trash"},null,-1),CP=[EP],IP={class:"row pb-5"},RP={class:"col-6"},OP=R("i",{class:"bi-plus-circle-fill me-1"},null,-1),AP=Qe(" Create New Conversation "),PP=[OP,AP],MP={class:"card text-bg-warning mb-3"},NP=R("div",{class:"card-header fs-3"},"Create a new conversation",-1),xP={class:"card-body"},LP={class:"form-group mb-3"},jP=R("label",{for:"conversationType "},[R("span",{class:"fw-bold fs-4"},"Conversation Type")],-1),UP=["value"],DP={class:"form-group mb-3"},FP=R("label",{for:"friendlyName "},[R("span",{class:"fw-bold fs-4"},"Friendly Name")],-1),BP={class:"form-group"},qP={class:"d-grid gap-2"},HP=R("i",{class:"bi-plus-circle-fill me-2"},null,-1),WP=Qe(" Create "),GP=[HP,WP],zP={__name:"Conversations",setup(e){const t=Ya();D$();const r=Ve([]),n=async()=>{try{const y=await fetch("/conversations/return-conversations",{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(y.ok){let _=await y.json();r.value=_;for(let b=0;b<r.value.length;b++)Object.keys(r.value[b].attributes).length>0&&(r.value[b].attributes=JSON.parse(r.value[b].attributes)),(r.value[b].attributes.conversationType===void 0||r.value[b].attributes.conversationType==="")&&(r.value[b].attributes.conversationType="Support"),(r.value[b].friendlyName===null||r.value[b].friendlyName==="")&&(r.value[b].friendlyName="no name...")}}catch(d){console.log("getConversations error => ",d)}},i=Ve(""),a=Ve(!1),s=Ve("Support"),u=Ve(["Support","ChatChannel"]),o=async()=>{let d={conversationType:s.value,createdBy:t.agent.identity};try{(await fetch("/conversations/conversation-create",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationName:i.value,attributes:d}})})).ok?(console.log("Success! Created a new conversation..."),i.value="",a.value=!1,n()):console.log("Error! Unable to create new conversation...")}catch(y){console.log("createNewConversation error => ",y)}},c=async d=>{try{(await fetch("/conversations/conversation-delete",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:d}})})).ok&&(console.log("Success! Conversation deleted..."),n())}catch(y){console.log("deleteConversations error => ",y)}};return uo(()=>{n()}),(d,y)=>{const _=fr("router-link");return He(),Ye("div",fP,[R("button",{onClick:y[0]||(y[0]=b=>n()),class:"float-end btn btn-lg btn-secondary"},hP),vP,R("table",gP,[yP,R("tbody",null,[(He(!0),Ye(Ht,null,wn(r.value,b=>(He(),Ye("tr",{key:b.sid},[R("td",mP,Bt(b.friendlyName),1),R("td",bP,Bt(Ot(q$)(b.dateCreated)),1),R("td",wP,[vt(_,{to:{name:"conversation",params:{sid:b.sid}},custom:""},{default:tr(({navigate:T})=>[R("button",{class:"btn btn-primary",onClick:T},kP,8,_P)]),_:2},1032,["to"]),R("button",{class:"btn btn-danger ms-2",onClick:T=>c(b.sid)},CP,8,TP)])]))),128))])]),R("div",IP,[R("div",RP,[rt(R("button",{type:"button",class:"btn btn-secondary",onClick:y[1]||(y[1]=b=>a.value=!0)},PP,512),[[dt,!a.value]]),rt(R("div",MP,[NP,R("div",xP,[R("div",LP,[jP,rt(R("select",{class:"form-select form-control-lg","onUpdate:modelValue":y[2]||(y[2]=b=>s.value=b)},[(He(!0),Ye(Ht,null,wn(u.value,b=>(He(),Ye("option",{key:b,value:b},Bt(b),9,UP))),128))],512),[[vc,s.value]])]),R("div",DP,[FP,rt(R("input",{type:"text","onUpdate:modelValue":y[3]||(y[3]=b=>i.value=b),class:"form-control form-control-lg"},null,512),[[xs,i.value]])]),R("div",BP,[R("div",qP,[R("button",{type:"button",class:"btn btn-success btn-block",onClick:y[4]||(y[4]=b=>o())},GP)])])])],512),[[dt,a.value]])])])])}}},VP={name:"App",components:{Layout:lo,Conversations:zP}};function KP(e,t,r,n,i,a){const s=fr("Conversations"),u=fr("Layout");return He(),cn(u,null,{default:tr(()=>[vt(s)]),_:1})}const JP=Wn(VP,[["render",KP]]);function H$(e){return e?e.replace("EndUser:",""):""}function _a(e,t,r){let n={displayName:r,avatar:YP(),sms:!1,chat:!1,whatsapp:!1,enduser:!1,agent:!1,bot:!1};switch(e){case"sms":n.sms=!0;break;case"chat":n.chat=!0;break;case"whatsapp":n.whatsapp=!0;break}switch(t){case"enduser":n.enduser=!0;break;case"agent":n.agent=!0;break;case"bot":n.bot=!0;break}return JSON.stringify(n)}function YP(){let e=1,t=700;return`https://picsum.photos/id/${Math.floor(Math.random()*(t-e+1)+e)}/50`}var Tn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function QP(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var W$={},gl=function(e){return e&&e.Math==Math&&e},ct=gl(typeof globalThis=="object"&&globalThis)||gl(typeof window=="object"&&window)||gl(typeof self=="object"&&self)||gl(typeof Tn=="object"&&Tn)||function(){return this}()||Function("return this")(),Gn={},nt=function(e){try{return!!e()}catch{return!0}},XP=nt,qt=!XP(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),ZP=nt,Pu=!ZP(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),eM=Pu,yl=Function.prototype.call,Pt=eM?yl.bind(yl):function(){return yl.apply(yl,arguments)},Mu={},G$={}.propertyIsEnumerable,z$=Object.getOwnPropertyDescriptor,tM=z$&&!G$.call({1:2},1);Mu.f=tM?function(t){var r=z$(this,t);return!!r&&r.enumerable}:G$;var Qa=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},V$=Pu,K$=Function.prototype,rM=K$.bind,zp=K$.call,nM=V$&&rM.bind(zp,zp),Ze=V$?function(e){return e&&nM(e)}:function(e){return e&&function(){return zp.apply(e,arguments)}},J$=Ze,iM=J$({}.toString),aM=J$("".slice),ea=function(e){return aM(iM(e),8,-1)},sM=Ze,oM=nt,uM=ea,zf=Object,lM=sM("".split),Nu=oM(function(){return!zf("z").propertyIsEnumerable(0)})?function(e){return uM(e)=="String"?lM(e,""):zf(e)}:zf,zn=function(e){return e==null},cM=zn,fM=TypeError,Vn=function(e){if(cM(e))throw fM("Can't call method on "+e);return e},dM=Nu,pM=Vn,Hr=function(e){return dM(pM(e))},Mt=function(e){return typeof e=="function"},Zy=Mt,Vp=typeof document=="object"&&document.all,hM=typeof Vp>"u"&&Vp!==void 0,zt=hM?function(e){return typeof e=="object"?e!==null:Zy(e)||e===Vp}:function(e){return typeof e=="object"?e!==null:Zy(e)},Vf=ct,vM=Mt,gM=function(e){return vM(e)?e:void 0},fn=function(e,t){return arguments.length<2?gM(Vf[e]):Vf[e]&&Vf[e][t]},yM=Ze,vi=yM({}.isPrototypeOf),mM=fn,Xa=mM("navigator","userAgent")||"",Y$=ct,Kf=Xa,em=Y$.process,tm=Y$.Deno,rm=em&&em.versions||tm&&tm.version,nm=rm&&rm.v8,_n,mc;nm&&(_n=nm.split("."),mc=_n[0]>0&&_n[0]<4?1:+(_n[0]+_n[1]));!mc&&Kf&&(_n=Kf.match(/Edge\/(\d+)/),(!_n||_n[1]>=74)&&(_n=Kf.match(/Chrome\/(\d+)/),_n&&(mc=+_n[1])));var Za=mc,im=Za,bM=nt,co=!!Object.getOwnPropertySymbols&&!bM(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&im&&im<41}),wM=co,Q$=wM&&!Symbol.sham&&typeof Symbol.iterator=="symbol",_M=fn,SM=Mt,$M=vi,kM=Q$,TM=Object,fo=kM?function(e){return typeof e=="symbol"}:function(e){var t=_M("Symbol");return SM(t)&&$M(t.prototype,TM(e))},EM=String,es=function(e){try{return EM(e)}catch{return"Object"}},CM=Mt,IM=es,RM=TypeError,An=function(e){if(CM(e))return e;throw RM(IM(e)+" is not a function")},OM=An,AM=zn,ts=function(e,t){var r=e[t];return AM(r)?void 0:OM(r)},Jf=Pt,Yf=Mt,Qf=zt,PM=TypeError,MM=function(e,t){var r,n;if(t==="string"&&Yf(r=e.toString)&&!Qf(n=Jf(r,e))||Yf(r=e.valueOf)&&!Qf(n=Jf(r,e))||t!=="string"&&Yf(r=e.toString)&&!Qf(n=Jf(r,e)))return n;throw PM("Can't convert object to primitive value")},rs={exports:{}},NM=!1,am=ct,xM=Object.defineProperty,wv=function(e,t){try{xM(am,e,{value:t,configurable:!0,writable:!0})}catch{am[e]=t}return t},LM=ct,jM=wv,sm="__core-js_shared__",UM=LM[sm]||jM(sm,{}),_v=UM,om=_v;(rs.exports=function(e,t){return om[e]||(om[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.25.1",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.1/LICENSE",source:"https://github.com/zloirock/core-js"});var DM=Vn,FM=Object,mr=function(e){return FM(DM(e))},BM=Ze,qM=mr,HM=BM({}.hasOwnProperty),Vt=Object.hasOwn||function(t,r){return HM(qM(t),r)},WM=Ze,GM=0,zM=Math.random(),VM=WM(1 .toString),xu=function(e){return"Symbol("+(e===void 0?"":e)+")_"+VM(++GM+zM,36)},KM=ct,JM=rs.exports,um=Vt,YM=xu,lm=co,X$=Q$,ys=JM("wks"),Ba=KM.Symbol,cm=Ba&&Ba.for,QM=X$?Ba:Ba&&Ba.withoutSetter||YM,It=function(e){if(!um(ys,e)||!(lm||typeof ys[e]=="string")){var t="Symbol."+e;lm&&um(Ba,e)?ys[e]=Ba[e]:X$&&cm?ys[e]=cm(t):ys[e]=QM(t)}return ys[e]},XM=Pt,fm=zt,dm=fo,ZM=ts,e2=MM,t2=It,r2=TypeError,n2=t2("toPrimitive"),Sv=function(e,t){if(!fm(e)||dm(e))return e;var r=ZM(e,n2),n;if(r){if(t===void 0&&(t="default"),n=XM(r,e,t),!fm(n)||dm(n))return n;throw r2("Can't convert object to primitive value")}return t===void 0&&(t="number"),e2(e,t)},i2=Sv,a2=fo,Lu=function(e){var t=i2(e,"string");return a2(t)?t:t+""},s2=ct,pm=zt,Kp=s2.document,o2=pm(Kp)&&pm(Kp.createElement),af=function(e){return o2?Kp.createElement(e):{}},u2=qt,l2=nt,c2=af,Z$=!u2&&!l2(function(){return Object.defineProperty(c2("div"),"a",{get:function(){return 7}}).a!=7}),f2=qt,d2=Pt,p2=Mu,h2=Qa,v2=Hr,g2=Lu,y2=Vt,m2=Z$,hm=Object.getOwnPropertyDescriptor;Gn.f=f2?hm:function(t,r){if(t=v2(t),r=g2(r),m2)try{return hm(t,r)}catch{}if(y2(t,r))return h2(!d2(p2.f,t,r),t[r])};var Xt={},b2=qt,w2=nt,e0=b2&&w2(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),_2=zt,S2=String,$2=TypeError,Zt=function(e){if(_2(e))return e;throw $2(S2(e)+" is not an object")},k2=qt,T2=Z$,E2=e0,ml=Zt,vm=Lu,C2=TypeError,Xf=Object.defineProperty,I2=Object.getOwnPropertyDescriptor,Zf="enumerable",ed="configurable",td="writable";Xt.f=k2?E2?function(t,r,n){if(ml(t),r=vm(r),ml(n),typeof t=="function"&&r==="prototype"&&"value"in n&&td in n&&!n[td]){var i=I2(t,r);i&&i[td]&&(t[r]=n.value,n={configurable:ed in n?n[ed]:i[ed],enumerable:Zf in n?n[Zf]:i[Zf],writable:!1})}return Xf(t,r,n)}:Xf:function(t,r,n){if(ml(t),r=vm(r),ml(n),T2)try{return Xf(t,r,n)}catch{}if("get"in n||"set"in n)throw C2("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var R2=qt,O2=Xt,A2=Qa,gi=R2?function(e,t,r){return O2.f(e,t,A2(1,r))}:function(e,t,r){return e[t]=r,e},$v={exports:{}},Jp=qt,P2=Vt,t0=Function.prototype,M2=Jp&&Object.getOwnPropertyDescriptor,kv=P2(t0,"name"),N2=kv&&function(){}.name==="something",x2=kv&&(!Jp||Jp&&M2(t0,"name").configurable),ju={EXISTS:kv,PROPER:N2,CONFIGURABLE:x2},L2=Ze,j2=Mt,Yp=_v,U2=L2(Function.toString);j2(Yp.inspectSource)||(Yp.inspectSource=function(e){return U2(e)});var Tv=Yp.inspectSource,D2=ct,F2=Mt,gm=D2.WeakMap,B2=F2(gm)&&/native code/.test(String(gm)),q2=rs.exports,H2=xu,ym=q2("keys"),sf=function(e){return ym[e]||(ym[e]=H2(e))},Uu={},W2=B2,r0=ct,rd=Ze,G2=zt,z2=gi,nd=Vt,id=_v,V2=sf,K2=Uu,mm="Object already initialized",Qp=r0.TypeError,J2=r0.WeakMap,bc,$u,wc,Y2=function(e){return wc(e)?$u(e):bc(e,{})},Q2=function(e){return function(t){var r;if(!G2(t)||(r=$u(t)).type!==e)throw Qp("Incompatible receiver, "+e+" required");return r}};if(W2||id.state){var Sa=id.state||(id.state=new J2),X2=rd(Sa.get),bm=rd(Sa.has),Z2=rd(Sa.set);bc=function(e,t){if(bm(Sa,e))throw Qp(mm);return t.facade=e,Z2(Sa,e,t),t},$u=function(e){return X2(Sa,e)||{}},wc=function(e){return bm(Sa,e)}}else{var ms=V2("state");K2[ms]=!0,bc=function(e,t){if(nd(e,ms))throw Qp(mm);return t.facade=e,z2(e,ms,t),t},$u=function(e){return nd(e,ms)?e[ms]:{}},wc=function(e){return nd(e,ms)}}var dn={set:bc,get:$u,has:wc,enforce:Y2,getterFor:Q2},eN=nt,tN=Mt,bl=Vt,Xp=qt,rN=ju.CONFIGURABLE,nN=Tv,n0=dn,iN=n0.enforce,aN=n0.get,Zl=Object.defineProperty,sN=Xp&&!eN(function(){return Zl(function(){},"length",{value:8}).length!==8}),oN=String(String).split("String"),uN=$v.exports=function(e,t,r){String(t).slice(0,7)==="Symbol("&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!bl(e,"name")||rN&&e.name!==t)&&(Xp?Zl(e,"name",{value:t,configurable:!0}):e.name=t),sN&&r&&bl(r,"arity")&&e.length!==r.arity&&Zl(e,"length",{value:r.arity});try{r&&bl(r,"constructor")&&r.constructor?Xp&&Zl(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=iN(e);return bl(n,"source")||(n.source=oN.join(typeof t=="string"?t:"")),e};Function.prototype.toString=uN(function(){return tN(this)&&aN(this).source||nN(this)},"toString");var lN=Mt,cN=Xt,fN=$v.exports,dN=wv,br=function(e,t,r,n){n||(n={});var i=n.enumerable,a=n.name!==void 0?n.name:t;if(lN(r)&&fN(r,a,n),n.global)i?e[t]=r:dN(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:cN.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},ta={},pN=Math.ceil,hN=Math.floor,vN=Math.trunc||function(t){var r=+t;return(r>0?hN:pN)(r)},gN=vN,yi=function(e){var t=+e;return t!==t||t===0?0:gN(t)},yN=yi,mN=Math.max,bN=Math.min,ns=function(e,t){var r=yN(e);return r<0?mN(r+t,0):bN(r,t)},wN=yi,_N=Math.min,mi=function(e){return e>0?_N(wN(e),9007199254740991):0},SN=mi,wr=function(e){return SN(e.length)},$N=Hr,kN=ns,TN=wr,wm=function(e){return function(t,r,n){var i=$N(t),a=TN(i),s=kN(n,a),u;if(e&&r!=r){for(;a>s;)if(u=i[s++],u!=u)return!0}else for(;a>s;s++)if((e||s in i)&&i[s]===r)return e||s||0;return!e&&-1}},of={includes:wm(!0),indexOf:wm(!1)},EN=Ze,ad=Vt,CN=Hr,IN=of.indexOf,RN=Uu,_m=EN([].push),i0=function(e,t){var r=CN(e),n=0,i=[],a;for(a in r)!ad(RN,a)&&ad(r,a)&&_m(i,a);for(;t.length>n;)ad(r,a=t[n++])&&(~IN(i,a)||_m(i,a));return i},Ev=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ON=i0,AN=Ev,PN=AN.concat("length","prototype");ta.f=Object.getOwnPropertyNames||function(t){return ON(t,PN)};var Du={};Du.f=Object.getOwnPropertySymbols;var MN=fn,NN=Ze,xN=ta,LN=Du,jN=Zt,UN=NN([].concat),a0=MN("Reflect","ownKeys")||function(t){var r=xN.f(jN(t)),n=LN.f;return n?UN(r,n(t)):r},Sm=Vt,DN=a0,FN=Gn,BN=Xt,s0=function(e,t,r){for(var n=DN(t),i=BN.f,a=FN.f,s=0;s<n.length;s++){var u=n[s];!Sm(e,u)&&!(r&&Sm(r,u))&&i(e,u,a(t,u))}},qN=nt,HN=Mt,WN=/#|\.prototype\./,Fu=function(e,t){var r=zN[GN(e)];return r==KN?!0:r==VN?!1:HN(t)?qN(t):!!t},GN=Fu.normalize=function(e){return String(e).replace(WN,".").toLowerCase()},zN=Fu.data={},VN=Fu.NATIVE="N",KN=Fu.POLYFILL="P",uf=Fu,sd=ct,JN=Gn.f,YN=gi,QN=br,XN=wv,ZN=s0,ex=uf,lt=function(e,t){var r=e.target,n=e.global,i=e.stat,a,s,u,o,c,d;if(n?s=sd:i?s=sd[r]||XN(r,{}):s=(sd[r]||{}).prototype,s)for(u in t){if(c=t[u],e.dontCallGetSet?(d=JN(s,u),o=d&&d.value):o=s[u],a=ex(n?u:r+(i?".":"#")+u,e.forced),!a&&o!==void 0){if(typeof c==typeof o)continue;ZN(c,o)}(e.sham||o&&o.sham)&&YN(c,"sham",!0),QN(s,u,c,e)}},tx=Pu,o0=Function.prototype,$m=o0.apply,km=o0.call,ra=typeof Reflect=="object"&&Reflect.apply||(tx?km.bind($m):function(){return km.apply($m,arguments)}),rx=Ze,po=rx([].slice),u0=Ze,nx=An,ix=zt,ax=Vt,Tm=po,sx=Pu,l0=Function,ox=u0([].concat),ux=u0([].join),od={},lx=function(e,t,r){if(!ax(od,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";od[t]=l0("C,a","return new C("+ux(n,",")+")")}return od[t](e,r)},cx=sx?l0.bind:function(t){var r=nx(this),n=r.prototype,i=Tm(arguments,1),a=function(){var u=ox(i,Tm(arguments));return this instanceof a?lx(r,u.length,u):r.apply(t,u)};return ix(n)&&(a.prototype=n),a},fx=It,dx=fx("toStringTag"),c0={};c0[dx]="z";var Cv=String(c0)==="[object z]",px=Cv,hx=Mt,ec=ea,vx=It,gx=vx("toStringTag"),yx=Object,mx=ec(function(){return arguments}())=="Arguments",bx=function(e,t){try{return e[t]}catch{}},bi=px?ec:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=bx(t=yx(e),gx))=="string"?r:mx?ec(t):(n=ec(t))=="Object"&&hx(t.callee)?"Arguments":n},wx=Ze,_x=nt,f0=Mt,Sx=bi,$x=fn,kx=Tv,d0=function(){},Tx=[],p0=$x("Reflect","construct"),Iv=/^\s*(?:class|function)\b/,Ex=wx(Iv.exec),Cx=!Iv.exec(d0),Lo=function(t){if(!f0(t))return!1;try{return p0(d0,Tx,t),!0}catch{return!1}},h0=function(t){if(!f0(t))return!1;switch(Sx(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Cx||!!Ex(Iv,kx(t))}catch{return!0}};h0.sham=!0;var lf=!p0||_x(function(){var e;return Lo(Lo.call)||!Lo(Object)||!Lo(function(){e=!0})||e})?h0:Lo,Ix=lf,Rx=es,Ox=TypeError,Rv=function(e){if(Ix(e))return e;throw Ox(Rx(e)+" is not a constructor")},Ov={},Ax=i0,Px=Ev,Bu=Object.keys||function(t){return Ax(t,Px)},Mx=qt,Nx=e0,xx=Xt,Lx=Zt,jx=Hr,Ux=Bu;Ov.f=Mx&&!Nx?Object.defineProperties:function(t,r){Lx(t);for(var n=jx(r),i=Ux(r),a=i.length,s=0,u;a>s;)xx.f(t,u=i[s++],n[u]);return t};var Dx=fn,v0=Dx("document","documentElement"),Fx=Zt,Bx=Ov,Em=Ev,qx=Uu,Hx=v0,Wx=af,Gx=sf,Cm=">",Im="<",Zp="prototype",eh="script",g0=Gx("IE_PROTO"),ud=function(){},y0=function(e){return Im+eh+Cm+e+Im+"/"+eh+Cm},Rm=function(e){e.write(y0("")),e.close();var t=e.parentWindow.Object;return e=null,t},zx=function(){var e=Wx("iframe"),t="java"+eh+":",r;return e.style.display="none",Hx.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(y0("document.F=Object")),r.close(),r.F},wl,tc=function(){try{wl=new ActiveXObject("htmlfile")}catch{}tc=typeof document<"u"?document.domain&&wl?Rm(wl):zx():Rm(wl);for(var e=Em.length;e--;)delete tc[Zp][Em[e]];return tc()};qx[g0]=!0;var na=Object.create||function(t,r){var n;return t!==null?(ud[Zp]=Fx(t),n=new ud,ud[Zp]=null,n[g0]=t):n=tc(),r===void 0?n:Bx.f(n,r)},Vx=lt,Kx=fn,ld=ra,Jx=cx,Om=Rv,Yx=Zt,Am=zt,Qx=na,m0=nt,Av=Kx("Reflect","construct"),Xx=Object.prototype,Zx=[].push,b0=m0(function(){function e(){}return!(Av(function(){},[],e)instanceof e)}),w0=!m0(function(){Av(function(){})}),Pm=b0||w0;Vx({target:"Reflect",stat:!0,forced:Pm,sham:Pm},{construct:function(t,r){Om(t),Yx(r);var n=arguments.length<3?t:Om(arguments[2]);if(w0&&!b0)return Av(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];return ld(Zx,i,r),new(ld(Jx,t,i))}var a=n.prototype,s=Qx(Am(a)?a:Xx),u=ld(t,s,r);return Am(u)?u:s}});var eL=lt,tL=mr,_0=Bu,rL=nt,nL=rL(function(){_0(1)});eL({target:"Object",stat:!0,forced:nL},{keys:function(t){return _0(tL(t))}});var iL=bi,aL=String,dr=function(e){if(iL(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return aL(e)},Pv={},sL=Lu,oL=Xt,uL=Qa,ho=function(e,t,r){var n=sL(t);n in e?oL.f(e,n,uL(0,r)):e[n]=r},Mm=ns,lL=wr,cL=ho,fL=Array,dL=Math.max,qu=function(e,t,r){for(var n=lL(e),i=Mm(t,n),a=Mm(r===void 0?n:r,n),s=fL(dL(a-i,0)),u=0;i<a;i++,u++)cL(s,u,e[i]);return s.length=u,s},pL=ea,hL=Hr,S0=ta.f,vL=qu,$0=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],gL=function(e){try{return S0(e)}catch{return vL($0)}};Pv.f=function(t){return $0&&pL(t)=="Window"?gL(t):S0(hL(t))};var Mv={},yL=It;Mv.f=yL;var mL=ct,bL=mL,Nm=bL,wL=Vt,_L=Mv,SL=Xt.f,k0=function(e){var t=Nm.Symbol||(Nm.Symbol={});wL(t,e)||SL(t,e,{value:_L.f(e)})},$L=Pt,kL=fn,TL=It,EL=br,CL=function(){var e=kL("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=TL("toPrimitive");t&&!t[n]&&EL(t,n,function(i){return $L(r,this)},{arity:1})},IL=Xt.f,RL=Vt,OL=It,xm=OL("toStringTag"),ia=function(e,t,r){e&&!r&&(e=e.prototype),e&&!RL(e,xm)&&IL(e,xm,{configurable:!0,value:t})},Lm=Ze,AL=An,PL=Pu,ML=Lm(Lm.bind),wi=function(e,t){return AL(e),t===void 0?e:PL?ML(e,t):function(){return e.apply(t,arguments)}},NL=ea,Hu=Array.isArray||function(t){return NL(t)=="Array"},jm=Hu,xL=lf,LL=zt,jL=It,UL=jL("species"),Um=Array,DL=function(e){var t;return jm(e)&&(t=e.constructor,xL(t)&&(t===Um||jm(t.prototype))?t=void 0:LL(t)&&(t=t[UL],t===null&&(t=void 0))),t===void 0?Um:t},FL=DL,Nv=function(e,t){return new(FL(e))(t===0?0:t)},BL=wi,qL=Ze,HL=Nu,WL=mr,GL=wr,zL=Nv,Dm=qL([].push),Ai=function(e){var t=e==1,r=e==2,n=e==3,i=e==4,a=e==6,s=e==7,u=e==5||a;return function(o,c,d,y){for(var _=WL(o),b=HL(_),T=BL(c,d),x=GL(b),N=0,D=y||zL,H=t?D(o,x):r||s?D(o,0):void 0,ve,ae;x>N;N++)if((u||N in b)&&(ve=b[N],ae=T(ve,N,_),e))if(t)H[N]=ae;else if(ae)switch(e){case 3:return!0;case 5:return ve;case 6:return N;case 2:Dm(H,ve)}else switch(e){case 4:return!1;case 7:Dm(H,ve)}return a?-1:n||i?i:H}},Wr={forEach:Ai(0),map:Ai(1),filter:Ai(2),some:Ai(3),every:Ai(4),find:Ai(5),findIndex:Ai(6),filterReject:Ai(7)},cf=lt,xv=ct,Lv=Pt,VL=Ze,Zs=qt,eo=co,KL=nt,ur=Vt,JL=vi,th=Zt,ff=Hr,jv=Lu,YL=dr,rh=Qa,ku=na,T0=Bu,QL=ta,E0=Pv,XL=Du,C0=Gn,I0=Xt,ZL=Ov,R0=Mu,cd=br,Uv=rs.exports,ej=sf,O0=Uu,Fm=xu,tj=It,rj=Mv,nj=k0,ij=CL,aj=ia,A0=dn,df=Wr.forEach,Pr=ej("hidden"),pf="Symbol",Tu="prototype",sj=A0.set,Bm=A0.getterFor(pf),on=Object[Tu],qa=xv.Symbol,Xo=qa&&qa[Tu],oj=xv.TypeError,fd=xv.QObject,P0=C0.f,Di=I0.f,M0=E0.f,uj=R0.f,N0=VL([].push),ci=Uv("symbols"),Wu=Uv("op-symbols"),lj=Uv("wks"),nh=!fd||!fd[Tu]||!fd[Tu].findChild,ih=Zs&&KL(function(){return ku(Di({},"a",{get:function(){return Di(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=P0(on,t);n&&delete on[t],Di(e,t,r),n&&e!==on&&Di(on,t,n)}:Di,dd=function(e,t){var r=ci[e]=ku(Xo);return sj(r,{type:pf,tag:e,description:t}),Zs||(r.description=t),r},hf=function(t,r,n){t===on&&hf(Wu,r,n),th(t);var i=jv(r);return th(n),ur(ci,i)?(n.enumerable?(ur(t,Pr)&&t[Pr][i]&&(t[Pr][i]=!1),n=ku(n,{enumerable:rh(0,!1)})):(ur(t,Pr)||Di(t,Pr,rh(1,{})),t[Pr][i]=!0),ih(t,i,n)):Di(t,i,n)},Dv=function(t,r){th(t);var n=ff(r),i=T0(n).concat(j0(n));return df(i,function(a){(!Zs||Lv(ah,n,a))&&hf(t,a,n[a])}),t},cj=function(t,r){return r===void 0?ku(t):Dv(ku(t),r)},ah=function(t){var r=jv(t),n=Lv(uj,this,r);return this===on&&ur(ci,r)&&!ur(Wu,r)?!1:n||!ur(this,r)||!ur(ci,r)||ur(this,Pr)&&this[Pr][r]?n:!0},x0=function(t,r){var n=ff(t),i=jv(r);if(!(n===on&&ur(ci,i)&&!ur(Wu,i))){var a=P0(n,i);return a&&ur(ci,i)&&!(ur(n,Pr)&&n[Pr][i])&&(a.enumerable=!0),a}},L0=function(t){var r=M0(ff(t)),n=[];return df(r,function(i){!ur(ci,i)&&!ur(O0,i)&&N0(n,i)}),n},j0=function(e){var t=e===on,r=M0(t?Wu:ff(e)),n=[];return df(r,function(i){ur(ci,i)&&(!t||ur(on,i))&&N0(n,ci[i])}),n};eo||(qa=function(){if(JL(Xo,this))throw oj("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:YL(arguments[0]),r=Fm(t),n=function(i){this===on&&Lv(n,Wu,i),ur(this,Pr)&&ur(this[Pr],r)&&(this[Pr][r]=!1),ih(this,r,rh(1,i))};return Zs&&nh&&ih(on,r,{configurable:!0,set:n}),dd(r,t)},Xo=qa[Tu],cd(Xo,"toString",function(){return Bm(this).tag}),cd(qa,"withoutSetter",function(e){return dd(Fm(e),e)}),R0.f=ah,I0.f=hf,ZL.f=Dv,C0.f=x0,QL.f=E0.f=L0,XL.f=j0,rj.f=function(e){return dd(tj(e),e)},Zs&&(Di(Xo,"description",{configurable:!0,get:function(){return Bm(this).description}}),cd(on,"propertyIsEnumerable",ah,{unsafe:!0})));cf({global:!0,constructor:!0,wrap:!0,forced:!eo,sham:!eo},{Symbol:qa});df(T0(lj),function(e){nj(e)});cf({target:pf,stat:!0,forced:!eo},{useSetter:function(){nh=!0},useSimple:function(){nh=!1}});cf({target:"Object",stat:!0,forced:!eo,sham:!Zs},{create:cj,defineProperty:hf,defineProperties:Dv,getOwnPropertyDescriptor:x0});cf({target:"Object",stat:!0,forced:!eo},{getOwnPropertyNames:L0});ij();aj(qa,pf);O0[Pr]=!0;var fj=co,U0=fj&&!!Symbol.for&&!!Symbol.keyFor,dj=lt,pj=fn,hj=Vt,vj=dr,D0=rs.exports,gj=U0,pd=D0("string-to-symbol-registry"),yj=D0("symbol-to-string-registry");dj({target:"Symbol",stat:!0,forced:!gj},{for:function(e){var t=vj(e);if(hj(pd,t))return pd[t];var r=pj("Symbol")(t);return pd[t]=r,yj[r]=t,r}});var mj=lt,bj=Vt,wj=fo,_j=es,Sj=rs.exports,$j=U0,qm=Sj("symbol-to-string-registry");mj({target:"Symbol",stat:!0,forced:!$j},{keyFor:function(t){if(!wj(t))throw TypeError(_j(t)+" is not a symbol");if(bj(qm,t))return qm[t]}});var kj=lt,F0=fn,B0=ra,Tj=Pt,Gu=Ze,q0=nt,Ej=Hu,Cj=Mt,Ij=zt,Hm=fo,H0=po,Rj=co,zi=F0("JSON","stringify"),_l=Gu(/./.exec),Wm=Gu("".charAt),Oj=Gu("".charCodeAt),Aj=Gu("".replace),Pj=Gu(1 .toString),Mj=/[\uD800-\uDFFF]/g,Gm=/^[\uD800-\uDBFF]$/,zm=/^[\uDC00-\uDFFF]$/,Vm=!Rj||q0(function(){var e=F0("Symbol")();return zi([e])!="[null]"||zi({a:e})!="{}"||zi(Object(e))!="{}"}),Km=q0(function(){return zi("\uDF06\uD834")!=='"\\udf06\\ud834"'||zi("\uDEAD")!=='"\\udead"'}),Nj=function(e,t){var r=H0(arguments),n=t;if(!(!Ij(t)&&e===void 0||Hm(e)))return Ej(t)||(t=function(i,a){if(Cj(n)&&(a=Tj(n,this,i,a)),!Hm(a))return a}),r[1]=t,B0(zi,null,r)},xj=function(e,t,r){var n=Wm(r,t-1),i=Wm(r,t+1);return _l(Gm,e)&&!_l(zm,i)||_l(zm,e)&&!_l(Gm,n)?"\\u"+Pj(Oj(e,0),16):e};zi&&kj({target:"JSON",stat:!0,arity:3,forced:Vm||Km},{stringify:function(t,r,n){var i=H0(arguments),a=B0(Vm?Nj:zi,null,i);return Km&&typeof a=="string"?Aj(a,Mj,xj):a}});var Lj=lt,jj=co,Uj=nt,W0=Du,Dj=mr,Fj=!jj||Uj(function(){W0.f(1)});Lj({target:"Object",stat:!0,forced:Fj},{getOwnPropertySymbols:function(t){var r=W0.f;return r?r(Dj(t)):[]}});var Bj=nt,qj=It,Hj=Za,Wj=qj("species"),zu=function(e){return Hj>=51||!Bj(function(){var t=[],r=t.constructor={};return r[Wj]=function(){return{foo:1}},t[e](Boolean).foo!==1})},Gj=lt,zj=Wr.filter,Vj=zu,Kj=Vj("filter");Gj({target:"Array",proto:!0,forced:!Kj},{filter:function(t){return zj(this,t,arguments.length>1?arguments[1]:void 0)}});var Jj=lt,Yj=nt,Qj=Hr,G0=Gn.f,z0=qt,Xj=Yj(function(){G0(1)}),Zj=!z0||Xj;Jj({target:"Object",stat:!0,forced:Zj,sham:!z0},{getOwnPropertyDescriptor:function(t,r){return G0(Qj(t),r)}});var eU=lt,tU=qt,rU=a0,nU=Hr,iU=Gn,aU=ho;eU({target:"Object",stat:!0,sham:!tU},{getOwnPropertyDescriptors:function(t){for(var r=nU(t),n=iU.f,i=rU(r),a={},s=0,u,o;i.length>s;)o=n(r,u=i[s++]),o!==void 0&&aU(a,u,o);return a}});var vo={exports:{}};(function(e){function t(n,i,a,s,u,o,c){try{var d=n[o](c),y=d.value}catch(_){a(_);return}d.done?i(y):Promise.resolve(y).then(s,u)}function r(n){return function(){var i=this,a=arguments;return new Promise(function(s,u){var o=n.apply(i,a);function c(y){t(o,s,u,c,d,"next",y)}function d(y){t(o,s,u,c,d,"throw",y)}c(void 0)})}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(vo);var is={exports:{}};(function(e){function t(n,i){for(var a=0;a<i.length;a++){var s=i[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,s.key,s)}}function r(n,i,a){return i&&t(n.prototype,i),a&&t(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(is);var aa={exports:{}};(function(e){function t(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(aa);var sa={exports:{}},vf={exports:{}};(function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(vf);(function(e){var t=vf.exports;function r(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),i&&t(n,i)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(sa);var oa={exports:{}},ua={exports:{}};(function(e){function t(r){return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(ua);(function(e){var t=ua.exports.default,r=aa.exports;function n(i,a){if(a&&(t(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(i)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(oa);var Kn={exports:{}};(function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Kn);var la={exports:{}};(function(e){function t(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(la);var ca={exports:{}};(function(e){function t(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(ca);var sU=Cv,oU=bi,uU=sU?{}.toString:function(){return"[object "+oU(this)+"]"},lU=Cv,cU=br,fU=uU;lU||cU(Object.prototype,"toString",fU,{unsafe:!0});var dU=ea,pU=ct,Vu=dU(pU.process)=="process",hU=Mt,vU=String,gU=TypeError,yU=function(e){if(typeof e=="object"||hU(e))return e;throw gU("Can't set "+vU(e)+" as a prototype")},mU=Ze,bU=Zt,wU=yU,go=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=mU(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),r(t,[]),e=t instanceof Array}catch{}return function(i,a){return bU(i),wU(a),e?r(i,a):i.__proto__=a,i}}():void 0),_U=fn,SU=Xt,$U=It,kU=qt,Jm=$U("species"),gf=function(e){var t=_U(e),r=SU.f;kU&&t&&!t[Jm]&&r(t,Jm,{configurable:!0,get:function(){return this}})},TU=vi,EU=TypeError,as=function(e,t){if(TU(t,e))return e;throw EU("Incorrect invocation")},Ym=Zt,CU=Rv,IU=zn,RU=It,OU=RU("species"),Fv=function(e,t){var r=Ym(e).constructor,n;return r===void 0||IU(n=Ym(r)[OU])?t:CU(n)},AU=TypeError,Bv=function(e,t){if(e<t)throw AU("Not enough arguments");return e},PU=Xa,V0=/(?:ipad|iphone|ipod).*applewebkit/i.test(PU),Br=ct,MU=ra,NU=wi,Qm=Mt,xU=Vt,LU=nt,Xm=v0,jU=po,Zm=af,UU=Bv,DU=V0,FU=Vu,sh=Br.setImmediate,oh=Br.clearImmediate,BU=Br.process,hd=Br.Dispatch,qU=Br.Function,eb=Br.MessageChannel,HU=Br.String,vd=0,lu={},tb="onreadystatechange",Eu,$a,gd,yd;try{Eu=Br.location}catch{}var qv=function(e){if(xU(lu,e)){var t=lu[e];delete lu[e],t()}},md=function(e){return function(){qv(e)}},rb=function(e){qv(e.data)},nb=function(e){Br.postMessage(HU(e),Eu.protocol+"//"+Eu.host)};(!sh||!oh)&&(sh=function(t){UU(arguments.length,1);var r=Qm(t)?t:qU(t),n=jU(arguments,1);return lu[++vd]=function(){MU(r,void 0,n)},$a(vd),vd},oh=function(t){delete lu[t]},FU?$a=function(e){BU.nextTick(md(e))}:hd&&hd.now?$a=function(e){hd.now(md(e))}:eb&&!DU?(gd=new eb,yd=gd.port2,gd.port1.onmessage=rb,$a=NU(yd.postMessage,yd)):Br.addEventListener&&Qm(Br.postMessage)&&!Br.importScripts&&Eu&&Eu.protocol!=="file:"&&!LU(nb)?($a=nb,Br.addEventListener("message",rb,!1)):tb in Zm("script")?$a=function(e){Xm.appendChild(Zm("script"))[tb]=function(){Xm.removeChild(this),qv(e)}}:$a=function(e){setTimeout(md(e),0)});var K0={set:sh,clear:oh},WU=Xa,GU=ct,zU=/ipad|iphone|ipod/i.test(WU)&&GU.Pebble!==void 0,VU=Xa,KU=/web0s(?!.*chrome)/i.test(VU),Wa=ct,ib=wi,JU=Gn.f,bd=K0.set,YU=V0,QU=zU,XU=KU,wd=Vu,ab=Wa.MutationObserver||Wa.WebKitMutationObserver,sb=Wa.document,ob=Wa.process,Sl=Wa.Promise,ub=JU(Wa,"queueMicrotask"),J0=ub&&ub.value,jo,Na,cu,As,_d,Sd,$l,lb;J0||(jo=function(){var e,t;for(wd&&(e=ob.domain)&&e.exit();Na;){t=Na.fn,Na=Na.next;try{t()}catch(r){throw Na?As():cu=void 0,r}}cu=void 0,e&&e.enter()},!YU&&!wd&&!XU&&ab&&sb?(_d=!0,Sd=sb.createTextNode(""),new ab(jo).observe(Sd,{characterData:!0}),As=function(){Sd.data=_d=!_d}):!QU&&Sl&&Sl.resolve?($l=Sl.resolve(void 0),$l.constructor=Sl,lb=ib($l.then,$l),As=function(){lb(jo)}):wd?As=function(){ob.nextTick(jo)}:(bd=ib(bd,Wa),As=function(){bd(jo)}));var ZU=J0||function(e){var t={fn:e,next:void 0};cu&&(cu.next=t),Na||(Na=t,As()),cu=t},eD=ct,tD=function(e,t){var r=eD.console;r&&r.error&&(arguments.length==1?r.error(e):r.error(e,t))},Hv=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},Y0=function(){this.head=null,this.tail=null};Y0.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var rD=Y0,nD=ct,yf=nD.Promise,Q0=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",iD=Q0,aD=Vu,sD=!iD&&!aD&&typeof window=="object"&&typeof document=="object",oD=ct,fu=yf,uD=Mt,lD=uf,cD=Tv,fD=It,dD=sD,pD=Q0,$d=Za;fu&&fu.prototype;var hD=fD("species"),uh=!1,X0=uD(oD.PromiseRejectionEvent),vD=lD("Promise",function(){var e=cD(fu),t=e!==String(fu);if(!t&&$d===66)return!0;if(!$d||$d<51||!/native code/.test(e)){var r=new fu(function(a){a(1)}),n=function(a){a(function(){},function(){})},i=r.constructor={};if(i[hD]=n,uh=r.then(function(){})instanceof n,!uh)return!0}return!t&&(dD||pD)&&!X0}),Ku={CONSTRUCTOR:vD,REJECTION_EVENT:X0,SUBCLASSING:uh},yo={},cb=An,gD=TypeError,yD=function(e){var t,r;this.promise=new e(function(n,i){if(t!==void 0||r!==void 0)throw gD("Bad Promise constructor");t=n,r=i}),this.resolve=cb(t),this.reject=cb(r)};yo.f=function(e){return new yD(e)};var mD=lt,_c=Vu,Xi=ct,to=Pt,fb=br,db=go,bD=ia,wD=gf,_D=An,rc=Mt,SD=zt,$D=as,kD=Fv,Z0=K0.set,Wv=ZU,TD=tD,ED=Hv,CD=rD,ek=dn,Sc=yf,Gv=Ku,tk=yo,mf="Promise",rk=Gv.CONSTRUCTOR,ID=Gv.REJECTION_EVENT,RD=Gv.SUBCLASSING,kd=ek.getterFor(mf),OD=ek.set,Ps=Sc&&Sc.prototype,xa=Sc,kl=Ps,nk=Xi.TypeError,lh=Xi.document,zv=Xi.process,ch=tk.f,AD=ch,PD=!!(lh&&lh.createEvent&&Xi.dispatchEvent),ik="unhandledrejection",MD="rejectionhandled",pb=0,ak=1,ND=2,Vv=1,sk=2,Tl,hb,xD,vb,ok=function(e){var t;return SD(e)&&rc(t=e.then)?t:!1},uk=function(e,t){var r=t.value,n=t.state==ak,i=n?e.ok:e.fail,a=e.resolve,s=e.reject,u=e.domain,o,c,d;try{i?(n||(t.rejection===sk&&jD(t),t.rejection=Vv),i===!0?o=r:(u&&u.enter(),o=i(r),u&&(u.exit(),d=!0)),o===e.promise?s(nk("Promise-chain cycle")):(c=ok(o))?to(c,o,a,s):a(o)):s(r)}catch(y){u&&!d&&u.exit(),s(y)}},lk=function(e,t){e.notified||(e.notified=!0,Wv(function(){for(var r=e.reactions,n;n=r.get();)uk(n,e);e.notified=!1,t&&!e.rejection&&LD(e)}))},ck=function(e,t,r){var n,i;PD?(n=lh.createEvent("Event"),n.promise=t,n.reason=r,n.initEvent(e,!1,!0),Xi.dispatchEvent(n)):n={promise:t,reason:r},!ID&&(i=Xi["on"+e])?i(n):e===ik&&TD("Unhandled promise rejection",r)},LD=function(e){to(Z0,Xi,function(){var t=e.facade,r=e.value,n=gb(e),i;if(n&&(i=ED(function(){_c?zv.emit("unhandledRejection",r,t):ck(ik,t,r)}),e.rejection=_c||gb(e)?sk:Vv,i.error))throw i.value})},gb=function(e){return e.rejection!==Vv&&!e.parent},jD=function(e){to(Z0,Xi,function(){var t=e.facade;_c?zv.emit("rejectionHandled",t):ck(MD,t,e.value)})},Ls=function(e,t,r){return function(n){e(t,n,r)}},Hs=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=ND,lk(e,!0))},fh=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw nk("Promise can't be resolved itself");var n=ok(t);n?Wv(function(){var i={done:!1};try{to(n,t,Ls(fh,i,e),Ls(Hs,i,e))}catch(a){Hs(i,a,e)}}):(e.value=t,e.state=ak,lk(e,!1))}catch(i){Hs({done:!1},i,e)}}};if(rk&&(xa=function(t){$D(this,kl),_D(t),to(Tl,this);var r=kd(this);try{t(Ls(fh,r),Ls(Hs,r))}catch(n){Hs(r,n)}},kl=xa.prototype,Tl=function(t){OD(this,{type:mf,done:!1,notified:!1,parent:!1,reactions:new CD,rejection:!1,state:pb,value:void 0})},Tl.prototype=fb(kl,"then",function(t,r){var n=kd(this),i=ch(kD(this,xa));return n.parent=!0,i.ok=rc(t)?t:!0,i.fail=rc(r)&&r,i.domain=_c?zv.domain:void 0,n.state==pb?n.reactions.add(i):Wv(function(){uk(i,n)}),i.promise}),hb=function(){var e=new Tl,t=kd(e);this.promise=e,this.resolve=Ls(fh,t),this.reject=Ls(Hs,t)},tk.f=ch=function(e){return e===xa||e===xD?new hb(e):AD(e)},rc(Sc)&&Ps!==Object.prototype)){vb=Ps.then,RD||fb(Ps,"then",function(t,r){var n=this;return new xa(function(i,a){to(vb,n,i,a)}).then(t,r)},{unsafe:!0});try{delete Ps.constructor}catch{}db&&db(Ps,kl)}mD({global:!0,constructor:!0,wrap:!0,forced:rk},{Promise:xa});bD(xa,mf,!1);wD(mf);var Ju={},UD=It,DD=Ju,FD=UD("iterator"),BD=Array.prototype,Kv=function(e){return e!==void 0&&(DD.Array===e||BD[FD]===e)},qD=bi,yb=ts,HD=zn,WD=Ju,GD=It,zD=GD("iterator"),Yu=function(e){if(!HD(e))return yb(e,zD)||yb(e,"@@iterator")||WD[qD(e)]},VD=Pt,KD=An,JD=Zt,YD=es,QD=Yu,XD=TypeError,bf=function(e,t){var r=arguments.length<2?QD(e):t;if(KD(r))return JD(VD(r,e));throw XD(YD(e)+" is not iterable")},ZD=Pt,mb=Zt,eF=ts,fk=function(e,t,r){var n,i;mb(e);try{if(n=eF(e,"return"),!n){if(t==="throw")throw r;return r}n=ZD(n,e)}catch(a){i=!0,n=a}if(t==="throw")throw r;if(i)throw n;return mb(n),r},tF=wi,rF=Pt,nF=Zt,iF=es,aF=Kv,sF=wr,bb=vi,oF=bf,uF=Yu,wb=fk,lF=TypeError,nc=function(e,t){this.stopped=e,this.result=t},_b=nc.prototype,wf=function(e,t,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),a=!!(r&&r.IS_RECORD),s=!!(r&&r.IS_ITERATOR),u=!!(r&&r.INTERRUPTED),o=tF(t,n),c,d,y,_,b,T,x,N=function(H){return c&&wb(c,"normal",H),new nc(!0,H)},D=function(H){return i?(nF(H),u?o(H[0],H[1],N):o(H[0],H[1])):u?o(H,N):o(H)};if(a)c=e.iterator;else if(s)c=e;else{if(d=uF(e),!d)throw lF(iF(e)+" is not iterable");if(aF(d)){for(y=0,_=sF(e);_>y;y++)if(b=D(e[y]),b&&bb(_b,b))return b;return new nc(!1)}c=oF(e,d)}for(T=a?e.next:c.next;!(x=rF(T,c)).done;){try{b=D(x.value)}catch(H){wb(c,"throw",H)}if(typeof b=="object"&&b&&bb(_b,b))return b}return new nc(!1)},cF=It,dk=cF("iterator"),pk=!1;try{var fF=0,Sb={next:function(){return{done:!!fF++}},return:function(){pk=!0}};Sb[dk]=function(){return this},Array.from(Sb,function(){throw 2})}catch{}var _f=function(e,t){if(!t&&!pk)return!1;var r=!1;try{var n={};n[dk]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},dF=yf,pF=_f,hF=Ku.CONSTRUCTOR,hk=hF||!pF(function(e){dF.all(e).then(void 0,function(){})}),vF=lt,gF=Pt,yF=An,mF=yo,bF=Hv,wF=wf,_F=hk;vF({target:"Promise",stat:!0,forced:_F},{all:function(t){var r=this,n=mF.f(r),i=n.resolve,a=n.reject,s=bF(function(){var u=yF(r.resolve),o=[],c=0,d=1;wF(t,function(y){var _=c++,b=!1;d++,gF(u,r,y).then(function(T){b||(b=!0,o[_]=T,--d||i(o))},a)}),--d||i(o)});return s.error&&a(s.value),n.promise}});var SF=lt,$F=Ku.CONSTRUCTOR,dh=yf,kF=fn,TF=Mt,EF=br,$b=dh&&dh.prototype;SF({target:"Promise",proto:!0,forced:$F,real:!0},{catch:function(e){return this.then(void 0,e)}});if(TF(dh)){var kb=kF("Promise").prototype.catch;$b.catch!==kb&&EF($b,"catch",kb,{unsafe:!0})}var CF=lt,IF=Pt,RF=An,OF=yo,AF=Hv,PF=wf,MF=hk;CF({target:"Promise",stat:!0,forced:MF},{race:function(t){var r=this,n=OF.f(r),i=n.reject,a=AF(function(){var s=RF(r.resolve);PF(t,function(u){IF(s,r,u).then(n.resolve,i)})});return a.error&&i(a.value),n.promise}});var NF=lt,xF=Pt,LF=yo,jF=Ku.CONSTRUCTOR;NF({target:"Promise",stat:!0,forced:jF},{reject:function(t){var r=LF.f(this);return xF(r.reject,void 0,t),r.promise}});var UF=Zt,DF=zt,FF=yo,BF=function(e,t){if(UF(e),DF(t)&&t.constructor===e)return t;var r=FF.f(e),n=r.resolve;return n(t),r.promise},qF=lt,HF=fn,WF=Ku.CONSTRUCTOR,GF=BF;HF("Promise");qF({target:"Promise",stat:!0,forced:WF},{resolve:function(t){return GF(this,t)}});var vk={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},zF=af,Td=zF("span").classList,Tb=Td&&Td.constructor&&Td.constructor.prototype,gk=Tb===Object.prototype?void 0:Tb,VF=nt,Qu=function(e,t){var r=[][e];return!!r&&VF(function(){r.call(null,t||function(){return 1},1)})},KF=Wr.forEach,JF=Qu,YF=JF("forEach"),QF=YF?[].forEach:function(t){return KF(this,t,arguments.length>1?arguments[1]:void 0)},Eb=ct,Cb=vk,XF=gk,Ed=QF,ZF=gi,yk=function(e){if(e&&e.forEach!==Ed)try{ZF(e,"forEach",Ed)}catch{e.forEach=Ed}};for(var Cd in Cb)Cb[Cd]&&yk(Eb[Cd]&&Eb[Cd].prototype);yk(XF);var e3=Mt,t3=zt,Ib=go,Jv=function(e,t,r){var n,i;return Ib&&e3(n=t.constructor)&&n!==r&&t3(i=n.prototype)&&i!==r.prototype&&Ib(e,i),e},r3=Ze,n3=r3(1 .valueOf),i3=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,a3=Ze,s3=Vn,o3=dr,u3=i3,Rb=a3("".replace),$c="["+u3+"]",l3=RegExp("^"+$c+$c+"*"),c3=RegExp($c+$c+"*$"),Id=function(e){return function(t){var r=o3(s3(t));return e&1&&(r=Rb(r,l3,"")),e&2&&(r=Rb(r,c3,"")),r}},f3={start:Id(1),end:Id(2),trim:Id(3)},d3=qt,Yv=ct,mk=Ze,p3=uf,h3=br,Ob=Vt,v3=Jv,g3=vi,y3=fo,bk=Sv,m3=nt,b3=ta.f,w3=Gn.f,_3=Xt.f,S3=n3,$3=f3.trim,ph="Number",xi=Yv[ph],Rd=xi.prototype,k3=Yv.TypeError,T3=mk("".slice),El=mk("".charCodeAt),E3=function(e){var t=bk(e,"number");return typeof t=="bigint"?t:C3(t)},C3=function(e){var t=bk(e,"number"),r,n,i,a,s,u,o,c;if(y3(t))throw k3("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=$3(t),r=El(t,0),r===43||r===45){if(n=El(t,2),n===88||n===120)return NaN}else if(r===48){switch(El(t,1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+t}for(s=T3(t,2),u=s.length,o=0;o<u;o++)if(c=El(s,o),c<48||c>a)return NaN;return parseInt(s,i)}}return+t};if(p3(ph,!xi(" 0o1")||!xi("0b1")||xi("+0x1"))){for(var bs=function(t){var r=arguments.length<1?0:xi(E3(t)),n=this;return g3(Rd,n)&&m3(function(){S3(n)})?v3(Object(r),n,bs):r},Ab=d3?b3(xi):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Od=0,Cl;Ab.length>Od;Od++)Ob(xi,Cl=Ab[Od])&&!Ob(bs,Cl)&&_3(bs,Cl,w3(xi,Cl));bs.prototype=Rd,Rd.constructor=bs,h3(Yv,ph,bs,{constructor:!0})}var wk={exports:{}};(function(e){var t=ua.exports.default;function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var n={},i=Object.prototype,a=i.hasOwnProperty,s=typeof Symbol=="function"?Symbol:{},u=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function d(se,ee,ne){return Object.defineProperty(se,ee,{value:ne,enumerable:!0,configurable:!0,writable:!0}),se[ee]}try{d({},"")}catch{d=function(ne,te,me){return ne[te]=me}}function y(se,ee,ne,te){var me=ee&&ee.prototype instanceof T?ee:T,A=Object.create(me.prototype),Ne=new B(te||[]);return A._invoke=function(ft,ze,le){var G="suspendedStart";return function(J,k){if(G==="executing")throw new Error("Generator is already running");if(G==="completed"){if(J==="throw")throw k;return Se()}for(le.method=J,le.arg=k;;){var C=le.delegate;if(C){var X=Ie(C,le);if(X){if(X===b)continue;return X}}if(le.method==="next")le.sent=le._sent=le.arg;else if(le.method==="throw"){if(G==="suspendedStart")throw G="completed",le.arg;le.dispatchException(le.arg)}else le.method==="return"&&le.abrupt("return",le.arg);G="executing";var Z=_(ft,ze,le);if(Z.type==="normal"){if(G=le.done?"completed":"suspendedYield",Z.arg===b)continue;return{value:Z.arg,done:le.done}}Z.type==="throw"&&(G="completed",le.method="throw",le.arg=Z.arg)}}}(se,ne,Ne),A}function _(se,ee,ne){try{return{type:"normal",arg:se.call(ee,ne)}}catch(te){return{type:"throw",arg:te}}}n.wrap=y;var b={};function T(){}function x(){}function N(){}var D={};d(D,u,function(){return this});var H=Object.getPrototypeOf,ve=H&&H(H(ke([])));ve&&ve!==i&&a.call(ve,u)&&(D=ve);var ae=N.prototype=T.prototype=Object.create(D);function Ae(se){["next","throw","return"].forEach(function(ee){d(se,ee,function(ne){return this._invoke(ee,ne)})})}function Re(se,ee){function ne(me,A,Ne,ft){var ze=_(se[me],se,A);if(ze.type!=="throw"){var le=ze.arg,G=le.value;return G&&t(G)=="object"&&a.call(G,"__await")?ee.resolve(G.__await).then(function(J){ne("next",J,Ne,ft)},function(J){ne("throw",J,Ne,ft)}):ee.resolve(G).then(function(J){le.value=J,Ne(le)},function(J){return ne("throw",J,Ne,ft)})}ft(ze.arg)}var te;this._invoke=function(me,A){function Ne(){return new ee(function(ft,ze){ne(me,A,ft,ze)})}return te=te?te.then(Ne,Ne):Ne()}}function Ie(se,ee){var ne=se.iterator[ee.method];if(ne===void 0){if(ee.delegate=null,ee.method==="throw"){if(se.iterator.return&&(ee.method="return",ee.arg=void 0,Ie(se,ee),ee.method==="throw"))return b;ee.method="throw",ee.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var te=_(ne,se.iterator,ee.arg);if(te.type==="throw")return ee.method="throw",ee.arg=te.arg,ee.delegate=null,b;var me=te.arg;return me?me.done?(ee[se.resultName]=me.value,ee.next=se.nextLoc,ee.method!=="return"&&(ee.method="next",ee.arg=void 0),ee.delegate=null,b):me:(ee.method="throw",ee.arg=new TypeError("iterator result is not an object"),ee.delegate=null,b)}function L(se){var ee={tryLoc:se[0]};1 in se&&(ee.catchLoc=se[1]),2 in se&&(ee.finallyLoc=se[2],ee.afterLoc=se[3]),this.tryEntries.push(ee)}function oe(se){var ee=se.completion||{};ee.type="normal",delete ee.arg,se.completion=ee}function B(se){this.tryEntries=[{tryLoc:"root"}],se.forEach(L,this),this.reset(!0)}function ke(se){if(se){var ee=se[u];if(ee)return ee.call(se);if(typeof se.next=="function")return se;if(!isNaN(se.length)){var ne=-1,te=function me(){for(;++ne<se.length;)if(a.call(se,ne))return me.value=se[ne],me.done=!1,me;return me.value=void 0,me.done=!0,me};return te.next=te}}return{next:Se}}function Se(){return{value:void 0,done:!0}}return x.prototype=N,d(ae,"constructor",N),d(N,"constructor",x),x.displayName=d(N,c,"GeneratorFunction"),n.isGeneratorFunction=function(se){var ee=typeof se=="function"&&se.constructor;return!!ee&&(ee===x||(ee.displayName||ee.name)==="GeneratorFunction")},n.mark=function(se){return Object.setPrototypeOf?Object.setPrototypeOf(se,N):(se.__proto__=N,d(se,c,"GeneratorFunction")),se.prototype=Object.create(ae),se},n.awrap=function(se){return{__await:se}},Ae(Re.prototype),d(Re.prototype,o,function(){return this}),n.AsyncIterator=Re,n.async=function(se,ee,ne,te,me){me===void 0&&(me=Promise);var A=new Re(y(se,ee,ne,te),me);return n.isGeneratorFunction(ee)?A:A.next().then(function(Ne){return Ne.done?Ne.value:A.next()})},Ae(ae),d(ae,c,"Generator"),d(ae,u,function(){return this}),d(ae,"toString",function(){return"[object Generator]"}),n.keys=function(se){var ee=[];for(var ne in se)ee.push(ne);return ee.reverse(),function te(){for(;ee.length;){var me=ee.pop();if(me in se)return te.value=me,te.done=!1,te}return te.done=!0,te}},n.values=ke,B.prototype={constructor:B,reset:function(ee){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(oe),!ee)for(var ne in this)ne.charAt(0)==="t"&&a.call(this,ne)&&!isNaN(+ne.slice(1))&&(this[ne]=void 0)},stop:function(){this.done=!0;var ee=this.tryEntries[0].completion;if(ee.type==="throw")throw ee.arg;return this.rval},dispatchException:function(ee){if(this.done)throw ee;var ne=this;function te(le,G){return Ne.type="throw",Ne.arg=ee,ne.next=le,G&&(ne.method="next",ne.arg=void 0),!!G}for(var me=this.tryEntries.length-1;me>=0;--me){var A=this.tryEntries[me],Ne=A.completion;if(A.tryLoc==="root")return te("end");if(A.tryLoc<=this.prev){var ft=a.call(A,"catchLoc"),ze=a.call(A,"finallyLoc");if(ft&&ze){if(this.prev<A.catchLoc)return te(A.catchLoc,!0);if(this.prev<A.finallyLoc)return te(A.finallyLoc)}else if(ft){if(this.prev<A.catchLoc)return te(A.catchLoc,!0)}else{if(!ze)throw new Error("try statement without catch or finally");if(this.prev<A.finallyLoc)return te(A.finallyLoc)}}}},abrupt:function(ee,ne){for(var te=this.tryEntries.length-1;te>=0;--te){var me=this.tryEntries[te];if(me.tryLoc<=this.prev&&a.call(me,"finallyLoc")&&this.prev<me.finallyLoc){var A=me;break}}A&&(ee==="break"||ee==="continue")&&A.tryLoc<=ne&&ne<=A.finallyLoc&&(A=null);var Ne=A?A.completion:{};return Ne.type=ee,Ne.arg=ne,A?(this.method="next",this.next=A.finallyLoc,b):this.complete(Ne)},complete:function(ee,ne){if(ee.type==="throw")throw ee.arg;return ee.type==="break"||ee.type==="continue"?this.next=ee.arg:ee.type==="return"?(this.rval=this.arg=ee.arg,this.method="return",this.next="end"):ee.type==="normal"&&ne&&(this.next=ne),b},finish:function(ee){for(var ne=this.tryEntries.length-1;ne>=0;--ne){var te=this.tryEntries[ne];if(te.finallyLoc===ee)return this.complete(te.completion,te.afterLoc),oe(te),b}},catch:function(ee){for(var ne=this.tryEntries.length-1;ne>=0;--ne){var te=this.tryEntries[ne];if(te.tryLoc===ee){var me=te.completion;if(me.type==="throw"){var A=me.arg;oe(te)}return A}}throw new Error("illegal catch attempt")},delegateYield:function(ee,ne,te){return this.delegate={iterator:ke(ee),resultName:ne,nextLoc:te},this.method==="next"&&(this.arg=void 0),b}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(wk);var ic=wk.exports(),Xu=ic;try{regeneratorRuntime=ic}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=ic:Function("r","regeneratorRuntime = r")(ic)}var I3=TypeError,R3=9007199254740991,_k=function(e){if(e>R3)throw I3("Maximum allowed index exceeded");return e},O3=lt,A3=nt,P3=Hu,M3=zt,N3=mr,x3=wr,Pb=_k,Mb=ho,L3=Nv,j3=zu,U3=It,D3=Za,Sk=U3("isConcatSpreadable"),F3=D3>=51||!A3(function(){var e=[];return e[Sk]=!1,e.concat()[0]!==e}),B3=j3("concat"),q3=function(e){if(!M3(e))return!1;var t=e[Sk];return t!==void 0?!!t:P3(e)},H3=!F3||!B3;O3({target:"Array",proto:!0,arity:1,forced:H3},{concat:function(t){var r=N3(this),n=L3(r,0),i=0,a,s,u,o,c;for(a=-1,u=arguments.length;a<u;a++)if(c=a===-1?r:arguments[a],q3(c))for(o=x3(c),Pb(i+o),s=0;s<o;s++,i++)s in c&&Mb(n,i,c[s]);else Pb(i+1),Mb(n,i++,c);return n.length=i,n}});var W3=Zt,G3=fk,z3=function(e,t,r,n){try{return n?t(W3(r)[0],r[1]):t(r)}catch(i){G3(e,"throw",i)}},V3=wi,K3=Pt,J3=mr,Y3=z3,Q3=Kv,X3=lf,Z3=wr,Nb=ho,eB=bf,tB=Yu,xb=Array,$k=function(t){var r=J3(t),n=X3(this),i=arguments.length,a=i>1?arguments[1]:void 0,s=a!==void 0;s&&(a=V3(a,i>2?arguments[2]:void 0));var u=tB(r),o=0,c,d,y,_,b,T;if(u&&!(this===xb&&Q3(u)))for(_=eB(r,u),b=_.next,d=n?new this:[];!(y=K3(b,_)).done;o++)T=s?Y3(_,a,[y.value,o],!0):y.value,Nb(d,o,T);else for(c=Z3(r),d=n?new this(c):xb(c);c>o;o++)T=s?a(r[o],o):r[o],Nb(d,o,T);return d.length=o,d},rB=lt,nB=$k,iB=_f,aB=!iB(function(e){Array.from(e)});rB({target:"Array",stat:!0,forced:aB},{from:nB});var Qv=Ze,sB=yi,oB=dr,uB=Vn,lB=Qv("".charAt),Lb=Qv("".charCodeAt),cB=Qv("".slice),jb=function(e){return function(t,r){var n=oB(uB(t)),i=sB(r),a=n.length,s,u;return i<0||i>=a?e?"":void 0:(s=Lb(n,i),s<55296||s>56319||i+1===a||(u=Lb(n,i+1))<56320||u>57343?e?lB(n,i):s:e?cB(n,i,i+2):(s-55296<<10)+(u-56320)+65536)}},Xv={codeAt:jb(!1),charAt:jb(!0)},fB=nt,dB=!fB(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),pB=Vt,hB=Mt,vB=mr,gB=sf,yB=dB,Ub=gB("IE_PROTO"),hh=Object,mB=hh.prototype,Sf=yB?hh.getPrototypeOf:function(e){var t=vB(e);if(pB(t,Ub))return t[Ub];var r=t.constructor;return hB(r)&&t instanceof r?r.prototype:t instanceof hh?mB:null},bB=nt,wB=Mt,_B=zt,Db=Sf,SB=br,$B=It,vh=$B("iterator"),kk=!1,Ga,Ad,Pd;[].keys&&(Pd=[].keys(),"next"in Pd?(Ad=Db(Db(Pd)),Ad!==Object.prototype&&(Ga=Ad)):kk=!0);var kB=!_B(Ga)||bB(function(){var e={};return Ga[vh].call(e)!==e});kB&&(Ga={});wB(Ga[vh])||SB(Ga,vh,function(){return this});var Tk={IteratorPrototype:Ga,BUGGY_SAFARI_ITERATORS:kk},TB=Tk.IteratorPrototype,EB=na,CB=Qa,IB=ia,RB=Ju,OB=function(){return this},Ek=function(e,t,r,n){var i=t+" Iterator";return e.prototype=EB(TB,{next:CB(+!n,r)}),IB(e,i,!1),RB[i]=OB,e},AB=lt,PB=Pt,Ck=ju,MB=Mt,NB=Ek,Fb=Sf,Bb=go,xB=ia,LB=gi,Md=br,jB=It,UB=Ju,Ik=Tk,DB=Ck.PROPER,FB=Ck.CONFIGURABLE,qb=Ik.IteratorPrototype,Il=Ik.BUGGY_SAFARI_ITERATORS,Uo=jB("iterator"),Hb="keys",Do="values",Wb="entries",BB=function(){return this},Zv=function(e,t,r,n,i,a,s){NB(r,t,n);var u=function(D){if(D===i&&_)return _;if(!Il&&D in d)return d[D];switch(D){case Hb:return function(){return new r(this,D)};case Do:return function(){return new r(this,D)};case Wb:return function(){return new r(this,D)}}return function(){return new r(this)}},o=t+" Iterator",c=!1,d=e.prototype,y=d[Uo]||d["@@iterator"]||i&&d[i],_=!Il&&y||u(i),b=t=="Array"&&d.entries||y,T,x,N;if(b&&(T=Fb(b.call(new e)),T!==Object.prototype&&T.next&&(Fb(T)!==qb&&(Bb?Bb(T,qb):MB(T[Uo])||Md(T,Uo,BB)),xB(T,o,!0))),DB&&i==Do&&y&&y.name!==Do&&(FB?LB(d,"name",Do):(c=!0,_=function(){return PB(y,this)})),i)if(x={values:u(Do),keys:a?_:u(Hb),entries:u(Wb)},s)for(N in x)(Il||c||!(N in d))&&Md(d,N,x[N]);else AB({target:t,proto:!0,forced:Il||c},x);return d[Uo]!==_&&Md(d,Uo,_,{name:i}),UB[t]=_,x},eg=function(e,t){return{value:e,done:t}},qB=Xv.charAt,HB=dr,Rk=dn,WB=Zv,Gb=eg,Ok="String Iterator",GB=Rk.set,zB=Rk.getterFor(Ok);WB(String,"String",function(e){GB(this,{type:Ok,string:HB(e),index:0})},function(){var t=zB(this),r=t.string,n=t.index,i;return n>=r.length?Gb(void 0,!0):(i=qB(r,n),t.index+=i.length,Gb(i,!1))});var mo={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.log=r()})(Tn,function(){var t=function(){},r="undefined",n=typeof window!==r&&typeof window.navigator!==r&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function a(x,N){var D=x[N];if(typeof D.bind=="function")return D.bind(x);try{return Function.prototype.bind.call(D,x)}catch{return function(){return Function.prototype.apply.apply(D,[x,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function u(x){return x==="debug"&&(x="log"),typeof console===r?!1:x==="trace"&&n?s:console[x]!==void 0?a(console,x):console.log!==void 0?a(console,"log"):t}function o(x,N){for(var D=0;D<i.length;D++){var H=i[D];this[H]=D<x?t:this.methodFactory(H,x,N)}this.log=this.debug}function c(x,N,D){return function(){typeof console!==r&&(o.call(this,N,D),this[x].apply(this,arguments))}}function d(x,N,D){return u(x)||c.apply(this,arguments)}function y(x,N,D){var H=this,ve;N=N==null?"WARN":N;var ae="loglevel";typeof x=="string"?ae+=":"+x:typeof x=="symbol"&&(ae=void 0);function Ae(oe){var B=(i[oe]||"silent").toUpperCase();if(!(typeof window===r||!ae)){try{window.localStorage[ae]=B;return}catch{}try{window.document.cookie=encodeURIComponent(ae)+"="+B+";"}catch{}}}function Re(){var oe;if(!(typeof window===r||!ae)){try{oe=window.localStorage[ae]}catch{}if(typeof oe===r)try{var B=window.document.cookie,ke=B.indexOf(encodeURIComponent(ae)+"=");ke!==-1&&(oe=/^([^;]+)/.exec(B.slice(ke))[1])}catch{}return H.levels[oe]===void 0&&(oe=void 0),oe}}function Ie(){if(!(typeof window===r||!ae)){try{window.localStorage.removeItem(ae);return}catch{}try{window.document.cookie=encodeURIComponent(ae)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}H.name=x,H.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},H.methodFactory=D||d,H.getLevel=function(){return ve},H.setLevel=function(oe,B){if(typeof oe=="string"&&H.levels[oe.toUpperCase()]!==void 0&&(oe=H.levels[oe.toUpperCase()]),typeof oe=="number"&&oe>=0&&oe<=H.levels.SILENT){if(ve=oe,B!==!1&&Ae(oe),o.call(H,oe,x),typeof console===r&&oe<H.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+oe},H.setDefaultLevel=function(oe){N=oe,Re()||H.setLevel(oe,!1)},H.resetLevel=function(){H.setLevel(N,!1),Ie()},H.enableAll=function(oe){H.setLevel(H.levels.TRACE,oe)},H.disableAll=function(oe){H.setLevel(H.levels.SILENT,oe)};var L=Re();L==null&&(L=N),H.setLevel(L,!1)}var _=new y,b={};_.getLogger=function(N){if(typeof N!="symbol"&&typeof N!="string"||N==="")throw new TypeError("You must supply a name when creating a logger.");var D=b[N];return D||(D=b[N]=new y(N,_.getLevel(),_.methodFactory)),D};var T=typeof window!==r?window.log:void 0;return _.noConflict=function(){return typeof window!==r&&window.log===_&&(window.log=T),_},_.getLoggers=function(){return b},_.default=_,_})})(mo);const Ha="\\d+(?:[\\.,]\\d+)?",VB=`(${Ha}W)`,KB=`(${Ha}Y)?(${Ha}M)?(${Ha}D)?`,JB=`T(${Ha}H)?(${Ha}M)?(${Ha}S)?`,YB=`P(?:${VB}|${KB}(?:${JB})?)`,QB=["weeks","years","months","days","hours","minutes","seconds"],tg=new RegExp(YB),Ak=e=>e.match(tg).slice(1).reduce((t,r,n)=>(t[QB[n]]=parseFloat(r)||0,t),{}),rg=(e,t)=>{const r=t?t.getTime():Date.now(),n=new Date(r);return n.setFullYear(n.getFullYear()+e.years),n.setMonth(n.getMonth()+e.months),n.setDate(n.getDate()+e.days),n.setHours(n.getHours()+e.hours),n.setMinutes(n.getMinutes()+e.minutes),n.setMilliseconds(n.getMilliseconds()+e.seconds*1e3),n.setDate(n.getDate()+e.weeks*7),n},Pk=(e,t)=>{const r=t?t.getTime():Date.now(),n=new Date(r);return(rg(e,n).getTime()-n.getTime())/1e3},XB={end:rg,toSeconds:Pk,pattern:tg,parse:Ak},ZB=Object.freeze(Object.defineProperty({__proto__:null,pattern:tg,parse:Ak,end:rg,toSeconds:Pk,default:XB},Symbol.toStringTag,{value:"Module"})),e4=QP(ZB);var t4=lt,r4=Wr.map,n4=zu,i4=n4("map");t4({target:"Array",proto:!0,forced:!i4},{map:function(t){return r4(this,t,arguments.length>1?arguments[1]:void 0)}});var a4=It,s4=na,o4=Xt.f,gh=a4("unscopables"),yh=Array.prototype;yh[gh]==null&&o4(yh,gh,{configurable:!0,value:s4(null)});var ng=function(e){yh[gh][e]=!0},u4=Hr,ig=ng,zb=Ju,Mk=dn,l4=Xt.f,c4=Zv,Rl=eg,f4=qt,Nk="Array Iterator",d4=Mk.set,p4=Mk.getterFor(Nk),xk=c4(Array,"Array",function(e,t){d4(this,{type:Nk,target:u4(e),index:0,kind:t})},function(){var e=p4(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Rl(void 0,!0)):r=="keys"?Rl(n,!1):r=="values"?Rl(t[n],!1):Rl([n,t[n]],!1)},"values"),Vb=zb.Arguments=zb.Array;ig("keys");ig("values");ig("entries");if(f4&&Vb.name!=="values")try{l4(Vb,"name",{value:"values"})}catch{}var Kb=ct,Lk=vk,h4=gk,Zo=xk,Nd=gi,jk=It,xd=jk("iterator"),Jb=jk("toStringTag"),Ld=Zo.values,Uk=function(e,t){if(e){if(e[xd]!==Ld)try{Nd(e,xd,Ld)}catch{e[xd]=Ld}if(e[Jb]||Nd(e,Jb,t),Lk[t]){for(var r in Zo)if(e[r]!==Zo[r])try{Nd(e,r,Zo[r])}catch{e[r]=Zo[r]}}}};for(var jd in Lk)Uk(Kb[jd]&&Kb[jd].prototype,jd);Uk(h4,"DOMTokenList");var v4=Zt,Dk=function(){var e=v4(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},ag=nt,g4=ct,sg=g4.RegExp,og=ag(function(){var e=sg("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),y4=og||ag(function(){return!sg("a","y").sticky}),m4=og||ag(function(){var e=sg("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),Fk={BROKEN_CARET:m4,MISSED_STICKY:y4,UNSUPPORTED_Y:og},b4=nt,w4=ct,_4=w4.RegExp,S4=b4(function(){var e=_4(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),$4=nt,k4=ct,T4=k4.RegExp,E4=$4(function(){var e=T4("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),js=Pt,$f=Ze,C4=dr,I4=Dk,R4=Fk,O4=rs.exports,A4=na,P4=dn.get,M4=S4,N4=E4,x4=O4("native-string-replace",String.prototype.replace),kc=RegExp.prototype.exec,mh=kc,L4=$f("".charAt),j4=$f("".indexOf),U4=$f("".replace),Ud=$f("".slice),bh=function(){var e=/a/,t=/b*/g;return js(kc,e,"a"),js(kc,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),Bk=R4.BROKEN_CARET,wh=/()??/.exec("")[1]!==void 0,D4=bh||wh||Bk||M4||N4;D4&&(mh=function(t){var r=this,n=P4(r),i=C4(t),a=n.raw,s,u,o,c,d,y,_;if(a)return a.lastIndex=r.lastIndex,s=js(mh,a,i),r.lastIndex=a.lastIndex,s;var b=n.groups,T=Bk&&r.sticky,x=js(I4,r),N=r.source,D=0,H=i;if(T&&(x=U4(x,"y",""),j4(x,"g")===-1&&(x+="g"),H=Ud(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&L4(i,r.lastIndex-1)!==`
`)&&(N="(?: "+N+")",H=" "+H,D++),u=new RegExp("^(?:"+N+")",x)),wh&&(u=new RegExp("^"+N+"$(?!\\s)",x)),bh&&(o=r.lastIndex),c=js(kc,T?u:r,H),T?c?(c.input=Ud(c.input,D),c[0]=Ud(c[0],D),c.index=r.lastIndex,r.lastIndex+=c[0].length):r.lastIndex=0:bh&&c&&(r.lastIndex=r.global?c.index+c[0].length:o),wh&&c&&c.length>1&&js(x4,c[0],u,function(){for(d=1;d<arguments.length-2;d++)arguments[d]===void 0&&(c[d]=void 0)}),c&&b)for(c.groups=y=A4(null),d=0;d<b.length;d++)_=b[d],y[_[0]]=c[_[1]];return c});var kf=mh,F4=lt,Yb=kf;F4({target:"RegExp",proto:!0,forced:/./.exec!==Yb},{exec:Yb});var Qb=Ze,Xb=br,B4=kf,Zb=nt,qk=It,q4=gi,H4=qk("species"),Dd=RegExp.prototype,Tf=function(e,t,r,n){var i=qk(e),a=!Zb(function(){var c={};return c[i]=function(){return 7},""[e](c)!=7}),s=a&&!Zb(function(){var c=!1,d=/a/;return e==="split"&&(d={},d.constructor={},d.constructor[H4]=function(){return d},d.flags="",d[i]=/./[i]),d.exec=function(){return c=!0,null},d[i](""),!c});if(!a||!s||r){var u=Qb(/./[i]),o=t(i,""[e],function(c,d,y,_,b){var T=Qb(c),x=d.exec;return x===B4||x===Dd.exec?a&&!b?{done:!0,value:u(d,y,_)}:{done:!0,value:T(y,d,_)}:{done:!1}});Xb(String.prototype,e,o[0]),Xb(Dd,i,o[1])}n&&q4(Dd[i],"sham",!0)},W4=Xv.charAt,ug=function(e,t,r){return t+(r?W4(e,t).length:1)},lg=Ze,G4=mr,z4=Math.floor,Fd=lg("".charAt),V4=lg("".replace),Bd=lg("".slice),K4=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,J4=/\$([$&'`]|\d{1,2})/g,Y4=function(e,t,r,n,i,a){var s=r+e.length,u=n.length,o=J4;return i!==void 0&&(i=G4(i),o=K4),V4(a,o,function(c,d){var y;switch(Fd(d,0)){case"$":return"$";case"&":return e;case"`":return Bd(t,0,r);case"'":return Bd(t,s);case"<":y=i[Bd(d,1,-1)];break;default:var _=+d;if(_===0)return c;if(_>u){var b=z4(_/10);return b===0?c:b<=u?n[b-1]===void 0?Fd(d,1):n[b-1]+Fd(d,1):c}y=n[_-1]}return y===void 0?"":y})},ew=Pt,Q4=Zt,X4=Mt,Z4=ea,e5=kf,t5=TypeError,Ef=function(e,t){var r=e.exec;if(X4(r)){var n=ew(r,e,t);return n!==null&&Q4(n),n}if(Z4(e)==="RegExp")return ew(e5,e,t);throw t5("RegExp#exec called on incompatible receiver")},r5=ra,tw=Pt,Cf=Ze,n5=Tf,i5=nt,a5=Zt,s5=Mt,o5=zn,u5=yi,l5=mi,ws=dr,c5=Vn,f5=ug,d5=ts,p5=Y4,h5=Ef,v5=It,_h=v5("replace"),g5=Math.max,y5=Math.min,m5=Cf([].concat),qd=Cf([].push),rw=Cf("".indexOf),nw=Cf("".slice),b5=function(e){return e===void 0?e:String(e)},w5=function(){return"a".replace(/./,"$0")==="$0"}(),iw=function(){return/./[_h]?/./[_h]("a","$0")==="":!1}(),_5=!i5(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});n5("replace",function(e,t,r){var n=iw?"$":"$0";return[function(a,s){var u=c5(this),o=o5(a)?void 0:d5(a,_h);return o?tw(o,a,u,s):tw(t,ws(u),a,s)},function(i,a){var s=a5(this),u=ws(i);if(typeof a=="string"&&rw(a,n)===-1&&rw(a,"$<")===-1){var o=r(t,s,u,a);if(o.done)return o.value}var c=s5(a);c||(a=ws(a));var d=s.global;if(d){var y=s.unicode;s.lastIndex=0}for(var _=[];;){var b=h5(s,u);if(b===null||(qd(_,b),!d))break;var T=ws(b[0]);T===""&&(s.lastIndex=f5(u,l5(s.lastIndex),y))}for(var x="",N=0,D=0;D<_.length;D++){b=_[D];for(var H=ws(b[0]),ve=g5(y5(u5(b.index),u.length),0),ae=[],Ae=1;Ae<b.length;Ae++)qd(ae,b5(b[Ae]));var Re=b.groups;if(c){var Ie=m5([H],ae,ve,u);Re!==void 0&&qd(Ie,Re);var L=ws(r5(a,void 0,Ie))}else L=p5(H,u,ve,ae,Re,a);ve>=N&&(x+=nw(u,N,ve)+L,N=ve+H.length)}return x+nw(u,N)}]},!_5||!w5||iw);var S5=lt,$5=Ze,k5=Nu,T5=Hr,E5=Qu,C5=$5([].join),I5=k5!=Object,R5=E5("join",",");S5({target:"Array",proto:!0,forced:I5||!R5},{join:function(t){return C5(T5(this),t===void 0?",":t)}});var ar={},O5=lt,aw=Hu,A5=lf,P5=zt,sw=ns,M5=wr,N5=Hr,x5=ho,L5=It,j5=zu,U5=po,D5=j5("slice"),F5=L5("species"),Hd=Array,B5=Math.max;O5({target:"Array",proto:!0,forced:!D5},{slice:function(t,r){var n=N5(this),i=M5(n),a=sw(t,i),s=sw(r===void 0?i:r,i),u,o,c;if(aw(n)&&(u=n.constructor,A5(u)&&(u===Hd||aw(u.prototype))?u=void 0:P5(u)&&(u=u[F5],u===null&&(u=void 0)),u===Hd||u===void 0))return U5(n,a,s);for(o=new(u===void 0?Hd:u)(B5(s-a,0)),c=0;a<s;a++,c++)a in n&&x5(o,c,n[a]);return o.length=c,o}});var q5=lt,H5=qt,W5=ct,Ol=Ze,G5=Vt,z5=Mt,V5=vi,K5=dr,J5=Xt.f,Y5=s0,ii=W5.Symbol,ka=ii&&ii.prototype;if(H5&&z5(ii)&&(!("description"in ka)||ii().description!==void 0)){var ow={},Al=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:K5(arguments[0]),r=V5(ka,this)?new ii(t):t===void 0?ii():ii(t);return t===""&&(ow[r]=!0),r};Y5(Al,ii),Al.prototype=ka,ka.constructor=Al;var Q5=String(ii("test"))=="Symbol(test)",X5=Ol(ka.valueOf),Z5=Ol(ka.toString),e6=/^Symbol\((.*)\)[^)]+$/,t6=Ol("".replace),r6=Ol("".slice);J5(ka,"description",{configurable:!0,get:function(){var t=X5(this);if(G5(ow,t))return"";var r=Z5(t),n=Q5?r6(r,7,-1):t6(r,e6,"$1");return n===""?void 0:n}}),q5({global:!0,constructor:!0,forced:!0},{Symbol:Al})}var n6=k0;n6("iterator");var i6=qt,a6=ju.EXISTS,Hk=Ze,s6=Xt.f,Wk=Function.prototype,o6=Hk(Wk.toString),Gk=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u6=Hk(Gk.exec),l6="name";i6&&!a6&&s6(Wk,l6,{configurable:!0,get:function(){try{return u6(Gk,o6(this))[1]}catch{return""}}});var c6=zt,f6=Math.floor,zk=Number.isInteger||function(t){return!c6(t)&&isFinite(t)&&f6(t)===t},d6=lt,p6=zk;d6({target:"Number",stat:!0},{isInteger:p6});var Zu={exports:{}},Vk={exports:{}};(function(e){function t(r){if(Array.isArray(r))return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Vk);var Kk={exports:{}};(function(e){function t(r,n){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var a=[],s=!0,u=!1,o,c;try{for(i=i.call(r);!(s=(o=i.next()).done)&&(a.push(o.value),!(n&&a.length===n));s=!0);}catch(d){u=!0,c=d}finally{try{!s&&i.return!=null&&i.return()}finally{if(u)throw c}}return a}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Kk);var cg={exports:{}},fg={exports:{}};(function(e){function t(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,a=new Array(n);i<n;i++)a[i]=r[i];return a}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(fg);(function(e){var t=fg.exports;function r(n,i){if(!!n){if(typeof n=="string")return t(n,i);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(n,i)}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(cg);var Jk={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Jk);(function(e){var t=Vk.exports,r=Kk.exports,n=cg.exports,i=Jk.exports;function a(s,u){return t(s)||r(s,u)||n(s,u)||i()}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(Zu);var h6=qt,Yk=Ze,v6=Bu,g6=Hr,y6=Mu.f,m6=Yk(y6),b6=Yk([].push),uw=function(e){return function(t){for(var r=g6(t),n=v6(r),i=n.length,a=0,s=[],u;i>a;)u=n[a++],(!h6||m6(r,u))&&b6(s,e?[u,r[u]]:r[u]);return s}},w6={entries:uw(!0),values:uw(!1)},_6=lt,S6=w6.entries;_6({target:"Object",stat:!0},{entries:function(t){return S6(t)}});var el={exports:{}},Qk={exports:{}};(function(e){var t=fg.exports;function r(n){if(Array.isArray(n))return t(n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Qk);var Xk={exports:{}};(function(e){function t(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Xk);var Zk={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Zk);(function(e){var t=Qk.exports,r=Xk.exports,n=cg.exports,i=Zk.exports;function a(s){return t(s)||r(s)||n(s)||i()}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(el);var $6=lt,k6=of.includes,T6=nt,E6=ng,C6=T6(function(){return!Array(1).includes()});$6({target:"Array",proto:!0,forced:C6},{includes:function(t){return k6(this,t,arguments.length>1?arguments[1]:void 0)}});E6("includes");/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(ar,"__esModule",{value:!0});var I6=ua.exports,R6=Zu.exports,O6=el.exports,A6=ca.exports,P6=sa.exports,M6=oa.exports,N6=Kn.exports;function ss(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Ws=ss(I6),za=ss(R6),Wd=ss(O6),x6=ss(A6),L6=ss(P6),j6=ss(M6),lw=ss(N6),fa=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function U6(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=D6(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function D6(e,t){if(!!e){if(typeof e=="string")return cw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cw(e,t)}}function cw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var e1=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return fa(function(i){var a=!1,s=[],u=U6(r),o;try{for(u.s();!(o=u.n()).done;){var c=o.value;if(typeof c=="string"){a=a||Ws.default(i)===c,s.push("of type ".concat(c));continue}a=a||i instanceof c,s.push("an instance of ".concat(c.name))}}catch(d){u.e(d)}finally{u.f()}return[a,s]})};function F6(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=B6(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function B6(e,t){if(!!e){if(typeof e=="string")return fw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fw(e,t)}}function fw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var q6=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return fa(function(i){var a=!1,s=[],u=F6(r),o;try{for(u.s();!(o=u.n()).done;){var c=o.value;a=a||i===c,s.push(typeof c=="string"?'"'.concat(c,'"'):"".concat(c))}}catch(d){u.e(d)}finally{u.f()}return[a,s]})},H6=fa(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),W6=fa(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),G6=fa(function(e){return[Ws.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]});function z6(e){var t=V6();return function(){var n=lw.default(e),i;if(t){var a=lw.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return j6.default(this,i)}}function V6(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cu(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=K6(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function K6(e,t){if(!!e){if(typeof e=="string")return dw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dw(e,t)}}function dw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var If=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=Cu(r.entries()),i;try{for(n.s();!(i=n.n()).done;){var a=za.default(i.value,2),s=a[0],u=a[1],o=hg(t[s],u),c=za.default(o,4),d=c[0],y=c[1],_=c[2],b=c[3];if(!d){var T=s+1;throw new Error("Argument ".concat(T," is expected to be ").concat(_).concat(b," but got ").concat(y))}}}catch(x){n.e(x)}finally{n.f()}},t1=function(t){var r,n,i=["undefined","boolean","number","bigint","string"];if(i.includes(Ws.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),Ws.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var a;n=t===null?"null":"instance of ".concat(t==null||(a=t.constructor)===null||a===void 0?void 0:a.name)}return n||(n=Ws.default(t)),n},J6=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=dg(r);return function(a){return function(s){L6.default(o,s);var u=z6(o);function o(){x6.default(this,o);for(var c=arguments.length,d=new Array(c),y=0;y<c;y++)d[y]=arguments[y];return If(i,d),u.call.apply(u,[this].concat(d))}return o}(a)}},Y6=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=dg(r);return function(a,s,u){if(typeof u.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var o=u.value;u.value=function(){for(var c=arguments.length,d=new Array(c),y=0;y<c;y++)d[y]=arguments[y];return If(i,d),o.apply(this,d)}}},Q6=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=dg(r);return function(a,s,u){if(typeof u.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var o=u.value;u.value=function(){for(var c=arguments.length,d=new Array(c),y=0;y<c;y++)d[y]=arguments[y];try{If(i,d)}catch(_){return Promise.reject(_)}return o.apply(this,d)}}},dg=function(t){var r=[],n=Cu(t),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;r.push(pg(a))}}catch(s){n.e(s)}finally{n.f()}return r},pg=function(t){var r=[],n=Array.isArray(t)?t:[t],i=Cu(n),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;if(typeof s=="string"||typeof s=="function"){r.push(e1(s));continue}r.push(s)}}catch(u){i.e(u)}finally{i.f()}return r},hg=function(t,r){var n=[],i,a=!1,s=Cu(t),u;try{for(s.s();!(u=s.n()).done;){var o=u.value,c=Cu(o.checks),d;try{for(c.s();!(d=c.n()).done;){var y=d.value,_=y(r),b=za.default(_,3),T=b[0],x=b[1],N=b[2];a=a||T,!i&&N&&(i=N),x&&(n=typeof x=="string"?[].concat(Wd.default(n),[x]):[].concat(Wd.default(n),Wd.default(x)))}}catch(ae){c.e(ae)}finally{c.f()}}}catch(ae){s.e(ae)}finally{s.f()}if(a)return[!0];var D=i||t1(r),H=n.length-1,ve=H>0?"".concat(n.slice(0,H).join(", ")," or ").concat(n[H]):n.join(", ");return[!1,D,ve,H>1?";":","]},X6=function(t,r){return fa(function(n){if(Ws.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var i=0,a=Object.entries(r);i<a.length;i++){var s=za.default(a[i],2),u=s[0],o=s[1],c=hg(pg(o),n[u]),d=za.default(c,3),y=d[0],_=d[1],b=d[2];if(!y)return[!1,"valid ".concat(t,' (key "').concat(u,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(u,'" is ').concat(_,")")]}return[!0]})};function Z6(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=e8(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function e8(e,t){if(!!e){if(typeof e=="string")return pw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pw(e,t)}}function pw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var t8=function(t,r){return fa(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var i=Z6(n.entries()),a;try{for(i.s();!(a=i.n()).done;){var s=za.default(a.value,2),u=s[0],o=s[1],c=hg(pg(r),o),d=za.default(c,3),y=d[0],_=d[1],b=d[2];if(!y)return[!1,"a valid array of ".concat(t," (index ").concat(u," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(u," is ").concat(_,")")]}}catch(T){i.e(T)}finally{i.f()}return[!0]})};ar.array=t8;ar.custom=fa;ar.literal=q6;ar.nonEmptyString=H6;ar.nonNegativeInteger=W6;ar.objectSchema=X6;ar.pureObject=G6;ar.runtimeTypeValidation=If;ar.stringifyReceivedType=t1;ar.type=e1;ar.validateConstructorTypes=J6;ar.validateTypes=Y6;ar.validateTypesAsync=Q6;var vg={},Rf={exports:{}},r1={exports:{}};(function(e){var t=Kn.exports;function r(n,i){for(;!Object.prototype.hasOwnProperty.call(n,i)&&(n=t(n),n!==null););return n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(r1);(function(e){var t=r1.exports;function r(){return typeof Reflect<"u"&&Reflect.get?(e.exports=r=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=r=function(i,a,s){var u=t(i,a);if(!!u){var o=Object.getOwnPropertyDescriptor(u,a);return o.get?o.get.call(arguments.length<3?i:s):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),r.apply(this,arguments)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Rf);/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/Object.defineProperty(vg,"__esModule",{value:!0});var r8=el.exports,n8=ca.exports,i8=is.exports,a8=aa.exports,s8=Rf.exports,o8=sa.exports,u8=oa.exports,l8=Kn.exports,c8=la.exports;function _i(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var f8=_i(r8),d8=_i(n8),p8=_i(i8),h8=_i(a8),_s=_i(s8),v8=_i(o8),g8=_i(u8),Ui=_i(l8),y8=_i(c8),m8;function Vi(){}Vi.prototype=Object.create(null);function At(){At.init.call(this)}At.EventEmitter=At;At.usingDomains=!1;At.prototype.domain=void 0;At.prototype._events=void 0;At.prototype._maxListeners=void 0;At.defaultMaxListeners=10;At.init=function(){this.domain=null,At.usingDomains&&m8.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Vi,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};At.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function n1(e){return e._maxListeners===void 0?At.defaultMaxListeners:e._maxListeners}At.prototype.getMaxListeners=function(){return n1(this)};function b8(e,t,r){if(t)e.call(r);else for(var n=e.length,i=tl(e,n),a=0;a<n;++a)i[a].call(r)}function w8(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,a=tl(e,i),s=0;s<i;++s)a[s].call(r,n)}function _8(e,t,r,n,i){if(t)e.call(r,n,i);else for(var a=e.length,s=tl(e,a),u=0;u<a;++u)s[u].call(r,n,i)}function S8(e,t,r,n,i,a){if(t)e.call(r,n,i,a);else for(var s=e.length,u=tl(e,s),o=0;o<s;++o)u[o].call(r,n,i,a)}function $8(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,a=tl(e,i),s=0;s<i;++s)a[s].apply(r,n)}At.prototype.emit=function(t){var r,n,i,a,s,u,o,c=t==="error";if(u=this._events,u)c=c&&u.error==null;else if(!c)return!1;if(o=this.domain,c){if(r=arguments[1],o)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=o,r.domainThrown=!1,o.emit("error",r);else{if(r instanceof Error)throw r;var d=new Error('Uncaught, unspecified "error" event. ('+r+")");throw d.context=r,d}return!1}if(n=u[t],!n)return!1;var y=typeof n=="function";switch(i=arguments.length,i){case 1:b8(n,y,this);break;case 2:w8(n,y,this,arguments[1]);break;case 3:_8(n,y,this,arguments[1],arguments[2]);break;case 4:S8(n,y,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),s=1;s<i;s++)a[s-1]=arguments[s];$8(n,y,this,a)}return!0};function i1(e,t,r,n){var i,a,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=e._events,a?(a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]):(a=e._events=new Vi,e._eventsCount=0),!s)s=a[t]=r,++e._eventsCount;else if(typeof s=="function"?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=n1(e),i&&i>0&&s.length>i)){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,k8(u)}return e}function k8(e){typeof console.warn=="function"?console.warn(e):console.log(e)}At.prototype.addListener=function(t,r){return i1(this,t,r,!1)};At.prototype.on=At.prototype.addListener;At.prototype.prependListener=function(t,r){return i1(this,t,r,!0)};function a1(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}At.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,a1(this,t,r)),this};At.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,a1(this,t,r)),this};At.prototype.removeListener=function(t,r){var n,i,a,s,u;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new Vi:(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(a=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){u=n[s].listener,a=s;break}if(a<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new Vi,this;delete i[t]}else T8(n,a);i.removeListener&&this.emit("removeListener",t,u||r)}return this};At.prototype.off=function(e,t){return this.removeListener(e,t)};At.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new Vi,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new Vi:delete n[t]),this;if(arguments.length===0){for(var i=Object.keys(n),a=0,s;a<i.length;++a)s=i[a],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new Vi,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};At.prototype.listeners=function(t){var r,n,i=this._events;return i?(r=i[t],r?typeof r=="function"?n=[r.listener||r]:n=E8(r):n=[]):n=[],n};At.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):s1.call(e,t)};At.prototype.listenerCount=s1;function s1(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}At.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function T8(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function tl(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function E8(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function C8(e){var t=I8();return function(){var n=Ui.default(e),i;if(t){var a=Ui.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return g8.default(this,i)}}function I8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var R8=function(e){v8.default(r,e);var t=C8(r);function r(){var n;return d8.default(this,r),n=t.call(this),y8.default(h8.default(n),"eventHistory",new Map),n}return p8.default(r,[{key:"on",value:function(i,a){return _s.default(Ui.default(r.prototype),"on",this).call(this,i,a)}},{key:"once",value:function(i,a){return _s.default(Ui.default(r.prototype),"once",this).call(this,i,a)}},{key:"off",value:function(i,a){return _s.default(Ui.default(r.prototype),"off",this).call(this,i,a)}},{key:"emit",value:function(i){for(var a,s=arguments.length,u=new Array(s>1?s-1:0),o=1;o<s;o++)u[o-1]=arguments[o];return this.eventHistory.set(i,u),(a=_s.default(Ui.default(r.prototype),"emit",this)).call.apply(a,[this,i].concat(u))}},{key:"addListener",value:function(i,a){return _s.default(Ui.default(r.prototype),"addListener",this).call(this,i,a)}},{key:"removeListener",value:function(i,a){return _s.default(Ui.default(r.prototype),"removeListener",this).call(this,i,a)}},{key:"addListenerWithReplay",value:function(i,a){var s=this.eventHistory.get(i);return s!==void 0&&a.apply(void 0,f8.default(s)),this.addListener(i,a)}},{key:"onWithReplay",value:function(i,a){return this.addListenerWithReplay(i,a)}}]),r}(At);vg.ReplayEventEmitter=R8;var Sh={exports:{}};(function(e,t){var r=200,n="__lodash_hash_undefined__",i=1,a=2,s=9007199254740991,u="[object Arguments]",o="[object Array]",c="[object AsyncFunction]",d="[object Boolean]",y="[object Date]",_="[object Error]",b="[object Function]",T="[object GeneratorFunction]",x="[object Map]",N="[object Number]",D="[object Null]",H="[object Object]",ve="[object Promise]",ae="[object Proxy]",Ae="[object RegExp]",Re="[object Set]",Ie="[object String]",L="[object Symbol]",oe="[object Undefined]",B="[object WeakMap]",ke="[object ArrayBuffer]",Se="[object DataView]",se="[object Float32Array]",ee="[object Float64Array]",ne="[object Int8Array]",te="[object Int16Array]",me="[object Int32Array]",A="[object Uint8Array]",Ne="[object Uint8ClampedArray]",ft="[object Uint16Array]",ze="[object Uint32Array]",le=/[\\^$.*+?()[\]{}|]/g,G=/^\[object .+?Constructor\]$/,J=/^(?:0|[1-9]\d*)$/,k={};k[se]=k[ee]=k[ne]=k[te]=k[me]=k[A]=k[Ne]=k[ft]=k[ze]=!0,k[u]=k[o]=k[ke]=k[d]=k[Se]=k[y]=k[_]=k[b]=k[x]=k[N]=k[H]=k[Ae]=k[Re]=k[Ie]=k[B]=!1;var C=typeof Tn=="object"&&Tn&&Tn.Object===Object&&Tn,X=typeof self=="object"&&self&&self.Object===Object&&self,Z=C||X||Function("return this")(),$e=t&&!t.nodeType&&t,De=$e&&!0&&e&&!e.nodeType&&e,ue=De&&De.exports===$e,Te=ue&&C.process,E=function(){try{return Te&&Te.binding&&Te.binding("util")}catch{}}(),$=E&&E.isTypedArray;function q(O,V){for(var fe=-1,Be=O==null?0:O.length,Ft=0,ot=[];++fe<Be;){var Kt=O[fe];V(Kt,fe,O)&&(ot[Ft++]=Kt)}return ot}function P(O,V){for(var fe=-1,Be=V.length,Ft=O.length;++fe<Be;)O[Ft+fe]=V[fe];return O}function U(O,V){for(var fe=-1,Be=O==null?0:O.length;++fe<Be;)if(V(O[fe],fe,O))return!0;return!1}function _e(O,V){for(var fe=-1,Be=Array(O);++fe<O;)Be[fe]=V(fe);return Be}function de(O){return function(V){return O(V)}}function ye(O,V){return O.has(V)}function Ce(O,V){return O==null?void 0:O[V]}function K(O){var V=-1,fe=Array(O.size);return O.forEach(function(Be,Ft){fe[++V]=[Ft,Be]}),fe}function je(O,V){return function(fe){return O(V(fe))}}function Me(O){var V=-1,fe=Array(O.size);return O.forEach(function(Be){fe[++V]=Be}),fe}var Oe=Array.prototype,xe=Function.prototype,Ue=Object.prototype,Le=Z["__core-js_shared__"],Ge=xe.toString,et=Ue.hasOwnProperty,er=function(){var O=/[^.]+$/.exec(Le&&Le.keys&&Le.keys.IE_PROTO||"");return O?"Symbol(src)_1."+O:""}(),_r=Ue.toString,hn=RegExp("^"+Ge.call(et).replace(le,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ir=ue?Z.Buffer:void 0,bt=Z.Symbol,jt=Z.Uint8Array,ie=Ue.propertyIsEnumerable,ce=Oe.splice,Y=bt?bt.toStringTag:void 0,re=Object.getOwnPropertySymbols,Q=Ir?Ir.isBuffer:void 0,he=je(Object.keys,Object),be=Rt(Z,"DataView"),Pe=Rt(Z,"Map"),Xe=Rt(Z,"Promise"),at=Rt(Z,"Set"),tt=Rt(Z,"WeakMap"),Fe=Rt(Object,"create"),Sr=p(be),Je=p(Pe),Wt=p(Xe),Ut=p(at),$i=p(tt),Jn=bt?bt.prototype:void 0,Pn=Jn?Jn.valueOf:void 0;function Et(O){var V=-1,fe=O==null?0:O.length;for(this.clear();++V<fe;){var Be=O[V];this.set(Be[0],Be[1])}}function Dt(){this.__data__=Fe?Fe(null):{},this.size=0}function Lr(O){var V=this.has(O)&&delete this.__data__[O];return this.size-=V?1:0,V}function Rr(O){var V=this.__data__;if(Fe){var fe=V[O];return fe===n?void 0:fe}return et.call(V,O)?V[O]:void 0}function pa(O){var V=this.__data__;return Fe?V[O]!==void 0:et.call(V,O)}function ls(O,V){var fe=this.__data__;return this.size+=this.has(O)?0:1,fe[O]=Fe&&V===void 0?n:V,this}Et.prototype.clear=Dt,Et.prototype.delete=Lr,Et.prototype.get=Rr,Et.prototype.has=pa,Et.prototype.set=ls;function jr(O){var V=-1,fe=O==null?0:O.length;for(this.clear();++V<fe;){var Be=O[V];this.set(Be[0],Be[1])}}function cs(){this.__data__=[],this.size=0}function _o(O){var V=this.__data__,fe=Ti(V,O);if(fe<0)return!1;var Be=V.length-1;return fe==Be?V.pop():ce.call(V,fe,1),--this.size,!0}function So(O){var V=this.__data__,fe=Ti(V,O);return fe<0?void 0:V[fe][1]}function pr(O){return Ti(this.__data__,O)>-1}function vn(O,V){var fe=this.__data__,Be=Ti(fe,O);return Be<0?(++this.size,fe.push([O,V])):fe[Be][1]=V,this}jr.prototype.clear=cs,jr.prototype.delete=_o,jr.prototype.get=So,jr.prototype.has=pr,jr.prototype.set=vn;function Vr(O){var V=-1,fe=O==null?0:O.length;for(this.clear();++V<fe;){var Be=O[V];this.set(Be[0],Be[1])}}function _t(){this.size=0,this.__data__={hash:new Et,map:new(Pe||jr),string:new Et}}function $o(O){var V=Qn(this,O).delete(O);return this.size-=V?1:0,V}function ko(O){return Qn(this,O).get(O)}function To(O){return Qn(this,O).has(O)}function fs(O,V){var fe=Qn(this,O),Be=fe.size;return fe.set(O,V),this.size+=fe.size==Be?0:1,this}Vr.prototype.clear=_t,Vr.prototype.delete=$o,Vr.prototype.get=ko,Vr.prototype.has=To,Vr.prototype.set=fs;function Yn(O){var V=-1,fe=O==null?0:O.length;for(this.__data__=new Vr;++V<fe;)this.add(O[V])}function Eo(O){return this.__data__.set(O,n),this}function Co(O){return this.__data__.has(O)}Yn.prototype.add=Yn.prototype.push=Eo,Yn.prototype.has=Co;function Kr(O){var V=this.__data__=new jr(O);this.size=V.size}function $r(){this.__data__=new jr,this.size=0}function Io(O){var V=this.__data__,fe=V.delete(O);return this.size=V.size,fe}function Ro(O){return this.__data__.get(O)}function Oo(O){return this.__data__.has(O)}function Ao(O,V){var fe=this.__data__;if(fe instanceof jr){var Be=fe.__data__;if(!Pe||Be.length<r-1)return Be.push([O,V]),this.size=++fe.size,this;fe=this.__data__=new Vr(Be)}return fe.set(O,V),this.size=fe.size,this}Kr.prototype.clear=$r,Kr.prototype.delete=Io,Kr.prototype.get=Ro,Kr.prototype.has=Oo,Kr.prototype.set=Ao;function ki(O,V){var fe=h(O),Be=!fe&&g(O),Ft=!fe&&!Be&&S(O),ot=!fe&&!Be&&!Ft&&it(O),Kt=fe||Be||Ft||ot,sr=Kt?_e(O.length,String):[],cr=sr.length;for(var Gt in O)(V||et.call(O,Gt))&&!(Kt&&(Gt=="length"||Ft&&(Gt=="offset"||Gt=="parent")||ot&&(Gt=="buffer"||Gt=="byteLength"||Gt=="byteOffset")||I(Gt,cr)))&&sr.push(Gt);return sr}function Ti(O,V){for(var fe=O.length;fe--;)if(f(O[fe][0],V))return fe;return-1}function Ei(O,V,fe){var Be=V(O);return h(O)?Be:P(Be,fe(O))}function gn(O){return O==null?O===void 0?oe:D:Y&&Y in Object(O)?Jr(O):l(O)}function ha(O){return qe(O)&&gn(O)==u}function ds(O,V,fe,Be,Ft){return O===V?!0:O==null||V==null||!qe(O)&&!qe(V)?O!==O&&V!==V:ps(O,V,fe,Be,ds,Ft)}function ps(O,V,fe,Be,Ft,ot){var Kt=h(O),sr=h(V),cr=Kt?o:Yr(O),Gt=sr?o:Yr(V);cr=cr==u?H:cr,Gt=Gt==u?H:Gt;var Ur=cr==H,yn=Gt==H,hr=cr==Gt;if(hr&&S(O)){if(!S(V))return!1;Kt=!0,Ur=!1}if(hr&&!Ur)return ot||(ot=new Kr),Kt||it(O)?va(O,V,fe,Be,Ft,ot):hs(O,V,cr,fe,Be,Ft,ot);if(!(fe&i)){var Qr=Ur&&et.call(O,"__wrapped__"),Xr=yn&&et.call(V,"__wrapped__");if(Qr||Xr){var Ii=Qr?O.value():O,Xn=Xr?V.value():V;return ot||(ot=new Kr),Ft(Ii,Xn,fe,Be,ot)}}return hr?(ot||(ot=new Kr),Ci(O,V,fe,Be,Ft,ot)):!1}function Po(O){if(!pe(O)||m(O))return!1;var V=F(O)?hn:G;return V.test(p(O))}function Mo(O){return qe(O)&&z(O.length)&&!!k[gn(O)]}function St(O){if(!v(O))return he(O);var V=[];for(var fe in Object(O))et.call(O,fe)&&fe!="constructor"&&V.push(fe);return V}function va(O,V,fe,Be,Ft,ot){var Kt=fe&i,sr=O.length,cr=V.length;if(sr!=cr&&!(Kt&&cr>sr))return!1;var Gt=ot.get(O);if(Gt&&ot.get(V))return Gt==V;var Ur=-1,yn=!0,hr=fe&a?new Yn:void 0;for(ot.set(O,V),ot.set(V,O);++Ur<sr;){var Qr=O[Ur],Xr=V[Ur];if(Be)var Ii=Kt?Be(Xr,Qr,Ur,V,O,ot):Be(Qr,Xr,Ur,O,V,ot);if(Ii!==void 0){if(Ii)continue;yn=!1;break}if(hr){if(!U(V,function(Xn,ma){if(!ye(hr,ma)&&(Qr===Xn||Ft(Qr,Xn,fe,Be,ot)))return hr.push(ma)})){yn=!1;break}}else if(!(Qr===Xr||Ft(Qr,Xr,fe,Be,ot))){yn=!1;break}}return ot.delete(O),ot.delete(V),yn}function hs(O,V,fe,Be,Ft,ot,Kt){switch(fe){case Se:if(O.byteLength!=V.byteLength||O.byteOffset!=V.byteOffset)return!1;O=O.buffer,V=V.buffer;case ke:return!(O.byteLength!=V.byteLength||!ot(new jt(O),new jt(V)));case d:case y:case N:return f(+O,+V);case _:return O.name==V.name&&O.message==V.message;case Ae:case Ie:return O==V+"";case x:var sr=K;case Re:var cr=Be&i;if(sr||(sr=Me),O.size!=V.size&&!cr)return!1;var Gt=Kt.get(O);if(Gt)return Gt==V;Be|=a,Kt.set(O,V);var Ur=va(sr(O),sr(V),Be,Ft,ot,Kt);return Kt.delete(O),Ur;case L:if(Pn)return Pn.call(O)==Pn.call(V)}return!1}function Ci(O,V,fe,Be,Ft,ot){var Kt=fe&i,sr=ga(O),cr=sr.length,Gt=ga(V),Ur=Gt.length;if(cr!=Ur&&!Kt)return!1;for(var yn=cr;yn--;){var hr=sr[yn];if(!(Kt?hr in V:et.call(V,hr)))return!1}var Qr=ot.get(O);if(Qr&&ot.get(V))return Qr==V;var Xr=!0;ot.set(O,V),ot.set(V,O);for(var Ii=Kt;++yn<cr;){hr=sr[yn];var Xn=O[hr],ma=V[hr];if(Be)var ny=Kt?Be(ma,Xn,hr,V,O,ot):Be(Xn,ma,hr,O,V,ot);if(!(ny===void 0?Xn===ma||Ft(Xn,ma,fe,Be,ot):ny)){Xr=!1;break}Ii||(Ii=hr=="constructor")}if(Xr&&!Ii){var ll=O.constructor,cl=V.constructor;ll!=cl&&"constructor"in O&&"constructor"in V&&!(typeof ll=="function"&&ll instanceof ll&&typeof cl=="function"&&cl instanceof cl)&&(Xr=!1)}return ot.delete(O),ot.delete(V),Xr}function ga(O){return Ei(O,We,ya)}function Qn(O,V){var fe=O.__data__;return M(V)?fe[typeof V=="string"?"string":"hash"]:fe.map}function Rt(O,V){var fe=Ce(O,V);return Po(fe)?fe:void 0}function Jr(O){var V=et.call(O,Y),fe=O[Y];try{O[Y]=void 0;var Be=!0}catch{}var Ft=_r.call(O);return Be&&(V?O[Y]=fe:delete O[Y]),Ft}var ya=re?function(O){return O==null?[]:(O=Object(O),q(re(O),function(V){return ie.call(O,V)}))}:st,Yr=gn;(be&&Yr(new be(new ArrayBuffer(1)))!=Se||Pe&&Yr(new Pe)!=x||Xe&&Yr(Xe.resolve())!=ve||at&&Yr(new at)!=Re||tt&&Yr(new tt)!=B)&&(Yr=function(O){var V=gn(O),fe=V==H?O.constructor:void 0,Be=fe?p(fe):"";if(Be)switch(Be){case Sr:return Se;case Je:return x;case Wt:return ve;case Ut:return Re;case $i:return B}return V});function I(O,V){return V=V==null?s:V,!!V&&(typeof O=="number"||J.test(O))&&O>-1&&O%1==0&&O<V}function M(O){var V=typeof O;return V=="string"||V=="number"||V=="symbol"||V=="boolean"?O!=="__proto__":O===null}function m(O){return!!er&&er in O}function v(O){var V=O&&O.constructor,fe=typeof V=="function"&&V.prototype||Ue;return O===fe}function l(O){return _r.call(O)}function p(O){if(O!=null){try{return Ge.call(O)}catch{}try{return O+""}catch{}}return""}function f(O,V){return O===V||O!==O&&V!==V}var g=ha(function(){return arguments}())?ha:function(O){return qe(O)&&et.call(O,"callee")&&!ie.call(O,"callee")},h=Array.isArray;function w(O){return O!=null&&z(O.length)&&!F(O)}var S=Q||Or;function j(O,V){return ds(O,V)}function F(O){if(!pe(O))return!1;var V=gn(O);return V==b||V==T||V==c||V==ae}function z(O){return typeof O=="number"&&O>-1&&O%1==0&&O<=s}function pe(O){var V=typeof O;return O!=null&&(V=="object"||V=="function")}function qe(O){return O!=null&&typeof O=="object"}var it=$?de($):Mo;function We(O){return w(O)?ki(O):St(O)}function st(){return[]}function Or(){return!1}e.exports=j})(Sh,Sh.exports);var gg={exports:{}},O8=nt,A8=O8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),P8=nt,M8=zt,N8=ea,hw=A8,ac=Object.isExtensible,x8=P8(function(){ac(1)}),L8=x8||hw?function(t){return!M8(t)||hw&&N8(t)=="ArrayBuffer"?!1:ac?ac(t):!0}:ac,j8=nt,U8=!j8(function(){return Object.isExtensible(Object.preventExtensions({}))}),D8=lt,F8=Ze,B8=Uu,q8=zt,yg=Vt,H8=Xt.f,vw=ta,W8=Pv,mg=L8,G8=xu,z8=U8,o1=!1,fi=G8("meta"),V8=0,bg=function(e){H8(e,fi,{value:{objectID:"O"+V8++,weakData:{}}})},K8=function(e,t){if(!q8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!yg(e,fi)){if(!mg(e))return"F";if(!t)return"E";bg(e)}return e[fi].objectID},J8=function(e,t){if(!yg(e,fi)){if(!mg(e))return!0;if(!t)return!1;bg(e)}return e[fi].weakData},Y8=function(e){return z8&&o1&&mg(e)&&!yg(e,fi)&&bg(e),e},Q8=function(){X8.enable=function(){},o1=!0;var e=vw.f,t=F8([].splice),r={};r[fi]=1,e(r).length&&(vw.f=function(n){for(var i=e(n),a=0,s=i.length;a<s;a++)if(i[a]===fi){t(i,a,1);break}return i},D8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:W8.f}))},X8=gg.exports={enable:Q8,fastKey:K8,getWeakData:J8,onFreeze:Y8};B8[fi]=!0;var Z8=lt,eq=ct,tq=Ze,gw=uf,rq=br,nq=gg.exports,iq=wf,aq=as,sq=Mt,oq=zn,Gd=zt,zd=nt,uq=_f,lq=ia,cq=Jv,u1=function(e,t,r){var n=e.indexOf("Map")!==-1,i=e.indexOf("Weak")!==-1,a=n?"set":"add",s=eq[e],u=s&&s.prototype,o=s,c={},d=function(D){var H=tq(u[D]);rq(u,D,D=="add"?function(ae){return H(this,ae===0?0:ae),this}:D=="delete"?function(ve){return i&&!Gd(ve)?!1:H(this,ve===0?0:ve)}:D=="get"?function(ae){return i&&!Gd(ae)?void 0:H(this,ae===0?0:ae)}:D=="has"?function(ae){return i&&!Gd(ae)?!1:H(this,ae===0?0:ae)}:function(ae,Ae){return H(this,ae===0?0:ae,Ae),this})},y=gw(e,!sq(s)||!(i||u.forEach&&!zd(function(){new s().entries().next()})));if(y)o=r.getConstructor(t,e,n,a),nq.enable();else if(gw(e,!0)){var _=new o,b=_[a](i?{}:-0,1)!=_,T=zd(function(){_.has(1)}),x=uq(function(D){new s(D)}),N=!i&&zd(function(){for(var D=new s,H=5;H--;)D[a](H,H);return!D.has(-0)});x||(o=t(function(D,H){aq(D,u);var ve=cq(new s,D,o);return oq(H)||iq(H,ve[a],{that:ve,AS_ENTRIES:n}),ve}),o.prototype=u,u.constructor=o),(T||N)&&(d("delete"),d("has"),n&&d("get")),(N||b)&&d(a),i&&u.clear&&delete u.clear}return c[e]=o,Z8({global:!0,constructor:!0,forced:o!=s},c),lq(o,e),i||r.setStrong(o,e,n),o},fq=br,wg=function(e,t,r){for(var n in t)fq(e,n,t[n],r);return e},dq=Xt.f,pq=na,yw=wg,hq=wi,vq=as,gq=zn,yq=wf,mq=Zv,Pl=eg,bq=gf,Fo=qt,mw=gg.exports.fastKey,l1=dn,bw=l1.set,Vd=l1.getterFor,c1={getConstructor:function(e,t,r,n){var i=e(function(c,d){vq(c,a),bw(c,{type:t,index:pq(null),first:void 0,last:void 0,size:0}),Fo||(c.size=0),gq(d)||yq(d,c[n],{that:c,AS_ENTRIES:r})}),a=i.prototype,s=Vd(t),u=function(c,d,y){var _=s(c),b=o(c,d),T,x;return b?b.value=y:(_.last=b={index:x=mw(d,!0),key:d,value:y,previous:T=_.last,next:void 0,removed:!1},_.first||(_.first=b),T&&(T.next=b),Fo?_.size++:c.size++,x!=="F"&&(_.index[x]=b)),c},o=function(c,d){var y=s(c),_=mw(d),b;if(_!=="F")return y.index[_];for(b=y.first;b;b=b.next)if(b.key==d)return b};return yw(a,{clear:function(){for(var d=this,y=s(d),_=y.index,b=y.first;b;)b.removed=!0,b.previous&&(b.previous=b.previous.next=void 0),delete _[b.index],b=b.next;y.first=y.last=void 0,Fo?y.size=0:d.size=0},delete:function(c){var d=this,y=s(d),_=o(d,c);if(_){var b=_.next,T=_.previous;delete y.index[_.index],_.removed=!0,T&&(T.next=b),b&&(b.previous=T),y.first==_&&(y.first=b),y.last==_&&(y.last=T),Fo?y.size--:d.size--}return!!_},forEach:function(d){for(var y=s(this),_=hq(d,arguments.length>1?arguments[1]:void 0),b;b=b?b.next:y.first;)for(_(b.value,b.key,this);b&&b.removed;)b=b.previous},has:function(d){return!!o(this,d)}}),yw(a,r?{get:function(d){var y=o(this,d);return y&&y.value},set:function(d,y){return u(this,d===0?0:d,y)}}:{add:function(d){return u(this,d=d===0?0:d,d)}}),Fo&&dq(a,"size",{get:function(){return s(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=Vd(t),a=Vd(n);mq(e,t,function(s,u){bw(this,{type:n,target:s,state:i(s),kind:u,last:void 0})},function(){for(var s=a(this),u=s.kind,o=s.last;o&&o.removed;)o=o.previous;return!s.target||!(s.last=o=o?o.next:s.state.first)?(s.target=void 0,Pl(void 0,!0)):u=="keys"?Pl(o.key,!1):u=="values"?Pl(o.value,!1):Pl([o.key,o.value],!1)},r?"entries":"values",!r,!0),bq(t)}},wq=u1,_q=c1;wq("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},_q);var Si={};/*
@license
Copyright (c) 2016, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/Object.defineProperty(Si,"__esModule",{value:!0});var Sq=ca.exports,$q=is.exports,kq=aa.exports,Tq=sa.exports,Eq=oa.exports,Cq=Kn.exports,Iq=la.exports;function os(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var _g=os(Sq),Sg=os($q),si=os(kq),$g=os(Tq),f1=os(Eq),Tc=os(Cq),oi=os(Iq),Rq;function Ki(){}Ki.prototype=Object.create(null);function kt(){kt.init.call(this)}kt.EventEmitter=kt;kt.usingDomains=!1;kt.prototype.domain=void 0;kt.prototype._events=void 0;kt.prototype._maxListeners=void 0;kt.defaultMaxListeners=10;kt.init=function(){this.domain=null,kt.usingDomains&&Rq.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Ki,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};kt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function d1(e){return e._maxListeners===void 0?kt.defaultMaxListeners:e._maxListeners}kt.prototype.getMaxListeners=function(){return d1(this)};function Oq(e,t,r){if(t)e.call(r);else for(var n=e.length,i=rl(e,n),a=0;a<n;++a)i[a].call(r)}function Aq(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,a=rl(e,i),s=0;s<i;++s)a[s].call(r,n)}function Pq(e,t,r,n,i){if(t)e.call(r,n,i);else for(var a=e.length,s=rl(e,a),u=0;u<a;++u)s[u].call(r,n,i)}function Mq(e,t,r,n,i,a){if(t)e.call(r,n,i,a);else for(var s=e.length,u=rl(e,s),o=0;o<s;++o)u[o].call(r,n,i,a)}function Nq(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,a=rl(e,i),s=0;s<i;++s)a[s].apply(r,n)}kt.prototype.emit=function(t){var r,n,i,a,s,u,o,c=t==="error";if(u=this._events,u)c=c&&u.error==null;else if(!c)return!1;if(o=this.domain,c){if(r=arguments[1],o)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=o,r.domainThrown=!1,o.emit("error",r);else{if(r instanceof Error)throw r;var d=new Error('Uncaught, unspecified "error" event. ('+r+")");throw d.context=r,d}return!1}if(n=u[t],!n)return!1;var y=typeof n=="function";switch(i=arguments.length,i){case 1:Oq(n,y,this);break;case 2:Aq(n,y,this,arguments[1]);break;case 3:Pq(n,y,this,arguments[1],arguments[2]);break;case 4:Mq(n,y,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),s=1;s<i;s++)a[s-1]=arguments[s];Nq(n,y,this,a)}return!0};function p1(e,t,r,n){var i,a,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=e._events,a?(a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]):(a=e._events=new Ki,e._eventsCount=0),!s)s=a[t]=r,++e._eventsCount;else if(typeof s=="function"?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=d1(e),i&&i>0&&s.length>i)){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,xq(u)}return e}function xq(e){typeof console.warn=="function"?console.warn(e):console.log(e)}kt.prototype.addListener=function(t,r){return p1(this,t,r,!1)};kt.prototype.on=kt.prototype.addListener;kt.prototype.prependListener=function(t,r){return p1(this,t,r,!0)};function h1(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}kt.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,h1(this,t,r)),this};kt.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,h1(this,t,r)),this};kt.prototype.removeListener=function(t,r){var n,i,a,s,u;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new Ki:(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(a=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){u=n[s].listener,a=s;break}if(a<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new Ki,this;delete i[t]}else Lq(n,a);i.removeListener&&this.emit("removeListener",t,u||r)}return this};kt.prototype.off=function(e,t){return this.removeListener(e,t)};kt.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new Ki,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new Ki:delete n[t]),this;if(arguments.length===0){for(var i=Object.keys(n),a=0,s;a<i.length;++a)s=i[a],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new Ki,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};kt.prototype.listeners=function(t){var r,n,i=this._events;return i?(r=i[t],r?typeof r=="function"?n=[r.listener||r]:n=jq(r):n=[]):n=[],n};kt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):v1.call(e,t)};kt.prototype.listenerCount=v1;function v1(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}kt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function Lq(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function rl(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function jq(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function g1(e){var t=Uq();return function(){var n=Tc.default(e),i;if(t){var a=Tc.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return f1.default(this,i)}}function Uq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var y1=function(e){$g.default(r,e);var t=g1(r);function r(n){var i;return _g.default(this,r),i=t.call(this),oi.default(si.default(i),"timeout",null),oi.default(si.default(i),"startTimestamp",-1),i.minDelay=n.min,i.maxDelay=n.max,i.initialDelay=n.initial||0,i.maxAttemptsCount=n.maxAttemptsCount||0,i.maxAttemptsTime=n.maxAttemptsTime||0,i.randomness=n.randomness||0,i.inProgress=!1,i.attemptNum=0,i.prevDelay=0,i.currDelay=0,i}return Sg.default(r,[{key:"attempt",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.attemptNum++,this.emit("attempt",this)}},{key:"nextDelay",value:function(i){if(typeof i=="number")return this.prevDelay=0,this.currDelay=i,i;if(this.attemptNum==0)return this.initialDelay;if(this.attemptNum==1)return this.currDelay=this.minDelay,this.currDelay;this.prevDelay=this.currDelay;var a=this.currDelay+this.prevDelay;return this.maxDelay&&a>this.maxDelay&&(this.currDelay=this.maxDelay,a=this.maxDelay),this.currDelay=a,a}},{key:"randomize",value:function(i){var a=i*this.randomness,s=Math.round(Math.random()*a*2-a);return Math.max(0,i+s)}},{key:"scheduleAttempt",value:function(i){var a=this;if(this.maxAttemptsCount&&this.attemptNum>=this.maxAttemptsCount){this.cleanup(),this.emit("failed",new Error("Maximum attempt count limit reached"));return}var s=this.nextDelay(i);if(s=this.randomize(s),this.maxAttemptsTime&&this.startTimestamp+this.maxAttemptsTime<Date.now()+s){this.cleanup(),this.emit("failed",new Error("Maximum attempt time limit reached"));return}this.timeout=setTimeout(function(){return a.attempt()},s)}},{key:"cleanup",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0}},{key:"start",value:function(){if(this.inProgress)throw new Error("Retrier is already in progress");this.inProgress=!0,this.startTimestamp=Date.now(),this.scheduleAttempt(this.initialDelay)}},{key:"cancel",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.emit("cancelled"))}},{key:"succeeded",value:function(i){this.emit("succeeded",i)}},{key:"failed",value:function(i,a){if(this.timeout)throw new Error("Retrier attempt is already in progress");this.scheduleAttempt(a)}}]),r}(kt),Dq=function(e){$g.default(r,e);var t=g1(r);function r(n){var i;return _g.default(this,r),i=t.call(this),oi.default(si.default(i),"resolve",function(){}),oi.default(si.default(i),"reject",function(){}),i.retrier=new y1(n),i}return Sg.default(r,[{key:"run",value:function(i){var a=this;return this.retrier.on("attempt",function(){i().then(function(s){return a.retrier.succeeded(s)}).catch(function(s){return a.retrier.failed(s)})}),this.retrier.on("succeeded",function(s){return a.resolve(s)}),this.retrier.on("cancelled",function(){return a.reject(new Error("Cancelled"))}),this.retrier.on("failed",function(s){return a.reject(s)}),new Promise(function(s,u){a.resolve=s,a.reject=u,a.retrier.start()})}},{key:"cancel",value:function(){this.retrier.cancel()}}]),r}(kt);function Fq(e){var t=Bq();return function(){var n=Tc.default(e),i;if(t){var a=Tc.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return f1.default(this,i)}}function Bq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ml(e){return e!=null}var qq=function(e){$g.default(r,e);var t=Fq(r);function r(n){var i;_g.default(this,r),i=t.call(this),oi.default(si.default(i),"backoffDelay",0),oi.default(si.default(i),"nextBackoffDelay",0),oi.default(si.default(i),"backoffNumber",0),oi.default(si.default(i),"timeoutID",null),oi.default(si.default(i),"maxNumberOfRetry",-1),n=n||{};var a=n,s=a.initialDelay,u=a.maxDelay,o=a.randomisationFactor,c=a.factor;if(Ml(s)&&s<1)throw new Error("The initial timeout must be equal to or greater than 1.");if(Ml(u)&&u<=1)throw new Error("The maximal timeout must be greater than 1.");if(Ml(o)&&(o<0||o>1))throw new Error("The randomisation factor must be between 0 and 1.");if(Ml(c)&&c<=1)throw new Error("Exponential factor should be greater than 1.");if(i.initialDelay=s||100,i.maxDelay=u||1e4,i.maxDelay<=i.initialDelay)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");return i.randomisationFactor=o||0,i.factor=c||2,i.reset(),i}return Sg.default(r,[{key:"backoff",value:function(i){this.timeoutID==null&&(this.backoffNumber===this.maxNumberOfRetry?(this.emit("fail",i),this.reset()):(this.backoffDelay=this.next(),this.timeoutID=setTimeout(this.onBackoff.bind(this),this.backoffDelay),this.emit("backoff",this.backoffNumber,this.backoffDelay,i)))}},{key:"reset",value:function(){this.backoffDelay=0,this.nextBackoffDelay=this.initialDelay,this.backoffNumber=0,this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=null}},{key:"failAfter",value:function(i){if(i<=0)throw new Error("Expected a maximum number of retry greater than 0 but got ".concat(i));this.maxNumberOfRetry=i}},{key:"next",value:function(){this.backoffDelay=Math.min(this.nextBackoffDelay,this.maxDelay),this.nextBackoffDelay=this.backoffDelay*this.factor;var i=1+Math.random()*this.randomisationFactor;return Math.min(this.maxDelay,Math.round(this.backoffDelay*i))}},{key:"onBackoff",value:function(){this.timeoutID=null,this.emit("ready",this.backoffNumber,this.backoffDelay),this.backoffNumber++}}],[{key:"exponential",value:function(i){return new r(i)}}]),r}(kt);Si.AsyncRetrier=Dq;Si.Backoff=qq;Si.Retrier=y1;var Of={},Hq=Pt,Wq=Vt,Gq=vi,zq=Dk,ww=RegExp.prototype,Vq=function(e){var t=e.flags;return t===void 0&&!("flags"in ww)&&!Wq(e,"flags")&&Gq(ww,e)?Hq(zq,e):t},Kq=ju.PROPER,Jq=br,Yq=Zt,_w=dr,Qq=nt,Xq=Vq,kg="toString",Zq=RegExp.prototype,m1=Zq[kg],eH=Qq(function(){return m1.call({source:"a",flags:"b"})!="/a/b"}),tH=Kq&&m1.name!=kg;(eH||tH)&&Jq(RegExp.prototype,kg,function(){var t=Yq(this),r=_w(t.source),n=_w(Xq(t));return"/"+r+"/"+n},{unsafe:!0});var rH=u1,nH=c1;rH("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},nH);var b1={exports:{}};(function(e,t){(function(n,i){e.exports=i()})(Tn,function(){return function(r){var n={};function i(a){if(n[a])return n[a].exports;var s=n[a]={i:a,l:!1,exports:{}};return r[a].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=r,i.c=n,i.i=function(a){return a},i.d=function(a,s,u){i.o(a,s)||Object.defineProperty(a,s,{configurable:!1,enumerable:!0,get:u})},i.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(s,"a",s),s},i.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},i.p="",i(i.s=5)}([function(r,n,i){r.exports=function(a,s){var u,o,c;for(u=1;u<arguments.length;u++){o=arguments[u];for(c in o)o.hasOwnProperty(c)&&(a[c]=o[c])}return a}},function(r,n,i){var a=i(0);r.exports={build:function(s,u){var o,c,d,y=u.plugins;for(o=0,c=y.length;o<c;o++)d=y[o],d.methods&&a(s,d.methods),d.properties&&Object.defineProperties(s,d.properties)},hook:function(s,u,o){var c,d,y,_,b=s.config.plugins,T=[s.context];for(o&&(T=T.concat(o)),c=0,d=b.length;c<d;c++)_=b[c],y=b[c][u],y&&y.apply(_,T)}}},function(r,n,i){function a(s){if(s.length===0)return s;var u,o,c=s.split(/[_-]/);if(c.length===1&&c[0][0].toLowerCase()===c[0][0])return s;for(o=c[0].toLowerCase(),u=1;u<c.length;u++)o=o+c[u].charAt(0).toUpperCase()+c[u].substring(1).toLowerCase();return o}a.prepended=function(s,u){return u=a(u),s+u[0].toUpperCase()+u.substring(1)},r.exports=a},function(r,n,i){var a=i(0),s=i(2);function u(o,c){o=o||{},this.options=o,this.defaults=c.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(o.init),this.data=this.configureData(o.data),this.methods=this.configureMethods(o.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(o.transitions||[]),this.plugins=this.configurePlugins(o.plugins,c.plugin)}a(u.prototype,{addState:function(o){this.map[o]||(this.states.push(o),this.addStateLifecycleNames(o),this.map[o]={})},addStateLifecycleNames:function(o){this.lifecycle.onEnter[o]=s.prepended("onEnter",o),this.lifecycle.onLeave[o]=s.prepended("onLeave",o),this.lifecycle.on[o]=s.prepended("on",o)},addTransition:function(o){this.transitions.indexOf(o)<0&&(this.transitions.push(o),this.addTransitionLifecycleNames(o))},addTransitionLifecycleNames:function(o){this.lifecycle.onBefore[o]=s.prepended("onBefore",o),this.lifecycle.onAfter[o]=s.prepended("onAfter",o),this.lifecycle.on[o]=s.prepended("on",o)},mapTransition:function(o){var c=o.name,d=o.from,y=o.to;return this.addState(d),typeof y!="function"&&this.addState(y),this.addTransition(c),this.map[d][c]=o,o},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(o){return typeof o=="string"?this.mapTransition(a({},this.defaults.init,{to:o,active:!0})):typeof o=="object"?this.mapTransition(a({},this.defaults.init,o,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(o){return typeof o=="function"?o:typeof o=="object"?function(){return o}:function(){return{}}},configureMethods:function(o){return o||{}},configurePlugins:function(o,c){o=o||[];var d,y,_;for(d=0,y=o.length;d<y;d++)_=o[d],typeof _=="function"&&(o[d]=_=_()),_.configure&&_.configure(this);return o},configureTransitions:function(o){var c,d,y,_,b,T=this.defaults.wildcard;for(d=0;d<o.length;d++)for(y=o[d],_=Array.isArray(y.from)?y.from:[y.from||T],b=y.to||T,c=0;c<_.length;c++)this.mapTransition({name:y.name,from:_[c],to:b})},transitionFor:function(o,c){var d=this.defaults.wildcard;return this.map[o][c]||this.map[d][c]},transitionsFor:function(o){var c=this.defaults.wildcard;return Object.keys(this.map[o]).concat(Object.keys(this.map[c]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),r.exports=u},function(r,n,i){var a=i(0),s=i(6),u=i(1),o=[null,[]];function c(d,y){this.context=d,this.config=y,this.state=y.init.from,this.observers=[d]}a(c.prototype,{init:function(d){if(a(this.context,this.config.data.apply(this.context,d)),u.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(d){return Array.isArray(d)?d.indexOf(this.state)>=0:this.state===d},isPending:function(){return this.pending},can:function(d){return!this.isPending()&&!!this.seek(d)},cannot:function(d){return!this.can(d)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(d,y){var _=this.config.defaults.wildcard,b=this.config.transitionFor(this.state,d),T=b&&b.to;return typeof T=="function"?T.apply(this.context,y):T===_?this.state:T},fire:function(d,y){return this.transit(d,this.state,this.seek(d,y),y)},transit:function(d,y,_,b){var T=this.config.lifecycle,x=this.config.options.observeUnchangedState||y!==_;return _?this.isPending()?this.context.onPendingTransition(d,y,_):(this.config.addState(_),this.beginTransit(),b.unshift({transition:d,from:y,to:_,fsm:this.context}),this.observeEvents([this.observersForEvent(T.onBefore.transition),this.observersForEvent(T.onBefore[d]),x?this.observersForEvent(T.onLeave.state):o,x?this.observersForEvent(T.onLeave[y]):o,this.observersForEvent(T.on.transition),x?["doTransit",[this]]:o,x?this.observersForEvent(T.onEnter.state):o,x?this.observersForEvent(T.onEnter[_]):o,x?this.observersForEvent(T.on[_]):o,this.observersForEvent(T.onAfter.transition),this.observersForEvent(T.onAfter[d]),this.observersForEvent(T.on[d])],b)):this.context.onInvalidTransition(d,y,_)},beginTransit:function(){this.pending=!0},endTransit:function(d){return this.pending=!1,d},failTransit:function(d){throw this.pending=!1,d},doTransit:function(d){this.state=d.to},observe:function(d){if(d.length===2){var y={};y[d[0]]=d[1],this.observers.push(y)}else this.observers.push(d[0])},observersForEvent:function(d){for(var y=0,_=this.observers.length,b,T=[];y<_;y++)b=this.observers[y],b[d]&&T.push(b);return[d,T,!0]},observeEvents:function(d,y,_,b){if(d.length===0)return this.endTransit(b===void 0?!0:b);var T=d[0][0],x=d[0][1],N=d[0][2];if(y[0].event=T,T&&N&&T!==_&&u.hook(this,"lifecycle",y),x.length===0)return d.shift(),this.observeEvents(d,y,T,b);var D=x.shift(),H=D[T].apply(D,y);return H&&typeof H.then=="function"?H.then(this.observeEvents.bind(this,d,y,T)).catch(this.failTransit.bind(this)):H===!1?this.endTransit(!1):this.observeEvents(d,y,T,H)},onInvalidTransition:function(d,y,_){throw new s("transition is invalid in current state",d,y,_,this.state)},onPendingTransition:function(d,y,_){throw new s("transition is invalid while previous transition is still in progress",d,y,_,this.state)}}),r.exports=c},function(r,n,i){var a=i(0),s=i(2),u=i(1),o=i(3),c=i(4),d={is:function(N){return this._fsm.is(N)},can:function(N){return this._fsm.can(N)},cannot:function(N){return this._fsm.cannot(N)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(N,D,H){return this._fsm.onInvalidTransition(N,D,H)},onPendingTransition:function(N,D,H){return this._fsm.onPendingTransition(N,D,H)}},y={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(N){throw Error("use transitions to change state")}}};function _(N){return T(this||{},N)}function b(){var N,D;typeof arguments[0]=="function"?(N=arguments[0],D=arguments[1]||{}):(N=function(){this._fsm.apply(this,arguments)},D=arguments[0]||{});var H=new o(D,_);return x(N.prototype,H),N.prototype._fsm.config=H,N}function T(N,D){var H=new o(D,_);return x(N,H),N._fsm(),N}function x(N,D){if(typeof N!="object"||Array.isArray(N))throw Error("StateMachine can only be applied to objects");u.build(N,D),Object.defineProperties(N,y),a(N,d),a(N,D.methods),D.allTransitions().forEach(function(H){N[s(H)]=function(){return this._fsm.fire(H,[].slice.call(arguments))}}),N._fsm=function(){this._fsm=new c(this,D),this._fsm.init(arguments)}}_.version="3.0.1",_.factory=b,_.apply=T,_.defaults={wildcard:"*",init:{name:"init",from:"none"}},r.exports=_},function(r,n,i){r.exports=function(a,s,u,o,c){this.message=a,this.transition=s,this.from=u,this.to=o,this.current=c}}])})})(b1);var Ec={exports:{}},Sw=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(Sw){var $w=new Uint8Array(16);Ec.exports=function(){return Sw($w),$w}}else{var kw=new Array(16);Ec.exports=function(){for(var t=0,r;t<16;t++)(t&3)===0&&(r=Math.random()*4294967296),kw[t]=r>>>((t&3)<<3)&255;return kw}}var w1=[];for(var Nl=0;Nl<256;++Nl)w1[Nl]=(Nl+256).toString(16).substr(1);function iH(e,t){var r=t||0,n=w1;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}var _1=iH,aH=Ec.exports,sH=_1,Tw,Kd,Jd=0,Yd=0;function oH(e,t,r){var n=t&&r||0,i=t||[];e=e||{};var a=e.node||Tw,s=e.clockseq!==void 0?e.clockseq:Kd;if(a==null||s==null){var u=aH();a==null&&(a=Tw=[u[0]|1,u[1],u[2],u[3],u[4],u[5]]),s==null&&(s=Kd=(u[6]<<8|u[7])&16383)}var o=e.msecs!==void 0?e.msecs:new Date().getTime(),c=e.nsecs!==void 0?e.nsecs:Yd+1,d=o-Jd+(c-Yd)/1e4;if(d<0&&e.clockseq===void 0&&(s=s+1&16383),(d<0||o>Jd)&&e.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Jd=o,Yd=c,Kd=s,o+=122192928e5;var y=((o&268435455)*1e4+c)%4294967296;i[n++]=y>>>24&255,i[n++]=y>>>16&255,i[n++]=y>>>8&255,i[n++]=y&255;var _=o/4294967296*1e4&268435455;i[n++]=_>>>8&255,i[n++]=_&255,i[n++]=_>>>24&15|16,i[n++]=_>>>16&255,i[n++]=s>>>8|128,i[n++]=s&255;for(var b=0;b<6;++b)i[n+b]=a[b];return t||sH(i)}var uH=oH,lH=Ec.exports,cH=_1;function fH(e,t,r){var n=t&&r||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var i=e.random||(e.rng||lH)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t)for(var a=0;a<16;++a)t[n+a]=i[a];return t||cH(i)}var dH=fH,pH=uH,S1=dH,Tg=S1;Tg.v1=pH;Tg.v4=S1;var Af=Tg,$h={exports:{}},$1=typeof ArrayBuffer<"u"&&typeof DataView<"u",hH=$1,Eg=qt,Er=ct,k1=Mt,Pf=zt,Zi=Vt,Cg=bi,vH=es,gH=gi,kh=br,yH=Xt.f,mH=vi,Mf=Sf,bo=go,bH=It,wH=xu,T1=dn,E1=T1.enforce,_H=T1.get,Cc=Er.Int8Array,Th=Cc&&Cc.prototype,Ew=Er.Uint8ClampedArray,Cw=Ew&&Ew.prototype,Fn=Cc&&Mf(Cc),En=Th&&Mf(Th),SH=Object.prototype,Ig=Er.TypeError,Iw=bH("toStringTag"),Eh=wH("TYPED_ARRAY_TAG"),Ic="TypedArrayConstructor",di=hH&&!!bo&&Cg(Er.opera)!=="Opera",C1=!1,Mr,Fi,Gs,pi={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Rg={BigInt64Array:8,BigUint64Array:8},$H=function(t){if(!Pf(t))return!1;var r=Cg(t);return r==="DataView"||Zi(pi,r)||Zi(Rg,r)},I1=function(e){var t=Mf(e);if(!!Pf(t)){var r=_H(t);return r&&Zi(r,Ic)?r[Ic]:I1(t)}},R1=function(e){if(!Pf(e))return!1;var t=Cg(e);return Zi(pi,t)||Zi(Rg,t)},kH=function(e){if(R1(e))return e;throw Ig("Target is not a typed array")},TH=function(e){if(k1(e)&&(!bo||mH(Fn,e)))return e;throw Ig(vH(e)+" is not a typed array constructor")},EH=function(e,t,r,n){if(!!Eg){if(r)for(var i in pi){var a=Er[i];if(a&&Zi(a.prototype,e))try{delete a.prototype[e]}catch{try{a.prototype[e]=t}catch{}}}(!En[e]||r)&&kh(En,e,r?t:di&&Th[e]||t,n)}},CH=function(e,t,r){var n,i;if(!!Eg){if(bo){if(r){for(n in pi)if(i=Er[n],i&&Zi(i,e))try{delete i[e]}catch{}}if(!Fn[e]||r)try{return kh(Fn,e,r?t:di&&Fn[e]||t)}catch{}else return}for(n in pi)i=Er[n],i&&(!i[e]||r)&&kh(i,e,t)}};for(Mr in pi)Fi=Er[Mr],Gs=Fi&&Fi.prototype,Gs?E1(Gs)[Ic]=Fi:di=!1;for(Mr in Rg)Fi=Er[Mr],Gs=Fi&&Fi.prototype,Gs&&(E1(Gs)[Ic]=Fi);if((!di||!k1(Fn)||Fn===Function.prototype)&&(Fn=function(){throw Ig("Incorrect invocation")},di))for(Mr in pi)Er[Mr]&&bo(Er[Mr],Fn);if((!di||!En||En===SH)&&(En=Fn.prototype,di))for(Mr in pi)Er[Mr]&&bo(Er[Mr].prototype,En);di&&Mf(Cw)!==En&&bo(Cw,En);if(Eg&&!Zi(En,Iw)){C1=!0,yH(En,Iw,{get:function(){return Pf(this)?this[Eh]:void 0}});for(Mr in pi)Er[Mr]&&gH(Er[Mr],Eh,Mr)}var xt={NATIVE_ARRAY_BUFFER_VIEWS:di,TYPED_ARRAY_TAG:C1&&Eh,aTypedArray:kH,aTypedArrayConstructor:TH,exportTypedArrayMethod:EH,exportTypedArrayStaticMethod:CH,getTypedArrayConstructor:I1,isView:$H,isTypedArray:R1,TypedArray:Fn,TypedArrayPrototype:En},O1=ct,Qd=nt,IH=_f,RH=xt.NATIVE_ARRAY_BUFFER_VIEWS,OH=O1.ArrayBuffer,Ta=O1.Int8Array,AH=!RH||!Qd(function(){Ta(1)})||!Qd(function(){new Ta(-1)})||!IH(function(e){new Ta,new Ta(null),new Ta(1.5),new Ta(e)},!0)||Qd(function(){return new Ta(new OH(2),1,void 0).length!==1}),PH=yi,MH=mi,NH=RangeError,A1=function(e){if(e===void 0)return 0;var t=PH(e),r=MH(t);if(t!==r)throw NH("Wrong length or index");return r},xH=Array,LH=Math.abs,ai=Math.pow,jH=Math.floor,UH=Math.log,DH=Math.LN2,FH=function(e,t,r){var n=xH(r),i=r*8-t-1,a=(1<<i)-1,s=a>>1,u=t===23?ai(2,-24)-ai(2,-77):0,o=e<0||e===0&&1/e<0?1:0,c=0,d,y,_;for(e=LH(e),e!=e||e===1/0?(y=e!=e?1:0,d=a):(d=jH(UH(e)/DH),_=ai(2,-d),e*_<1&&(d--,_*=2),d+s>=1?e+=u/_:e+=u*ai(2,1-s),e*_>=2&&(d++,_/=2),d+s>=a?(y=0,d=a):d+s>=1?(y=(e*_-1)*ai(2,t),d=d+s):(y=e*ai(2,s-1)*ai(2,t),d=0));t>=8;)n[c++]=y&255,y/=256,t-=8;for(d=d<<t|y,i+=t;i>0;)n[c++]=d&255,d/=256,i-=8;return n[--c]|=o*128,n},BH=function(e,t){var r=e.length,n=r*8-t-1,i=(1<<n)-1,a=i>>1,s=n-7,u=r-1,o=e[u--],c=o&127,d;for(o>>=7;s>0;)c=c*256+e[u--],s-=8;for(d=c&(1<<-s)-1,c>>=-s,s+=t;s>0;)d=d*256+e[u--],s-=8;if(c===0)c=1-a;else{if(c===i)return d?NaN:o?-1/0:1/0;d=d+ai(2,t),c=c-a}return(o?-1:1)*d*ai(2,c-t)},qH={pack:FH,unpack:BH},HH=mr,Rw=ns,WH=wr,P1=function(t){for(var r=HH(this),n=WH(r),i=arguments.length,a=Rw(i>1?arguments[1]:void 0,n),s=i>2?arguments[2]:void 0,u=s===void 0?n:Rw(s,n);u>a;)r[a++]=t;return r},Nf=ct,Og=Ze,Xd=qt,GH=$1,M1=ju,Ow=gi,Aw=wg,Zd=nt,xl=as,zH=yi,VH=mi,Rc=A1,N1=qH,KH=Sf,Pw=go,JH=ta.f,YH=Xt.f,QH=P1,XH=qu,x1=ia,L1=dn,ZH=M1.PROPER,Mw=M1.CONFIGURABLE,ro=L1.get,Nw=L1.set,Oc="ArrayBuffer",j1="DataView",zs="prototype",eW="Wrong length",U1="Wrong index",nn=Nf[Oc],Dr=nn,Ss=Dr&&Dr[zs],jn=Nf[j1],Ea=jn&&jn[zs],xw=Object.prototype,tW=Nf.Array,Ac=Nf.RangeError,rW=Og(QH),nW=Og([].reverse),D1=N1.pack,Lw=N1.unpack,jw=function(e){return[e&255]},Uw=function(e){return[e&255,e>>8&255]},Dw=function(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]},Fw=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},iW=function(e){return D1(e,23,4)},aW=function(e){return D1(e,52,8)},Ll=function(e,t){YH(e[zs],t,{get:function(){return ro(this)[t]}})},Pi=function(e,t,r,n){var i=Rc(r),a=ro(e);if(i+t>a.byteLength)throw Ac(U1);var s=ro(a.buffer).bytes,u=i+a.byteOffset,o=XH(s,u,u+t);return n?o:nW(o)},Mi=function(e,t,r,n,i,a){var s=Rc(r),u=ro(e);if(s+t>u.byteLength)throw Ac(U1);for(var o=ro(u.buffer).bytes,c=s+u.byteOffset,d=n(+i),y=0;y<t;y++)o[c+y]=d[a?y:t-y-1]};if(!GH)Dr=function(t){xl(this,Ss);var r=Rc(t);Nw(this,{bytes:rW(tW(r),0),byteLength:r}),Xd||(this.byteLength=r)},Ss=Dr[zs],jn=function(t,r,n){xl(this,Ea),xl(t,Ss);var i=ro(t).byteLength,a=zH(r);if(a<0||a>i)throw Ac("Wrong offset");if(n=n===void 0?i-a:VH(n),a+n>i)throw Ac(eW);Nw(this,{buffer:t,byteLength:n,byteOffset:a}),Xd||(this.buffer=t,this.byteLength=n,this.byteOffset=a)},Ea=jn[zs],Xd&&(Ll(Dr,"byteLength"),Ll(jn,"buffer"),Ll(jn,"byteLength"),Ll(jn,"byteOffset")),Aw(Ea,{getInt8:function(t){return Pi(this,1,t)[0]<<24>>24},getUint8:function(t){return Pi(this,1,t)[0]},getInt16:function(t){var r=Pi(this,2,t,arguments.length>1?arguments[1]:void 0);return(r[1]<<8|r[0])<<16>>16},getUint16:function(t){var r=Pi(this,2,t,arguments.length>1?arguments[1]:void 0);return r[1]<<8|r[0]},getInt32:function(t){return Fw(Pi(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Fw(Pi(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return Lw(Pi(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return Lw(Pi(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,r){Mi(this,1,t,jw,r)},setUint8:function(t,r){Mi(this,1,t,jw,r)},setInt16:function(t,r){Mi(this,2,t,Uw,r,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,r){Mi(this,2,t,Uw,r,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,r){Mi(this,4,t,Dw,r,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,r){Mi(this,4,t,Dw,r,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,r){Mi(this,4,t,iW,r,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,r){Mi(this,8,t,aW,r,arguments.length>2?arguments[2]:void 0)}});else{var Bw=ZH&&nn.name!==Oc;if(!Zd(function(){nn(1)})||!Zd(function(){new nn(-1)})||Zd(function(){return new nn,new nn(1.5),new nn(NaN),nn.length!=1||Bw&&!Mw})){Dr=function(t){return xl(this,Ss),new nn(Rc(t))},Dr[zs]=Ss;for(var qw=JH(nn),Hw=0,ep;qw.length>Hw;)(ep=qw[Hw++])in Dr||Ow(Dr,ep,nn[ep]);Ss.constructor=Dr}else Bw&&Mw&&Ow(nn,"name",Oc);Pw&&KH(Ea)!==xw&&Pw(Ea,xw);var jl=new jn(new Dr(2)),Ww=Og(Ea.setInt8);jl.setInt8(0,2147483648),jl.setInt8(1,2147483649),(jl.getInt8(0)||!jl.getInt8(1))&&Aw(Ea,{setInt8:function(t,r){Ww(this,t,r<<24>>24)},setUint8:function(t,r){Ww(this,t,r<<24>>24)}},{unsafe:!0})}x1(Dr,Oc);x1(jn,j1);var F1={ArrayBuffer:Dr,DataView:jn},sW=yi,oW=RangeError,uW=function(e){var t=sW(e);if(t<0)throw oW("The argument can't be less than 0");return t},lW=uW,cW=RangeError,B1=function(e,t){var r=lW(e);if(r%t)throw cW("Wrong offset");return r},fW=bi,dW=Ze,pW=dW("".slice),hW=function(e){return pW(fW(e),0,3)==="Big"},vW=Sv,gW=TypeError,q1=function(e){var t=vW(e,"number");if(typeof t=="number")throw gW("Can't convert number to bigint");return BigInt(t)},yW=wi,mW=Pt,bW=Rv,wW=mr,_W=wr,SW=bf,$W=Yu,kW=Kv,TW=hW,EW=xt.aTypedArrayConstructor,CW=q1,IW=function(t){var r=bW(this),n=wW(t),i=arguments.length,a=i>1?arguments[1]:void 0,s=a!==void 0,u=$W(n),o,c,d,y,_,b,T,x;if(u&&!kW(u))for(T=SW(n,u),x=T.next,n=[];!(b=mW(x,T)).done;)n.push(b.value);for(s&&i>2&&(a=yW(a,arguments[2])),c=_W(n),d=new(EW(r))(c),y=TW(d),o=0;c>o;o++)_=s?a(n[o],o):n[o],d[o]=y?CW(_):+_;return d},Gw=lt,H1=ct,zw=Pt,RW=qt,OW=AH,wo=xt,W1=F1,Vw=as,AW=Qa,Bo=gi,PW=zk,MW=mi,Kw=A1,tp=B1,G1=Lu,qo=Vt,NW=bi,Ch=zt,xW=fo,LW=na,jW=vi,Ul=go,UW=ta.f,Jw=IW,DW=Wr.forEach,FW=gf,z1=Xt,V1=Gn,Ag=dn,BW=Jv,Ih=Ag.get,qW=Ag.set,HW=Ag.enforce,Pg=z1.f,WW=V1.f,GW=Math.round,rp=H1.RangeError,K1=W1.ArrayBuffer,zW=K1.prototype,VW=W1.DataView,Dl=wo.NATIVE_ARRAY_BUFFER_VIEWS,Yw=wo.TYPED_ARRAY_TAG,Qw=wo.TypedArray,Ho=wo.TypedArrayPrototype,KW=wo.aTypedArrayConstructor,Rh=wo.isTypedArray,Fl="BYTES_PER_ELEMENT",np="Wrong length",Xw=function(e,t){KW(e);for(var r=0,n=t.length,i=new e(n);n>r;)i[r]=t[r++];return i},Bl=function(e,t){Pg(e,t,{get:function(){return Ih(this)[t]}})},Zw=function(e){var t;return jW(zW,e)||(t=NW(e))=="ArrayBuffer"||t=="SharedArrayBuffer"},J1=function(e,t){return Rh(e)&&!xW(t)&&t in e&&PW(+t)&&t>=0},e_=function(t,r){return r=G1(r),J1(t,r)?AW(2,t[r]):WW(t,r)},t_=function(t,r,n){return r=G1(r),J1(t,r)&&Ch(n)&&qo(n,"value")&&!qo(n,"get")&&!qo(n,"set")&&!n.configurable&&(!qo(n,"writable")||n.writable)&&(!qo(n,"enumerable")||n.enumerable)?(t[r]=n.value,t):Pg(t,r,n)};RW?(Dl||(V1.f=e_,z1.f=t_,Bl(Ho,"buffer"),Bl(Ho,"byteOffset"),Bl(Ho,"byteLength"),Bl(Ho,"length")),Gw({target:"Object",stat:!0,forced:!Dl},{getOwnPropertyDescriptor:e_,defineProperty:t_}),$h.exports=function(e,t,r){var n=e.match(/\d+$/)[0]/8,i=e+(r?"Clamped":"")+"Array",a="get"+e,s="set"+e,u=H1[i],o=u,c=o&&o.prototype,d={},y=function(x,N){var D=Ih(x);return D.view[a](N*n+D.byteOffset,!0)},_=function(x,N,D){var H=Ih(x);r&&(D=(D=GW(D))<0?0:D>255?255:D&255),H.view[s](N*n+H.byteOffset,D,!0)},b=function(x,N){Pg(x,N,{get:function(){return y(this,N)},set:function(D){return _(this,N,D)},enumerable:!0})};Dl?OW&&(o=t(function(x,N,D,H){return Vw(x,c),BW(function(){return Ch(N)?Zw(N)?H!==void 0?new u(N,tp(D,n),H):D!==void 0?new u(N,tp(D,n)):new u(N):Rh(N)?Xw(o,N):zw(Jw,o,N):new u(Kw(N))}(),x,o)}),Ul&&Ul(o,Qw),DW(UW(u),function(x){x in o||Bo(o,x,u[x])}),o.prototype=c):(o=t(function(x,N,D,H){Vw(x,c);var ve=0,ae=0,Ae,Re,Ie;if(!Ch(N))Ie=Kw(N),Re=Ie*n,Ae=new K1(Re);else if(Zw(N)){Ae=N,ae=tp(D,n);var L=N.byteLength;if(H===void 0){if(L%n||(Re=L-ae,Re<0))throw rp(np)}else if(Re=MW(H)*n,Re+ae>L)throw rp(np);Ie=Re/n}else return Rh(N)?Xw(o,N):zw(Jw,o,N);for(qW(x,{buffer:Ae,byteOffset:ae,byteLength:Re,length:Ie,view:new VW(Ae)});ve<Ie;)b(x,ve++)}),Ul&&Ul(o,Qw),c=o.prototype=LW(Ho)),c.constructor!==o&&Bo(c,"constructor",o),HW(c).TypedArrayConstructor=o,Yw&&Bo(c,Yw,i);var T=o!=u;d[i]=o,Gw({global:!0,constructor:!0,forced:T,sham:!Dl},d),Fl in o||Bo(o,Fl,n),Fl in c||Bo(c,Fl,n),FW(i)}):$h.exports=function(){};var JW=$h.exports;JW("Uint8",function(e){return function(r,n,i){return e(this,r,n,i)}});var r_=es,YW=TypeError,Mg=function(e,t){if(!delete e[t])throw YW("Cannot delete property "+r_(t)+" of "+r_(e))},QW=mr,ip=ns,XW=wr,ZW=Mg,eG=Math.min,tG=[].copyWithin||function(t,r){var n=QW(this),i=XW(n),a=ip(t,i),s=ip(r,i),u=arguments.length>2?arguments[2]:void 0,o=eG((u===void 0?i:ip(u,i))-s,i-a),c=1;for(s<a&&a<s+o&&(c=-1,s+=o-1,a+=o-1);o-- >0;)s in n?n[a]=n[s]:ZW(n,a),a+=c,s+=c;return n},rG=Ze,Y1=xt,nG=tG,iG=rG(nG),aG=Y1.aTypedArray,sG=Y1.exportTypedArrayMethod;sG("copyWithin",function(t,r){return iG(aG(this),t,r,arguments.length>2?arguments[2]:void 0)});var Q1=xt,oG=Wr.every,uG=Q1.aTypedArray,lG=Q1.exportTypedArrayMethod;lG("every",function(t){return oG(uG(this),t,arguments.length>1?arguments[1]:void 0)});var X1=xt,cG=P1,fG=q1,dG=bi,pG=Pt,hG=Ze,vG=nt,gG=X1.aTypedArray,yG=X1.exportTypedArrayMethod,mG=hG("".slice),bG=vG(function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),e!==1});yG("fill",function(t){var r=arguments.length;gG(this);var n=mG(dG(this),0,3)==="Big"?fG(t):+t;return pG(cG,this,n,r>1?arguments[1]:void 0,r>2?arguments[2]:void 0)},bG);var wG=wr,_G=function(e,t){for(var r=0,n=wG(t),i=new e(n);n>r;)i[r]=t[r++];return i},Z1=xt,SG=Fv,$G=Z1.aTypedArrayConstructor,kG=Z1.getTypedArrayConstructor,xf=function(e){return $G(SG(e,kG(e)))},TG=_G,EG=xf,CG=function(e,t){return TG(EG(e),t)},eT=xt,IG=Wr.filter,RG=CG,OG=eT.aTypedArray,AG=eT.exportTypedArrayMethod;AG("filter",function(t){var r=IG(OG(this),t,arguments.length>1?arguments[1]:void 0);return RG(this,r)});var tT=xt,PG=Wr.find,MG=tT.aTypedArray,NG=tT.exportTypedArrayMethod;NG("find",function(t){return PG(MG(this),t,arguments.length>1?arguments[1]:void 0)});var rT=xt,xG=Wr.findIndex,LG=rT.aTypedArray,jG=rT.exportTypedArrayMethod;jG("findIndex",function(t){return xG(LG(this),t,arguments.length>1?arguments[1]:void 0)});var nT=xt,UG=Wr.forEach,DG=nT.aTypedArray,FG=nT.exportTypedArrayMethod;FG("forEach",function(t){UG(DG(this),t,arguments.length>1?arguments[1]:void 0)});var iT=xt,BG=of.includes,qG=iT.aTypedArray,HG=iT.exportTypedArrayMethod;HG("includes",function(t){return BG(qG(this),t,arguments.length>1?arguments[1]:void 0)});var aT=xt,WG=of.indexOf,GG=aT.aTypedArray,zG=aT.exportTypedArrayMethod;zG("indexOf",function(t){return WG(GG(this),t,arguments.length>1?arguments[1]:void 0)});var VG=ct,KG=nt,Ng=Ze,sT=xt,xg=xk,JG=It,Lg=JG("iterator"),n_=VG.Uint8Array,YG=Ng(xg.values),QG=Ng(xg.keys),XG=Ng(xg.entries),jg=sT.aTypedArray,Lf=sT.exportTypedArrayMethod,Ms=n_&&n_.prototype,jf=!KG(function(){Ms[Lg].call([1])}),oT=!!Ms&&Ms.values&&Ms[Lg]===Ms.values&&Ms.values.name==="values",uT=function(){return YG(jg(this))};Lf("entries",function(){return XG(jg(this))},jf);Lf("keys",function(){return QG(jg(this))},jf);Lf("values",uT,jf||!oT,{name:"values"});Lf(Lg,uT,jf||!oT,{name:"values"});var lT=xt,ZG=Ze,e7=lT.aTypedArray,t7=lT.exportTypedArrayMethod,r7=ZG([].join);t7("join",function(t){return r7(e7(this),t)});var n7=ra,i7=Hr,a7=yi,s7=wr,o7=Qu,u7=Math.min,Oh=[].lastIndexOf,cT=!!Oh&&1/[1].lastIndexOf(1,-0)<0,l7=o7("lastIndexOf"),c7=cT||!l7,f7=c7?function(t){if(cT)return n7(Oh,this,arguments)||0;var r=i7(this),n=s7(r),i=n-1;for(arguments.length>1&&(i=u7(i,a7(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:Oh,fT=xt,d7=ra,p7=f7,h7=fT.aTypedArray,v7=fT.exportTypedArrayMethod;v7("lastIndexOf",function(t){var r=arguments.length;return d7(p7,h7(this),r>1?[t,arguments[1]]:[t])});var dT=xt,g7=Wr.map,y7=xf,m7=dT.aTypedArray,b7=dT.exportTypedArrayMethod;b7("map",function(t){return g7(m7(this),t,arguments.length>1?arguments[1]:void 0,function(r,n){return new(y7(r))(n)})});var w7=An,_7=mr,S7=Nu,$7=wr,k7=TypeError,i_=function(e){return function(t,r,n,i){w7(r);var a=_7(t),s=S7(a),u=$7(a),o=e?u-1:0,c=e?-1:1;if(n<2)for(;;){if(o in s){i=s[o],o+=c;break}if(o+=c,e?o<0:u<=o)throw k7("Reduce of empty array with no initial value")}for(;e?o>=0:u>o;o+=c)o in s&&(i=r(i,s[o],o,a));return i}},Ug={left:i_(!1),right:i_(!0)},pT=xt,T7=Ug.left,E7=pT.aTypedArray,C7=pT.exportTypedArrayMethod;C7("reduce",function(t){var r=arguments.length;return T7(E7(this),t,r,r>1?arguments[1]:void 0)});var hT=xt,I7=Ug.right,R7=hT.aTypedArray,O7=hT.exportTypedArrayMethod;O7("reduceRight",function(t){var r=arguments.length;return I7(R7(this),t,r,r>1?arguments[1]:void 0)});var vT=xt,A7=vT.aTypedArray,P7=vT.exportTypedArrayMethod,M7=Math.floor;P7("reverse",function(){for(var t=this,r=A7(t).length,n=M7(r/2),i=0,a;i<n;)a=t[i],t[i++]=t[--r],t[r]=a;return t});var gT=ct,yT=Pt,Dg=xt,N7=wr,x7=B1,L7=mr,mT=nt,j7=gT.RangeError,Ah=gT.Int8Array,a_=Ah&&Ah.prototype,bT=a_&&a_.set,U7=Dg.aTypedArray,D7=Dg.exportTypedArrayMethod,Ph=!mT(function(){var e=new Uint8ClampedArray(2);return yT(bT,e,{length:1,0:3},1),e[1]!==3}),F7=Ph&&Dg.NATIVE_ARRAY_BUFFER_VIEWS&&mT(function(){var e=new Ah(2);return e.set(1),e.set("2",1),e[0]!==0||e[1]!==2});D7("set",function(t){U7(this);var r=x7(arguments.length>1?arguments[1]:void 0,1),n=L7(t);if(Ph)return yT(bT,this,n,r);var i=this.length,a=N7(n),s=0;if(a+r>i)throw j7("Wrong length");for(;s<a;)this[r+s]=n[s++]},!Ph||F7);var wT=xt,B7=xf,q7=nt,H7=po,W7=wT.aTypedArray,G7=wT.exportTypedArrayMethod,z7=q7(function(){new Int8Array(1).slice()});G7("slice",function(t,r){for(var n=H7(W7(this),t,r),i=B7(this),a=0,s=n.length,u=new i(s);s>a;)u[a]=n[a++];return u},z7);var _T=xt,V7=Wr.some,K7=_T.aTypedArray,J7=_T.exportTypedArrayMethod;J7("some",function(t){return V7(K7(this),t,arguments.length>1?arguments[1]:void 0)});var s_=qu,Y7=Math.floor,Mh=function(e,t){var r=e.length,n=Y7(r/2);return r<8?Q7(e,t):X7(e,Mh(s_(e,0,n),t),Mh(s_(e,n),t),t)},Q7=function(e,t){for(var r=e.length,n=1,i,a;n<r;){for(a=n,i=e[n];a&&t(e[a-1],i)>0;)e[a]=e[--a];a!==n++&&(e[a]=i)}return e},X7=function(e,t,r,n){for(var i=t.length,a=r.length,s=0,u=0;s<i||u<a;)e[s+u]=s<i&&u<a?n(t[s],r[u])<=0?t[s++]:r[u++]:s<i?t[s++]:r[u++];return e},Fg=Mh,Z7=Xa,o_=Z7.match(/firefox\/(\d+)/i),ST=!!o_&&+o_[1],ez=Xa,$T=/MSIE|Trident/.test(ez),tz=Xa,u_=tz.match(/AppleWebKit\/(\d+)\./),kT=!!u_&&+u_[1],rz=ct,nz=Ze,Nh=nt,iz=An,az=Fg,TT=xt,l_=ST,sz=$T,c_=Za,f_=kT,oz=TT.aTypedArray,uz=TT.exportTypedArrayMethod,Iu=rz.Uint16Array,Vs=Iu&&nz(Iu.prototype.sort),lz=!!Vs&&!(Nh(function(){Vs(new Iu(2),null)})&&Nh(function(){Vs(new Iu(2),{})})),d_=!!Vs&&!Nh(function(){if(c_)return c_<74;if(l_)return l_<67;if(sz)return!0;if(f_)return f_<602;var e=new Iu(516),t=Array(516),r,n;for(r=0;r<516;r++)n=r%4,e[r]=515-r,t[r]=r-2*n+3;for(Vs(e,function(i,a){return(i/4|0)-(a/4|0)}),r=0;r<516;r++)if(e[r]!==t[r])return!0}),cz=function(e){return function(t,r){return e!==void 0?+e(t,r)||0:r!==r?-1:t!==t?1:t===0&&r===0?1/t>0&&1/r<0?1:-1:t>r}};uz("sort",function(t){return t!==void 0&&iz(t),d_?Vs(this,t):az(oz(this),cz(t))},!d_||lz);var ET=xt,fz=mi,p_=ns,dz=xf,pz=ET.aTypedArray,hz=ET.exportTypedArrayMethod;hz("subarray",function(t,r){var n=pz(this),i=n.length,a=p_(t,i),s=dz(n);return new s(n.buffer,n.byteOffset+a*n.BYTES_PER_ELEMENT,fz((r===void 0?i:p_(r,i))-a))});var vz=ct,gz=ra,CT=xt,xh=nt,h_=po,Pc=vz.Int8Array,v_=CT.aTypedArray,yz=CT.exportTypedArrayMethod,IT=[].toLocaleString,mz=!!Pc&&xh(function(){IT.call(new Pc(1))}),bz=xh(function(){return[1,2].toLocaleString()!=new Pc([1,2]).toLocaleString()})||!xh(function(){Pc.prototype.toLocaleString.call([1,2])});yz("toLocaleString",function(){return gz(IT,mz?h_(v_(this)):v_(this),h_(arguments))},bz);var wz=xt.exportTypedArrayMethod,_z=nt,Sz=ct,$z=Ze,g_=Sz.Uint8Array,kz=g_&&g_.prototype||{},Mc=[].toString,Tz=$z([].join);_z(function(){Mc.call({})})&&(Mc=function(){return Tz(this)});var Ez=kz.toString!=Mc;wz("toString",Mc,Ez);var Cz=zt,Iz=ea,Rz=It,Oz=Rz("match"),RT=function(e){var t;return Cz(e)&&((t=e[Oz])!==void 0?!!t:Iz(e)=="RegExp")},Az=ra,Wo=Pt,Bg=Ze,Pz=Tf,Mz=Zt,Nz=zn,xz=RT,y_=Vn,Lz=Fv,jz=ug,Uz=mi,ap=dr,Dz=ts,m_=qu,b_=Ef,Fz=kf,Bz=Fk,qz=nt,$s=Bz.UNSUPPORTED_Y,w_=4294967295,Hz=Math.min,OT=[].push,Wz=Bg(/./.exec),ks=Bg(OT),Go=Bg("".slice),Gz=!qz(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});Pz("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,a){var s=ap(y_(this)),u=a===void 0?w_:a>>>0;if(u===0)return[];if(i===void 0)return[s];if(!xz(i))return Wo(t,s,i,u);for(var o=[],c=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),d=0,y=new RegExp(i.source,c+"g"),_,b,T;(_=Wo(Fz,y,s))&&(b=y.lastIndex,!(b>d&&(ks(o,Go(s,d,_.index)),_.length>1&&_.index<s.length&&Az(OT,o,m_(_,1)),T=_[0].length,d=b,o.length>=u)));)y.lastIndex===_.index&&y.lastIndex++;return d===s.length?(T||!Wz(y,""))&&ks(o,""):ks(o,Go(s,d)),o.length>u?m_(o,0,u):o}:"0".split(void 0,0).length?n=function(i,a){return i===void 0&&a===0?[]:Wo(t,this,i,a)}:n=t,[function(a,s){var u=y_(this),o=Nz(a)?void 0:Dz(a,e);return o?Wo(o,a,u,s):Wo(n,ap(u),a,s)},function(i,a){var s=Mz(this),u=ap(i),o=r(n,s,u,a,n!==t);if(o.done)return o.value;var c=Lz(s,RegExp),d=s.unicode,y=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+($s?"g":"y"),_=new c($s?"^(?:"+s.source+")":s,y),b=a===void 0?w_:a>>>0;if(b===0)return[];if(u.length===0)return b_(_,u)===null?[u]:[];for(var T=0,x=0,N=[];x<u.length;){_.lastIndex=$s?0:x;var D=b_(_,$s?Go(u,x):u),H;if(D===null||(H=Hz(Uz(_.lastIndex+($s?x:0)),u.length))===T)x=jz(u,x,d);else{if(ks(N,Go(u,T,x)),N.length===b)return N;for(var ve=1;ve<=D.length-1;ve++)if(ks(N,D[ve]),N.length===b)return N;x=T=H}}return ks(N,Go(u,T)),N}]},!Gz,$s);var qg={exports:{}},AT={exports:{}};(function(e){function t(r){return Function.toString.call(r).indexOf("[native code]")!==-1}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(AT);var PT={exports:{}},MT={exports:{}};(function(e){function t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(MT);(function(e){var t=vf.exports,r=MT.exports;function n(i,a,s){return r()?(e.exports=n=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=n=function(o,c,d){var y=[null];y.push.apply(y,c);var _=Function.bind.apply(o,y),b=new _;return d&&t(b,d.prototype),b},e.exports.__esModule=!0,e.exports.default=e.exports),n.apply(null,arguments)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(PT);(function(e){var t=Kn.exports,r=vf.exports,n=AT.exports,i=PT.exports;function a(s){var u=typeof Map=="function"?new Map:void 0;return e.exports=a=function(c){if(c===null||!n(c))return c;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(typeof u<"u"){if(u.has(c))return u.get(c);u.set(c,d)}function d(){return i(c,arguments,t(this).constructor)}return d.prototype=Object.create(c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),r(d,c)},e.exports.__esModule=!0,e.exports.default=e.exports,a(s)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(qg);var Nc={exports:{}};/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */(function(e,t){(function(){var r={function:!0,object:!0},n=r[typeof window]&&window||this,i=t,a=e&&!e.nodeType&&e,s=i&&a&&typeof Tn=="object"&&Tn;s&&(s.global===s||s.window===s||s.self===s)&&(n=s);var u=Math.pow(2,53)-1,o=/\bOpera/,c=Object.prototype,d=c.hasOwnProperty,y=c.toString;function _(L){return L=String(L),L.charAt(0).toUpperCase()+L.slice(1)}function b(L,oe,B){var ke={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return oe&&B&&/^Win/i.test(L)&&!/^Windows Phone /i.test(L)&&(ke=ke[/[\d.]+$/.exec(L)])&&(L="Windows "+ke),L=String(L),oe&&B&&(L=L.replace(RegExp(oe,"i"),B)),L=x(L.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),L}function T(L,oe){var B=-1,ke=L?L.length:0;if(typeof ke=="number"&&ke>-1&&ke<=u)for(;++B<ke;)oe(L[B],B,L);else N(L,oe)}function x(L){return L=Ae(L),/^(?:webOS|i(?:OS|P))/.test(L)?L:_(L)}function N(L,oe){for(var B in L)d.call(L,B)&&oe(L[B],B,L)}function D(L){return L==null?_(L):y.call(L).slice(8,-1)}function H(L,oe){var B=L!=null?typeof L[oe]:"number";return!/^(?:boolean|number|string|undefined)$/.test(B)&&(B=="object"?!!L[oe]:!0)}function ve(L){return String(L).replace(/([ -])(?!$)/g,"$1?")}function ae(L,oe){var B=null;return T(L,function(ke,Se){B=oe(B,ke,Se,L)}),B}function Ae(L){return String(L).replace(/^ +| +$/g,"")}function Re(L){var oe=n,B=L&&typeof L=="object"&&D(L)!="String";B&&(oe=L,L=null);var ke=oe.navigator||{},Se=ke.userAgent||"";L||(L=Se);var se=B?!!ke.likeChrome:/\bChrome\b/.test(L)&&!/internal|\n/i.test(y.toString()),ee="Object",ne=B?ee:"ScriptBridgingProxyObject",te=B?ee:"Environment",me=B&&oe.java?"JavaPackage":D(oe.java),A=B?ee:"RuntimeObject",Ne=/\bJava/.test(me)&&oe.java,ft=Ne&&D(oe.environment)==te,ze=Ne?"a":"\u03B1",le=Ne?"b":"\u03B2",G=oe.document||{},J=oe.operamini||oe.opera,k=o.test(k=B&&J?J["[[Class]]"]:D(J))?k:J=null,C,X=L,Z=[],$e=null,De=L==Se,ue=De&&J&&typeof J.version=="function"&&J.version(),Te,E=_e([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),$=ye(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),q=K([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),P=de({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),U=Ce(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function _e(xe){return ae(xe,function(Ue,Le){return Ue||RegExp("\\b"+(Le.pattern||ve(Le))+"\\b","i").exec(L)&&(Le.label||Le)})}function de(xe){return ae(xe,function(Ue,Le,Ge){return Ue||(Le[q]||Le[/^[a-z]+(?: +[a-z]+\b)*/i.exec(q)]||RegExp("\\b"+ve(Ge)+"(?:\\b|\\w*\\d)","i").exec(L))&&Ge})}function ye(xe){return ae(xe,function(Ue,Le){return Ue||RegExp("\\b"+(Le.pattern||ve(Le))+"\\b","i").exec(L)&&(Le.label||Le)})}function Ce(xe){return ae(xe,function(Ue,Le){var Ge=Le.pattern||ve(Le);return!Ue&&(Ue=RegExp("\\b"+Ge+"(?:/[\\d.]+|[ \\w.]*)","i").exec(L))&&(Ue=b(Ue,Ge,Le.label||Le)),Ue})}function K(xe){return ae(xe,function(Ue,Le){var Ge=Le.pattern||ve(Le);return!Ue&&(Ue=RegExp("\\b"+Ge+" *\\d+[.\\w_]*","i").exec(L)||RegExp("\\b"+Ge+" *\\w+-[\\w]*","i").exec(L)||RegExp("\\b"+Ge+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(L))&&((Ue=String(Le.label&&!RegExp(Ge,"i").test(Le.label)?Le.label:Ue).split("/"))[1]&&!/[\d.]+/.test(Ue[0])&&(Ue[0]+=" "+Ue[1]),Le=Le.label||Le,Ue=x(Ue[0].replace(RegExp(Ge,"i"),Le).replace(RegExp("; *(?:"+Le+"[_-])?","i")," ").replace(RegExp("("+Le+")[-_.]?(\\w)","i"),"$1 $2"))),Ue})}function je(xe){return ae(xe,function(Ue,Le){return Ue||(RegExp(Le+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(L)||0)[1]||null})}function Me(){return this.description||""}if(E&&(E=[E]),/\bAndroid\b/.test(U)&&!q&&(C=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(L))&&(q=Ae(C[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),P&&!q?q=K([P]):P&&q&&(q=q.replace(RegExp("^("+ve(P)+")[-_.\\s]","i"),P+" ").replace(RegExp("^("+ve(P)+")[-_.]?(\\w)","i"),P+" $2")),(C=/\bGoogle TV\b/.exec(q))&&(q=C[0]),/\bSimulator\b/i.test(L)&&(q=(q?q+" ":"")+"Simulator"),$=="Opera Mini"&&/\bOPiOS\b/.test(L)&&Z.push("running in Turbo/Uncompressed mode"),$=="IE"&&/\blike iPhone OS\b/.test(L)?(C=Re(L.replace(/like iPhone OS/,"")),P=C.manufacturer,q=C.product):/^iP/.test(q)?($||($="Safari"),U="iOS"+((C=/ OS ([\d_]+)/i.exec(L))?" "+C[1].replace(/_/g,"."):"")):$=="Konqueror"&&/^Linux\b/i.test(U)?U="Kubuntu":P&&P!="Google"&&(/Chrome/.test($)&&!/\bMobile Safari\b/i.test(L)||/\bVita\b/.test(q))||/\bAndroid\b/.test(U)&&/^Chrome/.test($)&&/\bVersion\//i.test(L)?($="Android Browser",U=/\bAndroid\b/.test(U)?U:"Android"):$=="Silk"?(/\bMobi/i.test(L)||(U="Android",Z.unshift("desktop mode")),/Accelerated *= *true/i.test(L)&&Z.unshift("accelerated")):$=="UC Browser"&&/\bUCWEB\b/.test(L)?Z.push("speed mode"):$=="PaleMoon"&&(C=/\bFirefox\/([\d.]+)\b/.exec(L))?Z.push("identifying as Firefox "+C[1]):$=="Firefox"&&(C=/\b(Mobile|Tablet|TV)\b/i.exec(L))?(U||(U="Firefox OS"),q||(q=C[1])):!$||(C=!/\bMinefield\b/i.test(L)&&/\b(?:Firefox|Safari)\b/.exec($))?($&&!q&&/[\/,]|^[^(]+?\)/.test(L.slice(L.indexOf(C+"/")+8))&&($=null),(C=q||P||U)&&(q||P||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(U))&&($=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(U)?U:C)+" Browser")):$=="Electron"&&(C=(/\bChrome\/([\d.]+)\b/.exec(L)||0)[1])&&Z.push("Chromium "+C),ue||(ue=je(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",ve($),"(?:Firefox|Minefield|NetFront)"])),(C=E=="iCab"&&parseFloat(ue)>3&&"WebKit"||/\bOpera\b/.test($)&&(/\bOPR\b/.test(L)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(L)&&!/^(?:Trident|EdgeHTML)$/.test(E)&&"WebKit"||!E&&/\bMSIE\b/i.test(L)&&(U=="Mac OS"?"Tasman":"Trident")||E=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test($)&&"NetFront")&&(E=[C]),$=="IE"&&(C=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(L)||0)[1])?($+=" Mobile",U="Windows Phone "+(/\+$/.test(C)?C:C+".x"),Z.unshift("desktop mode")):/\bWPDesktop\b/i.test(L)?($="IE Mobile",U="Windows Phone 8.x",Z.unshift("desktop mode"),ue||(ue=(/\brv:([\d.]+)/.exec(L)||0)[1])):$!="IE"&&E=="Trident"&&(C=/\brv:([\d.]+)/.exec(L))&&($&&Z.push("identifying as "+$+(ue?" "+ue:"")),$="IE",ue=C[1]),De){if(H(oe,"global"))if(Ne&&(C=Ne.lang.System,X=C.getProperty("os.arch"),U=U||C.getProperty("os.name")+" "+C.getProperty("os.version")),ft){try{ue=oe.require("ringo/engine").version.join("."),$="RingoJS"}catch{(C=oe.system)&&C.global.system==oe.system&&($="Narwhal",U||(U=C[0].os||null))}$||($="Rhino")}else typeof oe.process=="object"&&!oe.process.browser&&(C=oe.process)&&(typeof C.versions=="object"&&(typeof C.versions.electron=="string"?(Z.push("Node "+C.versions.node),$="Electron",ue=C.versions.electron):typeof C.versions.nw=="string"&&(Z.push("Chromium "+ue,"Node "+C.versions.node),$="NW.js",ue=C.versions.nw)),$||($="Node.js",X=C.arch,U=C.platform,ue=/[\d.]+/.exec(C.version),ue=ue?ue[0]:null));else D(C=oe.runtime)==ne?($="Adobe AIR",U=C.flash.system.Capabilities.os):D(C=oe.phantom)==A?($="PhantomJS",ue=(C=C.version||null)&&C.major+"."+C.minor+"."+C.patch):typeof G.documentMode=="number"&&(C=/\bTrident\/(\d+)/i.exec(L))?(ue=[ue,G.documentMode],(C=+C[1]+4)!=ue[1]&&(Z.push("IE "+ue[1]+" mode"),E&&(E[1]=""),ue[1]=C),ue=$=="IE"?String(ue[1].toFixed(1)):ue[0]):typeof G.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test($)&&(Z.push("masking as "+$+" "+ue),$="IE",ue="11.0",E=["Trident"],U="Windows");U=U&&x(U)}if(ue&&(C=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(ue)||/(?:alpha|beta)(?: ?\d)?/i.exec(L+";"+(De&&ke.appMinorVersion))||/\bMinefield\b/i.test(L)&&"a")&&($e=/b/i.test(C)?"beta":"alpha",ue=ue.replace(RegExp(C+"\\+?$"),"")+($e=="beta"?le:ze)+(/\d+\+?/.exec(C)||"")),$=="Fennec"||$=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(U))$="Firefox Mobile";else if($=="Maxthon"&&ue)ue=ue.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(q))q=="Xbox 360"&&(U=null),q=="Xbox 360"&&/\bIEMobile\b/.test(L)&&Z.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test($)||$&&!q&&!/Browser|Mobi/.test($))&&(U=="Windows CE"||/Mobi/i.test(L)))$+=" Mobile";else if($=="IE"&&De)try{oe.external===null&&Z.unshift("platform preview")}catch{Z.unshift("embedded")}else(/\bBlackBerry\b/.test(q)||/\bBB10\b/.test(L))&&(C=(RegExp(q.replace(/ +/g," *")+"/([.\\d]+)","i").exec(L)||0)[1]||ue)?(C=[C,/BB10/.test(L)],U=(C[1]?(q=null,P="BlackBerry"):"Device Software")+" "+C[0],ue=null):this!=N&&q!="Wii"&&(De&&J||/Opera/.test($)&&/\b(?:MSIE|Firefox)\b/i.test(L)||$=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(U)||$=="IE"&&(U&&!/^Win/.test(U)&&ue>5.5||/\bWindows XP\b/.test(U)&&ue>8||ue==8&&!/\bTrident\b/.test(L)))&&!o.test(C=Re.call(N,L.replace(o,"")+";"))&&C.name&&(C="ing as "+C.name+((C=C.version)?" "+C:""),o.test($)?(/\bIE\b/.test(C)&&U=="Mac OS"&&(U=null),C="identify"+C):(C="mask"+C,k?$=x(k.replace(/([a-z])([A-Z])/g,"$1 $2")):$="Opera",/\bIE\b/.test(C)&&(U=null),De||(ue=null)),E=["Presto"],Z.push(C));(C=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(L)||0)[1])&&(C=[parseFloat(C.replace(/\.(\d)$/,".0$1")),C],$=="Safari"&&C[1].slice(-1)=="+"?($="WebKit Nightly",$e="alpha",ue=C[1].slice(0,-1)):(ue==C[1]||ue==(C[2]=(/\bSafari\/([\d.]+\+?)/i.exec(L)||0)[1]))&&(ue=null),C[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(L)||0)[1],C[0]==537.36&&C[2]==537.36&&parseFloat(C[1])>=28&&E=="WebKit"&&(E=["Blink"]),!De||!se&&!C[1]?(E&&(E[1]="like Safari"),C=(C=C[0],C<400?1:C<500?2:C<526?3:C<533?4:C<534?"4+":C<535?5:C<537?6:C<538?7:C<601?8:C<602?9:C<604?10:C<606?11:C<608?12:"12")):(E&&(E[1]="like Chrome"),C=C[1]||(C=C[0],C<530?1:C<532?2:C<532.05?3:C<533?4:C<534.03?5:C<534.07?6:C<534.1?7:C<534.13?8:C<534.16?9:C<534.24?10:C<534.3?11:C<535.01?12:C<535.02?"13+":C<535.07?15:C<535.11?16:C<535.19?17:C<536.05?18:C<536.1?19:C<537.01?20:C<537.11?"21+":C<537.13?23:C<537.18?24:C<537.24?25:C<537.36?26:E!="Blink"?"27":"28")),E&&(E[1]+=" "+(C+=typeof C=="number"?".x":/[.+]/.test(C)?"":"+")),$=="Safari"&&(!ue||parseInt(ue)>45)?ue=C:$=="Chrome"&&/\bHeadlessChrome/i.test(L)&&Z.unshift("headless")),$=="Opera"&&(C=/\bzbov|zvav$/.exec(U))?($+=" ",Z.unshift("desktop mode"),C=="zvav"?($+="Mini",ue=null):$+="Mobile",U=U.replace(RegExp(" *"+C+"$"),"")):$=="Safari"&&/\bChrome\b/.exec(E&&E[1])?(Z.unshift("desktop mode"),$="Chrome Mobile",ue=null,/\bOS X\b/.test(U)?(P="Apple",U="iOS 4.3+"):U=null):/\bSRWare Iron\b/.test($)&&!ue&&(ue=je("Chrome")),ue&&ue.indexOf(C=/[\d.]+$/.exec(U))==0&&L.indexOf("/"+C+"-")>-1&&(U=Ae(U.replace(C,""))),U&&U.indexOf($)!=-1&&!RegExp($+" OS").test(U)&&(U=U.replace(RegExp(" *"+ve($)+" *"),"")),E&&!/\b(?:Avant|Nook)\b/.test($)&&(/Browser|Lunascape|Maxthon/.test($)||$!="Safari"&&/^iOS/.test(U)&&/\bSafari\b/.test(E[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test($)&&E[1])&&(C=E[E.length-1])&&Z.push(C),Z.length&&(Z=["("+Z.join("; ")+")"]),P&&q&&q.indexOf(P)<0&&Z.push("on "+P),q&&Z.push((/^on /.test(Z[Z.length-1])?"":"on ")+q),U&&(C=/ ([\d.+]+)$/.exec(U),Te=C&&U.charAt(U.length-C[0].length-1)=="/",U={architecture:32,family:C&&!Te?U.replace(C[0],""):U,version:C?C[1]:null,toString:function(){var xe=this.version;return this.family+(xe&&!Te?" "+xe:"")+(this.architecture==64?" 64-bit":"")}}),(C=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(X))&&!/\bi686\b/i.test(X)?(U&&(U.architecture=64,U.family=U.family.replace(RegExp(" *"+C),"")),$&&(/\bWOW64\b/i.test(L)||De&&/\w(?:86|32)$/.test(ke.cpuClass||ke.platform)&&!/\bWin64; x64\b/i.test(L))&&Z.unshift("32-bit")):U&&/^OS X/.test(U.family)&&$=="Chrome"&&parseFloat(ue)>=39&&(U.architecture=64),L||(L=null);var Oe={};return Oe.description=L,Oe.layout=E&&E[0],Oe.manufacturer=P,Oe.name=$,Oe.prerelease=$e,Oe.product=q,Oe.ua=L,Oe.version=$&&ue,Oe.os=U||{architecture:null,family:null,version:null,toString:function(){return"null"}},Oe.parse=Re,Oe.toString=Me,Oe.version&&Z.unshift(ue),Oe.name&&Z.unshift($),U&&$&&!(U==String(U).split(" ")[0]&&(U==$.split(" ")[0]||q))&&Z.push(q?"("+U+")":"on "+U),Z.length&&(Oe.description=Z.join(" ")),Oe}var Ie=Re();i&&a?N(Ie,function(L,oe){i[oe]=L}):n.platform=Ie}).call(Tn)})(Nc,Nc.exports);var zz=Pt,Vz=Tf,Kz=Zt,Jz=zn,Yz=mi,sp=dr,Qz=Vn,Xz=ts,Zz=ug,__=Ef;Vz("match",function(e,t,r){return[function(i){var a=Qz(this),s=Jz(i)?void 0:Xz(i,e);return s?zz(s,i,a):new RegExp(i)[e](sp(a))},function(n){var i=Kz(this),a=sp(n),s=r(t,i,a);if(s.done)return s.value;if(!i.global)return __(i,a);var u=i.unicode;i.lastIndex=0;for(var o=[],c=0,d;(d=__(i,a))!==null;){var y=sp(d[0]);o[c]=y,y===""&&(i.lastIndex=Zz(a,Yz(i.lastIndex),u)),c++}return c===0?null:o}]});var eV=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},tV=Pt,rV=Tf,nV=Zt,iV=zn,aV=Vn,S_=eV,$_=dr,sV=ts,oV=Ef;rV("search",function(e,t,r){return[function(i){var a=aV(this),s=iV(i)?void 0:sV(i,e);return s?tV(s,i,a):new RegExp(i)[e]($_(a))},function(n){var i=nV(this),a=$_(n),s=r(t,i,a);if(s.done)return s.value;var u=i.lastIndex;S_(u,0)||(i.lastIndex=0);var o=oV(i,a);return S_(i.lastIndex,u)||(i.lastIndex=u),o===null?-1:o.index}]});var uV=qt,lV=Hu,cV=TypeError,fV=Object.getOwnPropertyDescriptor,dV=uV&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),pV=dV?function(e,t){if(lV(e)&&!fV(e,"length").writable)throw cV("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},hV=lt,vV=mr,gV=ns,yV=yi,mV=wr,bV=pV,wV=_k,_V=Nv,SV=ho,op=Mg,$V=zu,kV=$V("splice"),TV=Math.max,EV=Math.min;hV({target:"Array",proto:!0,forced:!kV},{splice:function(t,r){var n=vV(this),i=mV(n),a=gV(t,i),s=arguments.length,u,o,c,d,y,_;for(s===0?u=o=0:s===1?(u=0,o=i-a):(u=s-2,o=EV(TV(yV(r),0),i-a)),wV(i+u-o),c=_V(n,o),d=0;d<o;d++)y=a+d,y in n&&SV(c,d,n[y]);if(c.length=o,u<o){for(d=a;d<i-o;d++)y=d+o,_=d+u,y in n?n[_]=n[y]:op(n,_);for(d=i;d>i-o+u;d--)op(n,d-1)}else if(u>o)for(d=i-o;d>a;d--)y=d+o-1,_=d+u-1,y in n?n[_]=n[y]:op(n,_);for(d=0;d<u;d++)n[d+a]=arguments[d+2];return bV(n,i-o+u),c}});/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.


*/(function(e){var t=typeof t<"u"?t:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(e,"__esModule",{value:!0});var r=vo.exports,n=is.exports,i=aa.exports,a=Rf.exports,s=sa.exports,u=oa.exports,o=Kn.exports,c=ca.exports,d=la.exports,y=Xu,_=ua.exports,b=ar,T=mo.exports,x=b1.exports,N=Af,D=qg.exports,H=Si,ve=Nc.exports;function ae(m){return m&&typeof m=="object"&&"default"in m?m:{default:m}}function Ae(m){if(m&&m.__esModule)return m;var v=Object.create(null);return m&&Object.keys(m).forEach(function(l){if(l!=="default"){var p=Object.getOwnPropertyDescriptor(m,l);Object.defineProperty(v,l,p.get?p:{enumerable:!0,get:function(){return m[l]}})}}),v.default=m,Object.freeze(v)}var Re=ae(r),Ie=ae(n),L=ae(i),oe=ae(a),B=ae(s),ke=ae(u),Se=ae(o),se=ae(c),ee=ae(d),ne=ae(y),te=ae(_),me=Ae(T),A=Ae(x),Ne=ae(D),ft=Ae(ve);function ze(m,v,l,p){var f=arguments.length,g=f<3?v:p===null?p=Object.getOwnPropertyDescriptor(v,l):p,h;if((typeof Reflect>"u"?"undefined":te.default(Reflect))==="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(m,v,l,p);else for(var w=m.length-1;w>=0;w--)(h=m[w])&&(g=(f<3?h(g):f>3?h(v,l,g):h(v,l))||g);return f>3&&g&&Object.defineProperty(v,l,g),g}function le(m,v){if((typeof Reflect>"u"?"undefined":te.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(m,v)}var G;function J(){}J.prototype=Object.create(null);function k(){k.init.call(this)}k.EventEmitter=k,k.usingDomains=!1,k.prototype.domain=void 0,k.prototype._events=void 0,k.prototype._maxListeners=void 0,k.defaultMaxListeners=10,k.init=function(){this.domain=null,k.usingDomains&&G.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new J,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},k.prototype.setMaxListeners=function(v){if(typeof v!="number"||v<0||isNaN(v))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=v,this};function C(m){return m._maxListeners===void 0?k.defaultMaxListeners:m._maxListeners}k.prototype.getMaxListeners=function(){return C(this)};function X(m,v,l){if(v)m.call(l);else for(var p=m.length,f=U(m,p),g=0;g<p;++g)f[g].call(l)}function Z(m,v,l,p){if(v)m.call(l,p);else for(var f=m.length,g=U(m,f),h=0;h<f;++h)g[h].call(l,p)}function $e(m,v,l,p,f){if(v)m.call(l,p,f);else for(var g=m.length,h=U(m,g),w=0;w<g;++w)h[w].call(l,p,f)}function De(m,v,l,p,f,g){if(v)m.call(l,p,f,g);else for(var h=m.length,w=U(m,h),S=0;S<h;++S)w[S].call(l,p,f,g)}function ue(m,v,l,p){if(v)m.apply(l,p);else for(var f=m.length,g=U(m,f),h=0;h<f;++h)g[h].apply(l,p)}k.prototype.emit=function(v){var l,p,f,g,h,w,S,j=v==="error";if(w=this._events,w)j=j&&w.error==null;else if(!j)return!1;if(S=this.domain,j){if(l=arguments[1],S)l||(l=new Error('Uncaught, unspecified "error" event')),l.domainEmitter=this,l.domain=S,l.domainThrown=!1,S.emit("error",l);else{if(l instanceof Error)throw l;var F=new Error('Uncaught, unspecified "error" event. ('+l+")");throw F.context=l,F}return!1}if(p=w[v],!p)return!1;var z=typeof p=="function";switch(f=arguments.length,f){case 1:X(p,z,this);break;case 2:Z(p,z,this,arguments[1]);break;case 3:$e(p,z,this,arguments[1],arguments[2]);break;case 4:De(p,z,this,arguments[1],arguments[2],arguments[3]);break;default:for(g=new Array(f-1),h=1;h<f;h++)g[h-1]=arguments[h];ue(p,z,this,g)}return!0};function Te(m,v,l,p){var f,g,h;if(typeof l!="function")throw new TypeError('"listener" argument must be a function');if(g=m._events,g?(g.newListener&&(m.emit("newListener",v,l.listener?l.listener:l),g=m._events),h=g[v]):(g=m._events=new J,m._eventsCount=0),!h)h=g[v]=l,++m._eventsCount;else if(typeof h=="function"?h=g[v]=p?[l,h]:[h,l]:p?h.unshift(l):h.push(l),!h.warned&&(f=C(m),f&&f>0&&h.length>f)){h.warned=!0;var w=new Error("Possible EventEmitter memory leak detected. "+h.length+" "+v+" listeners added. Use emitter.setMaxListeners() to increase limit");w.name="MaxListenersExceededWarning",w.emitter=m,w.type=v,w.count=h.length,E(w)}return m}function E(m){typeof console.warn=="function"?console.warn(m):console.log(m)}k.prototype.addListener=function(v,l){return Te(this,v,l,!1)},k.prototype.on=k.prototype.addListener,k.prototype.prependListener=function(v,l){return Te(this,v,l,!0)};function $(m,v,l){var p=!1;function f(){m.removeListener(v,f),p||(p=!0,l.apply(m,arguments))}return f.listener=l,f}k.prototype.once=function(v,l){if(typeof l!="function")throw new TypeError('"listener" argument must be a function');return this.on(v,$(this,v,l)),this},k.prototype.prependOnceListener=function(v,l){if(typeof l!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(v,$(this,v,l)),this},k.prototype.removeListener=function(v,l){var p,f,g,h,w;if(typeof l!="function")throw new TypeError('"listener" argument must be a function');if(f=this._events,!f)return this;if(p=f[v],!p)return this;if(p===l||p.listener&&p.listener===l)--this._eventsCount===0?this._events=new J:(delete f[v],f.removeListener&&this.emit("removeListener",v,p.listener||l));else if(typeof p!="function"){for(g=-1,h=p.length;h-- >0;)if(p[h]===l||p[h].listener&&p[h].listener===l){w=p[h].listener,g=h;break}if(g<0)return this;if(p.length===1){if(p[0]=void 0,--this._eventsCount===0)return this._events=new J,this;delete f[v]}else P(p,g);f.removeListener&&this.emit("removeListener",v,w||l)}return this},k.prototype.off=function(m,v){return this.removeListener(m,v)},k.prototype.removeAllListeners=function(v){var l,p;if(p=this._events,!p)return this;if(!p.removeListener)return arguments.length===0?(this._events=new J,this._eventsCount=0):p[v]&&(--this._eventsCount===0?this._events=new J:delete p[v]),this;if(arguments.length===0){for(var f=Object.keys(p),g=0,h;g<f.length;++g)h=f[g],h!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events=new J,this._eventsCount=0,this}if(l=p[v],typeof l=="function")this.removeListener(v,l);else if(l)do this.removeListener(v,l[l.length-1]);while(l[0]);return this},k.prototype.listeners=function(v){var l,p,f=this._events;return f?(l=f[v],l?typeof l=="function"?p=[l.listener||l]:p=_e(l):p=[]):p=[],p},k.listenerCount=function(m,v){return typeof m.listenerCount=="function"?m.listenerCount(v):q.call(m,v)},k.prototype.listenerCount=q;function q(m){var v=this._events;if(v){var l=v[m];if(typeof l=="function")return 1;if(l)return l.length}return 0}k.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function P(m,v){for(var l=v,p=l+1,f=m.length;p<f;l+=1,p+=1)m[l]=m[p];m.pop()}function U(m,v){for(var l=new Array(v);v--;)l[v]=m[v];return l}function _e(m){for(var v=new Array(m.length),l=0;l<v.length;++l)v[l]=m[l].listener||m[l];return v}var de=me.getLogger("twilsock");function ye(m,v){return["".concat(new Date().toISOString()," Twilsock ").concat(m,":")].concat(Array.from(v))}var Ce=function(){function m(v){se.default(this,m),ee.default(this,"prefix",""),this.prefix=v!=null&&v.length>0?" "+v+":":""}return Ie.default(m,[{key:"setLevel",value:function(l){de.setLevel(l)}},{key:"trace",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];de.trace.apply(null,ye("T",p))}},{key:"debug",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];de.debug.apply(null,ye("D",p))}},{key:"info",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];de.info.apply(null,ye("I",p))}},{key:"warn",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];de.warn.apply(null,ye("W",p))}},{key:"error",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];de.error.apply(null,ye("E",p))}}],[{key:"setLevel",value:function(l){de.setLevel(l)}},{key:"trace",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];de.trace.apply(null,ye("T",p))}},{key:"debug",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];de.debug.apply(null,ye("D",p))}},{key:"info",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];de.info.apply(null,ye("I",p))}},{key:"warn",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];de.warn.apply(null,ye("W",p))}},{key:"error",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];de.error.apply(null,ye("E",p))}}]),m}(),K=new Ce(""),je="0.12.2",Me=function(){function m(v,l,p){se.default(this,m),ee.default(this,"confirmedCapabilities",new Set),this.activeGrant=l,this._token=v;var f=p.region||"us1",g="wss://tsock.".concat(f,".twilio.com/v3/wsconnect"),h=p.twilsock||p.Twilsock||{};this.url=h.uri||g,this._continuationToken=p.continuationToken?p.continuationToken:null,this.logLevel=p.logLevel?p.logLevel:"error",this.retryPolicy=p.retryPolicy?p.retryPolicy:{min:1*1e3,max:2*60*1e3,randomness:.2},this.clientMetadata=p.clientMetadata?p.clientMetadata:{},this.clientMetadata.ver=je,this.initRegistrations=p.initRegistrations?p.initRegistrations:null,this.tweaks=p.tweaks?p.tweaks:null}return Ie.default(m,[{key:"token",get:function(){return this._token}},{key:"continuationToken",get:function(){return this._continuationToken}},{key:"updateToken",value:function(l){this._token=l}},{key:"updateContinuationToken",value:function(l){this._continuationToken=l}}]),m}(),Oe=function m(v){se.default(this,m),this.id=v||"TM".concat(N.v4())};function xe(m){var v=Ue();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function Ue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Le=function(m){B.default(l,m);var v=xe(l);function l(p,f,g,h,w){var S;return se.default(this,l),S=v.call(this),ee.default(L.default(S),"method","init"),S.token=p,S.continuation_token=f,S.metadata=g,S.registrations=h,S.tweaks=w,S.capabilities=["client_update","offline_storage","telemetry.v1"],S}return l}(Oe);function Ge(m){var v=et();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function et(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var er=function(m){B.default(l,m);var v=Ge(l);function l(p,f,g,h,w,S,j){var F;return se.default(this,l),F=v.call(this,p),F.continuationToken=f,F.continuationTokenStatus=h,F.offlineStorage=w,F.initRegistrations=S,F.debugInfo=j,F.confirmedCapabilities=g,F}return l}(Oe);function _r(m){var v=hn();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function hn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ir=function(m){B.default(l,m);var v=_r(l);function l(p){var f;return se.default(this,l),f=v.call(this),ee.default(L.default(f),"method","update"),f.token=p,f}return l}(Oe);function bt(m){var v=jt();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function jt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ie=function(m){B.default(l,m);var v=bt(l);function l(p,f,g){var h;return se.default(this,l),h=v.call(this),ee.default(L.default(h),"method","message"),h.active_grant=p,h.payload_type=f,h.http_request=g,h}return l}(Oe);function ce(m){var v=Y();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function Y(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var re=function(m){B.default(l,m);var v=ce(l);function l(p){var f;return se.default(this,l),f=v.call(this,p),ee.default(L.default(f),"method","reply"),ee.default(L.default(f),"payload_type","application/json"),ee.default(L.default(f),"status",{code:200,status:"OK"}),f}return l}(Oe);function Q(m){var v=he();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function he(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var be=function(m){B.default(l,m);var v=Q(l);function l(){var p;return se.default(this,l),p=v.call(this),ee.default(L.default(p),"method","close"),p}return l}(Oe);function Pe(m){var v=Xe();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function Xe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var at=function m(v,l,p,f,g,h){se.default(this,m),this.start=v,this.end=l,this.title=p,this.details=f,this.id=g,this.type=h},tt=function(m){B.default(l,m);var v=Pe(l);function l(p){var f;return se.default(this,l),f=v.call(this),ee.default(L.default(f),"method","telemetry.v1"),f.events=p,f}return l}(Oe);function Fe(m){var v=encodeURIComponent(m),l=v.replace(/%([0-9A-F]{2})/g,function(p,f){return String.fromCharCode(Number("0x"+f))});return l.length}function Sr(m){var v=encodeURIComponent(m),l=v.replace(/%([0-9A-F]{2})/g,function(f,g){return String.fromCharCode(Number("0x"+g))}),p=new Uint8Array(l.length);return Array.prototype.forEach.call(l,function(f,g){p[g]=f.charCodeAt(0)}),p}function Je(m){var v=Array.prototype.map.call(m,function(p){return String.fromCharCode(p)}).join(""),l=v.replace(/(.)/g,function(p,f){var g=f.charCodeAt(0).toString(16).toUpperCase();return g.length<2&&(g="0"+g),"%"+g});return decodeURIComponent(l)}function Wt(m){return JSON.parse(Je(m))}function Ut(m){for(var v="",l=0;l<m.length;++l){var p=String.fromCharCode(m[l]);if(v+=p,p==="\r"){l+=2;break}}var f=v.split(" ");return{size:l,protocol:f[0],version:f[1],headerSize:Number(f[2])}}var $i=function(){function m(){se.default(this,m)}return Ie.default(m,null,[{key:"parse",value:function(l){var p=2,f=new Uint8Array(l),g=Ut(f);if(g.protocol!=="TWILSOCK"||g.version!=="V3.0")return K.error("unsupported protocol: ".concat(g.protocol," ver ").concat(g.version)),null;var h;try{h=Wt(f.subarray(g.size,g.size+g.headerSize))}catch(F){return K.error("failed to parse message header",F,l),null}K.debug("message received: ",h.method),K.trace("message received: ",h);var w;if(h.payload_size>0){var S=p+g.size+g.headerSize,j=h.payload_size;if(!h.hasOwnProperty("payload_type")||h.payload_type.indexOf("application/json")===0)try{w=Wt(f.subarray(S,S+j))}catch(F){return K.error("failed to parse message body",F,l),null}else h.payload_type.indexOf("text/plain")===0&&(w=Je(f.subarray(S,S+j)))}return{method:h.method,header:h,payload:w}}},{key:"createPacket",value:function(l){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";l.payload_size=Fe(p);var f=JSON.stringify(l),g="TWILSOCK V3.0 "+Fe(f);K.debug("send request:",g+f+p);var h=Sr(g+`\r
`+f+`\r
`+p);return h.buffer}}]),m}();function Jn(m){var v=Pn();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function Pn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Et=function(m){B.default(l,m);var v=Jn(l);function l(p){return se.default(this,l),v.call(this,p)}return l}(Ne.default(Error));function Dt(m){var v=Lr();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function Lr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Rr=function(m){B.default(l,m);var v=Dt(l);function l(p,f){var g;return se.default(this,l),g=v.call(this,p),g.reply=f,g}return l}(Et);function pa(m,v){var l=Object.keys(m);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(m);v&&(p=p.filter(function(f){return Object.getOwnPropertyDescriptor(m,f).enumerable})),l.push.apply(l,p)}return l}function ls(m){for(var v=1;v<arguments.length;v++){var l=arguments[v]!=null?arguments[v]:{};v%2?pa(Object(l),!0).forEach(function(p){ee.default(m,p,l[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(l)):pa(Object(l)).forEach(function(p){Object.defineProperty(m,p,Object.getOwnPropertyDescriptor(l,p))})}return m}function jr(m){var v=cs();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function cs(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _o=function(m){B.default(l,m);var v=jr(l);function l(p){var f;return se.default(this,l),f=v.call(this),ee.default(L.default(f),"newBackoff",null),ee.default(L.default(f),"usedBackoff",null),ee.default(L.default(f),"retrier",null),f.options=p?ls({},p):{},f}return Ie.default(l,[{key:"inProgress",get:function(){return!!this.retrier}},{key:"start",value:function(){if(this.inProgress)throw new Error("Already waiting for next attempt, call finishAttempt(success : boolean) to finish it");this.createRetrier()}},{key:"stop",value:function(){this.cleanRetrier(),this.newBackoff=null,this.usedBackoff=null}},{key:"modifyBackoff",value:function(f){this.newBackoff=f}},{key:"attemptFailed",value:function(){if(!this.inProgress)throw new Error("No attempt is in progress");if(this.newBackoff){var f=!this.usedBackoff||this.usedBackoff<this.newBackoff;if(f)this.createRetrier();else{var g;(g=this.retrier)===null||g===void 0||g.failed(new Error)}}else{var h;(h=this.retrier)===null||h===void 0||h.failed(new Error)}}},{key:"cancel",value:function(){var f;(f=this.retrier)===null||f===void 0||f.cancel()}},{key:"cleanRetrier",value:function(){var f,g;(f=this.retrier)===null||f===void 0||f.removeAllListeners(),(g=this.retrier)===null||g===void 0||g.cancel(),this.retrier=null}},{key:"getRetryPolicy",value:function(){var f=ls({},this.options);return this.newBackoff&&(f.min=this.newBackoff,f.max=this.options.max&&this.options.max>this.newBackoff?this.options.max:this.newBackoff),f.maxAttemptsCount=this.options.maxAttemptsCount?this.options.maxAttemptsCount+1:void 0,f}},{key:"createRetrier",value:function(){var f=this;this.cleanRetrier();var g=this.getRetryPolicy();this.retrier=new H.Retrier(g),this.retrier.once("attempt",function(){var h,w;(h=f.retrier)===null||h===void 0||h.on("attempt",function(){return f.emit("attempt")}),(w=f.retrier)===null||w===void 0||w.failed(new Error("Skipping first attempt"))}),this.retrier.on("failed",function(h){return f.emit("failed",h)}),this.usedBackoff=this.newBackoff,this.newBackoff=null,this.retrier.start()}}]),l}(k);function So(m){var v=pr();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function pr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vn=3e3;function Vr(m){setTimeout(m,0)}var _t=function(m){B.default(l,m);var v=So(l);function l(p,f,g){var h;se.default(this,l),h=v.call(this),ee.default(L.default(h),"disconnectingTimer",null),ee.default(L.default(h),"disconnectedPromiseResolve",null),ee.default(L.default(h),"terminalStates",["disconnected","rejected"]),ee.default(L.default(h),"tokenExpiredSasCode",20104),ee.default(L.default(h),"terminationReason","Connection is not initialized"),h.websocket=p,h.websocket.on("connected",function(){return h.fsm.socketConnected()}),h.websocket.on("disconnected",function(){return h.fsm.socketClosed()}),h.websocket.on("message",function(S){return h.onIncomingMessage(S)}),h.websocket.on("socketError",function(S){return h.emit("connectionError",{terminal:!1,message:"Socket error: ".concat(S.message),httpStatusCode:null,errorCode:null})}),h.transport=f,h.config=g,h.retrier=new _o(g.retryPolicy),h.retrier.on("attempt",function(){return h.retry()}),h.retrier.on("failed",function(S){K.warn("Retrying failed: ".concat(S.message)),h.disconnect()}),typeof window<"u"&&typeof window.addEventListener<"u"&&(window.addEventListener("online",function(){K.debug("Browser reported connectivity state: online"),h.resetBackoff(),h.fsm.systemOnline()}),window.addEventListener("offline",function(){K.debug("Browser reported connectivity state: offline"),h.websocket.close(),h.fsm.socketClosed()}));var w=A.factory({init:"disconnected",transitions:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"},{name:"userSend",from:["connected"],to:"connected"},{name:"systemOnline",from:["retrying"],to:"connecting"}],methods:{onConnecting:function(){h.setupSocket(),h.emit("connecting")},onEnterInitialising:function(){h.sendInit()},onLeaveInitialising:function(){h.cancelInit()},onEnterUpdating:function(){h.sendUpdate()},onLeaveUpdating:function(){h.cancelUpdate()},onEnterRetrying:function(){h.initRetry(),h.emit("connecting")},onEnterConnected:function(){h.resetBackoff(),h.onConnected()},onUserUpdateToken:function(){h.resetBackoff()},onTokenRejected:function(){h.resetBackoff(),h.closeSocket(!0),h.finalizeSocket()},onUserDisconnect:function(){h.closeSocket(!0)},onEnterDisconnecting:function(){h.startDisconnectTimer()},onLeaveDisconnecting:function(){h.cancelDisconnectTimer()},onEnterWaitSocketClosed:function(){h.startDisconnectTimer()},onLeaveWaitSocketClosed:function(){h.cancelDisconnectTimer()},onEnterWaitOffloadSocketClosed:function(){h.startDisconnectTimer()},onLeaveWaitOffloadSocketClosed:function(){h.cancelDisconnectTimer()},onDisconnected:function(){h.resetBackoff(),h.finalizeSocket()},onReceiveClose:function(){h.onCloseReceived()},onReceiveOffload:function(j,F){K.debug("onreceiveoffload: ",F),h.modifyBackoff(F.body),h.onCloseReceived()},onUnsupported:function(){h.closeSocket(!0),h.finalizeSocket()},onError:function(j,F){h.closeSocket(F),h.finalizeSocket()},onEnterState:function(j){j.from!=="none"&&h.changeState(j)},onInvalidTransition:function(j,F,z){K.warn("FSM: unexpected transition",F,z)}}});return h.fsm=new w,h}return Ie.default(l,[{key:"changeState",value:function(f){K.debug("FSM: ".concat(f.transition,": ").concat(f.from," --> ").concat(f.to)),this.lastEmittedState!==this.state&&(this.lastEmittedState=this.state,this.emit("stateChanged",this.state))}},{key:"resetBackoff",value:function(){K.trace("resetBackoff"),this.retrier.stop()}},{key:"modifyBackoff",value:function(f){K.trace("modifyBackoff",f);var g=f?f.backoff_policy:null;g&&typeof g.reconnect_min_ms=="number"&&this.retrier.modifyBackoff(g.reconnect_min_ms)}},{key:"startDisconnectTimer",value:function(){var f=this;K.trace("startDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null),this.disconnectingTimer=setTimeout(function(){K.debug("disconnecting is timed out"),f.closeSocket(!0)},vn)}},{key:"cancelDisconnectTimer",value:function(){K.trace("cancelDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null)}},{key:"isConnected",get:function(){return this.state==="connected"&&this.websocket.isConnected}},{key:"state",get:function(){switch(this.fsm.state){case"connecting":case"initialising":case"retrying":case"error":return"connecting";case"updating":case"connected":return"connected";case"rejected":return"denied";case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return"disconnecting";case"disconnected":default:return"disconnected"}}},{key:"initRetry",value:function(){K.debug("initRetry"),this.retrier.inProgress?this.retrier.attemptFailed():this.retrier.start()}},{key:"retry",value:function(){this.fsm.state!="connecting"?(K.trace("retry"),this.websocket.close(),this.fsm.userRetry()):K.trace("can	 retry as already connecting")}},{key:"onConnected",value:function(){this.emit("connected")}},{key:"finalizeSocket",value:function(){K.trace("finalizeSocket"),this.websocket.close(),this.emit("disconnected"),this.disconnectedPromiseResolve&&(this.disconnectedPromiseResolve(),this.disconnectedPromiseResolve=null)}},{key:"setupSocket",value:function(){K.trace("setupSocket:",this.config.token),this.emit("beforeConnect"),this.websocket.connect()}},{key:"onIncomingMessage",value:function(f){var g=$i.parse(f);if(!!g){var h=g.method,w=g.header,S=g.payload;if(h!=="reply"&&this.confirmReceiving(w),h==="notification")this.emit("message",w.message_type,S);else if(w.method==="reply")this.transport.processReply({id:w.id,status:w.status,header:w,body:S});else if(w.method==="client_update")w.client_update_type==="token_about_to_expire"&&this.emit("tokenAboutToExpire");else if(w.method==="close")if(w.status.code===308)K.debug("Connection has been offloaded"),this.fsm.receiveOffload({status:w.status.status,body:S});else if(w.status.code===406){var j="Server closed connection because can't parse protocol: ".concat(JSON.stringify(w.status));this.emitReplyConnectionError(j,w,!0),K.error(j),this.fsm.receiveFatalClose()}else w.status.code===417?(K.error("Server closed connection because can't parse client reply: ".concat(JSON.stringify(w.status))),this.fsm.receiveFatalClose(w.status.status)):w.status.code===410?(K.warn("Server closed connection: ".concat(JSON.stringify(w.status))),this.fsm.receiveClose(w.status.status),this.emit("tokenExpired")):w.status.code===401?(K.error("Server closed connection: ".concat(JSON.stringify(w.status))),this.fsm.receiveClose(w.status.status)):(K.warn("unexpected message: ",w.status),this.fsm.receiveOffload({status:w.status.status,body:null}))}}},{key:"sendInit",value:function(){var p=Re.default(ne.default.mark(function g(){var h,w;return ne.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return K.trace("sendInit"),j.prev=1,this.emit("beforeSendInit"),j.next=5,this.transport.sendInit();case 5:h=j.sent,this.config.updateContinuationToken(h.continuationToken),this.config.confirmedCapabilities=h.confirmedCapabilities,this.fsm.initSuccess(h),this.emit("initialized",h),this.emit("tokenUpdated"),j.next=17;break;case 13:j.prev=13,j.t0=j.catch(1),j.t0 instanceof Rr?(w=!1,K.warn("Init rejected by server: ".concat(JSON.stringify(j.t0.reply.status))),this.emit("sendInitFailed"),j.t0.reply.status.code===401||j.t0.reply.status.code===403?(w=!0,this.fsm.tokenRejected(j.t0.reply.status),j.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):j.t0.reply.status.code===429?(this.modifyBackoff(j.t0.reply.body),this.fsm.initError(!0)):j.t0.reply.status.code===500?this.fsm.initError(!1):this.fsm.initError(!0),this.emitReplyConnectionError(j.t0.message,j.t0.reply,w)):(this.terminationReason=j.t0.message,this.emit("connectionError",{terminal:!0,message:"Unknown error during connection initialisation: ".concat(j.t0.message,`
`).concat(JSON.stringify(j.t0,null,2)),httpStatusCode:null,errorCode:null}),this.fsm.initError(!0)),this.emit("tokenUpdated",j.t0);case 17:case"end":return j.stop()}},g,this,[[1,13]])}));function f(){return p.apply(this,arguments)}return f}()},{key:"sendUpdate",value:function(){var p=Re.default(ne.default.mark(function g(){var h,w,S;return ne.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return K.trace("sendUpdate"),h=new Ir(this.config.token),F.prev=2,F.next=5,this.transport.sendWithReply(h);case 5:w=F.sent,this.fsm.updateSuccess(w.body),this.emit("tokenUpdated"),F.next=14;break;case 10:F.prev=10,F.t0=F.catch(2),F.t0 instanceof Rr?(S=!1,K.warn("Token update rejected by server: ".concat(JSON.stringify(F.t0.reply.status))),F.t0.reply.status.code===401||F.t0.reply.status.code===403?(S=!0,this.fsm.tokenRejected(F.t0.reply.status),F.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):F.t0.reply.status.code===429?(this.modifyBackoff(F.t0.reply.body),this.fsm.updateError(F.t0.reply.status)):this.fsm.updateError(F.t0.reply.status),this.emitReplyConnectionError(F.t0.message,F.t0.reply,S)):(this.emit("error",!1,F.t0.message,null,null),this.fsm.updateError(F.t0)),this.emit("tokenUpdated",F.t0);case 14:case"end":return F.stop()}},g,this,[[2,10]])}));function f(){return p.apply(this,arguments)}return f}()},{key:"emitReplyConnectionError",value:function(f,g,h){var w=g.status&&g.status.description?g.status.description:f,S=g.status.code,j=g.status&&g.status.errorCode?g.status.errorCode:null;h&&(this.terminationReason=w),this.emit("connectionError",{terminal:h,message:"Connection error: ".concat(w),httpStatusCode:S,errorCode:j})}},{key:"cancelInit",value:function(){K.trace("cancelInit")}},{key:"cancelUpdate",value:function(){K.trace("cancelUpdate")}},{key:"confirmReceiving",value:function(f){K.trace("confirmReceiving");try{this.transport.send(new re(f.id))}catch(g){K.debug("failed to confirm packet receiving",g)}}},{key:"closeSocket",value:function(f){var g=this;K.trace("closeSocket (graceful: ".concat(f,")")),f&&this.transport.isConnected&&this.transport.sendClose(),this.websocket.close(),Vr(function(){return g.fsm.socketClosed()})}},{key:"connect",value:function(){K.trace("connect"),this.fsm.userConnect()}},{key:"disconnect",value:function(){var f=this;return K.trace("disconnect"),this.fsm.is("disconnected")?Promise.resolve():new Promise(function(g){f.disconnectedPromiseResolve=g,f.fsm.userDisconnect()})}},{key:"updateToken",value:function(f){var g=this;return K.trace("updateToken:",f),new Promise(function(h,w){g.once("tokenUpdated",function(S){S?w(S):h()}),g.fsm.userUpdateToken()})}},{key:"isTerminalState",get:function(){return this.terminalStates.indexOf(this.fsm.state)!==-1}},{key:"getTerminationReason",get:function(){return this.terminationReason}},{key:"onCloseReceived",value:function(){this.websocket.close()}}]),l}(k),$o=function(){function m(){se.default(this,m)}return Ie.default(m,null,[{key:"getMetadata",value:function(l){var p,f,g,h,w,S,j,F,z=l&&l.clientMetadata?l.clientMetadata:{},pe=["ver","env","envv","os","osv","osa","type","sdk","sdkv","dev","devv","devt","app","appv"],qe={env:(p=ft.name)!==null&&p!==void 0?p:"unknown",envv:(f=ft.version)!==null&&f!==void 0?f:"unknown",os:(g=(h=ft.os)===null||h===void 0?void 0:h.family)!==null&&g!==void 0?g:"unknown",osv:(w=(S=ft.os)===null||S===void 0?void 0:S.version)!==null&&w!==void 0?w:"unknown",osa:(j=(F=ft.os)===null||F===void 0?void 0:F.architecture)!==null&&j!==void 0?j:"unknown",sdk:"js-default"},it={};return pe.filter(function(We){return We in z||We in qe}).forEach(function(We){return it[We]=We in z?z[We]:qe[We]}),it}}]),m}(),ko=3e4;function To(m){return m>=200&&m<300}function fs(m){switch(te.default(m)){case"undefined":return"";case"object":return JSON.stringify(m);default:return m}}var Yn=function(){function m(v,l){var p=this;se.default(this,m),this.config=l,this.activeRequests=new Map,this.channel=v,this.channel.on("reply",function(f){return p.processReply(f)}),this.channel.on("disconnected",function(){p.activeRequests.forEach(function(f){clearTimeout(f.timeout),f.reject(new Et("disconnected"))}),p.activeRequests.clear()})}return Ie.default(m,[{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"processReply",value:function(l){var p=this.activeRequests.get(l.id);p&&(clearTimeout(p.timeout),this.activeRequests.delete(l.id),To(l.status.code)?p.resolve(l):(p.reject(new Rr("Transport failure: "+l.status.status,l)),K.trace("message rejected")))}},{key:"storeRequest",value:function(l,p,f){var g={resolve:p,reject:f,timeout:setTimeout(function(){K.trace("request",l,"is timed out"),f(new Et("Twilsock: request timeout: "+l))},ko)};this.activeRequests.set(l,g)}},{key:"shutdown",value:function(){this.activeRequests.forEach(function(l){clearTimeout(l.timeout),l.reject(new Et("Twilsock: request cancelled by user"))}),this.activeRequests.clear()}},{key:"sendInit",value:function(){var v=Re.default(ne.default.mark(function p(){var f,g,h;return ne.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return K.trace("sendInit"),f=$o.getMetadata(this.config),g=new Le(this.config.token,this.config.continuationToken,f,this.config.initRegistrations,this.config.tweaks),S.next=5,this.sendWithReply(g);case 5:return h=S.sent,S.abrupt("return",new er(h.id,h.header.continuation_token,new Set(h.header.capabilities),h.header.continuation_token_status,h.header.offline_storage,h.header.init_registrations,h.header.debug_info));case 7:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"sendClose",value:function(){var l=new be;this.send(l)}},{key:"sendWithReply",value:function(l,p){var f=this;return new Promise(function(g,h){var w=f.send(l,p);f.storeRequest(w,g,h)})}},{key:"send",value:function(l,p){l.id=l.id||"TM".concat(N.v4());var f=$i.createPacket(l,fs(p));try{return this.channel.send(f),l.id}catch(g){throw K.debug("failed to send ",l,g),K.trace(g.stack),g}}}]),m}();function Eo(m){var v=Co();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function Co(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Kr=function(m){B.default(l,m);var v=Eo(l);function l(p){var f;return se.default(this,l),f=v.call(this),ee.default(L.default(f),"socket",null),f.url=p,f.url=p,f.WebSocket=t.WebSocket||t.MozWebSocket||{},f}return Ie.default(l,[{key:"isConnected",get:function(){return!!this.socket&&this.socket.readyState===1}},{key:"connect",value:function(){var f=this;K.trace("connecting to socket");var g;try{g=new this.WebSocket(this.url)}catch(h){K.debug("Socket error: ".concat(this.url)),this.emit("socketError",h);return}g.binaryType="arraybuffer",g.onopen=function(){K.debug("socket opened ".concat(f.url)),f.emit("connected")},g.onclose=function(h){K.debug("socket closed",h),f.emit("disconnected",h)},g.onerror=function(h){K.debug("Socket error:",h),f.emit("socketError",h)},g.onmessage=function(h){f.emit("message",h.data)},this.socket=g}},{key:"send",value:function(f){return this.socket&&this.socket.send(f)}},{key:"close",value:function(){if(K.trace("closing socket"),this.socket){this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null;try{this.socket.close()}finally{}}}}]),l}(k);function $r(m){var v=Io();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function Io(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ro=function(m){B.default(l,m);var v=$r(l);function l(p){var f;return se.default(this,l),f=v.call(this),f.transport=p,f.registrations=new Map,f.registrationsInProgress=new Map,f}return Ie.default(l,[{key:"putNotificationContext",value:function(){var p=Re.default(ne.default.mark(function g(h,w){var S;return ne.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return S={method:"put_notification_ctx",notification_ctx_id:h},F.next=3,this.transport.sendWithReply(S,w);case 3:case"end":return F.stop()}},g,this)}));function f(g,h){return p.apply(this,arguments)}return f}()},{key:"deleteNotificationContext",value:function(){var p=Re.default(ne.default.mark(function g(h){var w;return ne.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return w={method:"delete_notification_ctx",notification_ctx_id:h},j.next=3,this.transport.sendWithReply(w);case 3:case"end":return j.stop()}},g,this)}));function f(g){return p.apply(this,arguments)}return f}()},{key:"updateRegistration",value:function(){var p=Re.default(ne.default.mark(function g(h,w){var S,j;return ne.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return K.debug("update registration for context",h),S=this.registrationsInProgress.get(h),S||(S=new Set,this.registrationsInProgress.set(h,S)),j=N.v4(),S.add(j),z.prev=5,z.next=8,this.putNotificationContext(h,w);case 8:K.debug("registration attempt succeeded for context",w),S.delete(j),S.size===0&&(this.registrationsInProgress.delete(h),this.emit("registered",h)),z.next=19;break;case 13:z.prev=13,z.t0=z.catch(5),K.warn("registration attempt failed for context",w),K.debug(z.t0),S.delete(j),S.size===0&&(this.registrationsInProgress.delete(h),this.emit("registrationFailed",h,z.t0));case 19:case"end":return z.stop()}},g,this,[[5,13]])}));function f(g,h){return p.apply(this,arguments)}return f}()},{key:"updateRegistrations",value:function(){var p=Re.default(ne.default.mark(function g(){var h=this,w;return ne.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return K.trace("refreshing ".concat(this.registrations.size," registrations")),w=[],this.registrations.forEach(function(F,z){w.push(h.updateRegistration(z,F))}),j.next=5,Promise.all(w);case 5:case"end":return j.stop()}},g,this)}));function f(){return p.apply(this,arguments)}return f}()},{key:"setNotificationsContext",value:function(){var p=Re.default(ne.default.mark(function g(h,w){return ne.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!(!h||!w)){j.next=2;break}throw new Et("Invalid arguments provided");case 2:return this.registrations.set(h,w),j.next=5,this.updateRegistration(h,w);case 5:return j.abrupt("return",j.sent);case 6:case"end":return j.stop()}},g,this)}));function f(g,h){return p.apply(this,arguments)}return f}()},{key:"removeNotificationsContext",value:function(){var p=Re.default(ne.default.mark(function g(h){return ne.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(this.registrations.has(h)){S.next=2;break}return S.abrupt("return");case 2:return S.next=4,this.deleteNotificationContext(h);case 4:this.transport.isConnected&&this.registrations.delete(h);case 5:case"end":return S.stop()}},g,this)}));function f(g){return p.apply(this,arguments)}return f}()}]),l}(k);function Oo(m){var v=Ao();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function Ao(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ki=function(m){B.default(l,m);var v=Oo(l);function l(p,f,g){var h;return se.default(this,l),h=v.call(this,f),h.status=p,h.description=f,h.body=g,h}return l}(Et);function Ti(m){var v=Ei();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function Ei(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var gn=function(m){B.default(l,m);var v=Ti(l);function l(p){return se.default(this,l),v.call(this,p)}return l}(Et),ha=2e4;function ds(m){return m>=200&&m<300}function ps(m){return m&&m.header&&m.header.http_status}function Po(m){var v=m.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(v){var l={protocol:v[1],host:v[2],hostname:v[3],port:v[4],pathname:v[5],search:v[6],hash:v[7],params:{}};if(l.search.length>0){var p=l.search.substring(1);l.params=p.split("&").map(function(f){return f.split("=")}).reduce(function(f,g){return f.hasOwnProperty(g[0])?Array.isArray(f[g[0]])?f[g[0]].push(g[1]):f[g[0]]=[f[g[0]],g[1]]:f[g[0]]=g[1],f},{})}return l}throw new Et("Incorrect URI: "+m)}function Mo(m,v){var l=Po(v),p={method:m,host:l.host,path:l.pathname};return l.params&&(p.params=l.params),p}function St(m,v,l,p,f){return{to:Mo(m,v),headers:l,body:p,grant:f}}var va=function(){function m(v,l,p){se.default(this,m),this.config=p,this.transport=v,this.pendingMessages=[],this.twilsock=l}return Ie.default(m,[{key:"saveMessage",value:function(l){var p=this;return new Promise(function(f,g){var h={message:l,resolve:f,reject:g,alreadyRejected:!1,timeout:setTimeout(function(){K.debug("request is timed out"),g(new Et("request '".concat(l.to.method,"' to '").concat(l.to.host,"' timed out"))),h.alreadyRejected=!0},ha)};p.pendingMessages.push(h)})}},{key:"sendPendingMessages",value:function(){for(var l=this,p=function(){var h=l.pendingMessages[0];if(!h.alreadyRejected)try{var w=h.message;l.actualSend(w).then(function(S){return h.resolve(S)}).catch(function(S){return h.reject(S)}),clearTimeout(h.timeout)}catch(S){return K.debug("Failed to send pending message",S),"break"}l.pendingMessages.splice(0,1)};this.pendingMessages.length>0;){var f=p();if(f==="break")break}}},{key:"rejectPendingMessages",value:function(){var l=this;this.pendingMessages.forEach(function(p){p.reject(new gn("Unable to connect: "+l.twilsock.getTerminationReason)),p.alreadyRejected=!0,clearTimeout(p.timeout)}),this.pendingMessages.splice(0,this.pendingMessages.length)}},{key:"actualSend",value:function(){var v=Re.default(ne.default.mark(function p(f){var g,h,w,S,j,F,z,pe;return ne.default.wrap(function(it){for(;;)switch(it.prev=it.next){case 0:return h=f.to,w=f.headers,S=f.body,j=(g=f.grant)!==null&&g!==void 0?g:this.config.activeGrant,F={host:h.host,path:h.path,method:h.method,params:h.params,headers:w},z=new ie(j,w["Content-Type"]||"application/json",F),K.trace("Sending upstream message",z),it.next=9,this.transport.sendWithReply(z,S);case 9:if(pe=it.sent,K.trace("Received upstream message response",pe),!(ps(pe)&&!ds(pe.header.http_status.code))){it.next=13;break}throw new ki(pe.header.http_status.code,pe.header.http_status.status,pe.body);case 13:return it.abrupt("return",{status:pe.header.http_status,headers:pe.header.http_headers,body:pe.body});case 14:case"end":return it.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"send",value:function(l,p){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},g=arguments.length>3?arguments[3]:void 0,h=arguments.length>4?arguments[4]:void 0;if(this.twilsock.isTerminalState)return Promise.reject(new gn("Unable to connect: "+this.twilsock.getTerminationReason));var w=St(l,p,f,g,h);return this.twilsock.isConnected?this.actualSend(w):this.saveMessage(w)}}]),m}(),hs=function(){function m(){var v=this;se.default(this,m),this._promise=new Promise(function(l,p){v._resolve=l,v._reject=p})}return Ie.default(m,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(l){this._resolve(l)}},{key:"set",value:function(l){this._resolve(l)}},{key:"fail",value:function(l){this._reject(l)}}]),m}(),Ci=function(){function m(v){se.default(this,m),this.id=v}return Ie.default(m,null,[{key:"create",value:function(l){if(l instanceof Object&&"storage_id"in l)return new m(l.storage_id);throw new Et('Field "storage_id" is missing')}}]),m}(),ga=function(){function m(){return se.default(this,m),ee.default(this,"initializedFlag","twilio_twilsock_token_storage"),ee.default(this,"tokenStoragePrefix","twilio_continuation_token_"),m._instance||(this.initialize(),m._instance=this),m._instance}return Ie.default(m,[{key:"sessionStorage",value:function(){try{return t.sessionStorage}catch{return null}}},{key:"window",value:function(){try{return t.window}catch{return null}}},{key:"storeToken",value:function(l,p){this.canStore()&&this.sessionStorage.setItem(this.getKeyName(p),l)}},{key:"getStoredToken",value:function(l){return this.canStore()?this.sessionStorage.getItem(this.getKeyName(l)):null}},{key:"initialize",value:function(){var l=this;if(this.canStore()){var p=this.sessionStorage.getItem(this.initializedFlag);p&&this.clear(),this.sessionStorage.setItem(this.initializedFlag,"true");var f=this.sessionStorage.removeItem;this.window.addEventListener("unload",function(){f(l.initializedFlag)})}}},{key:"clear",value:function(){if(this.canStore()){for(var l=[],p=0;p<this.sessionStorage.length;p++){var f=this.sessionStorage.key(p);f&&f.indexOf(this.tokenStoragePrefix)===0&&l.push(f)}var g=this.sessionStorage.removeItem;l.forEach(function(h){return g(h)}),g(this.initializedFlag)}}},{key:"getKeyName",value:function(l){return"".concat(this.tokenStoragePrefix).concat(l)}},{key:"canStore",value:function(){return!!(this.sessionStorage&&this.sessionStorage.length&&this.window)}}]),m}();ee.default(ga,"_instance",null);var Qn=new ga,Rt=function(){function m(v,l,p,f,g,h){se.default(this,m),this.title=v,this.details=l,this.start=p,this.type=g,this.id=h,this.end=f}return Ie.default(m,[{key:"toTelemetryEvent",value:function(){var l=new Date,p=this.start,f=this.end?this.end:l;if(f<p){var g=f;f=p,p=g}var h=p.getTime()-l.getTime(),w=f.getTime()-l.getTime(),S=new at(h,w,this.title,this.details,this.id,this.type);return S}}]),m}();e.TelemetryPoint=void 0,function(m){m[m.Start=0]="Start",m[m.End=1]="End"}(e.TelemetryPoint||(e.TelemetryPoint={})),e.EventSendingLimitation=void 0,function(m){m[m.MinEventsPortion=0]="MinEventsPortion",m[m.AnyEvents=1]="AnyEvents",m[m.AnyEventsIncludingUnfinished=2]="AnyEventsIncludingUnfinished"}(e.EventSendingLimitation||(e.EventSendingLimitation={}));var Jr=function(){function m(v,l){se.default(this,m),ee.default(this,"minEventsPortionToSend",50),ee.default(this,"maxEventsPortionToSend",100),ee.default(this,"pendingEvents",new Map),ee.default(this,"readyEvents",[]),ee.default(this,"hasInitializationFinished",!1),ee.default(this,"_canSendTelemetry",!1),this.config=v,this.packetInterface=l}return Ie.default(m,[{key:"isTelemetryEnabled",get:function(){return this.config.confirmedCapabilities.has("telemetry.v1")}},{key:"canSendTelemetry",get:function(){return this._canSendTelemetry&&this.isTelemetryEnabled},set:function(l){K.debug("TelemetryTracker.canSendTelemetry: ".concat(l," TelemetryTracker.isTelemetryEnabled: ").concat(this.isTelemetryEnabled)),this._canSendTelemetry&&!l&&(this.pendingEvents.clear(),this.readyEvents=[]),this._canSendTelemetry=l,l&&this.sendTelemetry(e.EventSendingLimitation.AnyEvents),l&&!this.hasInitializationFinished&&(this.hasInitializationFinished=!0)}},{key:"addTelemetryEvent",value:function(l){!this.canSendTelemetry&&this.hasInitializationFinished||this.readyEvents.push(l)}},{key:"addPartialEvent",value:function(l,p,f){K.debug("Adding ".concat(f===e.TelemetryPoint.Start?"starting":"ending"," timepoint for '").concat(p,"' event"));var g=this.pendingEvents.has(p);if(f===e.TelemetryPoint.Start)g&&K.debug("Overwriting starting point for '".concat(p,"' event")),this.pendingEvents.set(p,l);else{if(!g){K.info("Could not find started event for '".concat(p,"' event"));return}this.addTelemetryEvent(this.merge(this.pendingEvents.get(p),l)),this.pendingEvents.delete(p)}}},{key:"getTelemetryToSend",value:function(l){return!this.canSendTelemetry||this.readyEvents.length==0?[]:l==e.EventSendingLimitation.MinEventsPortion&&this.readyEvents.length<this.minEventsPortionToSend?[]:this.getTelemetryPortion(l==e.EventSendingLimitation.AnyEventsIncludingUnfinished)}},{key:"getTelemetryPortion",value:function(l){var p=this,f=Math.min(this.readyEvents.length,this.maxEventsPortionToSend),g=this.readyEvents.splice(0,f);return l&&g.length<this.maxEventsPortionToSend&&this.pendingEvents.forEach(function(h,w){if(!(g.length>=p.maxEventsPortionToSend)){var S=p.pendingEvents.get(w);p.pendingEvents.delete(w),g.push(new Rt("[UNFINISHED] ".concat(S.title),S.details,S.start,null,S.type,S.id))}}),g}},{key:"merge",value:function(l,p){return new Rt(p.title?p.title:l.title,p.details?p.details:l.details,l.start,p.end,p.type?p.type:l.type,p.id?p.id:l.id)}},{key:"sendTelemetryIfMinimalPortionCollected",value:function(){this.sendTelemetry(e.EventSendingLimitation.MinEventsPortion)}},{key:"sendTelemetry",value:function(l){var p=this.getTelemetryToSend(l);if(p.length!==0)try{this.packetInterface.send(new tt(p.map(function(f){return f.toTelemetryEvent()})))}catch(f){K.debug("Error while sending ".concat(p.length," telemetry events due to ").concat(f,"; they will be resubmitted")),this.readyEvents=this.readyEvents.concat(p)}}}]),m}();function ya(m){var v=Yr();return function(){var p=Se.default(m),f;if(v){var g=Se.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return ke.default(this,f)}}function Yr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var I=function m(){se.default(this,m)};ee.default(I,"TWILSOCK_CONNECT","twilsock.sdk.connect"),ee.default(I,"TWILSOCK_INIT","twilsock.sdk.init"),e.TwilsockClient=function(m){B.default(l,m);var v=ya(l);function l(p,f,g){var h;se.default(this,l),h=v.call(this),ee.default(L.default(h),"version",je),ee.default(L.default(h),"offlineStorageDeferred",new hs),g.continuationToken=g.continuationToken?g.continuationToken:Qn.getStoredToken(f);var w=h.config=new Me(p,f,g);K.setLevel(w.logLevel);var S=new Kr(w.url),j=new Yn(S,w);return h.channel=new _t(S,j,w),h.registrations=new Ro(j),h.upstream=new va(j,h.channel,w),h.telemetryTracker=new Jr(w,j),h.channel.on("initialized",function(){return h.telemetryTracker.canSendTelemetry=!0}),S.on("disconnected",function(){return h.telemetryTracker.canSendTelemetry=!1}),h.registrations.on("registered",function(F){return h.emit("registered",F)}),h.channel.on("message",function(F,z){return setTimeout(function(){return h.emit("message",F,z)},0)}),h.channel.on("stateChanged",function(F){return setTimeout(function(){return h.emit("stateChanged",F)},0)}),h.channel.on("connectionError",function(F){return setTimeout(function(){return h.emit("connectionError",F)},0)}),h.channel.on("tokenAboutToExpire",function(){return setTimeout(function(){return h.emit("tokenAboutToExpire")},0)}),h.channel.on("tokenExpired",function(){return setTimeout(function(){return h.emit("tokenExpired")},0)}),h.channel.on("connected",function(){return h.registrations.updateRegistrations()}),h.channel.on("connected",function(){return h.upstream.sendPendingMessages()}),h.channel.on("connected",function(){return setTimeout(function(){return h.emit("connected")},0)}),h.channel.on("beforeConnect",function(){return h.telemetryTracker.addPartialEvent(new Rt("Establish WebSocket connection","",new Date),I.TWILSOCK_CONNECT,e.TelemetryPoint.Start)}),h.channel.on("connected",function(){return h.telemetryTracker.addPartialEvent(new Rt("Establish WebSocket connection","",new Date,new Date),I.TWILSOCK_CONNECT,e.TelemetryPoint.End)}),h.channel.on("beforeSendInit",function(){return h.telemetryTracker.addPartialEvent(new Rt("Send Twilsock init","",new Date),I.TWILSOCK_INIT,e.TelemetryPoint.Start)}),h.channel.on("initialized",function(){return h.telemetryTracker.addPartialEvent(new Rt("Send Twilsock init","Succeeded",new Date,new Date),I.TWILSOCK_INIT,e.TelemetryPoint.End)}),h.channel.on("sendInitFailed",function(){return h.telemetryTracker.addPartialEvent(new Rt("Send Twilsock init","Failed",new Date,new Date),I.TWILSOCK_INIT,e.TelemetryPoint.End)}),h.channel.on("initialized",function(F){h.handleStorageId(f,F),Qn.storeToken(F.continuationToken,f),setTimeout(function(){return h.emit("initialized",F)},0)}),h.channel.on("disconnected",function(){return setTimeout(function(){return h.emit("disconnected")},0)}),h.channel.on("disconnected",function(){return h.upstream.rejectPendingMessages()}),h.channel.on("disconnected",function(){return h.offlineStorageDeferred.fail(new Et("Client disconnected"))}),h.offlineStorageDeferred.promise.catch(function(){}),h}return Ie.default(l,[{key:"emit",value:function(f){for(var g,h=arguments.length,w=new Array(h>1?h-1:0),S=1;S<h;S++)w[S-1]=arguments[S];return K.debug("Emitting ".concat(f.toString(),"(").concat(w.map(function(j){return JSON.stringify(j)}).join(", "),")")),(g=oe.default(Se.default(l.prototype),"emit",this)).call.apply(g,[this,f].concat(w))}},{key:"handleStorageId",value:function(f,g){if(!g.offlineStorage)this.offlineStorageDeferred.fail(new Et("No offline storage id"));else if(g.offlineStorage.hasOwnProperty(f))try{this.offlineStorageDeferred.set(Ci.create(g.offlineStorage[f])),K.debug("Offline storage for '".concat(f,"' product: ").concat(JSON.stringify(g.offlineStorage[f]),"."))}catch(h){this.offlineStorageDeferred.fail(new Et("Failed to parse offline storage for ".concat(f," ").concat(JSON.stringify(g.offlineStorage[f]),". ").concat(h,".")))}else this.offlineStorageDeferred.fail(new Et("No offline storage id for '".concat(f,"' product: ").concat(JSON.stringify(g.offlineStorage))))}},{key:"storageId",value:function(){return this.offlineStorageDeferred.promise}},{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"state",get:function(){return this.channel.state}},{key:"updateToken",value:function(){var p=Re.default(ne.default.mark(function g(h){return ne.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(K.trace("updating token '".concat(h,"'")),this.config.token!==h){S.next=3;break}return S.abrupt("return");case 3:return this.config.updateToken(h),S.next=6,this.channel.updateToken(h);case 6:return S.abrupt("return",S.sent);case 7:case"end":return S.stop()}},g,this)}));function f(g){return p.apply(this,arguments)}return f}()},{key:"setNotificationsContext",value:function(){var p=Re.default(ne.default.mark(function g(h,w){return ne.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,this.registrations.setNotificationsContext(h,w);case 2:case"end":return j.stop()}},g,this)}));function f(g,h){return p.apply(this,arguments)}return f}()},{key:"removeNotificationsContext",value:function(){var p=Re.default(ne.default.mark(function g(h){return ne.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this.registrations.removeNotificationsContext(h);case 2:case"end":return S.stop()}},g,this)}));function f(g){return p.apply(this,arguments)}return f}()},{key:"connect",value:function(){return this.channel.connect()}},{key:"disconnect",value:function(){var p=Re.default(ne.default.mark(function g(){return ne.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEventsIncludingUnfinished),w.next=3,this.channel.disconnect();case 3:return w.abrupt("return",w.sent);case 4:case"end":return w.stop()}},g,this)}));function f(){return p.apply(this,arguments)}return f}()},{key:"get",value:function(){var p=Re.default(ne.default.mark(function g(h,w,S){return ne.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),F.next=3,this.upstream.send("GET",h,w,void 0,S);case 3:return F.abrupt("return",F.sent);case 4:case"end":return F.stop()}},g,this)}));function f(g,h,w){return p.apply(this,arguments)}return f}()},{key:"post",value:function(){var p=Re.default(ne.default.mark(function g(h,w,S,j){return ne.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),z.next=3,this.upstream.send("POST",h,w,S,j);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},g,this)}));function f(g,h,w,S){return p.apply(this,arguments)}return f}()},{key:"put",value:function(){var p=Re.default(ne.default.mark(function g(h,w,S,j){return ne.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),z.next=3,this.upstream.send("PUT",h,w,S,j);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},g,this)}));function f(g,h,w,S){return p.apply(this,arguments)}return f}()},{key:"delete",value:function(){var p=Re.default(ne.default.mark(function g(h,w,S,j){return ne.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),z.next=3,this.upstream.send("DELETE",h,w,S,j);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},g,this)}));function f(g,h,w,S){return p.apply(this,arguments)}return f}()},{key:"addTelemetryEvent",value:function(f){this.telemetryTracker.addTelemetryEvent(f),this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}},{key:"addPartialTelemetryEvent",value:function(f,g,h){this.telemetryTracker.addPartialEvent(f,g,h),h===e.TelemetryPoint.End&&this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}}]),l}(k),e.TwilsockClient=ze([b.validateConstructorTypes(b.nonEmptyString,b.nonEmptyString,[b.pureObject,"undefined",b.literal(null)]),le("design:paramtypes",[String,String,Object])],e.TwilsockClient);var M=function(){function m(v){se.default(this,m),this.product=v,this.type="ers",this.notification_protocol_version=0,this.message_types=[]}return Ie.default(m,[{key:"populateInitRegistrations",value:function(l){var p=new Set(this.message_types);for(var f in l)p.add(l[f]);this.message_types=Array.from(p)}}]),m}();e.InitRegistration=M,e.TelemetryEventDescription=Rt,e.TelemetryTracker=Jr,e.TransportUnavailableError=gn,e.Twilsock=e.TwilsockClient,e.TwilsockError=Et})(Of);var NT={},k_=qt,CV=Ze,IV=Pt,RV=nt,up=Bu,OV=Du,AV=Mu,PV=mr,MV=Nu,Ts=Object.assign,T_=Object.defineProperty,NV=CV([].concat),xT=!Ts||RV(function(){if(k_&&Ts({b:1},Ts(T_({},"a",{enumerable:!0,get:function(){T_(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(i){t[i]=i}),Ts({},e)[r]!=7||up(Ts({},t)).join("")!=n})?function(t,r){for(var n=PV(t),i=arguments.length,a=1,s=OV.f,u=AV.f;i>a;)for(var o=MV(arguments[a++]),c=s?NV(up(o),s(o)):up(o),d=c.length,y=0,_;d>y;)_=c[y++],(!k_||IV(u,o,_))&&(n[_]=o[_]);return n}:Ts,xV=lt,E_=xT;xV({target:"Object",stat:!0,arity:2,forced:Object.assign!==E_},{assign:E_});/*
@license
The MIT License (MIT)

Copyright (c) 2016 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=vo.exports,r=ca.exports,n=is.exports,i=sa.exports,a=oa.exports,s=Kn.exports,u=Xu,o=ua.exports,c=Of,d=aa.exports,y=la.exports,_=Si,b=Zu.exports,T=el.exports,x=mo.exports,N=Af,D=ar;function H(ie){return ie&&typeof ie=="object"&&"default"in ie?ie:{default:ie}}function ve(ie){if(ie&&ie.__esModule)return ie;var ce=Object.create(null);return ie&&Object.keys(ie).forEach(function(Y){if(Y!=="default"){var re=Object.getOwnPropertyDescriptor(ie,Y);Object.defineProperty(ce,Y,re.get?re:{enumerable:!0,get:function(){return ie[Y]}})}}),ce.default=ie,Object.freeze(ce)}var ae=H(t),Ae=H(r),Re=H(n),Ie=H(i),L=H(a),oe=H(s),B=H(u),ke=H(o),Se=H(d),se=H(y),ee=H(b),ne=H(T),te=ve(x),me=ve(N);function A(ie,ce,Y,re){var Q=arguments.length,he=Q<3?ce:re===null?re=Object.getOwnPropertyDescriptor(ce,Y):re,be;if((typeof Reflect>"u"?"undefined":ke.default(Reflect))==="object"&&typeof Reflect.decorate=="function")he=Reflect.decorate(ie,ce,Y,re);else for(var Pe=ie.length-1;Pe>=0;Pe--)(be=ie[Pe])&&(he=(Q<3?be(he):Q>3?be(ce,Y,he):be(ce,Y))||he);return Q>3&&he&&Object.defineProperty(ce,Y,he),he}function Ne(ie,ce){if((typeof Reflect>"u"?"undefined":ke.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(ie,ce)}var ft;function ze(){}ze.prototype=Object.create(null);function le(){le.init.call(this)}le.EventEmitter=le,le.usingDomains=!1,le.prototype.domain=void 0,le.prototype._events=void 0,le.prototype._maxListeners=void 0,le.defaultMaxListeners=10,le.init=function(){this.domain=null,le.usingDomains&&ft.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new ze,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},le.prototype.setMaxListeners=function(ce){if(typeof ce!="number"||ce<0||isNaN(ce))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=ce,this};function G(ie){return ie._maxListeners===void 0?le.defaultMaxListeners:ie._maxListeners}le.prototype.getMaxListeners=function(){return G(this)};function J(ie,ce,Y){if(ce)ie.call(Y);else for(var re=ie.length,Q=$(ie,re),he=0;he<re;++he)Q[he].call(Y)}function k(ie,ce,Y,re){if(ce)ie.call(Y,re);else for(var Q=ie.length,he=$(ie,Q),be=0;be<Q;++be)he[be].call(Y,re)}function C(ie,ce,Y,re,Q){if(ce)ie.call(Y,re,Q);else for(var he=ie.length,be=$(ie,he),Pe=0;Pe<he;++Pe)be[Pe].call(Y,re,Q)}function X(ie,ce,Y,re,Q,he){if(ce)ie.call(Y,re,Q,he);else for(var be=ie.length,Pe=$(ie,be),Xe=0;Xe<be;++Xe)Pe[Xe].call(Y,re,Q,he)}function Z(ie,ce,Y,re){if(ce)ie.apply(Y,re);else for(var Q=ie.length,he=$(ie,Q),be=0;be<Q;++be)he[be].apply(Y,re)}le.prototype.emit=function(ce){var Y,re,Q,he,be,Pe,Xe,at=ce==="error";if(Pe=this._events,Pe)at=at&&Pe.error==null;else if(!at)return!1;if(Xe=this.domain,at){if(Y=arguments[1],Xe)Y||(Y=new Error('Uncaught, unspecified "error" event')),Y.domainEmitter=this,Y.domain=Xe,Y.domainThrown=!1,Xe.emit("error",Y);else{if(Y instanceof Error)throw Y;var tt=new Error('Uncaught, unspecified "error" event. ('+Y+")");throw tt.context=Y,tt}return!1}if(re=Pe[ce],!re)return!1;var Fe=typeof re=="function";switch(Q=arguments.length,Q){case 1:J(re,Fe,this);break;case 2:k(re,Fe,this,arguments[1]);break;case 3:C(re,Fe,this,arguments[1],arguments[2]);break;case 4:X(re,Fe,this,arguments[1],arguments[2],arguments[3]);break;default:for(he=new Array(Q-1),be=1;be<Q;be++)he[be-1]=arguments[be];Z(re,Fe,this,he)}return!0};function $e(ie,ce,Y,re){var Q,he,be;if(typeof Y!="function")throw new TypeError('"listener" argument must be a function');if(he=ie._events,he?(he.newListener&&(ie.emit("newListener",ce,Y.listener?Y.listener:Y),he=ie._events),be=he[ce]):(he=ie._events=new ze,ie._eventsCount=0),!be)be=he[ce]=Y,++ie._eventsCount;else if(typeof be=="function"?be=he[ce]=re?[Y,be]:[be,Y]:re?be.unshift(Y):be.push(Y),!be.warned&&(Q=G(ie),Q&&Q>0&&be.length>Q)){be.warned=!0;var Pe=new Error("Possible EventEmitter memory leak detected. "+be.length+" "+ce+" listeners added. Use emitter.setMaxListeners() to increase limit");Pe.name="MaxListenersExceededWarning",Pe.emitter=ie,Pe.type=ce,Pe.count=be.length,De(Pe)}return ie}function De(ie){typeof console.warn=="function"?console.warn(ie):console.log(ie)}le.prototype.addListener=function(ce,Y){return $e(this,ce,Y,!1)},le.prototype.on=le.prototype.addListener,le.prototype.prependListener=function(ce,Y){return $e(this,ce,Y,!0)};function ue(ie,ce,Y){var re=!1;function Q(){ie.removeListener(ce,Q),re||(re=!0,Y.apply(ie,arguments))}return Q.listener=Y,Q}le.prototype.once=function(ce,Y){if(typeof Y!="function")throw new TypeError('"listener" argument must be a function');return this.on(ce,ue(this,ce,Y)),this},le.prototype.prependOnceListener=function(ce,Y){if(typeof Y!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(ce,ue(this,ce,Y)),this},le.prototype.removeListener=function(ce,Y){var re,Q,he,be,Pe;if(typeof Y!="function")throw new TypeError('"listener" argument must be a function');if(Q=this._events,!Q)return this;if(re=Q[ce],!re)return this;if(re===Y||re.listener&&re.listener===Y)--this._eventsCount===0?this._events=new ze:(delete Q[ce],Q.removeListener&&this.emit("removeListener",ce,re.listener||Y));else if(typeof re!="function"){for(he=-1,be=re.length;be-- >0;)if(re[be]===Y||re[be].listener&&re[be].listener===Y){Pe=re[be].listener,he=be;break}if(he<0)return this;if(re.length===1){if(re[0]=void 0,--this._eventsCount===0)return this._events=new ze,this;delete Q[ce]}else E(re,he);Q.removeListener&&this.emit("removeListener",ce,Pe||Y)}return this},le.prototype.off=function(ie,ce){return this.removeListener(ie,ce)},le.prototype.removeAllListeners=function(ce){var Y,re;if(re=this._events,!re)return this;if(!re.removeListener)return arguments.length===0?(this._events=new ze,this._eventsCount=0):re[ce]&&(--this._eventsCount===0?this._events=new ze:delete re[ce]),this;if(arguments.length===0){for(var Q=Object.keys(re),he=0,be;he<Q.length;++he)be=Q[he],be!=="removeListener"&&this.removeAllListeners(be);return this.removeAllListeners("removeListener"),this._events=new ze,this._eventsCount=0,this}if(Y=re[ce],typeof Y=="function")this.removeListener(ce,Y);else if(Y)do this.removeListener(ce,Y[Y.length-1]);while(Y[0]);return this},le.prototype.listeners=function(ce){var Y,re,Q=this._events;return Q?(Y=Q[ce],Y?typeof Y=="function"?re=[Y.listener||Y]:re=q(Y):re=[]):re=[],re},le.listenerCount=function(ie,ce){return typeof ie.listenerCount=="function"?ie.listenerCount(ce):Te.call(ie,ce)},le.prototype.listenerCount=Te;function Te(ie){var ce=this._events;if(ce){var Y=ce[ie];if(typeof Y=="function")return 1;if(Y)return Y.length}return 0}le.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function E(ie,ce){for(var Y=ce,re=Y+1,Q=ie.length;re<Q;Y+=1,re+=1)ie[Y]=ie[re];ie.pop()}function $(ie,ce){for(var Y=new Array(ce);ce--;)Y[ce]=ie[ce];return Y}function q(ie){for(var ce=new Array(ie.length),Y=0;Y<ce.length;++Y)ce[Y]=ie[Y].listener||ie[Y];return ce}var P=te.getLogger("twilio-notificatiions");function U(ie,ce){return["".concat(new Date().toISOString()," Twilio.Notifications ").concat(ie,":")].concat(Array.from(ce))}var _e=function(){function ie(){Ae.default(this,ie)}return Re.default(ie,[{key:"setLevel",value:function(Y){P.setLevel(Y)}},{key:"trace",value:function(){for(var Y=arguments.length,re=new Array(Y),Q=0;Q<Y;Q++)re[Q]=arguments[Q];P.trace.apply(null,U("T",re))}},{key:"debug",value:function(){for(var Y=arguments.length,re=new Array(Y),Q=0;Q<Y;Q++)re[Q]=arguments[Q];P.debug.apply(null,U("D",re))}},{key:"info",value:function(){for(var Y=arguments.length,re=new Array(Y),Q=0;Q<Y;Q++)re[Q]=arguments[Q];P.info.apply(null,U("I",re))}},{key:"warn",value:function(){for(var Y=arguments.length,re=new Array(Y),Q=0;Q<Y;Q++)re[Q]=arguments[Q];P.warn.apply(null,U("W",re))}},{key:"error",value:function(){for(var Y=arguments.length,re=new Array(Y),Q=0;Q<Y;Q++)re[Q]=arguments[Q];P.error.apply(null,U("E",re))}}]),ie}(),de=new _e;function ye(ie){var ce=Ce();return function(){var re=oe.default(ie),Q;if(ce){var he=oe.default(this).constructor;Q=Reflect.construct(re,arguments,he)}else Q=re.apply(this,arguments);return L.default(this,Q)}}function Ce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var K=function ie(){var ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",re=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Set;Ae.default(this,ie),this.token=ce,this.notificationId=Y,this.messageTypes=re};function je(ie,ce){return[].concat(ne.default(ne.default(ie).filter(function(Y){return!ce.has(Y)})),ne.default(ne.default(ce).filter(function(Y){return!ie.has(Y)})))}function Me(ie,ce){var Y=new Set;return ie.notificationId!==ce.notificationId&&Y.add("notificationId"),ie.token!==ce.token&&Y.add("token"),je(ie.messageTypes,ce.messageTypes).length>0&&Y.add("messageType"),[Y.size>0,Y]}var Oe=function(ie){Ie.default(Y,ie);var ce=ye(Y);function Y(re){var Q;return Ae.default(this,Y),Q=ce.call(this),se.default(Se.default(Q),"desiredState",new K),se.default(Se.default(Q),"currentState",new K),se.default(Se.default(Q),"_hasActiveAttempt",!1),Q.channelType=re,Q}return Re.default(Y,[{key:"setNotificationId",value:function(Q){this.desiredState.notificationId=Q}},{key:"isActive",value:function(){return this.desiredState.notificationId!==""}},{key:"subscribe",value:function(Q){if(this.desiredState.messageTypes.has(Q)){de.debug("message type '".concat(Q,"' for channel ").concat(this.channelType," is already registered"));return}this.desiredState.messageTypes.add(Q)}},{key:"unsubscribe",value:function(Q){!this.desiredState.messageTypes.has(Q)||this.desiredState.messageTypes.delete(Q)}},{key:"updateToken",value:function(Q){this.desiredState.token=Q}},{key:"commitChanges",value:function(){var re=ae.default(B.default.mark(function he(){var be,Pe,Xe,at,tt,Fe;return B.default.wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:if(!this._hasActiveAttempt){Je.next=3;break}throw de.error("One registration attempt is already in progress"),new Error("One registration attempt is already in progress");case 3:if(be=Me(this.desiredState,this.currentState),Pe=ee.default(be,2),Xe=Pe[0],at=Pe[1],Xe){Je.next=6;break}return Je.abrupt("return");case 6:if(this.currentState.notificationId||at.delete("notificationId"),de.trace("Persisting ".concat(this.channelType," registration"),at,this.desiredState),Je.prev=8,this._hasActiveAttempt=!0,tt=new K,tt.token=this.desiredState.token,tt.notificationId=this.desiredState.notificationId,tt.messageTypes=new Set(this.desiredState.messageTypes),!(tt.messageTypes.size>0)){Je.next=24;break}return Je.next=17,this.updateRegistration(tt,at);case 17:Fe=Je.sent,this.currentState.token=Fe.token,this.currentState.notificationId=Fe.notificationId,this.currentState.messageTypes=new Set(Fe.messageTypes),this.emit("stateChanged",this.channelType,"registered",this.currentState),Je.next=30;break;case 24:return Je.next=26,this.removeRegistration();case 26:this.currentState.token=tt.token,this.currentState.notificationId=tt.notificationId,this.currentState.messageTypes.clear(),this.emit("stateChanged",this.channelType,"unregistered",this.currentState);case 30:Je.next=35;break;case 32:throw Je.prev=32,Je.t0=Je.catch(8),Je.t0;case 35:return Je.prev=35,this._hasActiveAttempt=!1,Je.finish(35);case 38:case"end":return Je.stop()}},he,this,[[8,32,35,38]])}));function Q(){return re.apply(this,arguments)}return Q}()}]),Y}(le);function xe(ie){var ce=Ue();return function(){var re=oe.default(ie),Q;if(ce){var he=oe.default(this).constructor;Q=Reflect.construct(re,arguments,he)}else Q=re.apply(this,arguments);return L.default(this,Q)}}function Ue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Le={min:2e3,max:12e4,randomness:.2},Ge=function(ie){Ie.default(Y,ie);var ce=xe(Y);function Y(re,Q,he,be){var Pe;return Ae.default(this,Y),Pe=ce.call(this,re),se.default(Se.default(Pe),"registrationId",null),Pe.context=Q,Pe.twilsock=he,Pe.registrarUrl=be,Pe}return Re.default(Y,[{key:"updateRegistration",value:function(){var re=ae.default(B.default.mark(function he(be,Pe){var Xe=this,at,tt,Fe,Sr,Je;return B.default.wrap(function(Ut){for(;;)switch(Ut.prev=Ut.next){case 0:if(!Pe.has("notificationId")){Ut.next=3;break}return Ut.next=3,this.removeRegistration();case 3:if(!(!be.notificationId||!be.notificationId.length)){Ut.next=6;break}throw de.error("No push notification ID for registration"),new Error("No push notification ID for registration");case 6:return de.trace("Registering",this.channelType,be),at={endpoint_platform:this.context.platform,channel_type:this.channelType,version:this.context.protocolVersion.toString(),message_types:Array.from(be.messageTypes),data:{registration_id:be.notificationId}},tt=this.context.productId,Fe="".concat(this.registrarUrl,"?productId=").concat(tt),Sr={"Content-Type":"application/json"},de.trace("Creating registration for channel ".concat(this.channelType)),Ut.prev=12,Ut.next=15,new _.AsyncRetrier(Le).run(function(){return Xe.twilsock.post(Fe,Sr,at,tt)});case 15:Je=Ut.sent,this.registrationId=Je.body.id,de.debug("Registration created: ",Je),Ut.next=24;break;case 20:throw Ut.prev=20,Ut.t0=Ut.catch(12),de.error("Registration failed: ",Ut.t0),Ut.t0;case 24:return Ut.abrupt("return",be);case 25:case"end":return Ut.stop()}},he,this,[[12,20]])}));function Q(he,be){return re.apply(this,arguments)}return Q}()},{key:"removeRegistration",value:function(){var re=ae.default(B.default.mark(function he(){var be=this,Pe,Xe,at;return B.default.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(this.registrationId){Fe.next=2;break}return Fe.abrupt("return");case 2:return Pe=this.context.productId,Xe="".concat(this.registrarUrl,"/").concat(this.registrationId,"?productId=").concat(Pe),at={"Content-Type":"application/json"},de.trace("Removing registration for ".concat(this.channelType)),Fe.prev=6,Fe.next=9,new _.AsyncRetrier(Object.assign(Le,{maxAttemptsCount:3})).run(function(){return be.twilsock.delete(Xe,at,{},Pe)});case 9:this.registrationId=null,this.currentState.notificationId="",de.debug("Registration removed for ".concat(this.channelType)),Fe.next=18;break;case 14:throw Fe.prev=14,Fe.t0=Fe.catch(6),de.error("Failed to remove registration ",this.channelType,Fe.t0),Fe.t0;case 18:case"end":return Fe.stop()}},he,this,[[6,14]])}));function Q(){return re.apply(this,arguments)}return Q}()},{key:"sendDeviceRemoveRequest",value:function(){var re=ae.default(B.default.mark(function he(be){var Pe=this,Xe,at,tt,Fe;return B.default.wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:if(be!==""){Je.next=2;break}throw new Error("Empty registration ID");case 2:return Xe=this.context.productId,at="".concat(this.registrarUrl,"?productId=").concat(Xe),tt={"Content-Type":"application/json"},Fe={binding_type:this.channelType,address:be},Je.prev=6,de.trace("Removing old registrations for ".concat(this.channelType)),Je.next=10,new _.AsyncRetrier(Object.assign(Le,{maxAttemptsCount:3})).run(function(){return Pe.twilsock.delete(at,tt,Fe,Xe)});case 10:this.registrationId=null,this.currentState.notificationId="",de.debug("Registration removed for ".concat(this.channelType)),Je.next=19;break;case 15:throw Je.prev=15,Je.t0=Je.catch(6),de.error("Failed to remove registration ",this.channelType,Je.t0),Je.t0;case 19:case"end":return Je.stop()}},he,this,[[6,15]])}));function Q(he){return re.apply(this,arguments)}return Q}()}]),Y}(Oe);function et(ie){var ce=er();return function(){var re=oe.default(ie),Q;if(ce){var he=oe.default(this).constructor;Q=Reflect.construct(re,arguments,he)}else Q=re.apply(this,arguments);return L.default(this,Q)}}function er(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _r=function(ie){Ie.default(Y,ie);var ce=et(Y);function Y(re,Q,he){var be;return Ae.default(this,Y),be=ce.call(this,"twilsock"),se.default(Se.default(be),"contextId",me.v4()),be.productId=re,be.platform=Q,be.twilsock=he,be}return Re.default(Y,[{key:"updateRegistration",value:function(){var re=ae.default(B.default.mark(function he(be,Pe){var Xe,at;return B.default.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(Pe.has("messageType")){Fe.next=2;break}return Fe.abrupt("return",be);case 2:return Xe=Array.from(be.messageTypes),at={product_id:this.productId,notification_protocol_version:4,endpoint_platform:this.platform,message_types:Xe},Fe.prev=4,Fe.next=7,this.twilsock.setNotificationsContext(this.contextId,at);case 7:Fe.next=13;break;case 9:throw Fe.prev=9,Fe.t0=Fe.catch(4),de.error("Failed to update twilsock notification context: ".concat(Fe.t0)),Fe.t0;case 13:return Fe.abrupt("return",be);case 14:case"end":return Fe.stop()}},he,this,[[4,9]])}));function Q(he,be){return re.apply(this,arguments)}return Q}()},{key:"removeRegistration",value:function(){var re=ae.default(B.default.mark(function he(){return B.default.wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return Pe.prev=0,Pe.next=3,this.twilsock.removeNotificationsContext(this.contextId);case 3:Pe.next=9;break;case 5:throw Pe.prev=5,Pe.t0=Pe.catch(0),de.error("Failed to remove twilsock notification context: ".concat(Pe.t0)),Pe.t0;case 9:case"end":return Pe.stop()}},he,this,[[0,5]])}));function Q(){return re.apply(this,arguments)}return Q}()},{key:"sendDeviceRemoveRequest",value:function(){var re=ae.default(B.default.mark(function he(be){return B.default.wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:case"end":return Xe.stop()}},he)}));function Q(he){return re.apply(this,arguments)}return Q}()}]),Y}(Oe);function hn(ie){var ce=Ir();return function(){var re=oe.default(ie),Q;if(ce){var he=oe.default(this).constructor;Q=Reflect.construct(re,arguments,he)}else Q=re.apply(this,arguments);return L.default(this,Q)}}function Ir(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var bt,jt=D.literal("apn","fcm","twilsock");e.Notifications=bt=function(ie){Ie.default(Y,ie);var ce=hn(Y);function Y(re){var Q,he,be,Pe,Xe,at,tt,Fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ae.default(this,Y),tt=ce.call(this),Fe.logLevel=(Q=Fe.logLevel)!==null&&Q!==void 0?Q:"error",de.setLevel(Fe.logLevel);var Sr=(he=Fe.productId)!==null&&he!==void 0?he:"notifications",Je=!Fe.twilsockClient,Wt=Fe.twilsockClient=(be=Fe.twilsockClient)!==null&&be!==void 0?be:new c.TwilsockClient(re,Sr,Fe),Ut=(Pe=Fe.notifications)!==null&&Pe!==void 0?Pe:{},$i=(Xe=(at=Ut.region)!==null&&at!==void 0?at:Fe.region)!==null&&Xe!==void 0?Xe:"us1",Jn="https://ers.".concat($i,".twilio.com/v1/registrations"),Pn=Ut.ersUrl||Jn;tt.connectors=new Map;var Et=bt._detectPlatform();return tt.connectors.set("apn",new Ge("apn",{protocolVersion:4,productId:Sr,platform:Et},Wt,Pn)),tt.connectors.set("fcm",new Ge("fcm",{protocolVersion:3,productId:Sr,platform:Et},Wt,Pn)),tt.connectors.set("twilsock",new _r(Sr,Et,Wt)),Wt.on("stateChanged",function(Dt){return tt.emit("transportState",Dt)}),tt._connector("twilsock").on("stateChanged",function(Dt,Lr,Rr){return tt.emit("stateChanged",Dt,Lr,Rr)}),tt._connector("apn").on("stateChanged",function(Dt,Lr,Rr){return tt.emit("stateChanged",Dt,Lr,Rr)}),tt._connector("fcm").on("stateChanged",function(Dt,Lr,Rr){return tt.emit("stateChanged",Dt,Lr,Rr)}),Wt.on("message",function(Dt,Lr){return tt._routeMessage(Dt,Lr)}),tt.updateToken(re),Je&&(Wt.connect(),tt.twilsock=Wt),tt}return Re.default(Y,[{key:"shutdown",value:function(){var re=ae.default(B.default.mark(function he(){return B.default.wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:if(this.connectors.clear(),!this.twilsock){Pe.next=4;break}return Pe.next=4,this.twilsock.disconnect();case 4:case"end":return Pe.stop()}},he,this)}));function Q(){return re.apply(this,arguments)}return Q}()},{key:"setPushRegistrationId",value:function(Q,he){de.debug("Set ".concat(Q," push registration id '").concat(he,"'")),this._connector(Q).setNotificationId(he)}},{key:"subscribe",value:function(Q,he){de.debug("Add ".concat(Q," subscriptions for message type ").concat(he)),this._connector(Q).subscribe(he)}},{key:"unsubscribe",value:function(Q,he){de.debug("Remove ".concat(Q," subscriptions for message type ").concat(he)),this._connector(Q).unsubscribe(he)}},{key:"updateToken",value:function(Q){this.connectors.forEach(function(he){return he.updateToken(Q)})}},{key:"commitChanges",value:function(){var re=ae.default(B.default.mark(function he(){var be;return B.default.wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:return be=[],this.connectors.forEach(function(at){at.isActive()&&be.push(at.commitChanges())}),Xe.next=4,Promise.all(be);case 4:case"end":return Xe.stop()}},he,this)}));function Q(){return re.apply(this,arguments)}return Q}()},{key:"removeRegistrations",value:function(){var re=ae.default(B.default.mark(function he(be,Pe){return B.default.wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return at.next=2,this._connector(be).sendDeviceRemoveRequest(Pe);case 2:case"end":return at.stop()}},he,this)}));function Q(he,be){return re.apply(this,arguments)}return Q}()},{key:"handlePushNotification",value:function(Q){return{messageType:Q.twi_message_type,payload:Q.payload}}},{key:"_routeMessage",value:function(Q,he){de.debug("Notification message arrived: ",Q,he),this.emit("message",Q,he)}},{key:"_connector",value:function(Q){var he=this.connectors.get(Q);if(!he)throw new Error("Unknown channel type: ".concat(Q));return he}}],[{key:"_detectPlatform",value:function(){var Q="";return typeof navigator<"u"?(Q="unknown",typeof navigator.product<"u"&&(Q=navigator.product),typeof navigator.userAgent<"u"&&(Q=navigator.userAgent)):Q="web",Q.substring(0,128)}}]),Y}(le),A([D.validateTypes(jt,D.nonEmptyString),Ne("design:type",Function),Ne("design:paramtypes",[String,String]),Ne("design:returntype",void 0)],e.Notifications.prototype,"setPushRegistrationId",null),A([D.validateTypes(jt,D.nonEmptyString),Ne("design:type",Function),Ne("design:paramtypes",[String,String]),Ne("design:returntype",void 0)],e.Notifications.prototype,"subscribe",null),A([D.validateTypes(jt,D.nonEmptyString),Ne("design:type",Function),Ne("design:paramtypes",[String,String]),Ne("design:returntype",void 0)],e.Notifications.prototype,"unsubscribe",null),A([D.validateTypes(D.nonEmptyString),Ne("design:type",Function),Ne("design:paramtypes",[String]),Ne("design:returntype",void 0)],e.Notifications.prototype,"updateToken",null),A([D.validateTypesAsync(jt,D.nonEmptyString),Ne("design:type",Function),Ne("design:paramtypes",[String,String]),Ne("design:returntype",Promise)],e.Notifications.prototype,"removeRegistrations",null),e.Notifications=bt=A([D.validateConstructorTypes(D.nonEmptyString,[D.pureObject,"undefined",D.literal(null)]),Ne("design:paramtypes",[String,Object])],e.Notifications)})(NT);var xr={};/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes Backoff library under the following license

    Copyright (C) 2012 Mathieu Turcotte

    Permission is hereby granted, free of charge, to any person obtaining a copy of
    this software and associated documentation files (the "Software"), to deal in
    the Software without restriction, including without limitation the rights to
    use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
    of the Software, and to permit persons to whom the Software is furnished to do
    so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.

This software includes Event-to-Promise library under the following license

    Copyright (c) 2014, Julien Fontanet <julien.fontanet@isonoe.net>.

    Permission to use, copy, modify, and/or distribute this software for any purpose
    with or without fee is hereby granted, provided that the above copyright notice
    and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
    FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
    OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
    TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
    THIS SOFTWARE.

*/Object.defineProperty(xr,"__esModule",{value:!0});var LV=vo.exports,jV=ca.exports,UV=is.exports,DV=aa.exports,FV=sa.exports,BV=oa.exports,qV=Kn.exports,HV=la.exports,WV=Xu,GV=ua.exports,ge=ar,xc=Of,zV=qg.exports,VV=mo.exports,KV=Zu.exports,LT=Si,jT=Af,JV=Rf.exports,YV=Nc.exports;function Gr(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function Hg(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if(r!=="default"){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,Object.freeze(t)}var Ee=Gr(LV),pt=Gr(jV),wt=Gr(UV),Bn=Gr(DV),Cr=Gr(FV),da=Gr(BV),Qt=Gr(qV),$t=Gr(HV),W=Gr(WV),UT=Gr(GV),QV=Gr(zV),XV=Hg(VV),DT=Gr(KV),ZV=Hg(jT),nl=Gr(JV),ql=Hg(YV);function gt(e,t,r,n){var i=arguments.length,a=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if((typeof Reflect>"u"?"undefined":UT.default(Reflect))==="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(s=e[u])&&(a=(i<3?s(a):i>3?s(t,r,a):s(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function we(e,t){if((typeof Reflect>"u"?"undefined":UT.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}var eK;function Ji(){}Ji.prototype=Object.create(null);function Tt(){Tt.init.call(this)}Tt.EventEmitter=Tt;Tt.usingDomains=!1;Tt.prototype.domain=void 0;Tt.prototype._events=void 0;Tt.prototype._maxListeners=void 0;Tt.defaultMaxListeners=10;Tt.init=function(){this.domain=null,Tt.usingDomains&&eK.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Ji,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Tt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function FT(e){return e._maxListeners===void 0?Tt.defaultMaxListeners:e._maxListeners}Tt.prototype.getMaxListeners=function(){return FT(this)};function tK(e,t,r){if(t)e.call(r);else for(var n=e.length,i=il(e,n),a=0;a<n;++a)i[a].call(r)}function rK(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,a=il(e,i),s=0;s<i;++s)a[s].call(r,n)}function nK(e,t,r,n,i){if(t)e.call(r,n,i);else for(var a=e.length,s=il(e,a),u=0;u<a;++u)s[u].call(r,n,i)}function iK(e,t,r,n,i,a){if(t)e.call(r,n,i,a);else for(var s=e.length,u=il(e,s),o=0;o<s;++o)u[o].call(r,n,i,a)}function aK(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,a=il(e,i),s=0;s<i;++s)a[s].apply(r,n)}Tt.prototype.emit=function(t){var r,n,i,a,s,u,o,c=t==="error";if(u=this._events,u)c=c&&u.error==null;else if(!c)return!1;if(o=this.domain,c){if(r=arguments[1],o)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=o,r.domainThrown=!1,o.emit("error",r);else{if(r instanceof Error)throw r;var d=new Error('Uncaught, unspecified "error" event. ('+r+")");throw d.context=r,d}return!1}if(n=u[t],!n)return!1;var y=typeof n=="function";switch(i=arguments.length,i){case 1:tK(n,y,this);break;case 2:rK(n,y,this,arguments[1]);break;case 3:nK(n,y,this,arguments[1],arguments[2]);break;case 4:iK(n,y,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),s=1;s<i;s++)a[s-1]=arguments[s];aK(n,y,this,a)}return!0};function BT(e,t,r,n){var i,a,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=e._events,a?(a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]):(a=e._events=new Ji,e._eventsCount=0),!s)s=a[t]=r,++e._eventsCount;else if(typeof s=="function"?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=FT(e),i&&i>0&&s.length>i)){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,sK(u)}return e}function sK(e){typeof console.warn=="function"?console.warn(e):console.log(e)}Tt.prototype.addListener=function(t,r){return BT(this,t,r,!1)};Tt.prototype.on=Tt.prototype.addListener;Tt.prototype.prependListener=function(t,r){return BT(this,t,r,!0)};function qT(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}Tt.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,qT(this,t,r)),this};Tt.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,qT(this,t,r)),this};Tt.prototype.removeListener=function(t,r){var n,i,a,s,u;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new Ji:(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(a=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){u=n[s].listener,a=s;break}if(a<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new Ji,this;delete i[t]}else oK(n,a);i.removeListener&&this.emit("removeListener",t,u||r)}return this};Tt.prototype.off=function(e,t){return this.removeListener(e,t)};Tt.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new Ji,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new Ji:delete n[t]),this;if(arguments.length===0){for(var i=Object.keys(n),a=0,s;a<i.length;++a)s=i[a],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new Ji,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};Tt.prototype.listeners=function(t){var r,n,i=this._events;return i?(r=i[t],r?typeof r=="function"?n=[r.listener||r]:n=uK(r):n=[]):n=[],n};Tt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):HT.call(e,t)};Tt.prototype.listenerCount=HT;function HT(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}Tt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function oK(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function il(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function uK(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}var no=function(){function e(t){pt.default(this,e),this.base=t,this.args=new Array,this.paths=new Array}return wt.default(e,[{key:"pathSegment",value:function(r){return this.paths.push(encodeURIComponent(r)),this}},{key:"queryParam",value:function(r,n){return typeof n<"u"&&this.args.push(encodeURIComponent(r)+"="+encodeURIComponent(n)),this}},{key:"build",value:function(){var r=this.base;return this.paths.length&&(r+="/"+this.paths.join("/")),this.args.length&&(r+="?"+this.args.join("&")),r}}]),e}();function WT(e){var t=lK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return da.default(this,i)}}function lK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Nr=function(e){Cr.default(r,e);var t=WT(r);function r(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return pt.default(this,r),i=t.call(this),i.name=i.constructor.name,i.message="".concat(n," (status: ").concat(a,", code: ").concat(s,")"),i.status=a,i.code=s,i}return r}(QV.default(Error)),cK=function(e){Cr.default(r,e);var t=WT(r);function r(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3?arguments[3]:void 0;return pt.default(this,r),i=t.call(this,n,a,s),i.body=u,i}return r}(Nr);function Cn(e){return JSON.parse(JSON.stringify(e))}function GT(e){var t=e===void 0||Wg(e);if(!t)throw new Nr("Invalid pageSize parameter. Expected a positive integer, was '".concat(e,"'."),400,20007)}function fK(e){return!isNaN(parseInt(e))&&isFinite(e)}function Wg(e){return fK(e)&&e>0}var Es=XV.getLogger("twilio-sync");function zo(e,t){return["".concat(new Date().toISOString()," Sync ").concat(e,":")].concat(Array.from(t))}var yt={setLevel:function(t){Es.setLevel(t)},trace:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Es.trace.apply(null,zo("T",r))},debug:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Es.debug.apply(null,zo("D",r))},info:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Es.info.apply(null,zo("I",r))},warn:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Es.warn.apply(null,zo("W",r))},error:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Es.error.apply(null,zo("E",r))}},dK="/v4/Subscriptions",pK="/v3/Maps",hK="/v3/Lists",vK="/v3/Documents",gK="/v3/Streams",yK="/v3/Insights";function mK(e,t,r){return e&&typeof e[t]<"u"?e[t]:r}var bK=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};pt.default(this,e);var r=t.region||"us1",n="https://cds.".concat(r,".twilio.com"),i=t.cdsUri||n;this.settings={subscriptionsUri:i+dK,documentsUri:i+vK,listsUri:i+hK,mapsUri:i+pK,streamsUri:i+gK,insightsUri:i+yK,sessionStorageEnabled:mK(t.Sync,"enableSessionStorage",!0),productId:t.productId}}return wt.default(e,[{key:"subscriptionsUri",get:function(){return this.settings.subscriptionsUri}},{key:"documentsUri",get:function(){return this.settings.documentsUri}},{key:"listsUri",get:function(){return this.settings.listsUri}},{key:"mapsUri",get:function(){return this.settings.mapsUri}},{key:"streamsUri",get:function(){return this.settings.streamsUri}},{key:"insightsUri",get:function(){return this.settings.insightsUri}},{key:"backoffConfig",get:function(){return this.settings.backoffConfig||{}}},{key:"sessionStorageEnabled",get:function(){return this.settings.sessionStorageEnabled}},{key:"productId",get:function(){return this.settings.productId}}]),e}();function Vo(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=wK(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function wK(e,t){if(!!e){if(typeof e=="string")return C_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C_(e,t)}}function C_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _K=function(){function e(t){pt.default(this,e),this.localObject=t,this.pendingCorrelationId=null,this.pendingAction=null,this.established=!1,this.retryCount=0}return wt.default(e,[{key:"sid",get:function(){return this.localObject.sid}},{key:"type",get:function(){return this.localObject.type}},{key:"lastEventId",get:function(){return this.localObject.lastEventId}},{key:"indexName",get:function(){return this.localObject.indexName}},{key:"queryString",get:function(){return this.localObject.queryString}},{key:"isEstablished",get:function(){return this.established}},{key:"update",value:function(r,n){this.localObject._update(r,n)}},{key:"updatePending",value:function(r,n){this.pendingAction=r,this.pendingCorrelationId=n}},{key:"reset",value:function(){this.updatePending(null,null),this.retryCount=0,this.established=!1,this.setSubscriptionState("none")}},{key:"markAsFailed",value:function(r){this.rejectedWithError=r.error,this.updatePending(null,null),this.localObject.reportFailure(new Nr("Failed to subscribe on service events: ".concat(r.error.message),r.error.status,r.error.code))}},{key:"complete",value:function(r){this.updatePending(null,null),this.established=!0,this.localObject._advanceLastEventId(r)}},{key:"setSubscriptionState",value:function(r){this.localObject._setSubscriptionState(r)}}]),e}(),SK=function(){function e(t){var r=this;pt.default(this,e),$t.default(this,"isConnected",!1),$t.default(this,"maxBatchSize",100),$t.default(this,"subscriptionTtlTimer",null),$t.default(this,"pendingPokeReason",null),this.services=t,this.subscriptions=new Map,this.persisted=new Map,this.latestPokeResponseArrivalTimestampByCorrelationId=new Map;var n={randomisationFactor:.2,initialDelay:100,maxDelay:2*60*1e3};this.backoff=LT.Backoff.exponential(Object.assign(n,this.services.config.backoffConfig)),this.backoff.on("ready",function(){var i=r.getSubscriptionUpdateBatch(),a=i.action,s=i.subscriptions;a?r.applyNewSubscriptionUpdateBatch(a,s):(r.backoff.reset(),yt.debug("All subscriptions resolved."))})}return wt.default(e,[{key:"getSubscriptionUpdateBatch",value:function(){function r(a,s,u,o){var c=[],d=Vo(a),y;try{for(d.s();!(y=d.n()).done;){var _=DT.default(y.value,2),b=_[0],T=_[1],x=s.get(b);if(!x&&u!==T.pendingAction&&!T.rejectedWithError&&(c.push(T),o&&c.length>=o))break}}catch(N){d.e(N)}finally{d.f()}return c}var n=r(this.subscriptions,this.persisted,"establish",this.maxBatchSize);if(n.length>0)return{action:"establish",subscriptions:n};var i=r(this.persisted,this.subscriptions,"cancel",this.maxBatchSize);return i.length>0?{action:"cancel",subscriptions:i}:{action:null,subscriptions:null}}},{key:"persist",value:function(){this.backoff.backoff()}},{key:"applyNewSubscriptionUpdateBatch",value:function(){var t=Ee.default(W.default.mark(function n(i,a){var s=this,u,o,c,d,y,_,b,T,x,N,D,H,ve,ae,Ae,Re;return W.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(this.isConnected){L.next=4;break}return yt.debug("Twilsock connection (required for subscription) not ready; waiting\u2026"),this.backoff.reset(),L.abrupt("return");case 4:a=this.processLocalActions(i,a),u=new Date().getTime(),o=Vo(a);try{for(o.s();!(c=o.n()).done;)d=c.value,this.recordActionAttemptOn(d,i,u)}catch(oe){o.e(oe)}finally{o.f()}return y=this.pendingPokeReason,this.pendingPokeReason=null,L.prev=10,L.next=13,this.request(i,u,y,a);case 13:_=L.sent,b=_.body.max_batch_size,!isNaN(parseInt(b))&&isFinite(b)&&b>0&&(this.maxBatchSize=b),this.subscriptionTtlTimer||(T=_.body.ttl_in_s,x=!isNaN(parseFloat(T))&&isFinite(T),N=x&&T>0,N&&(this.subscriptionTtlTimer=setTimeout(function(){return s.onSubscriptionTtlElapsed()},T*1e3))),i==="establish"&&(D=_.body.estimated_delivery_in_ms,H=!isNaN(parseFloat(D))&&isFinite(D),ve=H&&D>0,ve?setTimeout(function(){return s.verifyPokeDelivery(u,D,a)},D):yt.error("Invalid timeout: ".concat(D)),a.filter(function(oe){return oe.pendingCorrelationId===u}).forEach(function(oe){return oe.setSubscriptionState("response_in_flight")})),this.backoff.reset(),L.next=26;break;case 21:L.prev=21,L.t0=L.catch(10),ae=Vo(a);try{for(ae.s();!(Ae=ae.n()).done;)Re=Ae.value,this.recordActionFailureOn(Re,i)}catch(oe){ae.e(oe)}finally{ae.f()}L.t0 instanceof xc.TransportUnavailableError?(yt.debug("Twilsock connection (required for subscription) not ready (c:".concat(u,"); waiting\u2026")),this.backoff.reset()):(yt.debug("Failed an attempt to ".concat(i," subscriptions (c:").concat(u,"); retrying"),L.t0),this.persist());case 26:case"end":return L.stop()}},n,this,[[10,21]])}));function r(n,i){return t.apply(this,arguments)}return r}()},{key:"verifyPokeDelivery",value:function(r,n,i){var a=this,s=this.latestPokeResponseArrivalTimestampByCorrelationId.get(r),u=s?new Date().getTime()-s:n;if(u>=n)i.filter(function(c){return c.pendingCorrelationId===r}).forEach(function(c){c.updatePending(null,null),c.retryCount++,a.persisted.delete(c.sid)}),this.persist(),this.latestPokeResponseArrivalTimestampByCorrelationId.delete(r);else{var o=n-u;setTimeout(function(){return a.verifyPokeDelivery(r,n,i)},o)}}},{key:"processLocalActions",value:function(r,n){return r==="cancel"?n.filter(function(i){return!i.rejectedWithError}):n}},{key:"recordActionAttemptOn",value:function(r,n,i){if(r.setSubscriptionState("request_in_flight"),n==="establish")this.persisted.set(r.sid,r),r.updatePending(n,i);else{var a=this.persisted.get(r.sid);a&&a.updatePending(n,i)}}},{key:"recordActionFailureOn",value:function(r,n){r.setSubscriptionState("none"),r.updatePending(null,null),n==="establish"&&this.persisted.delete(r.sid)}},{key:"request",value:function(r,n,i,a){var s=a.map(function(c){return{object_sid:c.sid,object_type:c.type,last_event_id:r==="establish"?c.lastEventId:void 0,index_name:r==="establish"?c.indexName:void 0,query_string:r==="establish"?c.queryString:void 0}}),u=a.filter(function(c){return c.retryCount>0}).length;yt.debug("Attempting '".concat(r,"' request (c:").concat(n,"):"),s);var o={event_protocol_version:4,action:r,correlation_id:n,retried_requests:u,ttl_in_s:-1,requests:s};return i==="ttl"&&(o.reason=i),this.services.network.post(this.services.config.subscriptionsUri,o)}},{key:"add",value:function(r,n){yt.debug("Establishing intent to subscribe to ".concat(r));var i=this.subscriptions.get(r);i&&n&&i.lastEventId===n.lastEventId||(this.persisted.delete(r),this.subscriptions.set(r,new _K(n)),this.persist())}},{key:"remove",value:function(r){yt.debug("Establishing intent to unsubscribe from ".concat(r));var n=this.subscriptions.delete(r);n&&this.persist()}},{key:"acceptMessage",value:function(r,n){yt.trace("Subscriptions received",r);var i=r.event_type,a=typeof r.events<"u"?r.events:[r.event],s=r.correlation_id;s&&this.latestPokeResponseArrivalTimestampByCorrelationId.set(s,new Date().getTime());var u=Vo(a),o;try{for(u.s();!(o=u.n()).done;){var c=o.value,d=void 0;switch(r.event_type){case"subscription_established":this.applySubscriptionEstablishedMessage(c,s);break;case"subscription_canceled":this.applySubscriptionCancelledMessage(c,s);break;case"subscription_failed":this.applySubscriptionFailedMessage(c,s);break;case(d=i.match(/^(?:map|list|document|stream|live_query)_/)||{}).input:{var y=void 0;switch(d[0]){case"map_":y=c.map_sid;break;case"list_":y=c.list_sid;break;case"document_":y=c.document_sid;break;case"stream_":y=c.stream_sid;break;case"live_query_":y=c.query_id,n=!1,r.strictly_ordered===!0&&(n=!0);break;default:y=void 0}this.applyEventToSubscribedEntity(y,c,i,n);break}default:yt.debug("Dropping unknown message type ".concat(i));break}}}catch(_){u.e(_)}finally{u.f()}}},{key:"applySubscriptionEstablishedMessage",value:function(r,n){var i=r.object_sid,a=this.persisted.get(r.object_sid);a&&a.pendingCorrelationId===n?r.replay_status==="interrupted"?(yt.debug("Event Replay for subscription to ".concat(i," (c:").concat(n,") interrupted; continuing eagerly.")),a.updatePending(null,null),this.persisted.delete(a.sid),this.backoff.reset()):r.replay_status==="completed"&&(yt.debug("Event Replay for subscription to ".concat(i," (c:").concat(n,") completed. Subscription is ready.")),a.complete(r.last_event_id),this.persisted.set(r.object_sid,a),a.setSubscriptionState("established"),this.backoff.reset()):yt.debug("Late message for ".concat(r.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionCancelledMessage",value:function(r,n){var i=this.persisted.get(r.object_sid);i&&i.pendingCorrelationId===n?(i.updatePending(null,null),i.setSubscriptionState("none"),this.persisted.delete(r.object_sid)):yt.debug("Late message for ".concat(r.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionFailedMessage",value:function(r,n){var i=r.object_sid,a=this.subscriptions.get(i),s=this.persisted.get(i);a&&s?s.pendingCorrelationId===n&&(yt.error("Failed to subscribe on ".concat(s.sid),r.error),s.markAsFailed(r),s.setSubscriptionState("none")):!a&&s&&(this.persisted.delete(i),s.setSubscriptionState("none")),this.persist()}},{key:"applyEventToSubscribedEntity",value:function(r,n,i,a){var s=this;if(!!r){a=a||function(){var o=s.persisted.get(r);return o&&o.isEstablished}();var u=this.subscriptions.get(r);u?(n.type=i,u.update(n,a)):yt.debug("Message dropped for SID '".concat(r,"', for which there is no subscription."))}}},{key:"onConnectionStateChanged",value:function(r){this.isConnected=r,r&&this.poke("reconnect")}},{key:"onSubscriptionTtlElapsed",value:function(){this.isConnected&&this.poke("ttl")}},{key:"poke",value:function(r){yt.debug("Triggering event replay for all subscriptions, reason=".concat(r)),this.pendingPokeReason=r,this.subscriptionTtlTimer&&(clearTimeout(this.subscriptionTtlTimer),this.subscriptionTtlTimer=null);var n=[],i=Vo(this.persisted.values()),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;s.reset(),s.rejectedWithError&&n.push(s)}}catch(d){i.e(d)}finally{i.f()}this.persisted.clear();for(var u=0,o=n;u<o.length;u++){var c=o[u];this.persisted.set(c.sid,c)}this.persist()}},{key:"shutdown",value:function(){this.backoff.reset(),this.subscriptions.clear()}}]),e}(),$K=4e3,kK=6e4,TK=9e4,EK=.2;function I_(e){if(e.body&&e.body.message)return e.body.message;switch(e.status){case 429:return"Throttled by server";case 404:return"Not found from server";default:return"Error from server"}}function R_(e){return e.body?e.body.code:0}function Ko(e){return e.status===409?new cK(I_(e),e.status,R_(e),e.body):e.status?new Nr(I_(e),e.status,R_(e)):e instanceof xc.TransportUnavailableError?e:new Nr(e.message,0,0)}var CK=function(){function e(t,r,n){pt.default(this,e),this.clientInfo=t,this.config=r,this.transport=n}return wt.default(e,[{key:"createHeaders",value:function(){return{"Content-Type":"application/json","Twilio-Sync-Client-Info":JSON.stringify(this.clientInfo),"Twilio-Request-Id":"RQ"+ZV.v4().replace(/-/g,"")}}},{key:"backoffConfig",value:function(){return Object.assign({min:$K,max:kK,maxAttemptsTime:TK,randomness:EK},this.config.backoffConfig)}},{key:"executeWithRetry",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new Promise(function(a,s){var u=[502,503,504];i&&u.push(429);var o=new LT.Retrier(n.backoffConfig());o.on("attempt",function(){r().then(function(c){return o.succeeded(c)}).catch(function(c){if(u.includes(c.status)){var d=parseInt(c.headers?c.headers["Retry-After"]:null);o.failed(Ko(c),isNaN(d)?null:d*1e3)}else c.message==="Twilsock disconnected"?o.failed(Ko(c)):(o.removeAllListeners(),o.cancel(),s(Ko(c)))})}),o.on("succeeded",function(c){a(c)}),o.on("cancelled",function(c){return s(Ko(c))}),o.on("failed",function(c){return s(Ko(c))}),o.start()})}},{key:"get",value:function(r){var n=this,i=this.createHeaders();return yt.debug("GET",r,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.get(r,i,n.config.productId)},!0)}},{key:"post",value:function(r,n,i){var a=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,u=this.createHeaders();return typeof i<"u"&&i!==null&&(u["If-Match"]=i),yt.debug("POST",r,"ID:",u["Twilio-Request-Id"]),this.executeWithRetry(function(){return a.transport.post(r,u,n,a.config.productId)},s)}},{key:"put",value:function(r,n,i){var a=this,s=this.createHeaders();return typeof i<"u"&&i!==null&&(s["If-Match"]=i),yt.debug("PUT",r,"ID:",s["Twilio-Request-Id"]),this.executeWithRetry(function(){return a.transport.put(r,s,n,a.config.productId)},!1)}},{key:"delete",value:function(r){var n=this,i=this.createHeaders();return yt.debug("DELETE",r,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.delete(r,i,n.config.productId)},!1)}}]),e}(),IK=function(){function e(t,r){pt.default(this,e),this.config=t,this.storageId=null;try{this.storage=r||sessionStorage}catch{}}return wt.default(e,[{key:"storageKey",value:function(r,n){return"".concat(this.storageId,"::").concat(r,"::").concat(n)}},{key:"isReady",get:function(){return this.config.sessionStorageEnabled&&!!this.storageId}},{key:"updateStorageId",value:function(r){this.storageId=r}},{key:"store",value:function(r,n,i){return this.isReady?this._store(this.storageKey(r,n),i):null}},{key:"read",value:function(r,n){return this.isReady?this._read(this.storageKey(r,n)):null}},{key:"remove",value:function(r,n,i){if(!this.isReady)return null;try{this.storage.removeItem(this.storageKey(r,n)),i&&this.storage.removeItem(this.storageKey(r,i))}catch{}}},{key:"update",value:function(r,n,i,a){if(!this.isReady)return null;this._apply(this.storageKey(r,n),a),i&&this._apply(this.storageKey(r,i),a)}},{key:"_store",value:function(r,n){try{this.storage.setItem(r,JSON.stringify(n))}catch{}}},{key:"_read",value:function(r){try{var n=this.storage.getItem(r);if(n)return JSON.parse(n)}catch{}return null}},{key:"_apply",value:function(r,n){var i=this._read(r);if(!i)return!1;this._store(r,Object.assign(i,n))}}]),e}();function RK(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=OK(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function OK(e,t){if(!!e){if(typeof e=="string")return O_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O_(e,t)}}function O_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var al=function(){function e(t,r){pt.default(this,e),this.services=t,this.removalHandler=r,this.subscriptionState="none",this._attachedListeners=new Map}return wt.default(e,[{key:"_advanceLastEventId",value:function(r,n){}},{key:"reportFailure",value:function(r){r.status===404?this.onRemoved(!1):this.broadcastEventToListeners("failure",r)}},{key:"_subscribe",value:function(){this.services.router._subscribe(this.sid,this)}},{key:"_unsubscribe",value:function(){this.services.router._unsubscribe(this.sid)}},{key:"_setSubscriptionState",value:function(r){this.subscriptionState=r,this.broadcastEventToListeners("_subscriptionStateChanged",r)}},{key:"close",value:function(){this._unsubscribe(),this.removalHandler!=null&&this.removalHandler(this.type,this.sid,this.uniqueName)}},{key:"attach",value:function(r){var n=r.listenerUuid,i=this._attachedListeners.get(n);i||(this._attachedListeners.size||this._subscribe(),this._attachedListeners.set(n,r))}},{key:"detach",value:function(r){this._attachedListeners.delete(r),this._attachedListeners.size||this.close()}},{key:"broadcastEventToListeners",value:function(r,n){var i=RK(this._attachedListeners.values()),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;s.emit(r,n)}}catch(u){i.e(u)}finally{i.f()}}}]),e}(),zT=function(){function e(t){pt.default(this,e),$t.default(this,"queuedRequests",[]),$t.default(this,"isRequestInFlight",!1),this.inputMergingFunction=t}return wt.default(e,[{key:"add",value:function(r,n){var i=this,a=new Promise(function(s,u){return i.queuedRequests.push({input:r,requestFunction:n,resolve:s,reject:u})});return this.wakeupQueue(),a}},{key:"squashAndAdd",value:function(r,n){var i=this.queuedRequests;this.queuedRequests=[];var a;i.length>0?(a=i.map(function(u){return u.input}).reduce(this.inputMergingFunction),a=this.inputMergingFunction(a,r)):a=r;var s=this.add(a,n);return i.forEach(function(u){return s.then(u.resolve,u.reject)}),s}},{key:"isEmpty",value:function(){return this.queuedRequests.length===0&&!this.isRequestInFlight}},{key:"wakeupQueue",value:function(){var r=this;if(!(this.queuedRequests.length===0||this.isRequestInFlight)){var n=this.queuedRequests.shift();this.isRequestInFlight=!0,n.requestFunction(n.input).then(n.resolve,n.reject).then(function(i){r.isRequestInFlight=!1,r.wakeupQueue()})}}}]),e}(),VT=function(){function e(t){pt.default(this,e),$t.default(this,"queueByNamespaceKey",new Map),this.inputReducer=t}return wt.default(e,[{key:"add",value:function(){var t=Ee.default(W.default.mark(function n(i,a,s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.invokeQueueMethod(i,function(c){return c.add(a,s)}));case 1:case"end":return o.stop()}},n,this)}));function r(n,i,a){return t.apply(this,arguments)}return r}()},{key:"squashAndAdd",value:function(){var t=Ee.default(W.default.mark(function n(i,a,s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.invokeQueueMethod(i,function(c){return c.squashAndAdd(a,s)}));case 1:case"end":return o.stop()}},n,this)}));function r(n,i,a){return t.apply(this,arguments)}return r}()},{key:"invokeQueueMethod",value:function(){var t=Ee.default(W.default.mark(function n(i,a){var s,u;return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.queueByNamespaceKey.has(i)||this.queueByNamespaceKey.set(i,new zT(this.inputReducer)),s=this.queueByNamespaceKey.get(i),u=a(s),this.queueByNamespaceKey.get(i).isEmpty()&&this.queueByNamespaceKey.delete(i),c.abrupt("return",u);case 5:case"end":return c.stop()}},n,this)}));function r(n,i){return t.apply(this,arguments)}return r}()}]),e}();function AK(e){var t=PK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return da.default(this,i)}}function PK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var sl=function(e){Cr.default(r,e);var t=AK(r);function r(){var n;return pt.default(this,r),n=t.call(this),n.closed=!1,n.uuid=jT.v4(),n}return wt.default(r,[{key:"listenerUuid",get:function(){return this.uuid}},{key:"close",value:function(){this.removeAllListeners(),this.closed=!0}},{key:"ensureNotClosed",value:function(){if(this.closed)throw new Error("Invalid operation on closed object")}}]),r}(Tt);function KT(e){var t=MK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return da.default(this,i)}}function MK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Lh=function(e){Cr.default(r,e);var t=KT(r);function r(n,i,a){var s;pt.default(this,r),s=t.call(this,n,a),$t.default(Bn.default(s),"isDeleted",!1);var u=function(c,d){return typeof d.ttl=="number"?{ttl:d.ttl}:c};return s.updateMergingQueue=new zT(u),s.descriptor=i,s.descriptor.data=s.descriptor.data||{},s.descriptor.date_updated=new Date(s.descriptor.date_updated),s}return wt.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"document"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"_update",value:function(i){switch(i.date_created=new Date(i.date_created),i.type){case"document_updated":if(i.id<=this.lastEventId){yt.trace("Document update skipped, current:",this.lastEventId,", remote:",i.id);break}var a=this.descriptor.data!==void 0?Cn(this.descriptor.data):null;this.descriptor.last_event_id=i.id,this.descriptor.revision=i.document_revision,this.descriptor.date_updated=i.date_created,this.descriptor.data=i.document_data,this.broadcastEventToListeners("updated",{data:i.document_data,isLocal:!1,previousData:a}),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:i.id,revision:i.document_revision,date_updated:i.date_created,data:i.document_data});break;case"document_removed":this.onRemoved(!1);break}}},{key:"set",value:function(){var n=Ee.default(W.default.mark(function a(s,u){var o=this,c;return W.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return c=u||{},y.abrupt("return",this.updateMergingQueue.squashAndAdd(c,function(_){return o._setUnconditionally(s,_.ttl)}));case 2:case"end":return y.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Ee.default(W.default.mark(function a(s,u){var o=this,c;return W.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return c=u||{},y.abrupt("return",this.updateMergingQueue.add(c,function(_){return o._setWithIfMatch(s,_.ttl)}));case 2:case"end":return y.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Ee.default(W.default.mark(function a(s,u){return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.mutate(function(d){return Object.assign(d,s)},u));case 1:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ee.default(W.default.mark(function a(s){var u;return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this._postUpdateToServer({ttl:s});case 2:u=c.sent,this.descriptor.date_expires=u.date_expires;case 4:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_setUnconditionally",value:function(){var n=Ee.default(W.default.mark(function a(s,u){var o;return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this._postUpdateToServer({data:s,revision:void 0,ttl:u});case 2:return o=d.sent,this._handleSuccessfulUpdateResult(o),d.abrupt("return",this.descriptor.data);case 5:case"end":return d.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"_setWithIfMatch",value:function(){var n=Ee.default(W.default.mark(function a(s,u){var o,c,d;return W.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(o=s(Cn(this.descriptor.data)),!o){_.next=22;break}return c=this.revision,_.prev=3,_.next=6,this._postUpdateToServer({data:o,revision:c,ttl:u});case 6:return d=_.sent,this._handleSuccessfulUpdateResult(d),_.abrupt("return",this.descriptor.data);case 11:if(_.prev=11,_.t0=_.catch(3),_.t0.status!==412){_.next=19;break}return _.next=16,this._softSync();case 16:return _.abrupt("return",this._setWithIfMatch(s));case 19:throw _.t0;case 20:_.next=23;break;case 22:return _.abrupt("return",this.descriptor.data);case 23:case"end":return _.stop()}},a,this,[[3,11]])}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"_handleSuccessfulUpdateResult",value:function(i){if(!(i.last_event_id<=this.descriptor.last_event_id)){var a=this.descriptor.data!==void 0?Cn(this.descriptor.data):null;this.descriptor.revision=i.revision,this.descriptor.data=i.data,this.descriptor.last_event_id=i.last_event_id,this.descriptor.date_expires=i.date_expires,this.descriptor.date_updated=new Date(i.date_updated),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:i.last_event_id,revision:i.revision,date_updated:i.date_updated,data:i.data}),this.broadcastEventToListeners("updated",{data:this.descriptor.data,isLocal:!0,previousData:a})}}},{key:"_postUpdateToServer",value:function(){var n=Ee.default(W.default.mark(function a(s){var u,o,c;return W.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(this.isDeleted){y.next=17;break}return u={data:s.data},s.ttl!==void 0&&(u.ttl=s.ttl),o=s.revision,y.prev=4,y.next=7,this.services.network.post(this.uri,u,o);case 7:return c=y.sent,y.abrupt("return",{revision:c.body.revision,data:s.data,last_event_id:c.body.last_event_id,date_updated:c.body.date_updated,date_expires:c.body.date_expires});case 11:throw y.prev=11,y.t0=y.catch(4),y.t0.status===404&&this.onRemoved(!1),y.t0;case 15:y.next=18;break;case 17:return y.abrupt("return",Promise.reject(new Nr("The Document has been removed",404,54100)));case 18:case"end":return y.stop()}},a,this,[[4,11]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_softSync",value:function(){var n=Ee.default(W.default.mark(function a(){var s=this;return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.services.network.get(this.uri).then(function(c){var d={type:"document_updated",id:c.body.last_event_id,document_revision:c.body.revision,document_data:c.body.data,date_created:c.body.date_updated};return s._update(d),s}).catch(function(c){c.status===404?s.onRemoved(!1):yt.error("Can't get updates for ".concat(s.sid,":"),c)}));case 1:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"onRemoved",value:function(i){if(!this.isDeleted){var a=this.descriptor.data!==void 0?Cn(this.descriptor.data):null;this.isDeleted=!0,this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i,previousData:a})}}},{key:"removeDocument",value:function(){var n=Ee.default(W.default.mark(function a(){return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.isDeleted){u.next=6;break}return u.next=3,this.services.network.delete(this.uri);case 3:this.onRemoved(!0),u.next=7;break;case 6:return u.abrupt("return",Promise.reject(new Nr("The Document has been removed",404,54100)));case 7:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()}],[{key:"type",get:function(){return"document"}}]),r}(al),sn=function(e){Cr.default(r,e);var t=KT(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.syncDocumentImpl=n,i.syncDocumentImpl.attach(Bn.default(i)),i}return wt.default(r,[{key:"uri",get:function(){return this.syncDocumentImpl.uri}},{key:"revision",get:function(){return this.syncDocumentImpl.revision}},{key:"lastEventId",get:function(){return this.syncDocumentImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncDocumentImpl.dateExpires}},{key:"type",get:function(){return Lh.type}},{key:"sid",get:function(){return this.syncDocumentImpl.sid}},{key:"data",get:function(){return this.syncDocumentImpl.data}},{key:"dateUpdated",get:function(){return this.syncDocumentImpl.dateUpdated}},{key:"uniqueName",get:function(){return this.syncDocumentImpl.uniqueName}},{key:"set",value:function(){var n=Ee.default(W.default.mark(function a(s,u){return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncDocumentImpl.set(s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Ee.default(W.default.mark(function a(s,u){return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncDocumentImpl.mutate(s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Ee.default(W.default.mark(function a(s,u){return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncDocumentImpl.update(s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncDocumentImpl.setTtl(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"removeDocument",value:function(){var n=Ee.default(W.default.mark(function a(){return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncDocumentImpl.removeDocument());case 2:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){nl.default(Qt.default(r.prototype),"close",this).call(this),this.syncDocumentImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Lh.type}}]),r}(sl);$t.default(sn,"removed","removed");$t.default(sn,"updated","updated");gt([ge.validateTypesAsync(ge.pureObject,["undefined",ge.objectSchema("document metadata",{ttl:[ge.nonNegativeInteger,"undefined"]})]),we("design:type",Function),we("design:paramtypes",[Object,Object]),we("design:returntype",Promise)],sn.prototype,"set",null);gt([ge.validateTypesAsync("function",["undefined",ge.objectSchema("document metadata",{ttl:[ge.nonNegativeInteger,"undefined"]})]),we("design:type",Function),we("design:paramtypes",[Function,Object]),we("design:returntype",Promise)],sn.prototype,"mutate",null);gt([ge.validateTypesAsync(ge.pureObject,["undefined",ge.objectSchema("document metadata",{ttl:[ge.nonNegativeInteger,"undefined"]})]),we("design:type",Function),we("design:paramtypes",[Object,Object]),we("design:returntype",Promise)],sn.prototype,"update",null);gt([ge.validateTypesAsync(ge.nonNegativeInteger),we("design:type",Function),we("design:paramtypes",[Number]),we("design:returntype",Promise)],sn.prototype,"setTtl",null);var jh=function(){function e(t){pt.default(this,e),this.descriptor=t}return wt.default(e,[{key:"uri",get:function(){return this.descriptor.uri}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.lastEventId}},{key:"dateUpdated",get:function(){return this.descriptor.dateUpdated}},{key:"dateExpires",get:function(){return this.descriptor.dateExpires}},{key:"index",get:function(){return this.descriptor.index}},{key:"data",get:function(){return this.descriptor.data}},{key:"update",value:function(r,n,i,a){return this.descriptor.lastEventId=r,this.descriptor.revision=n,this.descriptor.data=i,this.descriptor.dateUpdated=a,this}},{key:"updateDateExpires",value:function(r){this.descriptor.dateExpires=r}}]),e}(),Gg=function(){function e(t,r,n,i){pt.default(this,e),this.prevToken=n,this.nextToken=i,this.items=t,this.source=r}return wt.default(e,[{key:"hasNextPage",get:function(){return!!this.nextToken}},{key:"hasPrevPage",get:function(){return!!this.prevToken}},{key:"nextPage",value:function(){var t=Ee.default(W.default.mark(function n(){return W.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.hasNextPage){a.next=2;break}throw new Error("No next page");case 2:return a.abrupt("return",this.source(this.nextToken));case 3:case"end":return a.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"prevPage",value:function(){var t=Ee.default(W.default.mark(function n(){return W.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.hasPrevPage){a.next=2;break}throw new Error("No previous page");case 2:return a.abrupt("return",this.source(this.prevToken));case 3:case"end":return a.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()}]),e}();function NK(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=xK(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function xK(e,t){if(!!e){if(typeof e=="string")return A_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A_(e,t)}}function A_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var LK=function(){function e(t,r){pt.default(this,e),this.balanceFactor=0,this.key=t,this.value=r,this.parent=null,this.left=null,this.right=null}return wt.default(e,[{key:"isRoot",get:function(){return this.parent===null}},{key:"isLeaf",get:function(){return this.left===null&&this.right===null}},{key:"isLeftChild",get:function(){return this.parent.left===this}},{key:"update",value:function(r){this.value=r}},{key:"replace",value:function(r,n){!r||(this.left===n?this.left=n:this.right===n&&(this.right=n))}}]),e}(),jK=function(){function e(t,r){pt.default(this,e),this.isLessThan=t||function(n,i){return n<i},this.isEqual=r||function(n,i){return n===i},this.root=null,this.count=null}return wt.default(e,[{key:"size",get:function(){return this.count}},{key:"clear",value:function(){this.root=null,this.count=0}},{key:"set",value:function(r,n){var i=this.getNode(r);i?i.update(n):this.insert(r,n)}},{key:"insert",value:function(r,n){var i=new LK(r,n);if(this.count++,!this.root){this.root=i;return}for(var a=this.root;;)if(this.isLessThan(r,a.key))if(a.left)a=a.left;else{a.left=i;break}else if(a.right)a=a.right;else{a.right=i;break}for(i.parent=a,a=i;a.parent;){var s=a.parent,u=s.balanceFactor;if(a.isLeftChild?s.balanceFactor++:s.balanceFactor--,Math.abs(s.balanceFactor)<Math.abs(u))break;if(s.balanceFactor<-1||s.balanceFactor>1){this.rebalance(s);break}a=s}}},{key:"get",value:function(r){for(var n=this.root;n;){if(this.isEqual(r,n.key))return n.value;this.isLessThan(r,n.key)?n=n.left:n=n.right}return null}},{key:"delete",value:function(r){var n=this.getNode(r);if(!n||n.key!==r)return null;var i=n.parent,a=n.left,s=n.right;if(!!a!=!!s){var u=a||s;!i&&!u?this.root=null:i&&!u?this.root=u:(i.replace(n,null),this.rebalance(i))}else{for(var o=n.left;o.right;)o=o.right;if(n.left===o)n.isRoot?(this.root=o,o.parent=null):(n.isLeftChild?n.parent.left=o:n.parent.right=o,o.parent=n.parent),o.right=n.right,o.right.parent=o,o.balanceFactor=n.balanceFactor,n={parent:o,isLeftChild:!0};else{var c=o.parent,d=o.left;c.right=d,d&&(d.parent=c),n.isRoot?(this.root=o,o.parent=null):(n.isLeftChild?n.parent.left=o:n.parent.right=o,o.parent=n.parent),o.right=n.right,o.right.parent=o,o.left=n.left,o.left.parent=o,o.balanceFactor=n.balanceFactor,n={parent:c,isLeftChild:!1}}}for(this.count--;n.parent;){var y=n.parent,_=y.balanceFactor;if(n.isLeftChild?y.balanceFactor-=1:y.balanceFactor+=1,Math.abs(y.balanceFactor)>Math.abs(_))if(y.balanceFactor<-1||y.balanceFactor>1)if(this.rebalance(y),y.parent.balanceFactor===0)n=y.parent;else break;else break;else n=y}return null}},{key:"getNode",value:function(r){for(var n=this.root;n;){if(this.isEqual(r,n.key))return n;this.isLessThan(r,n.key)?n=n.left:n=n.right}return null}},{key:"rebalance",value:function(r){r.balanceFactor<0?r.right.balanceFactor>0?(this.rotateRight(r.right),this.rotateLeft(r)):this.rotateLeft(r):r.balanceFactor>0&&(r.left.balanceFactor<0?(this.rotateLeft(r.left),this.rotateRight(r)):this.rotateRight(r))}},{key:"rotateLeft",value:function(r){var n=r.right;r.right=n.left,n.left!==null&&(n.left.parent=r),n.parent=r.parent,n.parent===null?this.root=n:r.isLeftChild?n.parent.left=n:n.parent.right=n,n.left=r,r.parent=n,r.balanceFactor=r.balanceFactor+1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor+1-Math.max(r.balanceFactor,0)}},{key:"rotateRight",value:function(r){var n=r.left;r.left=n.right,n.right!==null&&(n.right.parent=r),n.parent=r.parent,n.parent===null?this.root=n:r.isLeftChild?n.parent.left=n:n.parent.right=n,n.right=r,r.parent=n,r.balanceFactor=r.balanceFactor-1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor-1-Math.max(r.balanceFactor,0)}},{key:Symbol.iterator,value:W.default.mark(function t(){var r,n,i;return W.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:r=NK(this.getIterator()),s.prev=1,r.s();case 3:if((n=r.n()).done){s.next=9;break}return i=n.value,s.next=7,i;case 7:s.next=3;break;case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),r.e(s.t0);case 14:return s.prev=14,r.f(),s.finish(14);case 17:case"end":return s.stop()}},t,this,[[1,11,14,17]])})},{key:"getIterator",value:W.default.mark(function t(){var r,n,i,a=arguments;return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=a.length>0&&a[0]!==void 0?a[0]:null,n=this.root;case 2:if(!n){u.next=8;break}if(!(this.isEqual(r,n.key)||r===null&&!n.left)){u.next=5;break}return u.abrupt("break",8);case 5:this.isLessThan(r,n.key)||r===null?n=n.left:n=n.right,u.next=2;break;case 8:if(n){u.next=10;break}return u.abrupt("return",null);case 10:i=!0;case 11:if(!i){u.next=29;break}return u.next=14,[n.key,n.value];case 14:if(i=!1,!n.right){u.next=21;break}for(n=n.right;n.left;)n=n.left;i=!0,u.next=27;break;case 21:if(!n.parent){u.next=26;break}i=n.parent.left===n,n=n.parent,u.next=27;break;case 26:return u.abrupt("break",37);case 27:u.next=35;break;case 29:if(!n.parent){u.next=34;break}i=n.parent.left===n,n=n.parent,u.next=35;break;case 34:return u.abrupt("break",37);case 35:u.next=11;break;case 37:return u.abrupt("return",null);case 38:case"end":return u.stop()}},t,this)})},{key:"getReverseIterator",value:W.default.mark(function t(){var r,n,i,a=arguments;return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=a.length>0&&a[0]!==void 0?a[0]:null,n=this.root;case 2:if(!n){u.next=8;break}if(!(this.isEqual(r,n.key)||r===null&&!n.right)){u.next=5;break}return u.abrupt("break",8);case 5:!this.isLessThan(r,n.key)||r===null?n=n.right:n=n.left,u.next=2;break;case 8:if(n){u.next=10;break}return u.abrupt("return",null);case 10:i=!0;case 11:if(!i){u.next=29;break}return u.next=14,[n.key,n.value];case 14:if(i=!1,!n.left){u.next=21;break}for(n=n.left;n.right;)n=n.right;i=!0,u.next=27;break;case 21:if(!n.parent){u.next=26;break}i=n.parent.right===n,n=n.parent,u.next=27;break;case 26:return u.abrupt("break",37);case 27:u.next=35;break;case 29:if(!n.parent){u.next=34;break}i=n.parent.right===n,n=n.parent,u.next=35;break;case 34:return u.abrupt("break",37);case 35:u.next=11;break;case 37:return u.abrupt("return",null);case 38:case"end":return u.stop()}},t,this)})}]),e}();function UK(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=DK(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function DK(e,t){if(!!e){if(typeof e=="string")return P_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P_(e,t)}}function P_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var FK=function(){function e(t,r){pt.default(this,e),this.value=t,this.revision=r||0}return wt.default(e,[{key:"isValid",get:function(){return!0}}]),e}(),BK=function(){function e(t){pt.default(this,e),this.revision=t}return wt.default(e,[{key:"isValid",get:function(){return!1}}]),e}(),zg=function(){function e(){pt.default(this,e),this.items=new jK}return wt.default(e,[{key:"store",value:function(r,n,i){var a=this.items.get(r);return a&&a.revision>i?a.isValid?a.value:null:(this.items.set(r,new FK(n,i)),n)}},{key:"delete",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.items.get(r);(!a||a.revision<n||a&&i===!0)&&this.items.set(r,new BK(n))}},{key:"isKnown",value:function(r,n){var i=this.items.get(r);return i&&i.revision>=n}},{key:"get",value:function(r){var n=this.items.get(r);return n&&n.isValid?n.value:null}},{key:"has",value:function(r){var n=this.items.get(r);return n&&n.isValid}},{key:"forEach",value:function(r){if(this.items){var n=UK(this.items),i;try{for(n.s();!(i=n.n()).done;){var a=DT.default(i.value,2),s=a[0],u=a[1];u.isValid&&r(s,u.value)}}catch(o){n.e(o)}finally{n.f()}}}}]),e}();function JT(e){var t=qK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return da.default(this,i)}}function qK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Uh=function(e){Cr.default(r,e);var t=JT(r);function r(n,i,a){var s;pt.default(this,r),s=t.call(this,n,a);var u=function(c,d){return typeof d.ttl=="number"?{ttl:d.ttl}:c};return s.updateMergingQueue=new VT(u),s.cache=new zg,s.descriptor=i,s.descriptor.date_updated=new Date(s.descriptor.date_updated),s}return wt.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"list"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"_addOrUpdateItemOnServer",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o,c){var d,y;return W.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return d={data:u},c!==void 0&&(d.ttl=c),b.next=4,this.services.network.post(s,d,o);case 4:return y=b.sent,y.body.data=u,y.body.date_updated=new Date(y.body.date_updated),b.abrupt("return",y.body);case 8:case"end":return b.stop()}},a,this)}));function i(a,s,u,o){return n.apply(this,arguments)}return i}()},{key:"push",value:function(){var n=Ee.default(W.default.mark(function a(s,u){var o,c,d;return W.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return o=(u||{}).ttl,_.next=3,this._addOrUpdateItemOnServer(this.links.items,s,void 0,o);case 3:return c=_.sent,d=Number(c.index),this._handleItemMutated(d,c.url,c.last_event_id,c.revision,s,c.date_updated,c.date_expires,!0,!1),_.abrupt("return",this.cache.get(d));case 7:case"end":return _.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"set",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){var c=this,d;return W.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=o||{},_.abrupt("return",this.updateMergingQueue.squashAndAdd(s,d,function(b){return c._updateItemUnconditionally(s,u,b.ttl)}));case 2:case"end":return _.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"_updateItemUnconditionally",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){var c,d;return W.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this.get(s);case 2:return c=_.sent,_.next=5,this._addOrUpdateItemOnServer(c.uri,u,void 0,o);case 5:return d=_.sent,this._handleItemMutated(s,d.url,d.last_event_id,d.revision,d.data,d.date_updated,d.date_expires,!1,!1),_.abrupt("return",this.cache.get(s));case 8:case"end":return _.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"_updateItemWithIfMatch",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){var c,d,y,_;return W.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,this.get(s);case 2:if(c=T.sent,d=u(Cn(c.data)),!d){T.next=25;break}return y=c.revision,T.prev=6,T.next=9,this._addOrUpdateItemOnServer(c.uri,d,y,o);case 9:return _=T.sent,this._handleItemMutated(s,_.url,_.last_event_id,_.revision,_.data,_.date_updated,_.date_expires,!1,!1),T.abrupt("return",this.cache.get(s));case 14:if(T.prev=14,T.t0=T.catch(6),T.t0.status!==412){T.next=22;break}return T.next=19,this._getItemFromServer(s);case 19:return T.abrupt("return",this._updateItemWithIfMatch(s,u,o));case 22:throw T.t0;case 23:T.next=26;break;case 25:return T.abrupt("return",c);case 26:case"end":return T.stop()}},a,this,[[6,14]])}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){var c=this,d;return W.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=o||{},_.abrupt("return",this.updateMergingQueue.add(s,d,function(b){return c._updateItemWithIfMatch(s,u,b.ttl)}));case 2:case"end":return _.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.mutate(s,function(y){return Object.assign(y,u)},o));case 1:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=Ee.default(W.default.mark(function a(s){var u,o,c;return W.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this.get(s);case 2:return u=y.sent,o=Cn(u.data),y.next=6,this.services.network.delete(u.uri);case 6:c=y.sent,this._handleItemRemoved(s,c.body.last_event_id,o,new Date(c.body.date_updated),!1);case 8:case"end":return y.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=Ee.default(W.default.mark(function a(s){var u;return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(u=this.cache.get(s),!u){c.next=5;break}return c.abrupt("return",u);case 5:return c.abrupt("return",this._getItemFromServer(s));case 6:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_getItemFromServer",value:function(){var n=Ee.default(W.default.mark(function a(s){var u;return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.queryItems({index:s});case 2:if(u=c.sent,!(u.items.length<1)){c.next=7;break}throw new Nr("No item with index ".concat(s," found"),404,54151);case 7:return c.abrupt("return",u.items[0]);case 8:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"queryItems",value:function(){var n=Ee.default(W.default.mark(function a(s){var u=this,o,c,d,y;return W.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return s=s||{},o=new no(this.links.items).queryParam("From",s.from).queryParam("PageSize",s.limit).queryParam("Index",s.index).queryParam("PageToken",s.pageToken).queryParam("Order",s.order).build(),b.next=4,this.services.network.get(o);case 4:return c=b.sent,d=c.body.items.map(function(T){T.date_updated=new Date(T.date_updated);var x=u.cache.get(T.index);return x?u._handleItemMutated(T.index,T.url,T.last_event_id,T.revision,T.data,T.date_updated,T.date_expires,!1,!0):u.cache.store(Number(T.index),new jh({index:Number(T.index),uri:T.url,revision:T.revision,lastEventId:T.last_event_id,dateUpdated:T.date_updated,dateExpires:T.date_expires,data:T.data}),T.last_event_id),u.cache.get(T.index)}),y=c.body.meta,b.abrupt("return",new Gg(d,function(T){return u.queryItems({pageToken:T})},y.previous_token,y.next_token));case 8:case"end":return b.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return s=s||{},GT(s.pageSize),s.limit=s.pageSize||s.limit||50,s.order=s.order||"asc",o.abrupt("return",this.queryItems(s));case 5:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getContext",value:function(){var n=Ee.default(W.default.mark(function a(){var s;return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.context){o.next=5;break}return o.next=3,this.services.network.get(this.links.context);case 3:s=o.sent,this._updateContextIfRequired(s.body.data,s.body.last_event_id);case 5:return o.abrupt("return",this.context);case 6:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ee.default(W.default.mark(function a(s){var u,o;return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,u={ttl:s},d.next=4,this.services.network.post(this.uri,u);case 4:o=d.sent,this.descriptor.date_expires=o.body.date_expires,d.next=12;break;case 8:throw d.prev=8,d.t0=d.catch(0),d.t0.status===404&&this.onRemoved(!1),d.t0;case 12:case"end":return d.stop()}},a,this,[[0,8]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=Ee.default(W.default.mark(function a(s,u){var o,c,d;return W.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this.get(s);case 2:return o=_.sent,c={ttl:u},_.next=6,this.services.network.post(o.uri,c);case 6:d=_.sent,o.updateDateExpires(d.body.date_expires);case 8:case"end":return _.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeList",value:function(){var n=Ee.default(W.default.mark(function a(){return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"onRemoved",value:function(i){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i})}},{key:"shouldIgnoreEvent",value:function(i,a){return this.cache.isKnown(i,a)}},{key:"_update",value:function(i,a){var s=Number(i.item_index);switch(i.date_created=new Date(i.date_created),i.type){case"list_item_added":case"list_item_updated":this._handleItemMutated(s,i.item_url,i.id,i.item_revision,i.item_data,i.date_created,void 0,i.type==="list_item_added",!0);break;case"list_item_removed":this._handleItemRemoved(s,i.id,i.item_data,i.date_created,!0);break;case"list_context_updated":this._handleContextUpdate(i.context_data,i.id,i.date_created);break;case"list_removed":this.onRemoved(!1);break}a&&this._advanceLastEventId(i.id,i.list_revision)}},{key:"_advanceLastEventId",value:function(i,a){this.lastEventId<i&&(this.descriptor.last_event_id=i,a&&(this.descriptor.revision=a))}},{key:"_updateRootDateUpdated",value:function(i){(!this.descriptor.date_updated||i.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=i,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:i}))}},{key:"_handleItemMutated",value:function(i,a,s,u,o,c,d,y,_){if(this.shouldIgnoreEvent(i,s)){yt.trace("Item ".concat(i," update skipped, current: ").concat(this.lastEventId,", remote: ").concat(s));return}this._updateRootDateUpdated(c);var b=this.cache.get(i);if(!b){var T=new jh({index:i,uri:a,lastEventId:s,revision:u,data:o,dateUpdated:c,dateExpires:d});this.cache.store(i,T,s),this.emitItemMutationEvent(T,_,y);return}var x=Cn(b.data);b.update(s,u,o,c),this.cache.store(i,b,s),d!==void 0&&b.updateDateExpires(d),this.emitItemMutationEvent(b,_,!1,x)}},{key:"emitItemMutationEvent",value:function(i,a,s){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=s?"itemAdded":"itemUpdated",c={item:i,isLocal:!a};s||(c.previousItemData=u),this.broadcastEventToListeners(o,c)}},{key:"_handleItemRemoved",value:function(i,a,s,u,o){this._updateRootDateUpdated(u),this.cache.delete(i,a),this.broadcastEventToListeners("itemRemoved",{index:i,isLocal:!o,previousItemData:s})}},{key:"_handleContextUpdate",value:function(i,a,s){this._updateRootDateUpdated(s),this._updateContextIfRequired(i,a)&&this.broadcastEventToListeners("contextUpdated",{context:i,isLocal:!1})}},{key:"_updateContextIfRequired",value:function(i,a){return!this.contextEventId||a>this.contextEventId?(this.context=i,this.contextEventId=a,!0):(yt.trace("Context update skipped, current:",this.lastEventId,", remote:",a),!1)}}],[{key:"type",get:function(){return"list"}}]),r}(al),rr=function(e){Cr.default(r,e);var t=JT(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.syncListImpl=n,i.syncListImpl.attach(Bn.default(i)),i}return wt.default(r,[{key:"uri",get:function(){return this.syncListImpl.uri}},{key:"revision",get:function(){return this.syncListImpl.revision}},{key:"lastEventId",get:function(){return this.syncListImpl.lastEventId}},{key:"links",get:function(){return this.syncListImpl.links}},{key:"dateExpires",get:function(){return this.syncListImpl.dateExpires}},{key:"type",get:function(){return Uh.type}},{key:"sid",get:function(){return this.syncListImpl.sid}},{key:"uniqueName",get:function(){return this.syncListImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncListImpl.dateUpdated}},{key:"push",value:function(){var n=Ee.default(W.default.mark(function a(s,u){return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.push(s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"set",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncListImpl.set(s,u,o));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncListImpl.mutate(s,u,o));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncListImpl.update(s,u,o));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.remove(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.get(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getContext",value:function(){var n=Ee.default(W.default.mark(function a(){return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.getContext());case 2:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.getItems(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.setTtl(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=Ee.default(W.default.mark(function a(s,u){return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.setItemTtl(s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeList",value:function(){var n=Ee.default(W.default.mark(function a(){return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.removeList());case 2:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){nl.default(Qt.default(r.prototype),"close",this).call(this),this.syncListImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Uh.type}}]),r}(sl);$t.default(rr,"itemAdded","itemAdded");$t.default(rr,"itemUpdated","itemUpdated");$t.default(rr,"itemRemoved","itemRemoved");$t.default(rr,"removed","removed");gt([ge.validateTypesAsync(ge.pureObject,["undefined",ge.objectSchema("item metadata",{ttl:[ge.nonNegativeInteger,"undefined"]})]),we("design:type",Function),we("design:paramtypes",[Object,Object]),we("design:returntype",Promise)],rr.prototype,"push",null);gt([ge.validateTypesAsync(ge.nonNegativeInteger,ge.pureObject,["undefined",ge.objectSchema("item metadata",{ttl:[ge.nonNegativeInteger,"undefined"]})]),we("design:type",Function),we("design:paramtypes",[Number,Object,Object]),we("design:returntype",Promise)],rr.prototype,"set",null);gt([ge.validateTypesAsync(ge.nonNegativeInteger,"function",["undefined",ge.objectSchema("item metadata",{ttl:[ge.nonNegativeInteger,"undefined"]})]),we("design:type",Function),we("design:paramtypes",[Number,Function,Object]),we("design:returntype",Promise)],rr.prototype,"mutate",null);gt([ge.validateTypesAsync(ge.nonNegativeInteger,ge.pureObject,["undefined",ge.objectSchema("item metadata",{ttl:[ge.nonNegativeInteger,"undefined"]})]),we("design:type",Function),we("design:paramtypes",[Number,Object,Object]),we("design:returntype",Promise)],rr.prototype,"update",null);gt([ge.validateTypesAsync(ge.nonNegativeInteger),we("design:type",Function),we("design:paramtypes",[Number]),we("design:returntype",Promise)],rr.prototype,"remove",null);gt([ge.validateTypesAsync(ge.nonNegativeInteger),we("design:type",Function),we("design:paramtypes",[Number]),we("design:returntype",Promise)],rr.prototype,"get",null);gt([ge.validateTypesAsync(["undefined",ge.objectSchema("query options",{from:[ge.nonNegativeInteger,"undefined"],pageSize:[ge.custom(function(e){return[Wg(e),"a positive integer"]}),"undefined"]})]),we("design:type",Function),we("design:paramtypes",[Object]),we("design:returntype",Promise)],rr.prototype,"getItems",null);gt([ge.validateTypesAsync(ge.nonNegativeInteger),we("design:type",Function),we("design:paramtypes",[Number]),we("design:returntype",Promise)],rr.prototype,"setTtl",null);gt([ge.validateTypesAsync(ge.nonNegativeInteger,ge.nonNegativeInteger),we("design:type",Function),we("design:paramtypes",[Number,Number]),we("design:returntype",Promise)],rr.prototype,"setItemTtl",null);var eu=function(){function e(t){pt.default(this,e),this.descriptor=t}return wt.default(e,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"key",get:function(){return this.descriptor.key}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"update",value:function(r,n,i,a){return this.descriptor.last_event_id=r,this.descriptor.revision=n,this.descriptor.data=i,this.descriptor.date_updated=a,this}},{key:"updateDateExpires",value:function(r){this.descriptor.date_expires=r}}]),e}();function YT(e){var t=HK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return da.default(this,i)}}function HK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Dh=function(e){Cr.default(r,e);var t=YT(r);function r(n,i,a){var s;pt.default(this,r),s=t.call(this,n,a);var u=function(c,d){return typeof d.ttl=="number"?{ttl:d.ttl}:c};return s.updateMergingQueue=new VT(u),s.cache=new zg,s.descriptor=i,s.descriptor.date_updated=new Date(s.descriptor.date_updated),i.items&&i.items.forEach(function(o){o.date_updated=new Date(o.date_updated),s.cache.store(o.key,new eu(o),o.last_event_id)}),s}return wt.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"map"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"set",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){var c=this,d;return W.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=o||{},_.abrupt("return",this.updateMergingQueue.squashAndAdd(s,d,function(b){return c._putItemUnconditionally(s,u,b.ttl)}));case 2:case"end":return _.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(s!=null){o.next=2;break}throw new Nr("SyncMapItem key may not be empty",400,54209);case 2:if(!this.cache.has(s)){o.next=6;break}return o.abrupt("return",this.cache.get(s));case 6:return o.abrupt("return",this._getItemFromServer(s));case 7:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_getItemFromServer",value:function(){var n=Ee.default(W.default.mark(function a(s){var u;return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.queryItems({key:s});case 2:if(u=c.sent,!(u.items.length<1)){c.next=7;break}throw new Nr("The specified Map Item does not exist",404,54201);case 7:return c.abrupt("return",u.items[0]);case 8:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){var c=this,d;return W.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=o||{},_.abrupt("return",this.updateMergingQueue.add(s,d,function(b){return c._putItemWithIfMatch(s,u,b.ttl)}));case 2:case"end":return _.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.mutate(s,function(y){return Object.assign(y,u)},o));case 1:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"_putItemUnconditionally",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){var c,d;return W.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._putItemToServer(s,u,void 0,o);case 2:return c=_.sent,d=c.item,this._handleItemMutated(d.key,d.url,d.last_event_id,d.revision,d.data,d.date_updated,d.date_expires,c.added,!1),_.abrupt("return",this.cache.get(d.key));case 6:case"end":return _.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"_putItemWithIfMatch",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){var c,d,y,_,b;return W.default.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,this.get(s).catch(function(N){if(N.status===404)return new eu({key:s,data:{},last_event_id:-1,revision:"-1",url:null,date_updated:null,date_expires:null});throw N});case 2:if(c=x.sent,d=u(Cn(c.data)),!d){x.next=26;break}return y=c.revision,x.prev=6,x.next=9,this._putItemToServer(s,d,y,o);case 9:return _=x.sent,b=_.item,this._handleItemMutated(b.key,b.url,b.last_event_id,b.revision,b.data,b.date_updated,b.date_expires,_.added,!1),x.abrupt("return",this.cache.get(b.key));case 15:if(x.prev=15,x.t0=x.catch(6),x.t0.status!==412){x.next=23;break}return x.next=20,this._getItemFromServer(s);case 20:return x.abrupt("return",this._putItemWithIfMatch(s,u,o));case 23:throw x.t0;case 24:x.next=27;break;case 26:return x.abrupt("return",c);case 27:case"end":return x.stop()}},a,this,[[6,15]])}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"_putItemToServer",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o,c){var d,y,_,b,T;return W.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return d=new no(this.links.items).pathSegment(s).build(),y={data:u},c!==void 0&&(y.ttl=c),N.prev=3,N.next=6,this.services.network.put(d,y,o);case 6:return _=N.sent,b=_.body,b.data=u,b.date_updated=new Date(b.date_updated),T=_.status.code===201,N.abrupt("return",{added:T,item:b});case 14:throw N.prev=14,N.t0=N.catch(3),N.t0.status===404&&this.onRemoved(!1),N.t0;case 18:case"end":return N.stop()}},a,this,[[3,14]])}));function i(a,s,u,o){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=Ee.default(W.default.mark(function a(s){var u,o,c;return W.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this.get(s);case 2:return u=y.sent,o=Cn(u.data),y.next=6,this.services.network.delete(u.uri);case 6:c=y.sent,this._handleItemRemoved(s,c.body.last_event_id,o,new Date(c.body.date_updated),!1);case 8:case"end":return y.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"queryItems",value:function(){var n=Ee.default(W.default.mark(function a(s){var u=this,o,c,d,y;return W.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return s=s||{},o=new no(this.links.items).queryParam("From",s.from).queryParam("PageSize",s.limit).queryParam("Key",s.key).queryParam("PageToken",s.pageToken).queryParam("Order",s.order).build(),b.next=4,this.services.network.get(o);case 4:return c=b.sent,d=c.body.items.map(function(T){T.date_updated=new Date(T.date_updated);var x=u.cache.get(T.key);return x?u._handleItemMutated(T.key,T.url,T.last_event_id,T.revision,T.data,T.date_updated,T.date_expires,!1,!0):u.cache.store(T.key,new eu(T),T.last_event_id),u.cache.get(T.key)}),y=c.body.meta,b.abrupt("return",new Gg(d,function(T){return u.queryItems({pageToken:T})},y.previous_token,y.next_token));case 8:case"end":return b.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return s=s||{},GT(s.pageSize),s.limit=s.pageSize||s.limit||50,s.order=s.order||"asc",o.abrupt("return",this.queryItems(s));case 5:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"shouldIgnoreEvent",value:function(i,a){return this.cache.isKnown(i,a)}},{key:"_update",value:function(i,a){switch(i.date_created=new Date(i.date_created),i.type){case"map_item_added":case"map_item_updated":this._handleItemMutated(i.item_key,i.item_url,i.id,i.item_revision,i.item_data,i.date_created,void 0,i.type==="map_item_added",!0);break;case"map_item_removed":this._handleItemRemoved(i.item_key,i.id,i.item_data,i.date_created,!0);break;case"map_removed":this.onRemoved(!1);break}a&&this._advanceLastEventId(i.id,i.map_revision)}},{key:"_advanceLastEventId",value:function(i,a){this.lastEventId<i&&(this.descriptor.last_event_id=i,a&&(this.descriptor.revision=a))}},{key:"_updateRootDateUpdated",value:function(i){(!this.descriptor.date_updated||i.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=i,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:i}))}},{key:"_handleItemMutated",value:function(i,a,s,u,o,c,d,y,_){if(this.shouldIgnoreEvent(i,s)){yt.trace("SyncMapItem ",i," update skipped, current:",this.lastEventId,", remote:",s);return}this._updateRootDateUpdated(c);var b=this.cache.get(i);if(!b){var T=new eu({key:i,url:a,last_event_id:s,revision:u,data:o,date_updated:c,date_expires:d});this.cache.store(i,T,s),this.emitItemMutationEvent(T,_,y);return}var x=Cn(b.data);b.update(s,u,o,c),this.cache.store(i,b,s),d!==void 0&&b.updateDateExpires(d),this.emitItemMutationEvent(b,_,!1,x)}},{key:"emitItemMutationEvent",value:function(i,a,s){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=s?"itemAdded":"itemUpdated",c={item:i,isLocal:!a};s||(c.previousItemData=u),this.broadcastEventToListeners(o,c)}},{key:"_handleItemRemoved",value:function(i,a,s,u,o){this._updateRootDateUpdated(u),this.cache.delete(i,a),this.broadcastEventToListeners("itemRemoved",{key:i,isLocal:!o,previousItemData:s})}},{key:"onRemoved",value:function(i){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i})}},{key:"setTtl",value:function(){var n=Ee.default(W.default.mark(function a(s){var u,o;return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,u={ttl:s},d.next=4,this.services.network.post(this.uri,u);case 4:o=d.sent,this.descriptor.date_expires=o.body.date_expires,d.next=12;break;case 8:throw d.prev=8,d.t0=d.catch(0),d.t0.status===404&&this.onRemoved(!1),d.t0;case 12:case"end":return d.stop()}},a,this,[[0,8]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=Ee.default(W.default.mark(function a(s,u){var o,c,d;return W.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this.get(s);case 2:return o=_.sent,c={ttl:u},_.next=6,this.services.network.post(o.uri,c);case 6:d=_.sent,o.updateDateExpires(d.body.date_expires);case 8:case"end":return _.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeMap",value:function(){var n=Ee.default(W.default.mark(function a(){return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()}],[{key:"type",get:function(){return"map"}}]),r}(al),ir=function(e){Cr.default(r,e);var t=YT(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.syncMapImpl=n,i.syncMapImpl.attach(Bn.default(i)),i}return wt.default(r,[{key:"uri",get:function(){return this.syncMapImpl.uri}},{key:"links",get:function(){return this.syncMapImpl.links}},{key:"revision",get:function(){return this.syncMapImpl.revision}},{key:"lastEventId",get:function(){return this.syncMapImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncMapImpl.dateExpires}},{key:"type",get:function(){return Dh.type}},{key:"sid",get:function(){return this.syncMapImpl.sid}},{key:"uniqueName",get:function(){return this.syncMapImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncMapImpl.dateUpdated}},{key:"set",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncMapImpl.set(s,u,o));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncMapImpl.get(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncMapImpl.mutate(s,u,o));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Ee.default(W.default.mark(function a(s,u,o){return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncMapImpl.update(s,u,o));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncMapImpl.remove(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncMapImpl.getItems(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncMapImpl.setTtl(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=Ee.default(W.default.mark(function a(s,u){return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.setItemTtl(s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeMap",value:function(){var n=Ee.default(W.default.mark(function a(){return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.next=3,this.syncMapImpl.removeMap();case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){nl.default(Qt.default(r.prototype),"close",this).call(this),this.syncMapImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Dh.type}}]),r}(sl);$t.default(ir,"itemAdded","itemAdded");$t.default(ir,"itemUpdated","itemUpdated");$t.default(ir,"itemRemoved","itemRemoved");$t.default(ir,"removed","removed");gt([ge.validateTypesAsync("string",ge.pureObject,["undefined",ge.objectSchema("item metadata",{ttl:[ge.nonNegativeInteger,"undefined"]})]),we("design:type",Function),we("design:paramtypes",[String,Object,Object]),we("design:returntype",Promise)],ir.prototype,"set",null);gt([ge.validateTypesAsync("string"),we("design:type",Function),we("design:paramtypes",[String]),we("design:returntype",Promise)],ir.prototype,"get",null);gt([ge.validateTypesAsync("string","function",["undefined",ge.objectSchema("item metadata",{ttl:[ge.nonNegativeInteger,"undefined"]})]),we("design:type",Function),we("design:paramtypes",[String,Function,Object]),we("design:returntype",Promise)],ir.prototype,"mutate",null);gt([ge.validateTypesAsync("string",ge.pureObject,["undefined",ge.objectSchema("item metadata",{ttl:[ge.nonNegativeInteger,"undefined"]})]),we("design:type",Function),we("design:paramtypes",[String,Object,Object]),we("design:returntype",Promise)],ir.prototype,"update",null);gt([ge.validateTypesAsync("string"),we("design:type",Function),we("design:paramtypes",[String]),we("design:returntype",Promise)],ir.prototype,"remove",null);gt([ge.validateTypesAsync(["undefined",ge.objectSchema("query options",{from:["string","undefined"],pageSize:[ge.custom(function(e){return[Wg(e),"a positive integer"]}),"undefined"]})]),we("design:type",Function),we("design:paramtypes",[Object]),we("design:returntype",Promise)],ir.prototype,"getItems",null);gt([ge.validateTypesAsync(ge.nonNegativeInteger),we("design:type",Function),we("design:paramtypes",[Number]),we("design:returntype",Promise)],ir.prototype,"setTtl",null);gt([ge.validateTypesAsync("string",ge.nonNegativeInteger),we("design:type",Function),we("design:paramtypes",[String,Number]),we("design:returntype",Promise)],ir.prototype,"setItemTtl",null);function QT(e){var t=WK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return da.default(this,i)}}function WK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ru=function(e){Cr.default(r,e);var t=QT(r);function r(n,i,a){var s;return pt.default(this,r),s=t.call(this,n,a),s.descriptor=i,s}return wt.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"stream"}},{key:"lastEventId",get:function(){return null}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"publishMessage",value:function(){var n=Ee.default(W.default.mark(function a(s){var u,o,c,d;return W.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return u={data:s},_.next=3,this.services.network.post(this.links.messages,u);case 3:return o=_.sent,c=o.body,d=this._handleMessagePublished(c.sid,s,!1),_.abrupt("return",d);case 7:case"end":return _.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ee.default(W.default.mark(function a(s){var u,o;return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,u={ttl:s},d.next=4,this.services.network.post(this.uri,u);case 4:o=d.sent,this.descriptor.date_expires=o.body.date_expires,d.next=12;break;case 8:throw d.prev=8,d.t0=d.catch(0),d.t0.status===404&&this.onRemoved(!1),d.t0;case 12:case"end":return d.stop()}},a,this,[[0,8]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"removeStream",value:function(){var n=Ee.default(W.default.mark(function a(){return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"_update",value:function(i){switch(i.type){case"stream_message_published":{this._handleMessagePublished(i.message_sid,i.message_data,!0);break}case"stream_removed":{this.onRemoved(!1);break}}}},{key:"_handleMessagePublished",value:function(i,a,s){var u={sid:i,data:a};return this.broadcastEventToListeners("messagePublished",{message:u,isLocal:!s}),u}},{key:"onRemoved",value:function(i){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i})}}],[{key:"type",get:function(){return"stream"}}]),r}(al);gt([ge.validateTypesAsync(ge.pureObject),we("design:type",Function),we("design:paramtypes",[Object]),we("design:returntype",Promise)],Ru.prototype,"publishMessage",null);gt([ge.validateTypesAsync(ge.nonNegativeInteger),we("design:type",Function),we("design:paramtypes",[Number]),we("design:returntype",Promise)],Ru.prototype,"setTtl",null);var Dn=function(e){Cr.default(r,e);var t=QT(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.syncStreamImpl=n,i.syncStreamImpl.attach(Bn.default(i)),i}return wt.default(r,[{key:"uri",get:function(){return this.syncStreamImpl.uri}},{key:"links",get:function(){return this.syncStreamImpl.links}},{key:"dateExpires",get:function(){return this.syncStreamImpl.dateExpires}},{key:"type",get:function(){return Ru.type}},{key:"lastEventId",get:function(){return null}},{key:"sid",get:function(){return this.syncStreamImpl.sid}},{key:"uniqueName",get:function(){return this.syncStreamImpl.uniqueName}},{key:"publishMessage",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncStreamImpl.publishMessage(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncStreamImpl.setTtl(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"removeStream",value:function(){var n=Ee.default(W.default.mark(function a(){return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncStreamImpl.removeStream());case 2:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){nl.default(Qt.default(r.prototype),"close",this).call(this),this.syncStreamImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Ru.type}}]),r}(sl);$t.default(Dn,"messagePublished","messagePublished");$t.default(Dn,"removed","removed");gt([ge.validateTypesAsync(ge.pureObject),we("design:type",Function),we("design:paramtypes",[Object]),we("design:returntype",Promise)],Dn.prototype,"publishMessage",null);gt([ge.validateTypesAsync(ge.nonNegativeInteger),we("design:type",Function),we("design:paramtypes",[Number]),we("design:returntype",Promise)],Dn.prototype,"setTtl",null);var GK=function e(t){pt.default(this,e),this.sdk="js",this.sdkVer=t,this.os=ql.os.family,this.osVer=ql.os.version,this.pl=ql.name,this.plVer=ql.version},zK=function(){function e(){pt.default(this,e),this.names=new Map,this.entities=new Map}return wt.default(e,[{key:"store",value:function(r){var n=this.entities.get(r.sid);return n||(this.entities.set(r.sid,r),r.uniqueName&&this.names.set(r.type+"::"+r.uniqueName,r.sid),r)}},{key:"getResolved",value:function(r,n){var i=this.names.get(n+"::"+r);return i?this.entities.get(i):null}},{key:"get",value:function(r,n){return this.entities.get(r)||this.getResolved(r,n)||null}},{key:"remove",value:function(r){var n=this.entities.get(r);n&&(this.entities.delete(r),n.uniqueName&&this.names.delete(n.type+"::"+n.uniqueName))}}]),e}();function Vg(e){var t=VK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return da.default(this,i)}}function VK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var KK=function e(){pt.default(this,e)},Fh=function(e){Cr.default(r,e);var t=Vg(r);function r(n,i,a,s){var u;return pt.default(this,r),u=t.call(this,i,a),u.descriptor=n,u.cache=new zg,s&&s.forEach(function(o){u.cache.store(o.key,{key:o.key,value:o.data},o.revision)}),u}return wt.default(r,[{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return null}},{key:"type",get:function(){return r.type}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"indexName",get:function(){return this.descriptor.indexName}},{key:"queryString",get:function(){return this.descriptor.queryExpression}},{key:"queryUri",get:function(){return this.descriptor.queryUri}},{key:"liveQueryDescriptor",get:function(){return this.descriptor}},{key:"onRemoved",value:function(){}},{key:"getItems",value:function(){var i={};return this.cache.forEach(function(a,s){i[a]=s.value}),i}},{key:"_update",value:function(i,a){switch(i.type){case"live_query_item_updated":this.handleItemMutated(i.item_key,i.item_data,i.item_revision);break;case"live_query_item_removed":this.handleItemRemoved(i.item_key,i.item_revision);break;case"live_query_updated":this.handleBatchUpdate(i.items);break}a&&this._advanceLastEventId(i.last_event_id)}},{key:"handleItemMutated",value:function(i,a,s){if(this.shouldIgnoreEvent(i,s))yt.trace("Item ".concat(i," update skipped, revision: ").concat(s));else{var u={key:i,value:a};this.cache.store(i,u,s),this.broadcastEventToListeners("itemUpdated",u)}}},{key:"handleItemRemoved",value:function(i,a){var s=a===null;this.shouldIgnoreEvent(i,a)?yt.trace("Item ".concat(i," delete skipped, revision: ").concat(a)):(this.cache.delete(i,a,s),this.broadcastEventToListeners("itemRemoved",{key:i}))}},{key:"handleBatchUpdate",value:function(i){var a=this,s={};i!=null&&i.forEach(function(o){s[o.key]={data:o.data,revision:o.revision}}),this.cache.forEach(function(o,c){var d=s[o];d!=null?a.handleItemMutated(o,d.data,d.revision):a.handleItemRemoved(o,null),delete s[o]});for(var u in s)this.handleItemMutated(u,s[u].data,s[u].revision)}},{key:"shouldIgnoreEvent",value:function(i,a){return i!=null&&a!=null&&this.cache.isKnown(i,a)}},{key:"_advanceLastEventId",value:function(i,a){this.lastEventId<i&&(this.descriptor.last_event_id=i)}}],[{key:"type",get:function(){return"live_query"}}]),r}(al);function XT(e){return Bh.apply(this,arguments)}function Bh(){return Bh=Ee.default(W.default.mark(function e(t){var r,n,i,a,s,u;return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(r=t.network,n=t.queryString,i=t.uri,a=t.type,n!=null){c.next=3;break}throw new Nr("Invalid query",400,54507);case 3:return s={query_string:n},a===ui.type&&(s.type=a),c.next=7,r.post(i,s,void 0,!0);case 7:return u=c.sent,c.abrupt("return",u.body);case 9:case"end":return c.stop()}},e)})),Bh.apply(this,arguments)}var ui=function(e){Cr.default(r,e);var t=Vg(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.liveQueryImpl=n,i.liveQueryImpl.attach(Bn.default(i)),i}return wt.default(r,[{key:"type",get:function(){return Fh.type}},{key:"lastEventId",get:function(){return this.liveQueryImpl.lastEventId}},{key:"sid",get:function(){return this.liveQueryImpl.sid}},{key:"close",value:function(){nl.default(Qt.default(r.prototype),"close",this).call(this),this.liveQueryImpl.detach(this.listenerUuid)}},{key:"getItems",value:function(){return this.ensureNotClosed(),this.liveQueryImpl.getItems()}}],[{key:"type",get:function(){return Fh.type}}]),r}(sl);$t.default(ui,"itemUpdated","itemUpdated");$t.default(ui,"itemRemoved","itemRemoved");var ol=function(e){Cr.default(r,e);var t=Vg(r);function r(n){var i;return pt.default(this,r),i=t.call(this),$t.default(Bn.default(i),"queryExpression",null),$t.default(Bn.default(i),"items",{}),Object.assign(Bn.default(i),n),i.updateIndexName(n.indexName),i}return wt.default(r,[{key:"type",get:function(){return r.type}},{key:"search",value:function(){var n=Ee.default(W.default.mark(function a(s){var u=this;return W.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.items={},c.abrupt("return",XT({network:this.network,uri:this.queryUri,queryString:s}).then(function(d){u.queryExpression=s,d.items&&d.items.forEach(function(y){u.items[y.key]=y.data}),u.emit("searchResult",u.getItems())}).catch(function(d){throw yt.error("Error '".concat(d.message,"' while executing query '").concat(s,"'")),u.queryExpression=null,d}));case 2:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"subscribe",value:function(){var n=Ee.default(W.default.mark(function a(){return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.queryExpression!=null){u.next=2;break}return u.abrupt("return",Promise.reject(new Nr("Invalid query",400,54507)));case 2:return u.abrupt("return",this.liveQueryCreator(this.indexName,this.queryExpression));case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){return this.items}},{key:"updateIndexName",value:function(i){this.indexName=i,this.queryUri=this.generateQueryUri(this.indexName)}},{key:"generateQueryUri",value:function(i){return new no(this.insightsUri).pathSegment(i).pathSegment("Items").build()}}],[{key:"type",get:function(){return"instant_query"}}]),r}(Tt);$t.default(ol,"searchResult","searchResult");gt([ge.validateTypesAsync("string"),we("design:type",Function),we("design:paramtypes",[String]),we("design:returntype",Promise)],ol.prototype,"search",null);gt([ge.validateTypes(ge.nonEmptyString),we("design:type",Function),we("design:paramtypes",[String]),we("design:returntype",void 0)],ol.prototype,"updateIndexName",null);var JK="3.1.0";function YK(e){var t=QK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return da.default(this,i)}}function QK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function M_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function N_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M_(Object(r),!0).forEach(function(n){$t.default(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var XK="data_sync",lp=JK;function Hl(e){if(e){if(typeof e=="string")return{id:e,mode:"open_or_create"};var t=e.mode||(e.id?"open_or_create":"create_new");return N_(N_({},e),{},{mode:t})}else return{mode:"create_new"}}var x_="com.twilio.rtd.cds.document",L_="com.twilio.rtd.cds.list",j_="com.twilio.rtd.cds.map",U_="twilio.sync.event",zr=function(e){Cr.default(r,e);var t=YK(r);function r(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(pt.default(this,r),i=t.call(this),!n)throw new Error("Sync library needs a valid Twilio token to be passed");a.hasOwnProperty("logLevel")?yt.setLevel(a.logLevel):yt.setLevel("silent");var s=a.productId=a.productId||XK;a.clientMetadata=a.clientMetadata||{},a.clientMetadata.hasOwnProperty("type")||(a.clientMetadata.type="sync"),a.clientMetadata.hasOwnProperty("sdk")||(a.clientMetadata.sdk="JS",a.clientMetadata.sdkv=lp);var u=!a.twilsockClient;if(!a.initRegistrations){var o=new xc.InitRegistration(s);r.populateInitRegistrations(o),a.initRegistrations=[o]}var c=a.twilsockClient=a.twilsockClient||new xc.Twilsock(n,s,a);c.on("tokenAboutToExpire",function(b){return i.emit("tokenAboutToExpire",b)}),c.on("tokenExpired",function(){return i.emit("tokenExpired")}),c.on("connectionError",function(b){return i.emit("connectionError",b)}),c.on("stateChanged",function(b){i.emit("connectionStateChanged",b),i.services.subscriptions.onConnectionStateChanged(b==="connected")}),c.on("message",function(b,T){return i._routeMessage(b,T)});var d=new bK(a),y=new CK(new GK(lp),d,c),_=new IK(d);return i.services={config:d,twilsock:c,network:y,storage:_,router:Bn.default(i),subscriptions:null},i.services.subscriptions=new SK(i.services),i.entities=new zK,u&&c.connect(),i}return wt.default(r,[{key:"_routeMessage",value:function(i,a){switch(yt.trace("Notification type:",i,"content:",a),i){case x_:case L_:case j_:this.services.subscriptions.acceptMessage(a,!1);break;case U_:this.services.subscriptions.acceptMessage(a,!0);break}}},{key:"_subscribe",value:function(i,a){this.services.subscriptions.add(i,a)}},{key:"_unsubscribe",value:function(i){this.services.subscriptions.remove(i)}},{key:"connectionState",get:function(){return this.services.twilsock.state}},{key:"ensureReady",value:function(){var n=Ee.default(W.default.mark(function a(){var s;return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.services.config.sessionStorageEnabled){o.next=2;break}return o.abrupt("return");case 2:return o.prev=2,o.next=5,this.services.twilsock.storageId();case 5:s=o.sent,this.services.storage.updateStorageId(s.id),o.next=12;break;case 9:o.prev=9,o.t0=o.catch(2),yt.warn("Failed to initialize storage",o.t0);case 12:case"end":return o.stop()}},a,this,[[2,9]])}));function i(){return n.apply(this,arguments)}return i}()},{key:"storeRootInSessionCache",value:function(i,a,s){if(!(!this.services.config.sessionStorageEnabled||!a)){var u=Cn(s);(i===rr.type||i===ir.type)&&(u.last_event_id=null,delete u.items),this.services.storage.store(i,a,u)}}},{key:"readRootFromSessionCache",value:function(i,a){return!this.services.config.sessionStorageEnabled||!a?null:this.services.storage.read(i,a)}},{key:"_get",value:function(){var n=Ee.default(W.default.mark(function a(s,u){var o,c,d,y=arguments;return W.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(o=y.length>2&&y[2]!==void 0?y[2]:!1,u){b.next=3;break}throw new Nr("Cannot get entity without id",404);case 3:return c=new no(s).pathSegment(u).queryParam("Include",o?"items":void 0).build(),b.next=6,this.services.network.get(c);case 6:return d=b.sent,b.abrupt("return",d.body);case 8:case"end":return b.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"_createDocument",value:function(i,a,s){var u={unique_name:i,data:a||{}};return s!==void 0&&(u.ttl=s),this.services.network.post(this.services.config.documentsUri,u).then(function(o){return o.body.data=u.data,o.body})}},{key:"_getDocument",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.readRootFromSessionCache(sn.type,s)||this._get(this.services.config.documentsUri,s));case 1:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_createList",value:function(i,a,s,u){var o={unique_name:i,purpose:a,context:s};return u!==void 0&&(o.ttl=u),this.services.network.post(this.services.config.listsUri,o).then(function(c){return c.body})}},{key:"_getList",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.readRootFromSessionCache(rr.type,s)||this._get(this.services.config.listsUri,s));case 1:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_createMap",value:function(i,a){var s={unique_name:i};return a!==void 0&&(s.ttl=a),this.services.network.post(this.services.config.mapsUri,s).then(function(u){return u.body})}},{key:"_getMap",value:function(){var n=Ee.default(W.default.mark(function a(s){var u,o=arguments;return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return u=o.length>1&&o[1]!==void 0?o[1]:!1,d.abrupt("return",this.readRootFromSessionCache(ir.type,s)||this._get(this.services.config.mapsUri,s,u));case 2:case"end":return d.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_getStream",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.readRootFromSessionCache(Dn.type,s)||this._get(this.services.config.streamsUri,s,!1));case 1:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_createStream",value:function(){var n=Ee.default(W.default.mark(function a(s,u){var o,c;return W.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return o={unique_name:s},u!==void 0&&(o.ttl=u),y.next=4,this.services.network.post(this.services.config.streamsUri,o);case 4:return c=y.sent,y.abrupt("return",c.body);case 6:case"end":return y.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"_getLiveQuery",value:function(i){return this.readRootFromSessionCache(ui.type,i)}},{key:"getCached",value:function(i,a){return i&&this.entities.get(i,a)||null}},{key:"removeFromCacheAndSession",value:function(i,a,s){this.entities.remove(a),this.services.config.sessionStorageEnabled&&this.services.storage.remove(i,a,s)}},{key:"document",value:function(){var n=Ee.default(W.default.mark(function a(s){var u=this,o,c,d,y;return W.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(o=Hl(s),o.mode!=="create_new"){b.next=9;break}return b.next=6,this._createDocument(o.id,o.data,o.ttl);case 6:c=b.sent,b.next=39;break;case 9:if(d=this.getCached(o.id,sn.type),!d){b.next=14;break}return b.abrupt("return",new sn(d));case 14:return b.prev=14,b.next=17,this._getDocument(o.id);case 17:c=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||o.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createDocument(o.id,o.data,o.ttl);case 29:c=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.document(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(sn.type,o.id,c),y=new Lh(this.services,c,function(T,x,N){return u.removeFromCacheAndSession(T,x,N)}),y=this.entities.store(y),b.abrupt("return",new sn(y));case 43:case"end":return b.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"map",value:function(){var n=Ee.default(W.default.mark(function a(s){var u=this,o,c,d,y;return W.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(o=Hl(s),o.mode!=="create_new"){b.next=9;break}return b.next=6,this._createMap(o.id,o.ttl);case 6:c=b.sent,b.next=39;break;case 9:if(d=this.getCached(o.id,ir.type),!d){b.next=14;break}return b.abrupt("return",new ir(d));case 14:return b.prev=14,b.next=17,this._getMap(o.id,o.includeItems);case 17:c=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||o.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createMap(o.id,o.ttl);case 29:c=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.map(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(ir.type,o.id,c),y=new Dh(this.services,c,function(T,x,N){return u.removeFromCacheAndSession(T,x,N)}),y=this.entities.store(y),b.abrupt("return",new ir(y));case 43:case"end":return b.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"list",value:function(){var n=Ee.default(W.default.mark(function a(s){var u=this,o,c,d,y;return W.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(o=Hl(s),o.mode!=="create_new"){b.next=9;break}return b.next=6,this._createList(o.id,o.purpose,o.context,o.ttl);case 6:c=b.sent,b.next=39;break;case 9:if(d=this.getCached(o.id,rr.type),!d){b.next=14;break}return b.abrupt("return",new rr(d));case 14:return b.prev=14,b.next=17,this._getList(o.id);case 17:c=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||o.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createList(o.id,o.purpose,o.context,o.ttl);case 29:c=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.list(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(rr.type,o.id,c),y=new Uh(this.services,c,function(T,x,N){return u.removeFromCacheAndSession(T,x,N)}),y=this.entities.store(y),b.abrupt("return",new rr(y));case 43:case"end":return b.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"stream",value:function(){var n=Ee.default(W.default.mark(function a(s){var u=this,o,c,d,y,_;return W.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,this.ensureReady();case 2:if(o=Hl(s),o.mode!=="create_new"){T.next=9;break}return T.next=6,this._createStream(o.id,o.ttl);case 6:c=T.sent,T.next=39;break;case 9:if(d=this.getCached(o.id,Dn.type),!d){T.next=14;break}return T.abrupt("return",new Dn(d));case 14:return T.prev=14,T.next=17,this._getStream(o.id);case 17:c=T.sent,T.next=39;break;case 20:if(T.prev=20,T.t0=T.catch(14),!(T.t0.status!==404||o.mode==="open_existing")){T.next=26;break}throw T.t0;case 26:return T.prev=26,T.next=29,this._createStream(o.id,o.ttl);case 29:c=T.sent,T.next=39;break;case 32:if(T.prev=32,T.t1=T.catch(26),T.t1.status!==409){T.next=38;break}return T.abrupt("return",this.stream(s));case 38:throw T.t1;case 39:return this.storeRootInSessionCache(Dn.type,o.id,c),y=function(N,D,H){return u.removeFromCacheAndSession(N,D,H)},_=new Ru(this.services,c,y),_=this.entities.store(_),T.abrupt("return",new Dn(_));case 44:case"end":return T.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"shutdown",value:function(){var n=Ee.default(W.default.mark(function a(){return W.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.services.subscriptions.shutdown();case 2:return u.next=4,this.services.twilsock.disconnect();case 4:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"updateToken",value:function(){var n=Ee.default(W.default.mark(function a(s){return W.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.services.twilsock.updateToken(s).catch(function(c){var d,y=c==null||(d=c.reply)===null||d===void 0?void 0:d.status;throw(y==null?void 0:y.code)===401&&(y==null?void 0:y.status)==="UNAUTHORIZED"?new Nr("Updated token was rejected by server",400,51130):c}));case 1:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"liveQuery",value:function(){var n=Ee.default(W.default.mark(function a(s,u){var o=this,c,d,y,_,b;return W.default.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,this.ensureReady();case 2:return c=new no(this.services.config.insightsUri).pathSegment(s).pathSegment("Items").build(),x.next=5,XT({network:this.services.network,uri:c,queryString:u,type:ui.type});case 5:return d=x.sent,y=this.getCached(d.query_id,ui.type),y||(_=this._getLiveQuery(d.query_id),_||(_={indexName:s,queryExpression:u,sid:d.query_id,queryUri:c,last_event_id:d.last_event_id}),b=function(D,H,ve){return o.removeFromCacheAndSession(D,H,ve)},y=new Fh(_,this.services,b,d.items)),this.storeRootInSessionCache(ui.type,d.query_id,y.liveQueryDescriptor),y=this.entities.store(y),x.abrupt("return",new ui(y));case 11:case"end":return x.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"instantQuery",value:function(){var n=Ee.default(W.default.mark(function a(s){var u=this,o;return W.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.ensureReady();case 2:return o=function(_,b){return u.liveQuery(_,b)},d.abrupt("return",new ol({indexName:s,network:this.services.network,insightsUri:this.services.config.insightsUri,liveQueryCreator:o}));case 4:case"end":return d.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()}],[{key:"populateInitRegistrations",value:function(i){i.populateInitRegistrations([U_,x_,L_,j_])}},{key:"version",get:function(){return lp}}]),r}(Tt);$t.default(zr,"connectionStateChanged","connectionStateChanged");$t.default(zr,"connectionError","connectionError");$t.default(zr,"tokenAboutToExpire","tokenAboutToExpire");$t.default(zr,"tokenExpired","tokenExpired");gt([ge.validateTypesAsync(["undefined","string",ge.objectSchema("open document options",{id:["string","undefined"],mode:[ge.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[ge.nonNegativeInteger,"undefined"],data:[ge.pureObject,"undefined",ge.literal(null)]})]),we("design:type",Function),we("design:paramtypes",[Object]),we("design:returntype",Promise)],zr.prototype,"document",null);gt([ge.validateTypesAsync(["undefined","string",ge.objectSchema("open map options",{id:["string","undefined"],mode:[ge.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[ge.nonNegativeInteger,"undefined"],data:[ge.pureObject,"undefined",ge.literal(null)],includeItems:["boolean","undefined"]})]),we("design:type",Function),we("design:paramtypes",[Object]),we("design:returntype",Promise)],zr.prototype,"map",null);gt([ge.validateTypesAsync(["undefined","string",ge.objectSchema("open list options",{id:["string","undefined"],mode:[ge.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[ge.nonNegativeInteger,"undefined"],data:[ge.pureObject,"undefined",ge.literal(null)],purpose:["string","undefined"],context:[ge.pureObject,"undefined"],includeItems:["boolean","undefined"]})]),we("design:type",Function),we("design:paramtypes",[Object]),we("design:returntype",Promise)],zr.prototype,"list",null);gt([ge.validateTypesAsync(["undefined","string",ge.objectSchema("open stream options",{id:["string","undefined"],mode:[ge.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[ge.nonNegativeInteger,"undefined"],data:[ge.pureObject,"undefined",ge.literal(null)]})]),we("design:type",Function),we("design:paramtypes",[Object]),we("design:returntype",Promise)],zr.prototype,"stream",null);gt([ge.validateTypesAsync(ge.nonEmptyString),we("design:type",Function),we("design:paramtypes",[String]),we("design:returntype",Promise)],zr.prototype,"updateToken",null);gt([ge.validateTypesAsync(ge.nonEmptyString,"string"),we("design:type",Function),we("design:paramtypes",[String,String]),we("design:returntype",Promise)],zr.prototype,"liveQuery",null);gt([ge.validateTypesAsync(ge.nonEmptyString),we("design:type",Function),we("design:paramtypes",[String]),we("design:returntype",Promise)],zr.prototype,"instantQuery",null);xr.Client=zr;xr.InsightsItem=KK;xr.InstantQuery=ol;xr.LiveQuery=ui;xr.Paginator=Gg;xr.SyncClient=zr;xr.SyncDocument=sn;xr.SyncList=rr;xr.SyncListItem=jh;xr.SyncMap=ir;xr.SyncMapItem=eu;xr.SyncStream=Dn;var ZT={},ZK=RT,e9=TypeError,eE=function(e){if(ZK(e))throw e9("The method doesn't accept regular expressions");return e},t9=It,r9=t9("match"),tE=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[r9]=!1,"/./"[e](t)}catch{}}return!1},n9=lt,rE=Ze,i9=Gn.f,a9=mi,D_=dr,s9=eE,o9=Vn,u9=tE,F_=rE("".startsWith),l9=rE("".slice),c9=Math.min,nE=u9("startsWith"),f9=!nE&&!!function(){var e=i9(String.prototype,"startsWith");return e&&!e.writable}();n9({target:"String",proto:!0,forced:!f9&&!nE},{startsWith:function(t){var r=D_(o9(this));s9(t);var n=a9(c9(arguments.length>1?arguments[1]:void 0,r.length)),i=D_(t);return F_?F_(r,i,n):l9(r,n,n+i.length)===i}});var d9=lt,p9=Ug.left,h9=Qu,B_=Za,v9=Vu,g9=h9("reduce"),y9=!v9&&B_>79&&B_<83;d9({target:"Array",proto:!0,forced:!g9||y9},{reduce:function(t){var r=arguments.length;return p9(this,t,r,r>1?arguments[1]:void 0)}});var m9=nt,b9=It,w9=NM,_9=b9("iterator"),iE=!m9(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach(function(n,i){t.delete("b"),r+=i+n}),w9&&!e.toJSON||!t.sort||e.href!=="http://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[_9]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||r!=="a1c3"||new URL("http://x",void 0).host!=="x"}),q_=$v.exports,S9=Xt,$9=function(e,t,r){return r.get&&q_(r.get,t,{getter:!0}),r.set&&q_(r.set,t,{setter:!0}),S9.f(e,t,r)},us=Ze,cp=2147483647,du=36,aE=1,qh=26,k9=38,T9=700,E9=72,C9=128,I9="-",R9=/[^\0-\u007E]/,sE=/[.\u3002\uFF0E\uFF61]/g,H_="Overflow: input needs wider integers to process",fp=du-aE,W_=RangeError,O9=us(sE.exec),Us=Math.floor,dp=String.fromCharCode,G_=us("".charCodeAt),oE=us([].join),Bi=us([].push),A9=us("".replace),P9=us("".split),M9=us("".toLowerCase),N9=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=G_(e,r++);if(i>=55296&&i<=56319&&r<n){var a=G_(e,r++);(a&64512)==56320?Bi(t,((i&1023)<<10)+(a&1023)+65536):(Bi(t,i),r--)}else Bi(t,i)}return t},z_=function(e){return e+22+75*(e<26)},x9=function(e,t,r){var n=0;for(e=r?Us(e/T9):e>>1,e+=Us(e/t);e>fp*qh>>1;)e=Us(e/fp),n+=du;return Us(n+(fp+1)*e/(e+k9))},L9=function(e){var t=[];e=N9(e);var r=e.length,n=C9,i=0,a=E9,s,u;for(s=0;s<e.length;s++)u=e[s],u<128&&Bi(t,dp(u));var o=t.length,c=o;for(o&&Bi(t,I9);c<r;){var d=cp;for(s=0;s<e.length;s++)u=e[s],u>=n&&u<d&&(d=u);var y=c+1;if(d-n>Us((cp-i)/y))throw W_(H_);for(i+=(d-n)*y,n=d,s=0;s<e.length;s++){if(u=e[s],u<n&&++i>cp)throw W_(H_);if(u==n){for(var _=i,b=du;;){var T=b<=a?aE:b>=a+qh?qh:b-a;if(_<T)break;var x=_-T,N=du-T;Bi(t,dp(z_(T+x%N))),_=Us(x/N),b+=du}Bi(t,dp(z_(_))),a=x9(i,y,c==o),i=0,c++}}i++,n++}return oE(t,"")},j9=function(e){var t=[],r=P9(A9(M9(e),sE,"."),"."),n,i;for(n=0;n<r.length;n++)i=r[n],Bi(t,O9(R9,i)?"xn--"+L9(i):i);return oE(t,".")},Hh=lt,io=ct,Wl=Pt,Hn=Ze,U9=qt,uE=iE,lE=br,D9=wg,F9=ia,B9=Ek,Kg=dn,cE=as,pp=Mt,q9=Vt,H9=wi,W9=bi,G9=Zt,fE=zt,Fr=dr,z9=na,V_=Qa,Wh=bf,V9=Yu,Cs=Bv,K9=It,J9=Fg,Y9=K9("iterator"),ul="URLSearchParams",dE=ul+"Iterator",pE=Kg.set,bn=Kg.getterFor(ul),Q9=Kg.getterFor(dE),X9=Object.getOwnPropertyDescriptor,Jg=function(e){if(!U9)return io[e];var t=X9(io,e);return t&&t.value},K_=Jg("fetch"),Lc=Jg("Request"),pu=Jg("Headers"),hp=Lc&&Lc.prototype,J_=pu&&pu.prototype,Z9=io.RegExp,eJ=io.TypeError,hE=io.decodeURIComponent,tJ=io.encodeURIComponent,rJ=Hn("".charAt),Y_=Hn([].join),Ua=Hn([].push),Gh=Hn("".replace),nJ=Hn([].shift),Q_=Hn([].splice),X_=Hn("".split),iJ=Hn("".slice),aJ=/\+/g,Z_=Array(4),sJ=function(e){return Z_[e-1]||(Z_[e-1]=Z9("((?:%[\\da-f]{2}){"+e+"})","gi"))},oJ=function(e){try{return hE(e)}catch{return e}},eS=function(e){var t=Gh(e,aJ," "),r=4;try{return hE(t)}catch{for(;r;)t=Gh(t,sJ(r--),oJ);return t}},uJ=/[!'()~]|%20/g,lJ={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},cJ=function(e){return lJ[e]},tS=function(e){return Gh(tJ(e),uJ,cJ)},vp=B9(function(t,r){pE(this,{type:dE,iterator:Wh(bn(t).entries),kind:r})},"Iterator",function(){var t=Q9(this),r=t.kind,n=t.iterator.next(),i=n.value;return n.done||(n.value=r==="keys"?i.key:r==="values"?i.value:[i.key,i.value]),n},!0),vE=function(e){this.entries=[],this.url=null,e!==void 0&&(fE(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?rJ(e,0)==="?"?iJ(e,1):e:Fr(e)))};vE.prototype={type:ul,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t=V9(e),r,n,i,a,s,u,o;if(t)for(r=Wh(e,t),n=r.next;!(i=Wl(n,r)).done;){if(a=Wh(G9(i.value)),s=a.next,(u=Wl(s,a)).done||(o=Wl(s,a)).done||!Wl(s,a).done)throw eJ("Expected sequence with length 2");Ua(this.entries,{key:Fr(u.value),value:Fr(o.value)})}else for(var c in e)q9(e,c)&&Ua(this.entries,{key:c,value:Fr(e[c])})},parseQuery:function(e){if(e)for(var t=X_(e,"&"),r=0,n,i;r<t.length;)n=t[r++],n.length&&(i=X_(n,"="),Ua(this.entries,{key:eS(nJ(i)),value:eS(Y_(i,"="))}))},serialize:function(){for(var e=this.entries,t=[],r=0,n;r<e.length;)n=e[r++],Ua(t,tS(n.key)+"="+tS(n.value));return Y_(t,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Uf=function(){cE(this,Ou);var t=arguments.length>0?arguments[0]:void 0;pE(this,new vE(t))},Ou=Uf.prototype;D9(Ou,{append:function(t,r){Cs(arguments.length,2);var n=bn(this);Ua(n.entries,{key:Fr(t),value:Fr(r)}),n.updateURL()},delete:function(e){Cs(arguments.length,1);for(var t=bn(this),r=t.entries,n=Fr(e),i=0;i<r.length;)r[i].key===n?Q_(r,i,1):i++;t.updateURL()},get:function(t){Cs(arguments.length,1);for(var r=bn(this).entries,n=Fr(t),i=0;i<r.length;i++)if(r[i].key===n)return r[i].value;return null},getAll:function(t){Cs(arguments.length,1);for(var r=bn(this).entries,n=Fr(t),i=[],a=0;a<r.length;a++)r[a].key===n&&Ua(i,r[a].value);return i},has:function(t){Cs(arguments.length,1);for(var r=bn(this).entries,n=Fr(t),i=0;i<r.length;)if(r[i++].key===n)return!0;return!1},set:function(t,r){Cs(arguments.length,1);for(var n=bn(this),i=n.entries,a=!1,s=Fr(t),u=Fr(r),o=0,c;o<i.length;o++)c=i[o],c.key===s&&(a?Q_(i,o--,1):(a=!0,c.value=u));a||Ua(i,{key:s,value:u}),n.updateURL()},sort:function(){var t=bn(this);J9(t.entries,function(r,n){return r.key>n.key?1:-1}),t.updateURL()},forEach:function(t){for(var r=bn(this).entries,n=H9(t,arguments.length>1?arguments[1]:void 0),i=0,a;i<r.length;)a=r[i++],n(a.value,a.key,this)},keys:function(){return new vp(this,"keys")},values:function(){return new vp(this,"values")},entries:function(){return new vp(this,"entries")}},{enumerable:!0});lE(Ou,Y9,Ou.entries,{name:"entries"});lE(Ou,"toString",function(){return bn(this).serialize()},{enumerable:!0});F9(Uf,ul);Hh({global:!0,constructor:!0,forced:!uE},{URLSearchParams:Uf});if(!uE&&pp(pu)){var fJ=Hn(J_.has),dJ=Hn(J_.set),rS=function(e){if(fE(e)){var t=e.body,r;if(W9(t)===ul)return r=e.headers?new pu(e.headers):new pu,fJ(r,"content-type")||dJ(r,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),z9(e,{body:V_(0,Fr(t)),headers:V_(0,r)})}return e};if(pp(K_)&&Hh({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return K_(t,arguments.length>1?rS(arguments[1]):{})}}),pp(Lc)){var gp=function(t){return cE(this,hp),new Lc(t,arguments.length>1?rS(arguments[1]):{})};hp.constructor=gp,gp.prototype=hp,Hh({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:gp})}}var pJ={URLSearchParams:Uf,getState:bn},hJ=lt,Yg=qt,vJ=iE,Qg=ct,nS=wi,pn=Ze,jc=br,en=$9,gJ=as,zh=Vt,Xg=xT,Is=$k,mn=qu,yJ=Xv.codeAt,mJ=j9,ti=dr,bJ=ia,wJ=Bv,gE=pJ,yE=dn,_J=yE.set,Uc=yE.getterFor("URL"),SJ=gE.URLSearchParams,$J=gE.getState,Jo=Qg.URL,Vh=Qg.TypeError,Dc=Qg.parseInt,kJ=Math.floor,iS=Math.pow,an=pn("".charAt),$n=pn(/./.exec),tu=pn([].join),TJ=pn(1 .toString),EJ=pn([].pop),Ns=pn([].push),aS=pn("".replace),CJ=pn([].shift),IJ=pn("".split),hu=pn("".slice),Fc=pn("".toLowerCase),RJ=pn([].unshift),OJ="Invalid authority",yp="Invalid scheme",Ca="Invalid host",sS="Invalid port",mE=/[a-z]/i,AJ=/[\d+-.a-z]/i,Kh=/\d/,PJ=/^0x/i,MJ=/^[0-7]+$/,NJ=/^\d+$/,bE=/^[\da-f]+$/i,xJ=/[\0\t\n\r #%/:<>?@[\\\]^|]/,LJ=/[\0\t\n\r #/:<>?@[\\\]^|]/,jJ=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,UJ=/[\t\n\r]/g,tn,DJ=function(e){var t=IJ(e,"."),r,n,i,a,s,u,o;if(t.length&&t[t.length-1]==""&&t.length--,r=t.length,r>4)return e;for(n=[],i=0;i<r;i++){if(a=t[i],a=="")return e;if(s=10,a.length>1&&an(a,0)=="0"&&(s=$n(PJ,a)?16:8,a=hu(a,s==8?1:2)),a==="")u=0;else{if(!$n(s==10?NJ:s==8?MJ:bE,a))return e;u=Dc(a,s)}Ns(n,u)}for(i=0;i<r;i++)if(u=n[i],i==r-1){if(u>=iS(256,5-r))return null}else if(u>255)return null;for(o=EJ(n),i=0;i<n.length;i++)o+=n[i]*iS(256,3-i);return o},FJ=function(e){var t=[0,0,0,0,0,0,0,0],r=0,n=null,i=0,a,s,u,o,c,d,y,_=function(){return an(e,i)};if(_()==":"){if(an(e,1)!=":")return;i+=2,r++,n=r}for(;_();){if(r==8)return;if(_()==":"){if(n!==null)return;i++,r++,n=r;continue}for(a=s=0;s<4&&$n(bE,_());)a=a*16+Dc(_(),16),i++,s++;if(_()=="."){if(s==0||(i-=s,r>6))return;for(u=0;_();){if(o=null,u>0)if(_()=="."&&u<4)i++;else return;if(!$n(Kh,_()))return;for(;$n(Kh,_());){if(c=Dc(_(),10),o===null)o=c;else{if(o==0)return;o=o*10+c}if(o>255)return;i++}t[r]=t[r]*256+o,u++,(u==2||u==4)&&r++}if(u!=4)return;break}else if(_()==":"){if(i++,!_())return}else if(_())return;t[r++]=a}if(n!==null)for(d=r-n,r=7;r!=0&&d>0;)y=t[r],t[r--]=t[n+d-1],t[n+--d]=y;else if(r!=8)return;return t},BJ=function(e){for(var t=null,r=1,n=null,i=0,a=0;a<8;a++)e[a]!==0?(i>r&&(t=n,r=i),n=null,i=0):(n===null&&(n=a),++i);return i>r&&(t=n,r=i),t},Yo=function(e){var t,r,n,i;if(typeof e=="number"){for(t=[],r=0;r<4;r++)RJ(t,e%256),e=kJ(e/256);return tu(t,".")}else if(typeof e=="object"){for(t="",n=BJ(e),r=0;r<8;r++)i&&e[r]===0||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=TJ(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},sc={},wE=Xg({},sc,{" ":1,'"':1,"<":1,">":1,"`":1}),_E=Xg({},wE,{"#":1,"?":1,"{":1,"}":1}),mp=Xg({},_E,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Ni=function(e,t){var r=yJ(e,0);return r>32&&r<127&&!zh(t,e)?e:encodeURIComponent(e)},Gl={ftp:21,file:null,http:80,https:443,ws:80,wss:443},ru=function(e,t){var r;return e.length==2&&$n(mE,an(e,0))&&((r=an(e,1))==":"||!t&&r=="|")},oS=function(e){var t;return e.length>1&&ru(hu(e,0,2))&&(e.length==2||(t=an(e,2))==="/"||t==="\\"||t==="?"||t==="#")},qJ=function(e){return e==="."||Fc(e)==="%2e"},HJ=function(e){return e=Fc(e),e===".."||e==="%2e."||e===".%2e"||e==="%2e%2e"},bp={},uS={},wp={},lS={},cS={},_p={},fS={},dS={},zl={},Vl={},Sp={},$p={},kp={},Tp={},pS={},Ep={},Rs={},Nn={},hS={},Ia={},ei={},Zg=function(e,t,r){var n=ti(e),i,a,s;if(t){if(a=this.parse(n),a)throw Vh(a);this.searchParams=null}else{if(r!==void 0&&(i=new Zg(r,!0)),a=this.parse(n,null,i),a)throw Vh(a);s=$J(new SJ),s.bindURL(this),this.searchParams=s}};Zg.prototype={type:"URL",parse:function(e,t,r){var n=this,i=t||bp,a=0,s="",u=!1,o=!1,c=!1,d,y,_,b;for(e=ti(e),t||(n.scheme="",n.username="",n.password="",n.host=null,n.port=null,n.path=[],n.query=null,n.fragment=null,n.cannotBeABaseURL=!1,e=aS(e,jJ,"")),e=aS(e,UJ,""),d=Is(e);a<=d.length;){switch(y=d[a],i){case bp:if(y&&$n(mE,y))s+=Fc(y),i=uS;else{if(t)return yp;i=wp;continue}break;case uS:if(y&&($n(AJ,y)||y=="+"||y=="-"||y=="."))s+=Fc(y);else if(y==":"){if(t&&(n.isSpecial()!=zh(Gl,s)||s=="file"&&(n.includesCredentials()||n.port!==null)||n.scheme=="file"&&!n.host))return;if(n.scheme=s,t){n.isSpecial()&&Gl[n.scheme]==n.port&&(n.port=null);return}s="",n.scheme=="file"?i=Tp:n.isSpecial()&&r&&r.scheme==n.scheme?i=lS:n.isSpecial()?i=dS:d[a+1]=="/"?(i=cS,a++):(n.cannotBeABaseURL=!0,Ns(n.path,""),i=hS)}else{if(t)return yp;s="",i=wp,a=0;continue}break;case wp:if(!r||r.cannotBeABaseURL&&y!="#")return yp;if(r.cannotBeABaseURL&&y=="#"){n.scheme=r.scheme,n.path=mn(r.path),n.query=r.query,n.fragment="",n.cannotBeABaseURL=!0,i=ei;break}i=r.scheme=="file"?Tp:_p;continue;case lS:if(y=="/"&&d[a+1]=="/")i=zl,a++;else{i=_p;continue}break;case cS:if(y=="/"){i=Vl;break}else{i=Nn;continue}case _p:if(n.scheme=r.scheme,y==tn)n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=mn(r.path),n.query=r.query;else if(y=="/"||y=="\\"&&n.isSpecial())i=fS;else if(y=="?")n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=mn(r.path),n.query="",i=Ia;else if(y=="#")n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=mn(r.path),n.query=r.query,n.fragment="",i=ei;else{n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=mn(r.path),n.path.length--,i=Nn;continue}break;case fS:if(n.isSpecial()&&(y=="/"||y=="\\"))i=zl;else if(y=="/")i=Vl;else{n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,i=Nn;continue}break;case dS:if(i=zl,y!="/"||an(s,a+1)!="/")continue;a++;break;case zl:if(y!="/"&&y!="\\"){i=Vl;continue}break;case Vl:if(y=="@"){u&&(s="%40"+s),u=!0,_=Is(s);for(var T=0;T<_.length;T++){var x=_[T];if(x==":"&&!c){c=!0;continue}var N=Ni(x,mp);c?n.password+=N:n.username+=N}s=""}else if(y==tn||y=="/"||y=="?"||y=="#"||y=="\\"&&n.isSpecial()){if(u&&s=="")return OJ;a-=Is(s).length+1,s="",i=Sp}else s+=y;break;case Sp:case $p:if(t&&n.scheme=="file"){i=Ep;continue}else if(y==":"&&!o){if(s=="")return Ca;if(b=n.parseHost(s),b)return b;if(s="",i=kp,t==$p)return}else if(y==tn||y=="/"||y=="?"||y=="#"||y=="\\"&&n.isSpecial()){if(n.isSpecial()&&s=="")return Ca;if(t&&s==""&&(n.includesCredentials()||n.port!==null))return;if(b=n.parseHost(s),b)return b;if(s="",i=Rs,t)return;continue}else y=="["?o=!0:y=="]"&&(o=!1),s+=y;break;case kp:if($n(Kh,y))s+=y;else if(y==tn||y=="/"||y=="?"||y=="#"||y=="\\"&&n.isSpecial()||t){if(s!=""){var D=Dc(s,10);if(D>65535)return sS;n.port=n.isSpecial()&&D===Gl[n.scheme]?null:D,s=""}if(t)return;i=Rs;continue}else return sS;break;case Tp:if(n.scheme="file",y=="/"||y=="\\")i=pS;else if(r&&r.scheme=="file")if(y==tn)n.host=r.host,n.path=mn(r.path),n.query=r.query;else if(y=="?")n.host=r.host,n.path=mn(r.path),n.query="",i=Ia;else if(y=="#")n.host=r.host,n.path=mn(r.path),n.query=r.query,n.fragment="",i=ei;else{oS(tu(mn(d,a),""))||(n.host=r.host,n.path=mn(r.path),n.shortenPath()),i=Nn;continue}else{i=Nn;continue}break;case pS:if(y=="/"||y=="\\"){i=Ep;break}r&&r.scheme=="file"&&!oS(tu(mn(d,a),""))&&(ru(r.path[0],!0)?Ns(n.path,r.path[0]):n.host=r.host),i=Nn;continue;case Ep:if(y==tn||y=="/"||y=="\\"||y=="?"||y=="#"){if(!t&&ru(s))i=Nn;else if(s==""){if(n.host="",t)return;i=Rs}else{if(b=n.parseHost(s),b)return b;if(n.host=="localhost"&&(n.host=""),t)return;s="",i=Rs}continue}else s+=y;break;case Rs:if(n.isSpecial()){if(i=Nn,y!="/"&&y!="\\")continue}else if(!t&&y=="?")n.query="",i=Ia;else if(!t&&y=="#")n.fragment="",i=ei;else if(y!=tn&&(i=Nn,y!="/"))continue;break;case Nn:if(y==tn||y=="/"||y=="\\"&&n.isSpecial()||!t&&(y=="?"||y=="#")){if(HJ(s)?(n.shortenPath(),y!="/"&&!(y=="\\"&&n.isSpecial())&&Ns(n.path,"")):qJ(s)?y!="/"&&!(y=="\\"&&n.isSpecial())&&Ns(n.path,""):(n.scheme=="file"&&!n.path.length&&ru(s)&&(n.host&&(n.host=""),s=an(s,0)+":"),Ns(n.path,s)),s="",n.scheme=="file"&&(y==tn||y=="?"||y=="#"))for(;n.path.length>1&&n.path[0]==="";)CJ(n.path);y=="?"?(n.query="",i=Ia):y=="#"&&(n.fragment="",i=ei)}else s+=Ni(y,_E);break;case hS:y=="?"?(n.query="",i=Ia):y=="#"?(n.fragment="",i=ei):y!=tn&&(n.path[0]+=Ni(y,sc));break;case Ia:!t&&y=="#"?(n.fragment="",i=ei):y!=tn&&(y=="'"&&n.isSpecial()?n.query+="%27":y=="#"?n.query+="%23":n.query+=Ni(y,sc));break;case ei:y!=tn&&(n.fragment+=Ni(y,wE));break}a++}},parseHost:function(e){var t,r,n;if(an(e,0)=="["){if(an(e,e.length-1)!="]"||(t=FJ(hu(e,1,-1)),!t))return Ca;this.host=t}else if(this.isSpecial()){if(e=mJ(e),$n(xJ,e)||(t=DJ(e),t===null))return Ca;this.host=t}else{if($n(LJ,e))return Ca;for(t="",r=Is(e),n=0;n<r.length;n++)t+=Ni(r[n],sc);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return zh(Gl,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;t&&(this.scheme!="file"||t!=1||!ru(e[0],!0))&&e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,i=e.host,a=e.port,s=e.path,u=e.query,o=e.fragment,c=t+":";return i!==null?(c+="//",e.includesCredentials()&&(c+=r+(n?":"+n:"")+"@"),c+=Yo(i),a!==null&&(c+=":"+a)):t=="file"&&(c+="//"),c+=e.cannotBeABaseURL?s[0]:s.length?"/"+tu(s,"/"):"",u!==null&&(c+="?"+u),o!==null&&(c+="#"+o),c},setHref:function(e){var t=this.parse(e);if(t)throw Vh(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if(e=="blob")try{return new ao(e.path[0]).origin}catch{return"null"}return e=="file"||!this.isSpecial()?"null":e+"://"+Yo(this.host)+(t!==null?":"+t:"")},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(ti(e)+":",bp)},getUsername:function(){return this.username},setUsername:function(e){var t=Is(ti(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=Ni(t[r],mp)}},getPassword:function(){return this.password},setPassword:function(e){var t=Is(ti(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=Ni(t[r],mp)}},getHost:function(){var e=this.host,t=this.port;return e===null?"":t===null?Yo(e):Yo(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Sp)},getHostname:function(){var e=this.host;return e===null?"":Yo(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,$p)},getPort:function(){var e=this.port;return e===null?"":ti(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(e=ti(e),e==""?this.port=null:this.parse(e,kp))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+tu(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Rs))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){e=ti(e),e==""?this.query=null:(an(e,0)=="?"&&(e=hu(e,1)),this.query="",this.parse(e,Ia)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){if(e=ti(e),e==""){this.fragment=null;return}an(e,0)=="#"&&(e=hu(e,1)),this.fragment="",this.parse(e,ei)},update:function(){this.query=this.searchParams.serialize()||null}};var ao=function(t){var r=gJ(this,Tr),n=wJ(arguments.length,1)>1?arguments[1]:void 0,i=_J(r,new Zg(t,!1,n));Yg||(r.href=i.serialize(),r.origin=i.getOrigin(),r.protocol=i.getProtocol(),r.username=i.getUsername(),r.password=i.getPassword(),r.host=i.getHost(),r.hostname=i.getHostname(),r.port=i.getPort(),r.pathname=i.getPathname(),r.search=i.getSearch(),r.searchParams=i.getSearchParams(),r.hash=i.getHash())},Tr=ao.prototype,rn=function(e,t){return{get:function(){return Uc(this)[e]()},set:t&&function(r){return Uc(this)[t](r)},configurable:!0,enumerable:!0}};Yg&&(en(Tr,"href",rn("serialize","setHref")),en(Tr,"origin",rn("getOrigin")),en(Tr,"protocol",rn("getProtocol","setProtocol")),en(Tr,"username",rn("getUsername","setUsername")),en(Tr,"password",rn("getPassword","setPassword")),en(Tr,"host",rn("getHost","setHost")),en(Tr,"hostname",rn("getHostname","setHostname")),en(Tr,"port",rn("getPort","setPort")),en(Tr,"pathname",rn("getPathname","setPathname")),en(Tr,"search",rn("getSearch","setSearch")),en(Tr,"searchParams",rn("getSearchParams")),en(Tr,"hash",rn("getHash","setHash")));jc(Tr,"toJSON",function(){return Uc(this).serialize()},{enumerable:!0});jc(Tr,"toString",function(){return Uc(this).serialize()},{enumerable:!0});if(Jo){var vS=Jo.createObjectURL,gS=Jo.revokeObjectURL;vS&&jc(ao,"createObjectURL",nS(vS,Jo)),gS&&jc(ao,"revokeObjectURL",nS(gS,Jo))}bJ(ao,"URL");hJ({global:!0,constructor:!0,forced:!vJ,sham:!Yg},{URL:ao});/*
@license
Copyright (c) 2018, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/(function(e){var t=typeof t<"u"?t:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(e,"__esModule",{value:!0});var r=vo.exports,n=la.exports,i=Xu,a=mo.exports,s=Si,u=ar;function o(le){return le&&typeof le=="object"&&"default"in le?le:{default:le}}function c(le){if(le&&le.__esModule)return le;var G=Object.create(null);return le&&Object.keys(le).forEach(function(J){if(J!=="default"){var k=Object.getOwnPropertyDescriptor(le,J);Object.defineProperty(G,J,k.get?k:{enumerable:!0,get:function(){return le[J]}})}}),G.default=le,Object.freeze(G)}var d=o(r),y=o(n),_=o(i),b=c(a);/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */function T(le,G,J,k){var C=arguments.length,X=C<3?G:k===null?k=Object.getOwnPropertyDescriptor(G,J):k,Z;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")X=Reflect.decorate(le,G,J,k);else for(var $e=le.length-1;$e>=0;$e--)(Z=le[$e])&&(X=(C<3?Z(X):C>3?Z(G,J,X):Z(G,J))||X);return C>3&&X&&Object.defineProperty(G,J,X),X}function x(le,G){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(le,G)}function N(le,G){return["".concat(new Date().toISOString()," MCS Client ").concat(le,":")].concat(Array.from(G))}class D{constructor(G){y.default(this,"prefix",""),this.prefix=G!=null&&G.length>0?G+" ":""}static scope(G){return new D(G)}setLevel(G){b.setLevel(G)}static setLevel(G){b.setLevel(G)}trace(){for(var G=arguments.length,J=new Array(G),k=0;k<G;k++)J[k]=arguments[k];b.trace.apply(null,N(this.prefix+"T",J))}debug(){for(var G=arguments.length,J=new Array(G),k=0;k<G;k++)J[k]=arguments[k];b.debug.apply(null,N(this.prefix+"D",J))}info(){for(var G=arguments.length,J=new Array(G),k=0;k<G;k++)J[k]=arguments[k];b.info.apply(null,N(this.prefix+"I",J))}warn(){for(var G=arguments.length,J=new Array(G),k=0;k<G;k++)J[k]=arguments[k];b.warn.apply(null,N(this.prefix+"W",J))}error(){for(var G=arguments.length,J=new Array(G),k=0;k<G;k++)J[k]=arguments[k];b.error.apply(null,N(this.prefix+"E",J))}static trace(){for(var G=arguments.length,J=new Array(G),k=0;k<G;k++)J[k]=arguments[k];b.trace.apply(null,N("T",J))}static debug(){for(var G=arguments.length,J=new Array(G),k=0;k<G;k++)J[k]=arguments[k];b.debug.apply(null,N("D",J))}static info(){for(var G=arguments.length,J=new Array(G),k=0;k<G;k++)J[k]=arguments[k];b.info.apply(null,N("I",J))}static warn(){for(var G=arguments.length,J=new Array(G),k=0;k<G;k++)J[k]=arguments[k];b.warn.apply(null,N("W",J))}static error(){for(var G=arguments.length,J=new Array(G),k=0;k<G;k++)J[k]=arguments[k];b.error.apply(null,N("E",J))}}var H=1e3,ve=4e3,ae=3,Ae=!0,Re=le=>"https://mcs.".concat(le!=null?le:"us1",".twilio.com"),Ie=le=>le.startsWith("http"),L=(le,G)=>"".concat(Ie(le)?"":Re(G)).concat(le);class oe{constructor(G,J,k,C){var X,Z,$e,De,ue,Te,E=(X=(Z=C.MCS)!==null&&Z!==void 0?Z:C)!==null&&X!==void 0?X:{};this.region=($e=(De=E.region)!==null&&De!==void 0?De:C.region)!==null&&$e!==void 0?$e:"us1",this.mediaUrl=L(J,this.region),this.mediaSetUrl=k?L(k):"".concat(this.mediaUrl,"Set"),this.token=G,this.retryWhenThrottledOverride=(ue=E.retryWhenThrottledOverride)!==null&&ue!==void 0?ue:Ae,this.backoffConfigOverride=(Te=E.backoffConfigOverride)!==null&&Te!==void 0?Te:oe.backoffConfigDefault}static get backoffConfigDefault(){return{min:H,max:ve,maxAttemptsCount:ae}}static get retryWhenThrottledDefault(){return Ae}updateToken(G){this.token=G}}class B{constructor(G,J,k){this.config=G,this.network=J,this._update(k)}get sid(){return this.state.sid}get serviceSid(){return this.state.serviceSid}get dateCreated(){return this.state.dateCreated}get dateUpdated(){return this.state.dateUpdated}get contentType(){return this.state.contentType}get size(){return this.state.size}get fileName(){return this.state.filename}get filename(){return this.state.filename}get category(){return this.state.category}getContentUrl(){var G=this;return d.default(_.default.mark(function J(){var k;return _.default.wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,G.network.get("".concat(G.config.mediaUrl,"/").concat(G.sid));case 2:return k=X.sent,G._update(k.body),X.abrupt("return",Promise.resolve(G.state.contentDirectUrl));case 5:case"end":return X.stop()}},J)}))()}getCachedContentUrl(){var G=this;return d.default(_.default.mark(function J(){return _.default.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(!G.state.contentDirectUrl){C.next=2;break}return C.abrupt("return",Promise.resolve(G.state.contentDirectUrl));case 2:return C.next=4,G.getContentUrl();case 4:return C.abrupt("return",C.sent);case 5:case"end":return C.stop()}},J)}))()}_update(G){var J,k,C,X;this.state={sid:G.sid,serviceSid:G.service_sid,channelSid:G.channel_sid,messageSid:G.message_sid,dateCreated:G.date_created?new Date(G.date_created):null,dateUploadUpdated:G.date_upload_updated?new Date(G.date_upload_updated):null,dateUpdated:G.date_updated?new Date(G.date_updated):null,size:G.size,contentType:G.content_type,author:G.author,url:G.url,contentUrl:G.links.content,contentDirectUrl:(J=G.links.content_direct_temporary)!==null&&J!==void 0?J:null,filename:(k=G.filename)!==null&&k!==void 0?k:null,category:(C=G.category)!==null&&C!==void 0?C:"media",isMultipartUpstream:(X=G.is_multipart_upstream)!==null&&X!==void 0?X:!1}}}class ke extends Error{constructor(G,J,k,C,X){super(G),this.code=J,this.body=k,this.status=C,this.headers=X}}var Se=t.XMLHttpRequest||{};function se(le){return le?le.split(`\r
`).map(G=>G.split(": ")).filter(G=>G.length===2&&G[1].length>0).reduce((G,J)=>(G[J[0]]=J[1],G),{}):{}}function ee(le){var G=le.getResponseHeader("Content-Type");if(!G||G.indexOf("application/json")!==0||le.responseText.length===0)return le.responseText;try{return JSON.parse(le.responseText)}catch{return le.responseText}}class ne{static request(G,J,k,C){return d.default(_.default.mark(function X(){return _.default.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return $e.abrupt("return",new Promise((De,ue)=>{var Te=new Se;Te.open(G,J,!0),Te.onreadystatechange=function(){if(Te.readyState===4){var q=se(Te.getAllResponseHeaders()),P=ee(Te);if(200<=Te.status&&Te.status<300)De({status:Te.status,headers:q,body:P});else{var U,_e=(U=Te.statusText)!==null&&U!==void 0?U:"NONE",de;typeof P=="string"?de=P&&P.split(`
`,2).length===1?P:"":de=JSON.stringify(P);var ye="".concat(Te.status,": [").concat(_e,"] ").concat(de);ue(new ke(ye,Te.status,P,_e,q))}}};for(var E in k)Te.setRequestHeader(E,k[E]),E==="Content-Type"&&k[E]==="application/json"&&(C=JSON.stringify(C));Te.send(C)}));case 1:case"end":return $e.stop()}},X)}))()}get(G,J){return d.default(_.default.mark(function k(){return _.default.wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.abrupt("return",ne.request("GET",G,J));case 1:case"end":return X.stop()}},k)}))()}post(G,J,k){return d.default(_.default.mark(function C(){return _.default.wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",ne.request("POST",G,J,k));case 1:case"end":return Z.stop()}},C)}))()}}var te=D.scope("Network");class me{constructor(G,J){this.config=G,this.transport=J}backoffConfig(){return Object.assign(oe.backoffConfigDefault,this.config.backoffConfigOverride)}retryWhenThrottled(){var G,J;return(G=(J=this.config.retryWhenThrottledOverride)!==null&&J!==void 0?J:oe.retryWhenThrottledDefault)!==null&&G!==void 0?G:!1}executeWithRetry(G,J){var k=this;return d.default(_.default.mark(function C(){return _.default.wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",new Promise(($e,De)=>{var ue=[502,503,504];J&&ue.push(429);var Te=new s.Retrier(k.backoffConfig());Te.on("attempt",d.default(_.default.mark(function E(){var $;return _.default.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.prev=0,P.next=3,G();case 3:$=P.sent,Te.succeeded($),P.next=10;break;case 7:P.prev=7,P.t0=P.catch(0),ue.indexOf(P.t0.status)>-1||P.t0.message==="Twilsock disconnected"?Te.failed(P.t0):(Te.removeAllListeners(),Te.cancel(),De(P.t0));case 10:case"end":return P.stop()}},E,null,[[0,7]])}))),Te.on("succeeded",E=>{$e(E)}),Te.on("cancelled",E=>De(E)),Te.on("failed",E=>De(E)),Te.start()}));case 1:case"end":return Z.stop()}},C)}))()}get(G){var J=this;return d.default(_.default.mark(function k(){var C,X;return _.default.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return C={"X-Twilio-Token":J.config.token},te.trace("sending GET request to ",G," headers ",C),$e.prev=2,$e.next=5,J.executeWithRetry(()=>J.transport.get(G,C),J.retryWhenThrottled());case 5:return X=$e.sent,te.trace("response",X),$e.abrupt("return",X);case 10:throw $e.prev=10,$e.t0=$e.catch(2),te.debug("get() error ".concat($e.t0)),$e.t0;case 14:case"end":return $e.stop()}},k,null,[[2,10]])}))()}post(G,J,k,C,X){var Z=this;return d.default(_.default.mark(function $e(){var De,ue,Te;return _.default.wrap(function($){for(;;)switch($.prev=$.next){case 0:return De={"X-Twilio-Token":Z.config.token},(typeof FormData>"u"||!(k instanceof FormData))&&C&&Object.assign(De,{"Content-Type":C}),ue=new URL(G),J&&ue.searchParams.append("Category",J),X&&ue.searchParams.append("Filename",X),te.trace("sending POST request to ".concat(G," with headers ").concat(De)),$.prev=6,$.next=9,Z.transport.post(ue.href,De,k);case 9:Te=$.sent,$.next=18;break;case 12:if($.prev=12,$.t0=$.catch(6),!(t.XMLHttpRequest===void 0&&k instanceof FormData)){$.next=16;break}throw new TypeError("Posting FormData supported only with browser engine's FormData");case 16:throw te.debug("post() error ".concat($.t0)),$.t0;case 18:return te.trace("response",Te),$.abrupt("return",Te);case 20:case"end":return $.stop()}},$e,null,[[6,12]])}))()}}var A="0.5.3",Ne,ft,ze=D.scope("");e.default=(ft=Ne=class{constructor(G,J,k){var C,X,Z=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.options=Z,this.options.logLevel=(C=this.options.logLevel)!==null&&C!==void 0?C:"silent",this.config=new oe(G,J,k,this.options),ze.setLevel(this.options.logLevel),this.options.transport=(X=this.options.transport)!==null&&X!==void 0?X:new ne,this.transport=this.options.transport,this.network=new me(this.config,this.transport)}updateToken(G){ze.info("updateToken"),this.config.updateToken(G)}get(G){var J=this;return d.default(_.default.mark(function k(){var C;return _.default.wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,J.network.get("".concat(J.config.mediaUrl,"/").concat(G));case 2:return C=Z.sent,Z.abrupt("return",new B(J.config,J.network,C.body));case 4:case"end":return Z.stop()}},k)}))()}post(G,J,k,C){var X=this;return d.default(_.default.mark(function Z(){var $e;return _.default.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.next=2,X.network.post(X.config.mediaUrl,k!=null?k:"media",J,G,C);case 2:return $e=ue.sent,ue.abrupt("return",new B(X.config,X.network,$e.body));case 4:case"end":return ue.stop()}},Z)}))()}postFormData(G,J){var k=this;return d.default(_.default.mark(function C(){var X;return _.default.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return $e.next=2,k.network.post(k.config.mediaUrl,J!=null?J:"media",G);case 2:return X=$e.sent,$e.abrupt("return",new B(k.config,k.network,X.body));case 4:case"end":return $e.stop()}},C)}))()}mediaSetGet(G){var J=this;return d.default(_.default.mark(function k(){var C,X;return _.default.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return C={command:"get",list:G.map(De=>({media_sid:De}))},$e.next=3,J.network.post("".concat(J.config.mediaSetUrl),null,C,"application/json");case 3:return X=$e.sent,$e.abrupt("return",X.body.map(De=>{if(De.code!==200)throw new Error("Failed to obtain detailed information about Media items (failed SID ".concat(De.media_record.sid,")"));return new B(J.config,J.network,De.media_record)}));case 5:case"end":return $e.stop()}},k)}))()}},y.default(Ne,"version",A),ft),T([u.validateTypes(u.nonEmptyString),x("design:type",Function),x("design:paramtypes",[String]),x("design:returntype",void 0)],e.default.prototype,"updateToken",null),T([u.validateTypesAsync(u.nonEmptyString),x("design:type",Function),x("design:paramtypes",[String]),x("design:returntype",Promise)],e.default.prototype,"get",null),e.default=T([u.validateConstructorTypes(u.nonEmptyString,u.nonEmptyString,[u.nonEmptyString,u.literal(null)],[u.pureObject,"undefined"]),x("design:paramtypes",[String,String,Object,Object])],e.default),e.Client=e.default,e.McsClient=e.default,e.McsMedia=B,e.Media=B,e.default=e.default})(ZT);var WJ=lt,GJ=ct,zJ=F1,VJ=gf,ey="ArrayBuffer",yS=zJ[ey],KJ=GJ[ey];WJ({global:!0,constructor:!0,forced:KJ!==yS},{ArrayBuffer:yS});VJ(ey);var JJ=lt,SE=Ze,YJ=An,QJ=mr,mS=wr,XJ=Mg,bS=dr,ty=nt,ZJ=Fg,eY=Qu,wS=ST,tY=$T,_S=Za,SS=kT,qi=[],$S=SE(qi.sort),rY=SE(qi.push),nY=ty(function(){qi.sort(void 0)}),iY=ty(function(){qi.sort(null)}),aY=eY("sort"),$E=!ty(function(){if(_S)return _S<70;if(!(wS&&wS>3)){if(tY)return!0;if(SS)return SS<603;var e="",t,r,n,i;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)qi.push({k:r+i,v:n})}for(qi.sort(function(a,s){return s.v-a.v}),i=0;i<qi.length;i++)r=qi[i].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),sY=nY||!iY||!aY||!$E,oY=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:bS(t)>bS(r)?1:-1}};JJ({target:"Array",proto:!0,forced:sY},{sort:function(t){t!==void 0&&YJ(t);var r=QJ(this);if($E)return t===void 0?$S(r):$S(r,t);var n=[],i=mS(r),a,s;for(s=0;s<i;s++)s in r&&rY(n,r[s]);for(ZJ(n,oY(t)),a=mS(n),s=0;s<a;)r[s]=n[s++];for(;s<i;)XJ(r,s++);return r}});var uY=lt,lY=Ze,cY=eE,fY=Vn,kS=dr,dY=tE,pY=lY("".indexOf);uY({target:"String",proto:!0,forced:!dY("includes")},{includes:function(t){return!!~pY(kS(fY(this)),kS(cY(t)),arguments.length>1?arguments[1]:void 0)}});var hY=lt,vY=Wr.find,gY=ng,Jh="find",kE=!0;Jh in[]&&Array(1)[Jh](function(){kE=!1});hY({target:"Array",proto:!0,forced:kE},{find:function(t){return vY(this,t,arguments.length>1?arguments[1]:void 0)}});gY(Jh);/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2019, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes q under the following license.

    Copyright 20092014 Kristopher Michael Kowal. All rights reserved.
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.

This software includes platform.js under the following license.

    Copyright 2014 Benjamin Tan <https://d10.github.io/>
    Copyright 2011-2015 John-David Dalton <http://allyoucanleet.com/>

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=vo.exports,r=is.exports,n=aa.exports,i=sa.exports,a=oa.exports,s=Kn.exports,u=la.exports,o=ca.exports,c=Xu,d=ua.exports,y=mo.exports,_=e4,b=ar,T=vg,x=Sh.exports,N=Zu.exports,D=Si,H=Of,ve=NT,ae=xr,Ae=ZT,Re=el.exports,Ie=Af;function L(I){return I&&typeof I=="object"&&"default"in I?I:{default:I}}function oe(I){if(I&&I.__esModule)return I;var M=Object.create(null);return I&&Object.keys(I).forEach(function(m){if(m!=="default"){var v=Object.getOwnPropertyDescriptor(I,m);Object.defineProperty(M,m,v.get?v:{enumerable:!0,get:function(){return I[m]}})}}),M.default=I,Object.freeze(M)}var B=L(t),ke=L(r),Se=L(n),se=L(i),ee=L(a),ne=L(s),te=L(u),me=L(o),A=L(c),Ne=L(d),ft=oe(y),ze=L(x),le=L(N),G=L(Re);function J(I,M,m,v){var l=arguments.length,p=l<3?M:v===null?v=Object.getOwnPropertyDescriptor(M,m):v,f;if((typeof Reflect>"u"?"undefined":Ne.default(Reflect))==="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(I,M,m,v);else for(var g=I.length-1;g>=0;g--)(f=I[g])&&(p=(l<3?f(p):l>3?f(M,m,p):f(M,m))||p);return l>3&&p&&Object.defineProperty(M,m,p),p}function k(I,M){if((typeof Reflect>"u"?"undefined":Ne.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(I,M)}function C(I,M){return["".concat(new Date().toISOString()," Conversations ").concat(I,":")].concat(Array.from(M))}var X=ft.getLogger("twilio-conversations"),Z=function(){function I(M){me.default(this,I),te.default(this,"prefix",""),this.prefix=M!=null&&M.length>0?M+" ":""}return ke.default(I,[{key:"setLevel",value:function(m){X.setLevel(m)}},{key:"trace",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];X.trace.apply(null,C(this.prefix+"T",v))}},{key:"debug",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];X.debug.apply(null,C(this.prefix+"D",v))}},{key:"info",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];X.info.apply(null,C(this.prefix+"I",v))}},{key:"warn",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];X.warn.apply(null,C(this.prefix+"W",v))}},{key:"error",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];X.error.apply(null,C(this.prefix+"E",v))}}],[{key:"scope",value:function(m){return new I(m)}},{key:"setLevel",value:function(m){X.setLevel(m)}},{key:"trace",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];X.trace.apply(null,C("T",v))}},{key:"debug",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];X.debug.apply(null,C("D",v))}},{key:"info",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];X.info.apply(null,C("I",v))}},{key:"warn",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];X.warn.apply(null,C("W",v))}},{key:"error",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];X.error.apply(null,C("E",v))}}]),I}();function $e(I,M){var m=Object.keys(I);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(I);M&&(v=v.filter(function(l){return Object.getOwnPropertyDescriptor(I,l).enumerable})),m.push.apply(m,v)}return m}function De(I){for(var M=1;M<arguments.length;M++){var m=arguments[M]!=null?arguments[M]:{};M%2?$e(Object(m),!0).forEach(function(v){te.default(I,v,m[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(m)):$e(Object(m)).forEach(function(v){Object.defineProperty(I,v,Object.getOwnPropertyDescriptor(m,v))})}return I}var ue=5,Te="PT5S",E="PT5S",$=100,q=1e3,P=4e3,U=3,_e=!0,de=function I(){var M,m,v,l,p,f,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=arguments.length>1?arguments[1]:void 0,w=arguments.length>2?arguments[2]:void 0;me.default(this,I),te.default(this,"typingIndicatorTimeoutDefault",ue*1e3);var S=g.Chat||g.IPMessaging||g||{};this.productId=S.productId,this.links={myConversations:h.links.my_conversations,conversations:h.links.conversations,users:h.links.users,currentUser:h.links.current_user,typing:h.links.typing,mediaService:h.links.media_service,mediaSetService:h.links.media_set_service,messagesReceipts:h.links.messages_receipts},this.limits={mediaAttachmentsCountLimit:h.options.media_attachments_count_limit,mediaAttachmentSizeLimitInMb:h.options.media_attachment_size_limit_in_mb,mediaAttachmentsTotalSizeLimitInMb:h.options.media_attachments_total_size_limit_in_mb,emailHistoriesAllowedMimeTypes:h.options.email_histories_allowed_mime_types,emailBodiesAllowedMimeTypes:h.options.email_bodies_allowed_mime_types},this.typingIndicatorTimeoutOverride=S.typingIndicatorTimeoutOverride,this.backoffConfiguration=De({min:q,max:P,maxAttemptsCount:U},S.backoffConfigOverride),this.retryWhenThrottled=S.retryWhenThrottledOverride!==void 0?S.retryWhenThrottledOverride:_e,this.userInfosToSubscribe=(M=(m=S.userInfosToSubscribeOverride)!==null&&m!==void 0?m:h.options.user_infos_to_subscribe)!==null&&M!==void 0?M:$,this.reachabilityEnabled=h.options.reachability_enabled,this.userIdentity=h.identity,this.userInfo=h.sync_objects.my_user_info,this.myConversations=h.sync_objects.my_conversations;var j=(v=(l=S.httpCacheIntervalOverride)!==null&&l!==void 0?l:h.options.http_cache_interval)!==null&&v!==void 0?v:Te;try{this.httpCacheInterval=_.toSeconds(_.parse(j))}catch{w.error("Failed to parse http cache interval ".concat(j,", using default value ").concat(Te)),this.httpCacheInterval=_.toSeconds(_.parse(Te))}var F=(p=(f=S.consumptionReportIntervalOverride)!==null&&f!==void 0?f:h.options.consumption_report_interval)!==null&&p!==void 0?p:E;try{this.consumptionReportInterval=_.toSeconds(_.parse(F))}catch{w.error("Failed to parse consumption report interval ".concat(F,", using default value ").concat(E)),this.consumptionReportInterval=_.toSeconds(_.parse(E))}};function ye(I){return JSON.parse(JSON.stringify(I))}function Ce(I){return typeof I<"u"&&!isNaN(Number(I))?Number(I):null}function K(I){try{return new Date(I)}catch{return null}}function je(I,M,m){var v={};if(I)try{v=JSON.parse(I)}catch(l){m.warn(M,l)}return v}var Me=function(){function I(M){me.default(this,I),this.base=M.replace(/\/$/,""),this.args=[],this.paths=[]}return ke.default(I,[{key:"arg",value:function(m,v){return typeof v<"u"&&this.args.push(encodeURIComponent(m)+"="+encodeURIComponent(v)),this}},{key:"path",value:function(m){return this.paths.push(encodeURIComponent(m)),this}},{key:"build",value:function(){var m=this.base;return this.paths.length&&(m+="/"+this.paths.join("/")),this.args.length&&(m+="?"+this.args.join("&")),m}}]),I}(),Oe=b.custom(function(I){return[["string","number","boolean","object"].includes(Ne.default(I)),"a JSON type"]}),xe=b.custom(function(I){return[["undefined","string","number","boolean","object"].includes(Ne.default(I)),"an optional JSON type"]});function Ue(I){var M=Le();return function(){var v=ne.default(I),l;if(M){var p=ne.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function Le(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ge=Z.scope("User"),et=function(I){se.default(m,I);var M=Ue(m);function m(v,l,p,f){var g;return me.default(this,m),g=M.call(this),te.default(Se.default(g),"promiseToFetch",null),te.default(Se.default(g),"updated","updated"),te.default(Se.default(g),"userSubscribed","userSubscribed"),te.default(Se.default(g),"userUnsubscribed","userUnsubscribed"),g.services=f,g.subscribed="initializing",g.setMaxListeners(0),g.state={identity:v,entityName:l,friendlyName:null,attributes:{},online:null,notifiable:null},g._initializationPromise=new Promise(function(h){g._resolveInitializationPromise=h}),p!==null&&g._resolveInitialization(p,v,l,!1),g}return ke.default(m,[{key:"identity",get:function(){return this.state.identity},set:function(l){this.state.identity=l}},{key:"entityName",set:function(l){this.state.entityName=l}},{key:"attributes",get:function(){return this.state.attributes}},{key:"friendlyName",get:function(){return this.state.friendlyName}},{key:"isOnline",get:function(){return this.state.online}},{key:"isNotifiable",get:function(){return this.state.notifiable}},{key:"isSubscribed",get:function(){return this.subscribed=="subscribed"}},{key:"_update",value:function(){var v=B.default(A.default.mark(function p(f,g){var h,w;return A.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,this._initializationPromise;case 2:h=[],Ge.debug("User for",this.state.identity,"updated:",f,g),j.t0=f,j.next=j.t0==="friendlyName"?7:j.t0==="attributes"?9:j.t0==="reachability"?12:15;break;case 7:return this.state.friendlyName!==g.value&&(h.push("friendlyName"),this.state.friendlyName=g.value),j.abrupt("break",16);case 9:return w=je(g.value,"Retrieved malformed attributes from the server for user: ".concat(this.state.identity),Ge),ze.default(this.state.attributes,w)||(this.state.attributes=w,h.push("attributes")),j.abrupt("break",16);case 12:return this.state.online!==g.online&&(this.state.online=g.online,h.push("reachabilityOnline")),this.state.notifiable!==g.notifiable&&(this.state.notifiable=g.notifiable,h.push("reachabilityNotifiable")),j.abrupt("break",16);case 15:return j.abrupt("return");case 16:h.length>0&&this.emit("updated",{user:this,updateReasons:h});case 17:case"end":return j.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"_updateReachabilityInfo",value:function(){var v=B.default(A.default.mark(function p(f,g){var h=this;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this._initializationPromise;case 2:if(this.configuration.reachabilityEnabled){S.next=4;break}return S.abrupt("return",Promise.resolve());case 4:return S.abrupt("return",f.get("reachability").then(g).catch(function(j){Ge.warn("Failed to get reachability info for ",h.state.identity,j)}));case 5:case"end":return S.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"_fetch",value:function(){var v=B.default(A.default.mark(function p(){var f=this;return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._initializationPromise;case 2:if(this.state.entityName){h.next=4;break}return h.abrupt("return",this);case 4:return this.promiseToFetch=this.services.syncClient.map({id:this.state.entityName,mode:"open_existing",includeItems:!0}).then(function(w){return f.entity=w,w.on("itemUpdated",function(S){return Ge.debug(f.state.entityName+" ("+f.state.identity+") itemUpdated: "+S.item.key),f._update(S.item.key,S.item.data)}),Promise.all([w.get("friendlyName").then(function(S){return f._update(S.key,S.data)}),w.get("attributes").then(function(S){return f._update(S.key,S.data)}),f._updateReachabilityInfo(w,function(S){return f._update(S.key,S.data)})])}).then(function(){return Ge.debug("Fetched for",f.identity),f.subscribed="subscribed",f.emit("userSubscribed",f),f}).catch(function(w){throw f.promiseToFetch=null,w}),h.abrupt("return",this.promiseToFetch);case 6:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_ensureFetched",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._initializationPromise;case 2:return g.abrupt("return",this.promiseToFetch||this._fetch());case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"updateAttributes",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){h.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return h.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(f)});case 6:return h.abrupt("return",this);case 7:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateFriendlyName",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){h.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return h.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:f});case 6:return h.abrupt("return",this);case 7:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"unsubscribe",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._initializationPromise;case 2:if(!this.promiseToFetch){g.next=9;break}return g.next=5,this.promiseToFetch;case 5:this.entity.close(),this.promiseToFetch=null,this.subscribed="unsubscribed",this.emit("userUnsubscribed",this);case 9:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_resolveInitialization",value:function(l,p,f,g){this.configuration=l,this.identity=p,this.entityName=f,this.links={self:"".concat(this.configuration.links.users,"/").concat(this.identity)},this._resolveInitializationPromise(),g&&this.emit("updated",{user:this,updateReasons:["friendlyName","attributes","reachabilityOnline","reachabilityNotifiable"]})}}]),m}(T.ReplayEventEmitter);J([b.validateTypesAsync(Oe),k("design:type",Function),k("design:paramtypes",[Object]),k("design:returntype",Promise)],et.prototype,"updateAttributes",null),J([b.validateTypesAsync(["string"]),k("design:type",Function),k("design:paramtypes",[String]),k("design:returntype",Promise)],et.prototype,"updateFriendlyName",null);function er(I,M){var m=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!m){if(Array.isArray(I)||(m=_r(I))||M&&I&&typeof I.length=="number"){m&&(I=m);var v=0,l=function(){};return{s:l,n:function(){return v>=I.length?{done:!0}:{done:!1,value:I[v++]}},e:function(w){throw w},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p=!0,f=!1,g;return{s:function(){m=m.call(I)},n:function(){var w=m.next();return p=w.done,w},e:function(w){f=!0,g=w},f:function(){try{!p&&m.return!=null&&m.return()}finally{if(f)throw g}}}}function _r(I,M){if(!!I){if(typeof I=="string")return hn(I,M);var m=Object.prototype.toString.call(I).slice(8,-1);if(m==="Object"&&I.constructor&&(m=I.constructor.name),m==="Map"||m==="Set")return Array.from(I);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return hn(I,M)}}function hn(I,M){(M==null||M>I.length)&&(M=I.length);for(var m=0,v=new Array(M);m<M;m++)v[m]=I[m];return v}var Ir=function(){function I(M,m){me.default(this,I),this.configuration=M,this.services=m,this.cache=new Map,this.cacheLifetime=this.configuration.httpCacheInterval*100,this.cleanupCache()}return ke.default(I,[{key:"isExpired",value:function(m){return!this.cacheLifetime||Date.now()-m>this.cacheLifetime}},{key:"cleanupCache",value:function(){var m=er(this.cache),v;try{for(m.s();!(v=m.n()).done;){var l=le.default(v.value,2),p=l[0],f=l[1];this.isExpired(f.timestamp)&&this.cache.delete(p)}}catch(g){m.e(g)}finally{m.f()}this.cache.size===0&&clearInterval(this.timer)}},{key:"pokeTimer",value:function(){var m=this;this.timer=this.timer||setInterval(function(){return m.cleanupCache()},this.cacheLifetime*2)}},{key:"executeWithRetry",value:function(m){var v=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return new Promise(function(p,f){var g=[502,503,504];l&&g.push(429);var h=new D.Retrier(v.configuration.backoffConfiguration);h.on("attempt",function(){m().then(function(w){return h.succeeded(w)}).catch(function(w){g.indexOf(w.status)>-1||w.message==="Twilsock disconnected"?h.failed(w):(h.removeAllListeners(),h.cancel(),f(w))})}),h.on("succeeded",function(w){p(w)}),h.on("cancelled",function(w){return f(w)}),h.on("failed",function(w){return f(w)}),h.start()})}},{key:"get",value:function(){var M=B.default(A.default.mark(function v(l){var p=this,f,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(f=this.cache.get(l),!(f&&!this.isExpired(f.timestamp))){S.next=3;break}return S.abrupt("return",f.response);case 3:return g={},S.next=6,this.executeWithRetry(function(){return p.services.transport.get(l,g,p.configuration.productId)},this.configuration.retryWhenThrottled);case 6:return h=S.sent,this.cache.set(l,{response:h,timestamp:Date.now()}),this.pokeTimer(),S.abrupt("return",h);case 10:case"end":return S.stop()}},v,this)}));function m(v){return M.apply(this,arguments)}return m}()}]),I}(),bt=function I(){me.default(this,I)};te.default(bt,"TYPING_INDICATOR","twilio.ipmsg.typing_indicator"),te.default(bt,"NEW_MESSAGE","twilio.conversations.new_message"),te.default(bt,"ADDED_TO_CONVERSATION","twilio.conversations.added_to_conversation"),te.default(bt,"REMOVED_FROM_CONVERSATION","twilio.conversations.removed_from_conversation"),te.default(bt,"CONSUMPTION_UPDATE","twilio.channel.consumption_update");function jt(I){var M=ie();return function(){var v=ne.default(I),l;if(M){var p=ne.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function ie(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ce=Z.scope("Participant"),Y=function(I){se.default(m,I);var M=jt(m);function m(v,l,p,f,g){var h,w,S;if(me.default(this,m),S=M.call(this),S.conversation=p,S.links=f,S.services=g,S.state={attributes:je(v.attributes,"Retrieved malformed attributes from the server for participant: "+l,ce),dateCreated:v.dateCreated?K(v.dateCreated):null,dateUpdated:v.dateCreated?K(v.dateUpdated):null,sid:l,typingTimeout:null,isTyping:!1,identity:v.identity,roleSid:(h=v.roleSid)!==null&&h!==void 0?h:"",lastReadMessageIndex:Number.isInteger(v.lastConsumedMessageIndex)?v.lastConsumedMessageIndex:null,lastReadTimestamp:v.lastConsumptionTimestamp?K(v.lastConsumptionTimestamp):null,type:v.type||"chat",userInfo:v.userInfo,bindings:(w=v.bindings)!==null&&w!==void 0?w:{}},!v.identity&&!v.type)throw new Error("Received invalid Participant object from server: Missing identity or type of Participant.");return S}return ke.default(m,[{key:"sid",get:function(){return this.state.sid}},{key:"attributes",get:function(){return this.state.attributes}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"identity",get:function(){return this.state.identity}},{key:"isTyping",get:function(){return this.state.isTyping}},{key:"lastReadMessageIndex",get:function(){return this.state.lastReadMessageIndex}},{key:"lastReadTimestamp",get:function(){return this.state.lastReadTimestamp}},{key:"roleSid",get:function(){return this.state.roleSid}},{key:"type",get:function(){return this.state.type}},{key:"bindings",get:function(){var l;return(l=this.state.bindings)!==null&&l!==void 0?l:{}}},{key:"_startTyping",value:function(l){var p=this;return this.state.typingTimeout&&clearTimeout(this.state.typingTimeout),this.state.isTyping=!0,this.emit("typingStarted",this),this.conversation.emit("typingStarted",this),this.state.typingTimeout=Number(setTimeout(function(){return p._endTyping()},l)),this}},{key:"_endTyping",value:function(){!this.state.typingTimeout||(this.state.isTyping=!1,this.emit("typingEnded",this),this.conversation.emit("typingEnded",this),clearInterval(this.state.typingTimeout),this.state.typingTimeout=null)}},{key:"_update",value:function(l){var p=[],f=je(l.attributes,"Retrieved malformed attributes from the server for participant: "+this.state.sid,ce);l.attributes&&!ze.default(this.state.attributes,f)&&(this.state.attributes=f,p.push("attributes"));var g=K(l.dateUpdated);l.dateUpdated&&(g==null?void 0:g.getTime())!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=g,p.push("dateUpdated"));var h=K(l.dateCreated);if(l.dateCreated&&(h==null?void 0:h.getTime())!==(this.state.dateCreated&&this.state.dateCreated.getTime())&&(this.state.dateCreated=h,p.push("dateCreated")),l.roleSid&&this.state.roleSid!==l.roleSid&&(this.state.roleSid=l.roleSid,p.push("roleSid")),(Number.isInteger(l.lastConsumedMessageIndex)||l.lastConsumedMessageIndex===null)&&this.state.lastReadMessageIndex!==l.lastConsumedMessageIndex&&(this.state.lastReadMessageIndex=l.lastConsumedMessageIndex,p.push("lastReadMessageIndex")),l.lastConsumptionTimestamp){var w=new Date(l.lastConsumptionTimestamp);(!this.state.lastReadTimestamp||this.state.lastReadTimestamp.getTime()!==w.getTime())&&(this.state.lastReadTimestamp=w,p.push("lastReadTimestamp"))}return l.bindings&&!ze.default(this.state.bindings,l.bindings)&&(this.state.bindings=l.bindings,p.push("bindings")),p.length>0&&this.emit("updated",{participant:this,updateReasons:p}),this}},{key:"getUser",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.type=="chat"){g.next=2;break}throw new Error("Getting User is not supported for this Participant type: "+this.type);case 2:return g.abrupt("return",this.services.users.getUser(this.state.identity,this.state.userInfo));case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"remove",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",this.conversation.removeParticipant(this));case 1:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"updateAttributes",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(f)});case 2:return h.abrupt("return",this);case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()}]),m}(T.ReplayEventEmitter);te.default(Y,"typingStarted","typingStarted"),te.default(Y,"typingEnded","typingEnded"),te.default(Y,"updated","updated"),J([b.validateTypesAsync(Oe),k("design:type",Function),k("design:paramtypes",[Object]),k("design:returntype",Promise)],Y.prototype,"updateAttributes",null);function re(I){var M=Q();return function(){var v=ne.default(I),l;if(M){var p=ne.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function Q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var he=Z.scope("Participants"),be=function(I){se.default(m,I);var M=re(m);function m(v,l,p,f,g){var h;return me.default(this,m),h=M.call(this),te.default(Se.default(h),"rosterEntityPromise",null),h.conversation=v,h.participants=l,h.links=p,h.configuration=f,h.services=g,h}return ke.default(m,[{key:"unsubscribe",value:function(){var v=B.default(A.default.mark(function p(){var f;return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!this.rosterEntityPromise){h.next=6;break}return h.next=3,this.rosterEntityPromise;case 3:f=h.sent,f.close(),this.rosterEntityPromise=null;case 6:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"subscribe",value:function(l){var p=this;return this.rosterEntityPromise=this.rosterEntityPromise||this.services.syncClient.map({id:l,mode:"open_existing"}).then(function(f){f.on("itemAdded",function(w){he.debug(p.conversation.sid+" itemAdded: "+w.item.key),p.upsertParticipant(w.item.key,w.item.data).then(function(S){p.emit("participantJoined",S)})}),f.on("itemRemoved",function(w){he.debug(p.conversation.sid+" itemRemoved: "+w.key);var S=w.key;if(!!p.participants.has(S)){var j=p.participants.get(S);p.participants.delete(S),j&&p.emit("participantLeft",j)}}),f.on("itemUpdated",function(w){he.debug(p.conversation.sid+" itemUpdated: "+w.item.key),p.upsertParticipant(w.item.key,w.item.data)});var g=[],h=function w(S){return S.items.forEach(function(j){g.push(p.upsertParticipant(j.key,j.data))}),S.hasNextPage?S.nextPage().then(w):null};return f.getItems().then(h).then(function(){return Promise.all(g)}).then(function(){return f})}).catch(function(f){throw p.rosterEntityPromise=null,p.services.syncClient.connectionState!="disconnected"&&he.error("Failed to get roster object for conversation",p.conversation.sid,f),he.debug("ERROR: Failed to get roster object for conversation",p.conversation.sid,f),f})}},{key:"upsertParticipant",value:function(){var v=B.default(A.default.mark(function p(f,g){var h=this,w,S;return A.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(w=this.participants.get(f),!w){F.next=3;break}return F.abrupt("return",w._update(g));case 3:return S={self:"".concat(this.links.participants,"/").concat(f)},w=new Y(g,f,this.conversation,S,this.services),this.participants.set(f,w),w.on("updated",function(z){return h.emit("participantUpdated",z)}),F.abrupt("return",w);case 8:case"end":return F.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"getParticipants",value:function(){var v=B.default(A.default.mark(function p(){var f=this;return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var w=[];return f.participants.forEach(function(S){return w.push(S)}),w}):[]);case 1:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getParticipantBySid",value:function(){var v=B.default(A.default.mark(function p(f){var g=this;return A.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var S=g.participants.get(f);if(!S)throw new Error("Participant with SID "+f+" was not found");return S}):null);case 1:case"end":return w.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getParticipantByIdentity",value:function(){var v=B.default(A.default.mark(function p(f){var g=this,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return h=null,S.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){if(g.participants.forEach(function(j){j.identity===f&&(h=j)}),!h)throw new Error("Participant with identity "+f+" was not found");return h}):null);case 2:case"end":return S.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"add",value:function(){var v=B.default(A.default.mark(function p(f,g){return A.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:f,attributes:typeof g<"u"?JSON.stringify(g):void 0});case 2:return w.abrupt("return",w.sent);case 3:case"end":return w.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"addNonChatParticipant",value:function(l,p){var f,g,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},w=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.services.commandExecutor.mutateResource("post",this.links.participants,{attributes:typeof h<"u"?JSON.stringify(h):void 0,messaging_binding:{address:p,proxy_address:l,name:w==null||(f=w.email)===null||f===void 0?void 0:f.name,level:w==null||(g=w.email)===null||g===void 0?void 0:g.level}})}},{key:"remove",value:function(l){return this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(l))}}]),m}(T.ReplayEventEmitter),Pe=function(){function I(M,m){me.default(this,I),te.default(this,"mcsMedia",null),this.services=m,M instanceof Ae.McsMedia&&(this.mcsMedia=M),this.state={sid:M.sid,category:M.category,filename:M.filename,contentType:M.contentType,size:M.size}}return ke.default(I,[{key:"sid",get:function(){return this.state.sid}},{key:"filename",get:function(){return this.state.filename}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}},{key:"category",get:function(){return this.state.category}},{key:"getContentTemporaryUrl",value:function(){var M=B.default(A.default.mark(function v(){var l,p;return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._fetchMcsMedia();case 2:return g.abrupt("return",(l=(p=this.mcsMedia)===null||p===void 0?void 0:p.getContentUrl())!==null&&l!==void 0?l:null);case 3:case"end":return g.stop()}},v,this)}));function m(){return M.apply(this,arguments)}return m}()},{key:"getCachedTemporaryUrl",value:function(){var M=B.default(A.default.mark(function v(){var l,p;return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._fetchMcsMedia();case 2:return g.abrupt("return",(l=(p=this.mcsMedia)===null||p===void 0?void 0:p.getCachedContentUrl())!==null&&l!==void 0?l:null);case 3:case"end":return g.stop()}},v,this)}));function m(){return M.apply(this,arguments)}return m}()},{key:"_fetchMcsMedia",value:function(){var M=B.default(A.default.mark(function v(){return A.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this.mcsMedia){p.next=8;break}if(!this.services.mcsClient){p.next=7;break}return p.next=4,this.services.mcsClient.get(this.state.sid);case 4:this.mcsMedia=p.sent,p.next=8;break;case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return p.stop()}},v,this)}));function m(){return M.apply(this,arguments)}return m}()}]),I}(),Xe=function(){function I(M){me.default(this,I),this.state=M}return ke.default(I,[{key:"total",get:function(){return this.state.total}},{key:"sent",get:function(){return this.state.sent}},{key:"delivered",get:function(){return this.state.delivered}},{key:"read",get:function(){return this.state.read}},{key:"undelivered",get:function(){return this.state.undelivered}},{key:"failed",get:function(){return this.state.failed}},{key:"_update",value:function(m){this.state=m}},{key:"_isEquals",value:function(m){var v=this.total===m.total,l=this.sent===m.sent,p=this.delivered===m.delivered,f=this.read===m.read,g=this.undelivered===m.undelivered,h=this.failed===m.failed;return v&&l&&p&&f&&g&&h}}]),I}(),at=function(){function I(M,m,v,l){me.default(this,I),this.state={prevToken:v,nextToken:l,source:m,items:M}}return ke.default(I,[{key:"hasNextPage",get:function(){return!!this.state.nextToken}},{key:"hasPrevPage",get:function(){return!!this.state.prevToken}},{key:"items",get:function(){return this.state.items}},{key:"nextPage",value:function(){return this.hasNextPage?this.state.source(this.state.nextToken):Promise.reject(new Error("No next page"))}},{key:"prevPage",value:function(){return this.hasPrevPage?this.state.source(this.state.prevToken):Promise.reject(new Error("No previous page"))}}]),I}(),tt=function I(M){me.default(this,I),this.sid=M.sid,this.messageSid=M.message_sid,this.conversationSid=M.conversation_sid,this.channelMessageSid=M.channel_message_sid,this.participantSid=M.participant_sid,this.status=M.status||"queued",this.errorCode=M.error_code||0,this.dateCreated=M.date_created,this.dateUpdated=M.date_updated};function Fe(I){var M=Sr();return function(){var v=ne.default(I),l;if(M){var p=ne.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function Sr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Je=Z.scope("Message"),Wt=function(I){se.default(m,I);var M=Fe(m);function m(v,l,p,f,g,h){var w,S,j,F,z;return me.default(this,m),z=M.call(this),z.conversation=p,z.links=f,z.configuration=g,z.services=h,z.state={sid:l.sid,index:v,author:l.author,subject:l.subject,body:(w=l.text)!==null&&w!==void 0?w:null,timestamp:l.timestamp?new Date(l.timestamp):null,dateUpdated:l.dateUpdated?new Date(l.dateUpdated):null,lastUpdatedBy:(S=l.lastUpdatedBy)!==null&&S!==void 0?S:null,attributes:je(l.attributes,"Got malformed attributes for the message ".concat(l.sid),Je),type:(j=l.type)!==null&&j!==void 0?j:"text",media:l.type&&l.type==="media"&&l.media?new Pe(l.media,z.services):null,medias:l.type&&l.type==="media"&&l.medias?l.medias.map(function(pe){return new Pe(pe,z.services)}):null,participantSid:(F=l.memberSid)!==null&&F!==void 0?F:null,aggregatedDeliveryReceipt:l.delivery?new Xe(l.delivery):null},z}return ke.default(m,[{key:"sid",get:function(){return this.state.sid}},{key:"author",get:function(){return this.state.author}},{key:"subject",get:function(){return this.state.subject}},{key:"body",get:function(){return this.state.body}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"index",get:function(){return this.state.index}},{key:"lastUpdatedBy",get:function(){return this.state.lastUpdatedBy}},{key:"dateCreated",get:function(){return this.state.timestamp}},{key:"attributes",get:function(){return this.state.attributes}},{key:"type",get:function(){return this.state.type}},{key:"media",get:function(){return this.state.media}},{key:"attachedMedia",get:function(){return this.getMediaByCategory(["media"])}},{key:"participantSid",get:function(){return this.state.participantSid}},{key:"aggregatedDeliveryReceipt",get:function(){return this.state.aggregatedDeliveryReceipt}},{key:"getMediaByCategory",value:function(l){var p;return((p=this.state.medias)!==null&&p!==void 0?p:[]).filter(function(f){return l.includes(f.category)})}},{key:"getEmailBody",value:function(){var l,p,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(l=(p=this.getMediaByCategory(["body"]))===null||p===void 0?void 0:p.filter(function(g){return g.contentType==f}).shift())!==null&&l!==void 0?l:null}},{key:"getEmailHistory",value:function(){var l,p,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(l=(p=this.getMediaByCategory(["history"]))===null||p===void 0?void 0:p.filter(function(g){return g.contentType==f}).shift())!==null&&l!==void 0?l:null}},{key:"_update",value:function(l){var p=[];(l.text||typeof l.text=="string")&&l.text!==this.state.body&&(this.state.body=l.text,p.push("body")),l.subject&&l.subject!==this.state.subject&&(this.state.subject=l.subject,p.push("subject")),l.lastUpdatedBy&&l.lastUpdatedBy!==this.state.lastUpdatedBy&&(this.state.lastUpdatedBy=l.lastUpdatedBy,p.push("lastUpdatedBy")),l.author&&l.author!==this.state.author&&(this.state.author=l.author,p.push("author")),l.dateUpdated&&new Date(l.dateUpdated).getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=new Date(l.dateUpdated),p.push("dateUpdated")),l.timestamp&&new Date(l.timestamp).getTime()!==(this.state.timestamp&&this.state.timestamp.getTime())&&(this.state.timestamp=new Date(l.timestamp),p.push("dateCreated"));var f=je(l.attributes,"Got malformed attributes for the message ".concat(this.sid),Je);ze.default(this.state.attributes,f)||(this.state.attributes=f,p.push("attributes"));var g=l.delivery,h=this.state.aggregatedDeliveryReceipt,w=!!g&&!!g.total&&!!g.delivered&&!!g.failed&&!!g.read&&!!g.sent&&!!g.undelivered;w&&(h?h._isEquals(g)||(h._update(g),p.push("deliveryReceipt")):(this.state.aggregatedDeliveryReceipt=new Xe(g),p.push("deliveryReceipt"))),p.length>0&&this.emit("updated",{message:this,updateReasons:p})}},{key:"getParticipant",value:function(){var v=B.default(A.default.mark(function p(){var f=this,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(g=null,!this.state.participantSid){S.next=5;break}return S.next=4,this.conversation.getParticipantBySid(this.state.participantSid).catch(function(){return Je.debug('Participant with sid "'.concat(f.participantSid,'" not found for message ').concat(f.sid)),null});case 4:g=S.sent;case 5:if(!(!g&&this.state.author)){S.next=9;break}return S.next=8,this.conversation.getParticipantByIdentity(this.state.author).catch(function(){return Je.debug('Participant with identity "'.concat(f.author,'" not found for message ').concat(f.sid)),null});case 8:g=S.sent;case 9:if(!g){S.next=11;break}return S.abrupt("return",g);case 11:throw h="Participant with ",this.state.participantSid&&(h+="SID '"+this.state.participantSid+"' "),this.state.author&&(this.state.participantSid&&(h+="or "),h+="identity '"+this.state.author+"' "),h==="Participant with "&&(h="Participant "),h+="was not found",new Error(h);case 17:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getDetailedDeliveryReceipts",value:function(){var v=B.default(A.default.mark(function p(){var f,g;return A.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._getDetailedDeliveryReceiptsPaginator();case 2:f=w.sent,g=[];case 4:if(g=[].concat(G.default(g),G.default(f.items)),f.hasNextPage){w.next=8;break}return w.abrupt("break",13);case 8:return w.next=10,f.nextPage();case 10:f=w.sent,w.next=4;break;case 13:return w.abrupt("return",g);case 14:case"end":return w.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"remove",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return g.abrupt("return",this);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"updateBody",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{body:f});case 2:return h.abrupt("return",this);case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateAttributes",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:typeof f<"u"?JSON.stringify(f):void 0});case 2:return h.abrupt("return",this);case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"attachTemporaryUrlsFor",value:function(){var v=B.default(A.default.mark(function p(f){var g=this,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(h=f==null?void 0:f.map(function(j){return j.sid}),!(this.services.mcsClient&&h)){S.next=7;break}return S.next=4,this.services.mcsClient.mediaSetGet(h);case 4:return S.abrupt("return",S.sent.map(function(j){return new Pe(j,g.services)}));case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return S.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"_getDetailedDeliveryReceiptsPaginator",value:function(){var v=B.default(A.default.mark(function p(f){var g=this,h,w,S;return A.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return h=this.configuration.links.messagesReceipts.replace("%s",this.conversation.sid).replace("%s",this.sid),w=new Me(h).arg("PageToken",f==null?void 0:f.pageToken).arg("PageSize",f==null?void 0:f.pageSize).build(),F.next=4,this.services.network.get(w);case 4:return S=F.sent,F.abrupt("return",new at(S.body.delivery_receipts.map(function(z){return new tt(z)}),function(z,pe){return g._getDetailedDeliveryReceiptsPaginator({pageToken:z,pageSize:pe})},S.body.meta.previous_token,S.body.meta.next_token));case 6:case"end":return F.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()}]),m}(T.ReplayEventEmitter);te.default(Wt,"updated","updated"),J([b.validateTypes([b.nonEmptyString,"undefined"]),k("design:type",Function),k("design:paramtypes",[Object]),k("design:returntype",Pe)],Wt.prototype,"getEmailBody",null),J([b.validateTypes([b.nonEmptyString,"undefined"]),k("design:type",Function),k("design:paramtypes",[Object]),k("design:returntype",Pe)],Wt.prototype,"getEmailHistory",null),J([b.validateTypesAsync("string"),k("design:type",Function),k("design:paramtypes",[String]),k("design:returntype",Promise)],Wt.prototype,"updateBody",null),J([b.validateTypesAsync(Oe),k("design:type",Function),k("design:paramtypes",[Object]),k("design:returntype",Promise)],Wt.prototype,"updateAttributes",null),J([b.validateTypesAsync(b.custom(function(I){return[I instanceof Array&&I.length>0&&I.reduce(function(M,m){return M&&m instanceof Pe},!0),"a non-empty array of Media"]})),k("design:type",Function),k("design:paramtypes",[Array]),k("design:returntype",Promise)],Wt.prototype,"attachTemporaryUrlsFor",null);function Ut(I,M){var m=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!m){if(Array.isArray(I)||(m=$i(I))||M&&I&&typeof I.length=="number"){m&&(I=m);var v=0,l=function(){};return{s:l,n:function(){return v>=I.length?{done:!0}:{done:!1,value:I[v++]}},e:function(w){throw w},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p=!0,f=!1,g;return{s:function(){m=m.call(I)},n:function(){var w=m.next();return p=w.done,w},e:function(w){f=!0,g=w},f:function(){try{!p&&m.return!=null&&m.return()}finally{if(f)throw g}}}}function $i(I,M){if(!!I){if(typeof I=="string")return Jn(I,M);var m=Object.prototype.toString.call(I).slice(8,-1);if(m==="Object"&&I.constructor&&(m=I.constructor.name),m==="Map"||m==="Set")return Array.from(I);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return Jn(I,M)}}function Jn(I,M){(M==null||M>I.length)&&(M=I.length);for(var m=0,v=new Array(M);m<M;m++)v[m]=I[m];return v}function Pn(I){var M=Et();return function(){var v=ne.default(I),l;if(M){var p=ne.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function Et(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Dt=Z.scope("Messages"),Lr=function(I){se.default(m,I);var M=Pn(m);function m(v,l,p){var f;return me.default(this,m),f=M.call(this),f.conversation=v,f.configuration=l,f.services=p,f.messagesByIndex=new Map,f.messagesListPromise=null,f}return ke.default(m,[{key:"subscribe",value:function(){var v=B.default(A.default.mark(function p(f){var g=this,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!this.messagesListPromise){S.next=2;break}return S.abrupt("return",this.messagesListPromise);case 2:return this.messagesListPromise=this.services.syncClient.list({id:f,mode:"open_existing"}),S.prev=3,S.next=6,this.messagesListPromise;case 6:return h=S.sent,h.on("itemAdded",function(j){Dt.debug("".concat(g.conversation.sid," itemAdded: ").concat(j.item.index));var F={self:"".concat(g.conversation.links.messages,"/").concat(j.item.data.sid),conversation:g.conversation.links.self,messages_receipts:"".concat(g.conversation.links.messages,"/").concat(j.item.data.sid,"/Receipts")},z=new Wt(j.item.index,j.item.data,g.conversation,F,g.configuration,g.services);if(g.messagesByIndex.has(z.index)){Dt.debug("Message arrived, but is already known and ignored",g.conversation.sid,z.index);return}g.messagesByIndex.set(z.index,z),z.on("updated",function(pe){return g.emit("messageUpdated",pe)}),g.emit("messageAdded",z)}),h.on("itemRemoved",function(j){Dt.debug("#{this.conversation.sid} itemRemoved: ".concat(j.index));var F=j.index;if(g.messagesByIndex.has(F)){var z=g.messagesByIndex.get(F);if(!z)return;g.messagesByIndex.delete(z.index),z.removeAllListeners("updated"),g.emit("messageRemoved",z)}}),h.on("itemUpdated",function(j){Dt.debug("".concat(g.conversation.sid," itemUpdated: ").concat(j.item.index));var F=g.messagesByIndex.get(j.item.index);F&&F._update(j.item.data)}),S.abrupt("return",h);case 13:throw S.prev=13,S.t0=S.catch(3),this.messagesListPromise=null,this.services.syncClient.connectionState!=="disconnected"&&Dt.error("Failed to get messages object for conversation",this.conversation.sid,S.t0),Dt.debug("ERROR: Failed to get messages object for conversation",this.conversation.sid,S.t0),S.t0;case 19:case"end":return S.stop()}},p,this,[[3,13]])}));function l(p){return v.apply(this,arguments)}return l}()},{key:"unsubscribe",value:function(){var v=B.default(A.default.mark(function p(){var f;return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.messagesListPromise){h.next=2;break}return h.abrupt("return");case 2:return h.next=4,this.messagesListPromise;case 4:f=h.sent,f.close(),this.messagesListPromise=null;case 7:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"sendV2",value:function(){var v=B.default(A.default.mark(function p(f){var g,h,w,S,j,F,z,pe,qe;return A.default.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:Dt.debug("Sending message V2",f.mediaContent,f.attributes,f.emailOptions),h=[],w=Ut(f.mediaContent),We.prev=3,w.s();case 5:if((S=w.n()).done){We.next=22;break}if(z=le.default(S.value,2),pe=z[0],qe=z[1],Dt.debug("Adding media to a message as ".concat(qe instanceof FormData?"FormData":"SendMediaOptions"),qe),We.t0=h,!(qe instanceof FormData)){We.next=15;break}return We.next=12,this.services.mcsClient.postFormData(qe,pe);case 12:We.t1=We.sent,We.next=18;break;case 15:return We.next=17,this.services.mcsClient.post((j=qe.contentType)!==null&&j!==void 0?j:"",(F=qe.media)!==null&&F!==void 0?F:"",pe,qe.filename);case 17:We.t1=We.sent;case 18:We.t2=We.t1,We.t0.push.call(We.t0,We.t2);case 20:We.next=5;break;case 22:We.next=27;break;case 24:We.prev=24,We.t3=We.catch(3),w.e(We.t3);case 27:return We.prev=27,w.f(),We.finish(27);case 30:return We.next=32,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{body:f.text,subject:(g=f.emailOptions)===null||g===void 0?void 0:g.subject,media_sids:h.map(function(st){return st.sid}),attributes:typeof f.attributes<"u"?JSON.stringify(f.attributes):void 0});case 32:return We.abrupt("return",We.sent);case 33:case"end":return We.stop()}},p,this,[[3,24,27,30]])}));function l(p){return v.apply(this,arguments)}return l}()},{key:"send",value:function(){var v=B.default(A.default.mark(function p(f){var g,h,w=arguments;return A.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return g=w.length>1&&w[1]!==void 0?w[1]:{},h=w.length>2?w[2]:void 0,Dt.debug("Sending text message",f,g,h),j.next=5,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{body:f!=null?f:"",attributes:typeof g<"u"?JSON.stringify(g):void 0,subject:h==null?void 0:h.subject});case 5:return j.abrupt("return",j.sent);case 6:case"end":return j.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"sendMedia",value:function(){var v=B.default(A.default.mark(function p(f){var g,h,w,S,j,F=arguments;return A.default.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(w=F.length>1&&F[1]!==void 0?F[1]:{},S=F.length>2?F[2]:void 0,Dt.debug("Sending media message",f,w,S),Dt.debug("Sending media message as ".concat(f instanceof FormData?"FormData":"SendMediaOptions"),f,w),!(f instanceof FormData)){pe.next=10;break}return pe.next=7,this.services.mcsClient.postFormData(f);case 7:pe.t0=pe.sent,pe.next=13;break;case 10:return pe.next=12,this.services.mcsClient.post((g=f.contentType)!==null&&g!==void 0?g:"",(h=f.media)!==null&&h!==void 0?h:"","media",f.filename);case 12:pe.t0=pe.sent;case 13:return j=pe.t0,pe.next=16,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{media_sids:[j.sid],attributes:typeof w<"u"?JSON.stringify(w):void 0});case 16:return pe.abrupt("return",pe.sent);case 17:case"end":return pe.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getMessages",value:function(){var v=B.default(A.default.mark(function p(f,g){var h,w=arguments;return A.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return h=w.length>2&&w[2]!==void 0?w[2]:"backwards",j.abrupt("return",this._getMessages(f,g,h));case 2:case"end":return j.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"_wrapPaginator",value:function(l,p,f){var g=this,h=l==="desc",w=function(){return p.nextPage().then(function(F){return g._wrapPaginator(l,F,f)})},S=function(){return p.prevPage().then(function(F){return g._wrapPaginator(l,F,f)})};return f(p.items).then(function(j){return{items:j.sort(function(F,z){return F.index-z.index}),hasPrevPage:h?p.hasNextPage:p.hasPrevPage,hasNextPage:h?p.hasPrevPage:p.hasNextPage,prevPage:h?w:S,nextPage:h?S:w}})}},{key:"_upsertMessage",value:function(l,p){var f=this,g=this.messagesByIndex.get(l);if(g)return g;var h={self:"".concat(this.conversation.links.messages,"/").concat(p.sid),conversation:this.conversation.links.self,messages_receipts:"".concat(this.conversation.links.messages,"/").concat(p.sid,"/Receipts")},w=new Wt(l,p,this.conversation,h,this.configuration,this.services);return this.messagesByIndex.set(w.index,w),w.on("updated",function(S){return f.emit("messageUpdated",S)}),w}},{key:"_getMessages",value:function(){var v=B.default(A.default.mark(function p(){var f=this,g,h,w,S,j,F,z=arguments;return A.default.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return g=z.length>0&&z[0]!==void 0?z[0]:30,h=z.length>1&&z[1]!==void 0?z[1]:"end",w=z.length>2&&z[2]!==void 0?z[2]:"forward",S=w==="backwards"?"desc":"asc",qe.next=6,this.messagesListPromise;case 6:return j=qe.sent,qe.next=9,j==null?void 0:j.getItems({from:h!=="end"?h:void 0,pageSize:g,order:S,limit:g});case 9:return F=qe.sent,qe.next=12,this._wrapPaginator(S,F,function(it){return Promise.all(it.map(function(We){return f._upsertMessage(We.index,We.data)}))});case 12:return qe.abrupt("return",qe.sent);case 13:case"end":return qe.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()}]),m}(T.ReplayEventEmitter),Rr=function(){function I(M){me.default(this,I),te.default(this,"attributes",{}),te.default(this,"mediaContent",[]),te.default(this,"emailOptions",{}),this.messagesEntity=M}return ke.default(I,[{key:"send",value:function(){var M=B.default(A.default.mark(function v(){var l;return A.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.messagesEntity.sendV2(this);case 2:return l=f.sent,f.abrupt("return",Ce(l.index));case 4:case"end":return f.stop()}},v,this)}));function m(){return M.apply(this,arguments)}return m}()}]),I}(),pa=function(){function I(M,m){me.default(this,I),this.limits=M,this.message=new Rr(m),this.emailBodies=new Map,this.emailHistories=new Map}return ke.default(I,[{key:"setBody",value:function(m){return this.message.text=m,this}},{key:"setSubject",value:function(m){return this.message.emailOptions.subject=m,this}},{key:"setAttributes",value:function(m){return this.message.attributes=m,this}},{key:"setEmailBody",value:function(m,v){return this.emailBodies.set(m,v),this}},{key:"setEmailHistory",value:function(m,v){return this.emailHistories.set(m,v),this}},{key:"addMedia",value:function(m){if(typeof FormData>"u"&&m instanceof FormData)throw new Error("Could not add FormData content whilst not in a browser");if(!(m instanceof FormData)){var v=m;if(!v.contentType||!v.media)throw new Error("Media content in SendMediaOptions must contain non-empty contentType and media")}return this.message.mediaContent.push(["media",m]),this}},{key:"build",value:function(){var m=this;if(this.emailBodies.forEach(function(v,l){if(!m.limits.emailBodiesAllowedMimeTypes.includes(l))throw new Error("Unsupported email body MIME type ".concat(l))}),this.emailHistories.forEach(function(v,l){if(!m.limits.emailHistoriesAllowedMimeTypes.includes(l))throw new Error("Unsupported email history MIME type ".concat(l))}),this.emailBodies.size>this.limits.emailBodiesAllowedMimeTypes.length)throw new Error("Too many email bodies attached to the message (".concat(this.emailBodies.size," > ").concat(this.limits.emailBodiesAllowedMimeTypes.length,")"));if(this.emailHistories.size>this.limits.emailHistoriesAllowedMimeTypes.length)throw new Error("Too many email histories attached to the message (".concat(this.emailHistories.size," > ").concat(this.limits.emailHistoriesAllowedMimeTypes.length,")"));if(this.message.mediaContent.length>this.limits.mediaAttachmentsCountLimit)throw new Error("Too many media attachments in the message (".concat(this.message.mediaContent.length," > ").concat(this.limits.mediaAttachmentsCountLimit,")"));return this.emailBodies.forEach(function(v){m.message.mediaContent.push(["body",v])}),this.emailHistories.forEach(function(v){m.message.mediaContent.push(["history",v])}),this.message}},{key:"getPayloadContentType",value:function(m){return typeof FormData<"u"&&m instanceof FormData?m.get("Content-Type"):m.contentType}}]),I}();function ls(I,M){var m=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!m){if(Array.isArray(I)||(m=jr(I))||M&&I&&typeof I.length=="number"){m&&(I=m);var v=0,l=function(){};return{s:l,n:function(){return v>=I.length?{done:!0}:{done:!1,value:I[v++]}},e:function(w){throw w},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p=!0,f=!1,g;return{s:function(){m=m.call(I)},n:function(){var w=m.next();return p=w.done,w},e:function(w){f=!0,g=w},f:function(){try{!p&&m.return!=null&&m.return()}finally{if(f)throw g}}}}function jr(I,M){if(!!I){if(typeof I=="string")return cs(I,M);var m=Object.prototype.toString.call(I).slice(8,-1);if(m==="Object"&&I.constructor&&(m=I.constructor.name),m==="Map"||m==="Set")return Array.from(I);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return cs(I,M)}}function cs(I,M){(M==null||M>I.length)&&(M=I.length);for(var m=0,v=new Array(M);m<M;m++)v[m]=I[m];return v}function _o(I){var M=So();return function(){var v=ne.default(I),l;if(M){var p=ne.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function So(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var pr=Z.scope("Conversation"),vn={lastMessage:"lastMessage",attributes:"attributes",createdBy:"createdBy",dateCreated:"dateCreated",dateUpdated:"dateUpdated",friendlyName:"friendlyName",lastConsumedMessageIndex:"lastConsumedMessageIndex",notificationLevel:"notificationLevel",sid:"sid",status:"status",uniqueName:"uniqueName",state:"state",bindings:"bindings"};function Vr(I){try{return new Date(I)}catch{return null}}var _t=function(I){se.default(m,I);var M=_o(m);function m(v,l,p,f,g){var h,w;me.default(this,m),w=M.call(this),w.sid=l,w.links=p,w.configuration=f,w.services=g;var S=v.attributes||{},j=v.createdBy,F=Vr(v.dateCreated),z=Vr(v.dateUpdated),pe=v.friendlyName||null,qe=Number.isInteger(v.lastConsumedMessageIndex)?v.lastConsumedMessageIndex:null,it=v.uniqueName||null;try{JSON.stringify(S)}catch{throw new Error("Attributes must be a valid JSON object.")}w.entityName=v.channel,w.channelState={uniqueName:it,status:"notParticipating",attributes:S,createdBy:j,dateCreated:F,dateUpdated:z,friendlyName:pe,lastReadMessageIndex:qe,bindings:(h=v.bindings)!==null&&h!==void 0?h:{}},v.notificationLevel&&(w.channelState.notificationLevel=v.notificationLevel);var We={participants:w.links.participants};return w.participants=new Map,w.participantsEntity=new be(Se.default(w),w.participants,We,w.configuration,w.services),w.participantsEntity.on("participantJoined",function(st){return w.emit("participantJoined",st)}),w.participantsEntity.on("participantLeft",function(st){return w.emit("participantLeft",st)}),w.participantsEntity.on("participantUpdated",function(st){return w.emit("participantUpdated",st)}),w.messagesEntity=new Lr(Se.default(w),f,g),w.messagesEntity.on("messageAdded",function(st){return w._onMessageAdded(st)}),w.messagesEntity.on("messageUpdated",function(st){return w.emit("messageUpdated",st)}),w.messagesEntity.on("messageRemoved",function(st){return w.emit("messageRemoved",st)}),w}return ke.default(m,[{key:"uniqueName",get:function(){return this.channelState.uniqueName}},{key:"status",get:function(){return this.channelState.status}},{key:"friendlyName",get:function(){return this.channelState.friendlyName}},{key:"dateUpdated",get:function(){return this.channelState.dateUpdated}},{key:"dateCreated",get:function(){return this.channelState.dateCreated}},{key:"createdBy",get:function(){var l;return(l=this.channelState.createdBy)!==null&&l!==void 0?l:""}},{key:"attributes",get:function(){return this.channelState.attributes}},{key:"lastReadMessageIndex",get:function(){return this.channelState.lastReadMessageIndex}},{key:"lastMessage",get:function(){var l;return(l=this.channelState.lastMessage)!==null&&l!==void 0?l:void 0}},{key:"notificationLevel",get:function(){var l;return(l=this.channelState.notificationLevel)!==null&&l!==void 0?l:"default"}},{key:"bindings",get:function(){return this.channelState.bindings}},{key:"limits",get:function(){return this.configuration.limits}},{key:"state",get:function(){return this.channelState.state}},{key:"_subscribe",value:function(){var l,p=this;return this.entityPromise=(l=this.entityPromise)!==null&&l!==void 0?l:this.services.syncClient.document({id:this.entityName,mode:"open_existing"}).then(function(f){return p.entity=f,p.entity.on("updated",function(g){p._update(g.data)}),p.entity.on("removed",function(){return p.emit("removed",p)}),p._update(p.entity.data),f}).catch(function(f){throw p.entity=null,p.entityPromise=null,p.services.syncClient.connectionState!="disconnected"&&pr.error("Failed to get conversation object",f),pr.debug("ERROR: Failed to get conversation object",f),f})}},{key:"_subscribeStreams",value:function(){var v=B.default(A.default.mark(function p(){var f,g,h,w,S;return A.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.prev=0,F.next=3,this._subscribe();case 3:return pr.trace("_subscribeStreams, this.entity.data=",(f=this.entity)===null||f===void 0?void 0:f.data),w=(g=this.entity)===null||g===void 0?void 0:g.data.messages,S=(h=this.entity)===null||h===void 0?void 0:h.data.roster,F.next=8,Promise.all([this.messagesEntity.subscribe(w),this.participantsEntity.subscribe(S)]);case 8:F.next=15;break;case 10:throw F.prev=10,F.t0=F.catch(0),this.services.syncClient.connectionState!=="disconnected"&&pr.error("Failed to subscribe on conversation objects",this.sid,F.t0),pr.debug("ERROR: Failed to subscribe on conversation objects",this.sid,F.t0),F.t0;case 15:case"end":return F.stop()}},p,this,[[0,10]])}));function l(){return v.apply(this,arguments)}return l}()},{key:"_unsubscribe",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!this.entity){g.next=5;break}return g.next=3,this.entity.close();case 3:this.entity=null,this.entityPromise=null;case 5:return g.abrupt("return",Promise.all([this.participantsEntity.unsubscribe(),this.messagesEntity.unsubscribe()]));case 6:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_setStatus",value:function(l,p){var f=this;this.statusSource=p,this.channelState.status!==l&&(this.channelState.status=l,l==="joined"?this._subscribeStreams().catch(function(g){if(pr.debug("ERROR while setting conversation status "+l,g),f.services.syncClient.connectionState!=="disconnected")throw g}):this.entityPromise&&this._unsubscribe().catch(function(g){if(pr.debug("ERROR while setting conversation status "+l,g),f.services.syncClient.connectionState!=="disconnected")throw g}))}},{key:"_statusSource",value:function(){return this.statusSource}},{key:"_update",value:function(l){var p,f,g,h,w;pr.trace("_update",l),m.preprocessUpdate(l,this.sid);for(var S=new Set,j=0,F=Object.keys(l);j<F.length;j++){var z=F[j],pe=vn[z];if(!!pe)switch(pe){case vn.status:if(!l.status||l.status==="unknown"||this.channelState.status===l.status)break;this.channelState.status=l.status,S.add(pe);break;case vn.attributes:if(ze.default(this.channelState.attributes,l.attributes))break;this.channelState.attributes=l.attributes,S.add(pe);break;case vn.lastConsumedMessageIndex:if(l.lastConsumedMessageIndex===void 0||l.lastConsumedMessageIndex===this.channelState.lastReadMessageIndex)break;this.channelState.lastReadMessageIndex=l.lastConsumedMessageIndex,S.add("lastReadMessageIndex");break;case vn.lastMessage:if(this.channelState.lastMessage&&!l.lastMessage){delete this.channelState.lastMessage,S.add(pe);break}this.channelState.lastMessage=this.channelState.lastMessage||{},((p=l.lastMessage)===null||p===void 0?void 0:p.index)!==void 0&&l.lastMessage.index!==this.channelState.lastMessage.index&&(this.channelState.lastMessage.index=l.lastMessage.index,S.add(pe)),((f=l.lastMessage)===null||f===void 0?void 0:f.timestamp)!==void 0&&((g=this.channelState.lastMessage)===null||g===void 0||(h=g.dateCreated)===null||h===void 0?void 0:h.getTime())!==l.lastMessage.timestamp.getTime()&&(this.channelState.lastMessage.dateCreated=l.lastMessage.timestamp,S.add(pe)),ze.default(this.channelState.lastMessage,{})&&delete this.channelState.lastMessage;break;case vn.state:var qe=l.state||void 0;if(qe!==void 0&&(qe.dateUpdated=new Date(qe.dateUpdated)),ze.default(this.channelState.state,qe))break;this.channelState.state=qe,S.add(pe);break;case vn.bindings:if(ze.default(this.channelState.bindings,l.bindings))break;this.channelState.bindings=l.bindings,S.add(pe);break;default:var it=l[z]instanceof Date,We=it&&((w=this.channelState[pe])===null||w===void 0?void 0:w.getTime())===l[z].getTime(),st=!it&&this[pe]===l[z];if(We||st)break;this.channelState[pe]=l[z],S.add(pe)}}S.size>0&&this.emit("updated",{conversation:this,updateReasons:G.default(S)})}},{key:"_onMessageAdded",value:function(l){var p=ls(this.participants.values()),f;try{for(p.s();!(f=p.n()).done;){var g=f.value;if(g.identity===l.author){g._endTyping();break}}}catch(h){p.e(h)}finally{p.f()}this.emit("messageAdded",l)}},{key:"_setLastReadMessageIndex",value:function(){var v=B.default(A.default.mark(function p(f){var g;return A.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.services.commandExecutor.mutateResource("post","".concat(this.configuration.links.myConversations,"/").concat(this.sid),{last_read_message_index:f});case 2:return g=w.sent,w.abrupt("return",g.unread_messages_count);case 4:case"end":return w.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"add",value:function(){var v=B.default(A.default.mark(function p(f,g){return A.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",this.participantsEntity.add(f,g!=null?g:{}));case 1:case"end":return w.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"addNonChatParticipant",value:function(){var v=B.default(A.default.mark(function p(f,g){var h,w,S=arguments;return A.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return h=S.length>2&&S[2]!==void 0?S[2]:{},w=S.length>3&&S[3]!==void 0?S[3]:{},F.abrupt("return",this.participantsEntity.addNonChatParticipant(f,g,h!=null?h:{},w!=null?w:{}));case 3:case"end":return F.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"advanceLastReadMessageIndex",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._subscribeStreams();case 2:if(!(f<(this.lastReadMessageIndex||0))){h.next=6;break}return h.next=5,this._setLastReadMessageIndex(this.lastReadMessageIndex);case 5:return h.abrupt("return",h.sent);case 6:return h.next=8,this._setLastReadMessageIndex(f);case 8:return h.abrupt("return",h.sent);case 9:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"delete",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return g.abrupt("return",this);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getAttributes",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._subscribe();case 2:return g.abrupt("return",this.attributes);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getMessages",value:function(){var v=B.default(A.default.mark(function p(f,g,h){return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this._subscribeStreams();case 2:return S.abrupt("return",this.messagesEntity.getMessages(f,g,h));case 3:case"end":return S.stop()}},p,this)}));function l(p,f,g){return v.apply(this,arguments)}return l}()},{key:"getParticipants",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._subscribeStreams();case 2:return g.abrupt("return",this.participantsEntity.getParticipants());case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getParticipantsCount",value:function(){var v=B.default(A.default.mark(function p(){var f,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return g=new Me(this.configuration.links.conversations).path(this.sid).build(),S.next=3,this.services.network.get(g);case 3:return h=S.sent,S.abrupt("return",(f=h.body.participants_count)!==null&&f!==void 0?f:0);case 5:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getParticipantBySid",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",this.participantsEntity.getParticipantBySid(f));case 1:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getParticipantByIdentity",value:function(){var v=B.default(A.default.mark(function p(){var f,g=arguments;return A.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return f=g.length>0&&g[0]!==void 0?g[0]:"",w.abrupt("return",this.participantsEntity.getParticipantByIdentity(f!=null?f:""));case 2:case"end":return w.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getMessagesCount",value:function(){var v=B.default(A.default.mark(function p(){var f,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return g=new Me(this.configuration.links.conversations).path(this.sid).build(),S.next=3,this.services.network.get(g);case 3:return h=S.sent,S.abrupt("return",(f=h.body.messages_count)!==null&&f!==void 0?f:0);case 5:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getUnreadMessagesCount",value:function(){var v=B.default(A.default.mark(function p(){var f,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return f=new Me(this.configuration.links.myConversations).path(this.sid).build(),S.next=3,this.services.network.get(f);case 3:if(g=S.sent,g.body.conversation_sid===this.sid){S.next=6;break}throw new Error("Conversation was not found in the user conversations list");case 6:if(h=g.body.unread_messages_count,typeof h!="number"){S.next=9;break}return S.abrupt("return",h);case 9:return S.abrupt("return",null);case 10:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"join",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:this.configuration.userIdentity});case 2:return g.abrupt("return",this);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"leave",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.channelState.status!=="joined"){g.next=3;break}return g.next=3,this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(this.configuration.userIdentity));case 3:return g.abrupt("return",this);case 4:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"removeParticipant",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.participantsEntity.remove(typeof f=="string"?f:f.sid);case 2:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"sendMessage",value:function(){var v=B.default(A.default.mark(function p(f,g,h){var w,S,j,F;return A.default.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(!(typeof f=="string"||f===null)){pe.next=5;break}return pe.next=3,this.messagesEntity.send(f,g,h);case 3:return j=pe.sent,pe.abrupt("return",(S=Ce(j.index))!==null&&S!==void 0?S:0);case 5:return pe.next=7,this.messagesEntity.sendMedia(f,g,h);case 7:return F=pe.sent,pe.abrupt("return",(w=Ce(F.index))!==null&&w!==void 0?w:0);case 9:case"end":return pe.stop()}},p,this)}));function l(p,f,g){return v.apply(this,arguments)}return l}()},{key:"prepareMessage",value:function(){return new pa(this.limits,this.messagesEntity)}},{key:"setAllMessagesRead",value:function(){var v=B.default(A.default.mark(function p(){var f;return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._subscribeStreams();case 2:return h.next=4,this.getMessages(1);case 4:if(f=h.sent,!(f.items.length>0)){h.next=7;break}return h.abrupt("return",this.advanceLastReadMessageIndex(f.items[0].index));case 7:return h.abrupt("return",Promise.resolve(0));case 8:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"setAllMessagesUnread",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._subscribeStreams();case 2:return g.next=4,this._setLastReadMessageIndex(null);case 4:return g.abrupt("return",g.sent);case 5:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"setUserNotificationLevel",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post","".concat(this.configuration.links.myConversations,"/").concat(this.sid),{notification_level:f});case 2:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"typing",value:function(){return this.services.typingIndicator.send(this.sid)}},{key:"updateAttributes",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:f!==void 0?JSON.stringify(f):void 0});case 2:return h.abrupt("return",this);case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateFriendlyName",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.channelState.friendlyName===f){h.next=3;break}return h.next=3,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:f});case 3:return h.abrupt("return",this);case 4:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateLastReadMessageIndex",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._subscribeStreams();case 2:return h.abrupt("return",this._setLastReadMessageIndex(f));case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateUniqueName",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.channelState.uniqueName===f){h.next=4;break}return f||(f=""),h.next=4,this.services.commandExecutor.mutateResource("post",this.links.self,{unique_name:f});case 4:return h.abrupt("return",this);case 5:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()}],[{key:"preprocessUpdate",value:function(l,p){try{typeof l.attributes=="string"?l.attributes=JSON.parse(l.attributes):l.attributes&&JSON.stringify(l.attributes)}catch{pr.warn("Retrieved malformed attributes from the server for conversation: "+p),l.attributes={}}try{l.dateCreated&&(l.dateCreated=new Date(l.dateCreated))}catch{pr.warn("Retrieved malformed dateCreated from the server for conversation: "+p),delete l.dateCreated}try{l.dateUpdated&&(l.dateUpdated=new Date(l.dateUpdated))}catch{pr.warn("Retrieved malformed dateUpdated from the server for conversation: "+p),delete l.dateUpdated}try{l.lastMessage&&l.lastMessage.timestamp&&(l.lastMessage.timestamp=new Date(l.lastMessage.timestamp))}catch{pr.warn("Retrieved malformed lastMessage.timestamp from the server for conversation: "+p),delete l.lastMessage.timestamp}}}]),m}(T.ReplayEventEmitter);te.default(_t,"participantJoined","participantJoined"),te.default(_t,"participantLeft","participantLeft"),te.default(_t,"participantUpdated","participantUpdated"),te.default(_t,"messageAdded","messageAdded"),te.default(_t,"messageRemoved","messageRemoved"),te.default(_t,"messageUpdated","messageUpdated"),te.default(_t,"typingEnded","typingEnded"),te.default(_t,"typingStarted","typingStarted"),te.default(_t,"updated","updated"),te.default(_t,"removed","removed"),J([b.validateTypesAsync(b.nonEmptyString,xe),k("design:type",Function),k("design:paramtypes",[String,Object]),k("design:returntype",Promise)],_t.prototype,"add",null),J([b.validateTypesAsync(b.nonEmptyString,b.nonEmptyString,xe),k("design:type",Function),k("design:paramtypes",[String,String,Object,Object]),k("design:returntype",Promise)],_t.prototype,"addNonChatParticipant",null),J([b.validateTypesAsync(b.nonNegativeInteger),k("design:type",Function),k("design:paramtypes",[Number]),k("design:returntype",Promise)],_t.prototype,"advanceLastReadMessageIndex",null),J([b.validateTypesAsync(["undefined",b.nonNegativeInteger],["undefined",b.nonNegativeInteger],["undefined",b.literal("backwards","forward")]),k("design:type",Function),k("design:paramtypes",[Number,Number,String]),k("design:returntype",Promise)],_t.prototype,"getMessages",null),J([b.validateTypesAsync(b.nonEmptyString),k("design:type",Function),k("design:paramtypes",[String]),k("design:returntype",Promise)],_t.prototype,"getParticipantBySid",null),J([b.validateTypesAsync(b.nonEmptyString),k("design:type",Function),k("design:paramtypes",[String]),k("design:returntype",Promise)],_t.prototype,"getParticipantByIdentity",null),J([b.validateTypesAsync([b.nonEmptyString,Y]),k("design:type",Function),k("design:paramtypes",[Object]),k("design:returntype",Promise)],_t.prototype,"removeParticipant",null),J([b.validateTypesAsync(["string",b.literal(null),b.custom(function(I){return[I instanceof FormData,"an instance of FormData"]}),b.objectSchema("media options",{contentType:b.nonEmptyString,media:b.custom(function(I){var M=typeof I=="string"&&I.length>0||I instanceof Uint8Array||I instanceof ArrayBuffer;return typeof Blob=="function"&&(M=M||I instanceof Blob),[M,"a non-empty string, an instance of Buffer or an instance of Blob"]})})],xe,["undefined",b.literal(null),b.objectSchema("email attributes",{subject:[b.nonEmptyString,"undefined"]})]),k("design:type",Function),k("design:paramtypes",[Object,Object,Object]),k("design:returntype",Promise)],_t.prototype,"sendMessage",null),J([b.validateTypesAsync(b.literal("default","muted")),k("design:type",Function),k("design:paramtypes",[String]),k("design:returntype",Promise)],_t.prototype,"setUserNotificationLevel",null),J([b.validateTypesAsync(Oe),k("design:type",Function),k("design:paramtypes",[Object]),k("design:returntype",Promise)],_t.prototype,"updateAttributes",null),J([b.validateTypesAsync(["string"]),k("design:type",Function),k("design:paramtypes",[String]),k("design:returntype",Promise)],_t.prototype,"updateFriendlyName",null),J([b.validateTypesAsync([b.literal(null),b.nonNegativeInteger]),k("design:type",Function),k("design:paramtypes",[Number]),k("design:returntype",Promise)],_t.prototype,"updateLastReadMessageIndex",null),J([b.validateTypesAsync(["string",b.literal(null)]),k("design:type",Function),k("design:paramtypes",[String]),k("design:returntype",Promise)],_t.prototype,"updateUniqueName",null);var $o=function(){function I(){var M=this;me.default(this,I),this._promise=new Promise(function(m,v){M._resolve=m,M._reject=v})}return ke.default(I,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(m){this._resolve(m)}},{key:"set",value:function(m){this.current=m,this._resolve(m)}},{key:"fail",value:function(m){this._reject(m)}}]),I}();function ko(I,M){var m=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!m){if(Array.isArray(I)||(m=To(I))||M&&I&&typeof I.length=="number"){m&&(I=m);var v=0,l=function(){};return{s:l,n:function(){return v>=I.length?{done:!0}:{done:!1,value:I[v++]}},e:function(w){throw w},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p=!0,f=!1,g;return{s:function(){m=m.call(I)},n:function(){var w=m.next();return p=w.done,w},e:function(w){f=!0,g=w},f:function(){try{!p&&m.return!=null&&m.return()}finally{if(f)throw g}}}}function To(I,M){if(!!I){if(typeof I=="string")return fs(I,M);var m=Object.prototype.toString.call(I).slice(8,-1);if(m==="Object"&&I.constructor&&(m=I.constructor.name),m==="Map"||m==="Set")return Array.from(I);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return fs(I,M)}}function fs(I,M){(M==null||M>I.length)&&(M=I.length);for(var m=0,v=new Array(M);m<M;m++)v[m]=I[m];return v}function Yn(I,M){var m=Object.keys(I);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(I);M&&(v=v.filter(function(l){return Object.getOwnPropertyDescriptor(I,l).enumerable})),m.push.apply(m,v)}return m}function Eo(I){for(var M=1;M<arguments.length;M++){var m=arguments[M]!=null?arguments[M]:{};M%2?Yn(Object(m),!0).forEach(function(v){te.default(I,v,m[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(m)):Yn(Object(m)).forEach(function(v){Object.defineProperty(I,v,Object.getOwnPropertyDescriptor(m,v))})}return I}function Co(I){var M=Kr();return function(){var v=ne.default(I),l;if(M){var p=ne.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function Kr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var $r=Z.scope("Conversations"),Io=function(I){se.default(m,I);var M=Co(m);function m(v,l){var p;return me.default(this,m),p=M.call(this),te.default(Se.default(p),"conversations",new Map),te.default(Se.default(p),"myConversationsRead",new $o),te.default(Se.default(p),"tombstones",new Set),te.default(Se.default(p),"myConversationsFetched",!1),p.configuration=v,p.services=l,p}return ke.default(m,[{key:"addConversation",value:function(){var v=B.default(A.default.mark(function p(f){var g,h,w,S,j,F,z,pe,qe,it;return A.default.wrap(function(st){for(;;)switch(st.prev=st.next){case 0:return S=typeof(f==null?void 0:f.attributes)<"u"?f.attributes:{},st.next=3,this.services.commandExecutor.mutateResource("post",this.configuration.links.conversations,{friendly_name:f.friendlyName,unique_name:f.uniqueName,attributes:typeof S<"u"?JSON.stringify(S):void 0});case 3:if(j=st.sent,F=(g=j.sid)!==null&&g!==void 0?g:null,z=(h=(w=j.sync_objects)===null||w===void 0?void 0:w.conversation)!==null&&h!==void 0?h:null,pe=Eo({self:j.url},j.links),qe=this.conversations.get(F),!qe){st.next=12;break}return st.next=11,qe._subscribe();case 11:return st.abrupt("return",qe);case 12:return it=new _t({channel:z,entityName:"",uniqueName:"",attributes:null,createdBy:"",friendlyName:"",lastConsumedMessageIndex:0,dateCreated:null,dateUpdated:null},F,pe,this.configuration,this.services),this.conversations.set(it.sid,it),this._registerForEvents(it),st.next=17,it._subscribe();case 17:return this.emit("conversationAdded",it),st.abrupt("return",it);case 19:case"end":return st.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"fetchConversations",value:function(){var v=B.default(A.default.mark(function p(){var f=this,g,h,w,S,j,F,z;return A.default.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return qe.prev=0,qe.next=3,this._getMap();case 3:return g=qe.sent,g.on("itemAdded",function(it){$r.debug("itemAdded: ".concat(it.item.key)),f._upsertConversation("sync",it.item.key,it.item.data)}),g.on("itemRemoved",function(it){$r.debug("itemRemoved: ".concat(it.key));var We=it.key;f.myConversationsFetched||f.tombstones.add(We);var st=f.conversations.get(We);!st||(st.status==="joined"&&(st._setStatus("notParticipating","sync"),f.emit("conversationLeft",st)),f.conversations.delete(We),f.emit("conversationRemoved",st),st.emit("removed",st))}),g.on("itemUpdated",function(it){$r.debug("itemUpdated: ".concat(it.item.key)),f._upsertConversation("sync",it.item.key,it.item.data)}),qe.next=9,this._fetchMyConversations();case 9:h=qe.sent,w=[],S=ko(h);try{for(S.s();!(j=S.n()).done;)F=j.value,w.push(this._upsertConversation("rest",F.channel_sid,F))}catch(it){S.e(it)}finally{S.f()}return this.myConversationsRead.set(!0),qe.next=16,Promise.all(w);case 16:return this.myConversationsFetched=!0,this.tombstones.clear(),$r.debug("The conversations list has been successfully fetched"),qe.abrupt("return",this);case 22:throw qe.prev=22,qe.t0=qe.catch(0),z="Failed to fetch the conversations list",this.services.syncClient.connectionState!=="disconnected"&&$r.error(z,qe.t0),$r.debug("ERROR: ".concat(z),qe.t0),qe.t0;case 28:case"end":return qe.stop()}},p,this,[[0,22]])}));function l(){return v.apply(this,arguments)}return l}()},{key:"getConversations",value:function(){var v=B.default(A.default.mark(function p(){var f=this,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this._getMap();case 2:return g=S.sent,S.next=5,g.getItems();case 5:return h=S.sent,S.abrupt("return",this._wrapPaginator(h,function(j){return Promise.all(j.map(function(F){return f._upsertConversation("sync",F.key,F.data)}))}));case 7:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getConversation",value:function(){var v=B.default(A.default.mark(function p(f){var g=this,h,w,S;return A.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,this._getMap();case 2:return h=F.sent,F.next=5,h.getItems({key:f});case 5:return w=F.sent,S=w.items.map(function(z){return g._upsertConversation("sync",z.key,z.data)}),F.abrupt("return",S.length>0?S[0]:null);case 8:case"end":return F.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getConversationByUniqueName",value:function(){var v=B.default(A.default.mark(function p(f){var g,h,w,S,j;return A.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return g=new Me(this.configuration.links.myConversations).path(f).build(),z.next=3,this.services.network.get(g);case 3:return h=z.sent,w=h.body,S=w.conversation_sid,j={entityName:null,lastConsumedMessageIndex:w.last_read_message_index,status:(w==null?void 0:w.status)||"unknown",friendlyName:w.friendly_name,dateUpdated:w.date_updated,dateCreated:w.date_created,uniqueName:w.unique_name,createdBy:w.created_by,attributes:w.attributes,channel:w.sync_objects.conversation,notificationLevel:w==null?void 0:w.notification_level,sid:S},z.abrupt("return",S?this._upsertConversation("sync",S,j):null);case 8:case"end":return z.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"peekConversation",value:function(){var v=B.default(A.default.mark(function p(f){var g,h,w,S;return A.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return g=new Me(this.configuration.links.conversations).path(f).build(),F.next=3,this.services.network.get(g);case 3:return h=F.sent,w=h.body,S={entityName:null,status:(w==null?void 0:w.status)||"unknown",friendlyName:w.friendly_name,dateUpdated:w.date_updated,dateCreated:w.date_created,uniqueName:w.unique_name,createdBy:w.created_by,attributes:w.attributes,channel:"".concat(f,".channel"),sid:f},F.abrupt("return",this._upsertConversation("sync",f,S));case 7:case"end":return F.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"_getMap",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.services.syncClient.map({id:this.configuration.myConversations,mode:"open_existing"});case 2:return g.abrupt("return",g.sent);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_wrapPaginator",value:function(){var v=B.default(A.default.mark(function p(f,g){var h=this,w;return A.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,g(f.items);case 2:return w=j.sent,j.abrupt("return",{items:w,hasNextPage:f.hasNextPage,hasPrevPage:f.hasPrevPage,nextPage:function(){return f.nextPage().then(function(z){return h._wrapPaginator(z,g)})},prevPage:function(){return f.prevPage().then(function(z){return h._wrapPaginator(z,g)})}});case 4:case"end":return j.stop()}},p)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"_updateConversation",value:function(){var v=B.default(A.default.mark(function p(f,g,h){var w=this,S,j,F;return A.default.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(S=g._statusSource()!==void 0&&f!==g._statusSource(),j=f!=="rest"||g._statusSource()==="sync",!(S&&j&&f!=="sync")){pe.next=5;break}return $r.trace("upsertConversation: conversation is known from sync and came from chat, ignoring",{sid:g.sid,data:h.status,conversation:g.status}),pe.abrupt("return");case 5:if(!(h.status==="joined"&&g.status!=="joined")){pe.next=13;break}return g._setStatus("joined",f),F={},typeof h.notificationLevel<"u"&&(F.notificationLevel=h.notificationLevel),typeof h.lastConsumedMessageIndex<"u"&&(F.lastConsumedMessageIndex=h.lastConsumedMessageIndex),ze.default(F,{})||g._update(F),g._subscribe().then(function(){w.emit("conversationJoined",g)}),pe.abrupt("return");case 13:if(!(h.status==="notParticipating"&&g.status==="joined")){pe.next=20;break}return g._setStatus("notParticipating",f),g._update(h),pe.next=18,g._subscribe();case 18:return this.emit("conversationLeft",g),pe.abrupt("return");case 20:if(h.status!=="notParticipating"){pe.next=24;break}return pe.next=23,g._subscribe();case 23:return pe.abrupt("return");case 24:g._update(h);case 25:case"end":return pe.stop()}},p,this)}));function l(p,f,g){return v.apply(this,arguments)}return l}()},{key:"_upsertConversation",value:function(){var v=B.default(A.default.mark(function p(f,g,h){var w,S,j,F;return A.default.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if($r.trace("upsertConversation called for ".concat(g),h),w=this.conversations.get(g),!w){pe.next=9;break}return $r.trace("upsertConversation: the conversation ".concat(w.sid," is known;")+"its status is known from the source ".concat(w._statusSource()," ")+"and the update came from the source ".concat(f),w),pe.next=6,this._updateConversation(f,w,h);case 6:return pe.next=8,w._subscribe();case 8:return pe.abrupt("return",w);case 9:if(!(["chat","rest"].includes(f)&&this.tombstones.has(g))){pe.next=12;break}return $r.trace("upsertChannel: the channel is deleted but reappeared again from chat, ignoring",g),pe.abrupt("return",null);case 12:return $r.trace("upsertConversation: creating a local conversation object with sid "+g,h),S="".concat(this.configuration.links.conversations,"/").concat(g),j={self:S,messages:"".concat(S,"/Messages"),participants:"".concat(S,"/Participants")},F=new _t(h,g,j,this.configuration,this.services),this.conversations.set(g,F),pe.next=19,F._subscribe();case 19:return this._registerForEvents(F),this.emit("conversationAdded",F),h.status==="joined"&&(F._setStatus("joined",f),this.emit("conversationJoined",F)),pe.abrupt("return",F);case 23:case"end":return pe.stop()}},p,this)}));function l(p,f,g){return v.apply(this,arguments)}return l}()},{key:"_fetchMyConversations",value:function(){var v=B.default(A.default.mark(function p(){var f,g,h,w,S,j;return A.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:f=[],g=null;case 2:return w=new Me(this.configuration.links.myConversations),g&&w.arg("PageToken",g),z.next=6,this.services.network.get(w.build());case 6:S=z.sent,j=(h=S.body)===null||h===void 0?void 0:h.conversations.map(function(pe){return{descriptor:pe,channel_sid:pe.conversation_sid,status:pe.status,channel:pe.sync_objects.conversation,messages:pe.sync_objects.messages,roster:"".concat(pe.conversation_sid,".roster"),lastConsumedMessageIndex:pe.last_read_message_index,notificationLevel:pe.notification_level}}),g=S.body.meta.next_token,f=[].concat(G.default(f),G.default(j));case 10:if(g){z.next=2;break}case 11:return z.abrupt("return",f);case 12:case"end":return z.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_onConversationRemoved",value:function(l){var p=this.conversations.get(l);p&&(this.conversations.delete(l),this.emit("conversationRemoved",p))}},{key:"_registerForEvents",value:function(l){var p=this;l.on("removed",function(){return p._onConversationRemoved(l.sid)}),l.on("updated",function(f){return p.emit("conversationUpdated",f)}),l.on("participantJoined",function(f){return p.emit("participantJoined",f)}),l.on("participantLeft",function(f){return p.emit("participantLeft",f)}),l.on("participantUpdated",function(f){return p.emit("participantUpdated",f)}),l.on("messageAdded",function(f){return p.emit("messageAdded",f)}),l.on("messageUpdated",function(f){return p.emit("messageUpdated",f)}),l.on("messageRemoved",function(f){return p.emit("messageRemoved",f)}),l.on("typingStarted",function(f){return p.emit("typingStarted",f)}),l.on("typingEnded",function(f){return p.emit("typingEnded",f)})}}]),m}(T.ReplayEventEmitter);function Ro(I){var M=Oo();return function(){var v=ne.default(I),l;if(M){var p=ne.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function Oo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ao=function(I){se.default(m,I);var M=Ro(m);function m(v,l,p){var f;return me.default(this,m),f=M.call(this),f.configuration=l,f.services=p,f.fifoStack=[],f.myself=v,f.myself.on("updated",function(g){return f.emit("userUpdated",g)}),f.myself.on("userSubscribed",function(){return f.emit("userSubscribed",f.myself)}),f.myself.on("userUnsubscribed",function(){f.emit("userUnsubscribed",f.myself),f.myself._ensureFetched()}),f.subscribedUsers=new Map,f}return ke.default(m,[{key:"handleUnsubscribeUser",value:function(l){this.subscribedUsers.has(l.identity)&&this.subscribedUsers.delete(l.identity);var p=0,f=this.fifoStack.find(function(g,h){return g==l.identity?(p=h,!0):!1});f&&this.fifoStack.splice(p,1),this.emit("userUnsubscribed",l)}},{key:"handleSubscribeUser",value:function(l){if(!this.subscribedUsers.has(l.identity)){if(this.fifoStack.length>=this.configuration.userInfosToSubscribe){var p,f,g=this.fifoStack.shift();(p=this.subscribedUsers)===null||p===void 0||(f=p.get(g))===null||f===void 0||f.unsubscribe()}this.fifoStack.push(l.identity),this.subscribedUsers.set(l.identity,l),this.emit("userSubscribed",l)}}},{key:"getUser",value:function(){var v=B.default(A.default.mark(function p(){var f=this,g,h,w,S,j=arguments;return A.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return g=j.length>0&&j[0]!==void 0?j[0]:"",h=j.length>1&&j[1]!==void 0?j[1]:"",z.next=4,this.myself._ensureFetched();case 4:if(g!=this.myself.identity){z.next=6;break}return z.abrupt("return",this.myself);case 6:if(w=this.subscribedUsers.get(g),!w){z.next=9;break}return z.abrupt("return",w);case 9:if(z.t0=h,z.t0){z.next=14;break}return z.next=13,this.getSyncUniqueName(g);case 13:z.t0=z.sent;case 14:return h=z.t0,S=new et(g,h,this.configuration,this.services),S.on("updated",function(pe){return f.emit("userUpdated",pe)}),S.on("userSubscribed",function(){return f.handleSubscribeUser(S)}),S.on("userUnsubscribed",function(){return f.handleUnsubscribeUser(S)}),z.next=21,S._ensureFetched();case 21:return z.abrupt("return",S);case 22:case"end":return z.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getSubscribedUsers",value:function(){var v=B.default(A.default.mark(function p(){var f;return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.myself._ensureFetched();case 2:return f=[this.myself],this.subscribedUsers.forEach(function(w){return f.push(w)}),h.abrupt("return",f);case 5:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getSyncUniqueName",value:function(){var v=B.default(A.default.mark(function p(f){var g,h,w,S;return A.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return w=new Me(this.configuration.links.users).path(f).build(),F.next=3,this.services.network.get(w);case 3:return S=F.sent,F.abrupt("return",(g=(h=S.body)===null||h===void 0?void 0:h.sync_objects.user_info_map)!==null&&g!==void 0?g:"");case 5:case"end":return F.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()}]),m}(T.ReplayEventEmitter),ki=Z.scope("TypingIndicator"),Ti=function(){function I(M,m,v){me.default(this,I),this.configuration=m,this.services=v,this.getConversation=M,this.serviceTypingTimeout=null,this.sentUpdates=new Map}return ke.default(I,[{key:"typingTimeout",get:function(){return this.configuration.typingIndicatorTimeoutOverride||this.serviceTypingTimeout||this.configuration.typingIndicatorTimeoutDefault}},{key:"initialize",value:function(){var m=this;this.services.notificationClient.on("message",function(){var v=B.default(A.default.mark(function l(p,f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(p!==bt.TYPING_INDICATOR){h.next=3;break}return h.next=3,m._handleRemoteTyping(f);case 3:case"end":return h.stop()}},l)}));return function(l,p){return v.apply(this,arguments)}}())}},{key:"_handleRemoteTyping",value:function(){var M=B.default(A.default.mark(function v(l){var p=this;return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:ki.trace("Got new typing indicator ",l),this.getConversation(l.channel_sid).then(function(h){!h||h.participants.forEach(function(w){if(w.identity===l.identity){var S=p.configuration.typingIndicatorTimeoutOverride?p.configuration.typingIndicatorTimeoutOverride+1e3:l.typing_timeout*1e3;w._startTyping(S)}})}).catch(function(h){throw ki.error(h),h});case 2:case"end":return g.stop()}},v,this)}));function m(v){return M.apply(this,arguments)}return m}()},{key:"send",value:function(m){var v=this.sentUpdates.get(m);return v&&v>Date.now()-this.typingTimeout?Promise.resolve():(this.sentUpdates.set(m,Date.now()),this._send(m))}},{key:"_send",value:function(m){var v=this;ki.trace("Sending typing indicator");var l=this.configuration.links.typing,p={"Content-Type":"application/x-www-form-urlencoded"},f="ChannelSid=".concat(m);return this.services.twilsockClient.post(l,p,f,this.configuration.productId).then(function(g){g.body.hasOwnProperty("typing_timeout")&&(v.serviceTypingTimeout=g.body.typing_timeout*1e3)}).catch(function(g){throw ki.error("Failed to send typing indicator:",g),g})}}]),I}(),Ei=function I(M){me.default(this,I),this.title=M.title||null,this.body=M.body||null,this.sound=M.sound||null,this.badge=M.badge||null,this.action=M.action||null,this.type=M.type||null,this.data=M.data||{}},gn="2.1.0";function ha(I,M){var m=Object.keys(I);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(I);M&&(v=v.filter(function(l){return Object.getOwnPropertyDescriptor(I,l).enumerable})),m.push.apply(m,v)}return m}function ds(I){for(var M=1;M<arguments.length;M++){var m=arguments[M]!=null?arguments[M]:{};M%2?ha(Object(m),!0).forEach(function(v){te.default(I,v,m[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(m)):ha(Object(m)).forEach(function(v){Object.defineProperty(I,v,Object.getOwnPropertyDescriptor(m,v))})}return I}var ps=function(M){return M.replace(/(^\/+|\/+$)/g,"")},Po=function(M){return M.status.code===202},Mo=function(){function I(M,m,v){me.default(this,I),this._serviceUrl=M,this._services=m,this._productId=v}return ke.default(I,[{key:"_preProcessUrl",value:function(m){var v=ps(m);return/^https?:\/\//.test(m)?v:"".concat(ps(this._serviceUrl),"/").concat(v)}},{key:"_makeRequest",value:function(){var M=B.default(A.default.mark(function v(l,p,f,g){var h,w,S,j;return A.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:h=this._preProcessUrl(p),w=ds({"Content-Type":"application/json; charset=utf-8"},g||{}),z.t0=l,z.next=z.t0==="get"?5:z.t0==="post"?11:z.t0==="delete"?15:19;break;case 5:return j=h,f&&(j+="?"+Object.entries(f).map(function(pe){return pe.map(encodeURIComponent).join("=")}).join("&")),z.next=9,this._services.transport.get(j,w,this._productId);case 9:return S=z.sent,z.abrupt("break",19);case 11:return z.next=13,this._services.transport.post(h,w,JSON.stringify(f),this._productId);case 13:return S=z.sent,z.abrupt("break",19);case 15:return z.next=17,this._services.transport.delete(h,w,{},this._productId);case 17:return S=z.sent,z.abrupt("break",19);case 19:if(!(S.status.code<200||S.status.code>=300)){z.next=21;break}throw new Error("Request responded with a non-success code ".concat(S.status.code));case 21:return z.abrupt("return",S);case 22:case"end":return z.stop()}},v,this)}));function m(v,l,p,f){return M.apply(this,arguments)}return m}()},{key:"fetchResource",value:function(){var M=B.default(A.default.mark(function v(l,p){var f=this,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return g=6,S.prev=1,S.next=4,new D.AsyncRetrier({min:50,max:1600,maxAttemptsCount:g}).run(function(){return f._makeRequest("get",l,p)});case 4:return h=S.sent,S.abrupt("return",h.body);case 8:throw S.prev=8,S.t0=S.catch(1),new Error('Fetch resource from "'.concat(l,'" failed.'));case 11:case"end":return S.stop()}},v,null,[[1,8]])}));function m(v,l){return M.apply(this,arguments)}return m}()},{key:"mutateResource",value:function(){var M=B.default(A.default.mark(function v(l,p,f){var g;return A.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._makeRequest(l,p,f,{"X-Twilio-Mutation-Id":Ie.v4()});case 2:if(g=w.sent,!Po(g)){w.next=7;break}return w.next=6,this.fetchResource(g.body.resource_url);case 6:return w.abrupt("return",w.sent);case 7:return w.abrupt("return",g.body);case 8:case"end":return w.stop()}},v,this)}));function m(v,l,p){return M.apply(this,arguments)}return m}()}]),I}(),St,va;function hs(I,M){var m=Object.keys(I);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(I);M&&(v=v.filter(function(l){return Object.getOwnPropertyDescriptor(I,l).enumerable})),m.push.apply(m,v)}return m}function Ci(I){for(var M=1;M<arguments.length;M++){var m=arguments[M]!=null?arguments[M]:{};M%2?hs(Object(m),!0).forEach(function(v){te.default(I,v,m[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(m)):hs(Object(m)).forEach(function(v){Object.defineProperty(I,v,Object.getOwnPropertyDescriptor(m,v))})}return I}function ga(I){var M=Qn();return function(){var v=ne.default(I),l;if(M){var p=ne.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function Qn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Rt,Jr=Z.scope("Client"),ya=gn,Yr=function I(){me.default(this,I)};e.Client=Rt=(va=St=function(I){se.default(m,I);var M=ga(m);function m(v){var l,p,f,g,h,w,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(me.default(this,m),w=M.call(this),te.default(Se.default(w),"connectionState","unknown"),te.default(Se.default(w),"version",ya),te.default(Se.default(w),"parsePushNotification",Rt.parsePushNotification),w.fpaToken=v!=null?v:"",w.options=S!=null?S:{},!w.options.disableDeepClone){var j=Ci(Ci({},w.options),{},{transport:void 0,twilsockClient:void 0});j=ye(j),j.transport=w.options.transport,j.twilsockClient=w.options.twilsockClient,w.options=j}w.options.logLevel=(l=w.options.logLevel)!==null&&l!==void 0?l:"silent",Jr.setLevel(w.options.logLevel);var F=w.options.productId="ip_messaging";if(w.options.clientMetadata=w.options.clientMetadata||{},w.options.clientMetadata.hasOwnProperty("type")||(w.options.clientMetadata.type="conversations"),w.options.clientMetadata.hasOwnProperty("sdk")||(w.options.clientMetadata.sdk="JS",w.options.clientMetadata.sdkv=ya),w.options.Sync=w.options.Sync||{},typeof w.options.Sync.enableSessionStorage>"u"&&(w.options.Sync.enableSessionStorage=!0),w.options.region&&(w.options.Sync.region=w.options.region),!v)throw new Error("A valid Twilio token should be provided");w.services=new Yr,w._myself=new et("","",null,w.services);var z=!w.options.twilsockClient;if(!w.options.initRegistrations){var pe=new H.InitRegistration(F);Rt.populateInitRegistrations(pe),w.options.initRegistrations=[pe]}w.services.twilsockClient=w.options.twilsockClient=(p=w.options.twilsockClient)!==null&&p!==void 0?p:new H.TwilsockClient(v,F,w.options),w.services.twilsockClient.on("tokenAboutToExpire",function(Or){return w.emit("tokenAboutToExpire",Or)}),w.services.twilsockClient.on("tokenExpired",function(){return w.emit("tokenExpired")}),w.services.twilsockClient.on("connectionError",function(Or){return w.emit("connectionError",Or)}),w.services.twilsockClient.on("stateChanged",function(Or){Jr.debug("Handling stateChanged for ConversationsClient: new state ".concat(Or)),Or!==w.connectionState&&(w.connectionState=Or,w.emit("connectionStateChanged",w.connectionState))}),w.services.transport=w.options.transport=(f=w.options.transport)!==null&&f!==void 0?f:w.options.twilsockClient,w.services.notificationClient=w.options.notificationsClient=(g=w.options.notificationsClient)!==null&&g!==void 0?g:new ve.Notifications(v,w.options),w.services.syncClient=w.options.syncClient=(h=w.options.syncClient)!==null&&h!==void 0?h:new ae.SyncClient(v,w.options);var qe=(S==null?void 0:S.Chat)||(S==null?void 0:S.IPMessaging)||S||{},it=qe.region||(S==null?void 0:S.region),We=qe.apiUri||qe.typingUri||"https://aim.".concat(it||"us1",".twilio.com");w.services.commandExecutor=new Mo(We,{transport:w.options.transport},F);var st=function(O){w._rejectEnsureReady(O),w.emit("stateChanged","failed")};return w.services.twilsockClient.once("connectionError",st),w.services.twilsockClient.once("disconnected",st),w.services.twilsockClient.once("connected",B.default(A.default.mark(function Or(){var O;return A.default.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return Jr.debug("ConversationsClient started INITIALIZING"),w.services.twilsockClient.off("connectionError",st),w.services.twilsockClient.off("disconnected",st),fe.prev=3,O="conversations.client.startup",w.services.twilsockClient.addPartialTelemetryEvent(new H.TelemetryEventDescription(O,"Conversations client startup",new Date),O,H.TelemetryPoint.Start),fe.next=8,w._initialize();case 8:w.services.twilsockClient.addPartialTelemetryEvent(new H.TelemetryEventDescription("","",new Date),O,H.TelemetryPoint.End),fe.next=15;break;case 11:fe.prev=11,fe.t0=fe.catch(3),w._rejectEnsureReady(fe.t0),w.emit("stateChanged","failed");case 15:case"end":return fe.stop()}},Or,null,[[3,11]])}))),w._ensureReady=new Promise(function(Or,O){w._resolveEnsureReady=Or,w._rejectEnsureReady=O}).catch(function(){}),z&&w.services.twilsockClient.connect(),w}return ke.default(m,[{key:"user",get:function(){return this._myself}},{key:"reachabilityEnabled",get:function(){if(!this.configuration)throw new Error("Reachability information could not yet be accessed as the client has not yet been initialized. Subscribe to the 'stateChanged' event to properly react to the client initialization.");return this.configuration.reachabilityEnabled}},{key:"token",get:function(){return this.fpaToken}},{key:"_subscribeToPushNotifications",value:function(l){var p=this;[bt.NEW_MESSAGE,bt.ADDED_TO_CONVERSATION,bt.REMOVED_FROM_CONVERSATION,bt.TYPING_INDICATOR,bt.CONSUMPTION_UPDATE].forEach(function(f){p.services.notificationClient.subscribe(l,f)})}},{key:"_unsubscribeFromPushNotifications",value:function(l){var p=this;[bt.NEW_MESSAGE,bt.ADDED_TO_CONVERSATION,bt.REMOVED_FROM_CONVERSATION,bt.TYPING_INDICATOR,bt.CONSUMPTION_UPDATE].forEach(function(f){p.services.notificationClient.unsubscribe(l,f)})}},{key:"_initialize",value:function(){var v=B.default(A.default.mark(function p(){var f=this,g;return A.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.services.commandExecutor.fetchResource("Client/v2/Configuration");case 2:return g=w.sent,this.configuration=new de(this.options,g,Jr),this._myself._resolveInitialization(this.configuration,this.configuration.userIdentity,this.configuration.userInfo,!0),this.services.typingIndicator=new Ti(this.getConversationBySid.bind(this),this.configuration,this.services),this.services.network=new Ir(this.configuration,this.services),this.services.users=new Ao(this._myself,this.configuration,this.services),this.services.users.on("userSubscribed",function(S){f.emit("userSubscribed",S)}),this.services.users.on("userUpdated",function(S){return f.emit("userUpdated",S)}),this.services.users.on("userUnsubscribed",function(S){f.emit("userUnsubscribed",S)}),this.conversations=new Io(this.configuration,this.services),this.conversations.on("conversationAdded",function(S){f.emit("conversationAdded",S)}),this.conversations.on("conversationRemoved",function(S){f.emit("conversationRemoved",S)}),this.conversations.on("conversationJoined",function(S){f.emit("conversationJoined",S)}),this.conversations.on("conversationLeft",function(S){f.emit("conversationLeft",S)}),this.conversations.on("conversationUpdated",function(S){return f.emit("conversationUpdated",S)}),this.conversations.on("participantJoined",function(S){f.emit("participantJoined",S)}),this.conversations.on("participantLeft",function(S){f.emit("participantLeft",S)}),this.conversations.on("participantUpdated",function(S){return f.emit("participantUpdated",S)}),this.conversations.on("messageAdded",function(S){return f.emit("messageAdded",S)}),this.conversations.on("messageUpdated",function(S){return f.emit("messageUpdated",S)}),this.conversations.on("messageRemoved",function(S){return f.emit("messageRemoved",S)}),this.conversations.on("typingStarted",function(S){return f.emit("typingStarted",S)}),this.conversations.on("typingEnded",function(S){return f.emit("typingEnded",S)}),this.conversationsPromise=this.conversations.fetchConversations().then(function(){return f.conversations}).catch(function(S){throw S}),w.next=28,this.services.users.myself._ensureFetched();case 28:Rt.supportedPushChannels.forEach(function(S){return f._subscribeToPushNotifications(S)}),this.services.typingIndicator.initialize(),this.services.mcsClient=new Ae.McsClient(this.fpaToken,this.configuration.links.mediaService,this.configuration.links.mediaSetService,Ci(Ci({},this.options),{},{transport:void 0})),this._resolveEnsureReady(),this.emit("stateChanged","initialized");case 33:case"end":return w.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"shutdown",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._ensureReady;case 2:return g.next=4,this.services.twilsockClient.disconnect();case 4:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"updateToken",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:if(Jr.info("updateToken"),this.fpaToken!==f){h.next=5;break}return h.abrupt("return",this);case 5:return h.next=7,this.services.twilsockClient.updateToken(f);case 7:return h.next=9,this.services.notificationClient.updateToken(f);case 9:return h.next=11,this.services.mcsClient.updateToken(f);case 11:return this.fpaToken=f,h.abrupt("return",this);case 13:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getConversationBySid",value:function(){var v=B.default(A.default.mark(function p(f){var g;return A.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._ensureReady;case 2:return w.next=4,this.conversations.myConversationsRead.promise;case 4:return w.next=6,this.conversations.getConversation(f);case 6:if(g=w.sent,g){w.next=11;break}return w.next=10,this.conversations.peekConversation(f);case 10:g=w.sent;case 11:if(g){w.next=13;break}throw new Error("Conversation with SID ".concat(f," is not found."));case 13:return w.abrupt("return",g);case 14:case"end":return w.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getConversationByUniqueName",value:function(){var v=B.default(A.default.mark(function p(f){var g;return A.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._ensureReady;case 2:return w.next=4,this.conversations.myConversationsRead.promise;case 4:return w.next=6,this.conversations.getConversationByUniqueName(f);case 6:if(g=w.sent,g){w.next=9;break}throw new Error("Conversation with unique name ".concat(f," is not found."));case 9:return w.abrupt("return",g);case 10:case"end":return w.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getSubscribedConversations",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._ensureReady;case 2:return g.abrupt("return",this.conversationsPromise.then(function(h){return h.getConversations()}));case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"createConversation",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:return f=f||{},h.abrupt("return",this.conversationsPromise.then(function(w){return w.addConversation(f)}));case 4:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"setPushRegistrationId",value:function(){var v=B.default(A.default.mark(function p(f,g){return A.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._ensureReady;case 2:return this._subscribeToPushNotifications(f),this.services.notificationClient.setPushRegistrationId(f,g),w.next=6,this.services.notificationClient.commitChanges();case 6:case"end":return w.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"unsetPushRegistrationId",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:return this._unsubscribeFromPushNotifications(f),h.next=5,this.services.notificationClient.commitChanges();case 5:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"removePushRegistrations",value:function(){var v=B.default(A.default.mark(function p(f,g){return A.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.services.notificationClient.removeRegistrations(f,g);case 2:case"end":return w.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"handlePushNotification",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:Jr.debug("handlePushNotification, notificationPayload=",f),this.emit("pushNotification",Rt.parsePushNotification(f));case 4:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getUser",value:function(){var v=B.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:return h.abrupt("return",this.services.users.getUser(f));case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getSubscribedUsers",value:function(){var v=B.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._ensureReady;case 2:return g.abrupt("return",this.services.users.getSubscribedUsers());case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()}],[{key:"populateInitRegistrations",value:function(l){l.populateInitRegistrations([bt.TYPING_INDICATOR]),ae.SyncClient.populateInitRegistrations(l)}},{key:"create",value:function(){var v=B.default(A.default.mark(function p(f,g){var h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(g!=null&&g.twilsockClient)){S.next=2;break}throw new Error("Obsolete usage of ConversationsClient.create() factory method: if you pass twilsock from the outside then you must use ConversationsClient constructor and be prepared to work with uninitialized client.");case 2:return h=new Rt(f,g),S.next=5,h._ensureReady;case 5:return S.abrupt("return",h);case 6:case"end":return S.stop()}},p)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"parsePushNotificationChatData",value:function(l){var p={};for(var f in Rt.supportedPushDataFields)if(!(typeof l[f]>"u"||l[f]===null)){if(f!=="message_index"){p[Rt.supportedPushDataFields[f]]=l[f];continue}Ce(l[f])!==null&&(p[Rt.supportedPushDataFields[f]]=Number(l[f]))}return p}},{key:"parsePushNotification",value:function(l){if(Jr.debug("parsePushNotification, notificationPayload=",l),typeof l.aps<"u"){if(!l.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var p=Rt.parsePushNotificationChatData(l),f=l.aps,g,h=null;return typeof f.alert=="string"?g=f.alert||null:(g=f.alert.body||null,h=f.alert.title||null),new Ei({title:h,body:g,sound:f.sound||null,badge:f.badge||null,action:f.category||null,type:l.twi_message_type,data:p})}if(typeof l.data<"u"){var w=l.data;if(!w.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var S=Rt.parsePushNotificationChatData(l.data);return new Ei({title:w.twi_title||null,body:w.twi_body||null,sound:w.twi_sound||null,badge:null,action:w.twi_action||null,type:w.twi_message_type,data:S})}throw new Error("Provided push notification payload is not Programmable Chat notification")}}]),m}(T.ReplayEventEmitter),te.default(St,"version",ya),te.default(St,"supportedPushChannels",["fcm","apn"]),te.default(St,"supportedPushDataFields",{conversation_sid:"conversationSid",message_sid:"messageSid",message_index:"messageIndex"}),te.default(St,"conversationAdded","conversationAdded"),te.default(St,"conversationJoined","conversationJoined"),te.default(St,"conversationLeft","conversationLeft"),te.default(St,"conversationRemoved","conversationRemoved"),te.default(St,"conversationUpdated","conversationUpdated"),te.default(St,"participantJoined","participantJoined"),te.default(St,"participantLeft","participantLeft"),te.default(St,"participantUpdated","participantUpdated"),te.default(St,"messageAdded","messageAdded"),te.default(St,"messageRemoved","messageRemoved"),te.default(St,"messageUpdated","messageUpdated"),te.default(St,"tokenAboutToExpire","tokenAboutToExpire"),te.default(St,"tokenExpired","tokenExpired"),te.default(St,"typingEnded","typingEnded"),te.default(St,"typingStarted","typingStarted"),te.default(St,"pushNotification","pushNotification"),te.default(St,"userSubscribed","userSubscribed"),te.default(St,"userUnsubscribed","userUnsubscribed"),te.default(St,"userUpdated","userUpdated"),te.default(St,"stateChanged","stateChanged"),te.default(St,"connectionStateChanged","connectionStateChanged"),te.default(St,"connectionError","connectionError"),va),J([b.validateTypesAsync(b.nonEmptyString),k("design:type",Function),k("design:paramtypes",[String]),k("design:returntype",Promise)],e.Client.prototype,"updateToken",null),J([b.validateTypesAsync(b.nonEmptyString),k("design:type",Function),k("design:paramtypes",[String]),k("design:returntype",Promise)],e.Client.prototype,"getConversationBySid",null),J([b.validateTypesAsync(b.nonEmptyString),k("design:type",Function),k("design:paramtypes",[String]),k("design:returntype",Promise)],e.Client.prototype,"getConversationByUniqueName",null),J([b.validateTypesAsync(["undefined",b.objectSchema("conversation options",{friendlyName:["string","undefined"],isPrivate:["boolean","undefined"],uniqueName:["string","undefined"]})]),k("design:type",Function),k("design:paramtypes",[Object]),k("design:returntype",Promise)],e.Client.prototype,"createConversation",null),J([b.validateTypesAsync(b.literal("fcm","apn"),"string"),k("design:type",Function),k("design:paramtypes",[String,String]),k("design:returntype",Promise)],e.Client.prototype,"setPushRegistrationId",null),J([b.validateTypesAsync(b.literal("fcm","apn")),k("design:type",Function),k("design:paramtypes",[String]),k("design:returntype",Promise)],e.Client.prototype,"unsetPushRegistrationId",null),J([b.validateTypesAsync(b.literal("fcm","apn"),b.nonEmptyString),k("design:type",Function),k("design:paramtypes",[String,String]),k("design:returntype",Promise)],e.Client.prototype,"removePushRegistrations",null),J([b.validateTypesAsync(b.pureObject),k("design:type",Function),k("design:paramtypes",[Object]),k("design:returntype",Promise)],e.Client.prototype,"handlePushNotification",null),J([b.validateTypesAsync(b.nonEmptyString),k("design:type",Function),k("design:paramtypes",[String]),k("design:returntype",Promise)],e.Client.prototype,"getUser",null),J([b.validateTypesAsync("string",["undefined",b.pureObject]),k("design:type",Function),k("design:paramtypes",[String,Object]),k("design:returntype",Promise)],e.Client,"create",null),J([b.validateTypes(b.pureObject),k("design:type",Function),k("design:paramtypes",[Object]),k("design:returntype",Ei)],e.Client,"parsePushNotification",null),e.Client=Rt=J([b.validateConstructorTypes(b.nonEmptyString,[b.pureObject,"undefined"]),k("design:paramtypes",[String,Object])],e.Client),e.AggregatedDeliveryReceipt=Xe,e.Conversation=_t,e.DetailedDeliveryReceipt=tt,e.Media=Pe,e.Message=Wt,e.MessageBuilder=pa,e.NotificationTypes=bt,e.Participant=Y,e.PushNotification=Ei,e.RestPaginator=at,e.UnsentMessage=Rr,e.User=et})(W$);async function yY(e){try{let t=`/conversations/conversation-message-media-url?mediaSid=${e}`;const r=await fetch(t,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(r.ok)return(await r.json()).contentUrl}catch(t){console.log("getMediaUrl error => ",t)}}const mY={props:["author","content","dateCreated","cSid","participant","mSid","pSid","media","mAttributes"],setup(e){const t=e.author,r=e.content,n=e.media,i=e.dateCreated,a=e.cSid,s=e.mSid,u=e.pSid,o=e.mAttributes,c=e.participant,d=Ve(!1),y=Ve("/placeholder.png"),_=Jt(()=>Object.keys(o).length===0?!1:!!(o.mType!==void 0&&o.mType.startsWith("chatButton"))),b=Jt(()=>!!(c!=null&&c.enduser!=null&&c.enduser||(t.startsWith("+")||t.startsWith("whatsapp"))&&!c.agent||o.mType!==void 0&&o.mType==="clientChat")),T=Jt(()=>!!(c!=null&&c.chat!=null&&c.chat||o.mType!==void 0&&o.mType==="agentChat"||o.mType!==void 0&&o.mType==="clientChat")),x=Jt(()=>t===a),N=Jt(()=>!!(c!=null&&c.agent!=null&&c.agent||o.mType!==void 0&&o.agentMessage===!0)),D=Jt(()=>!!(c!=null&&c.sms!=null&&c.sms||t.startsWith("+"))),H=Jt(()=>!!(c!=null&&c.whatsapp!=null&&c.whatsapp||t.startsWith("whatsapp"))),ve=Jt(()=>r===null&&n!==null);return uo(async()=>{if(r===null&&n!==null){let ae=null,Ae=mt(n);Ae[0]!==void 0?ae=Ae[0].sid:Ae.state!==void 0&&(ae=Ae.state.sid),ae!=null&&(y.value=await yY(ae))}}),{author:t,content:r,dateCreated:i,participant:c,mSid:s,pSid:u,isMedia:ve,mAttributes:o,imageUrl:y,isChatButton:_,isSms:D,isChat:T,isCustomer:b,isBot:x,isWhatsapp:H,isAgent:N,formatDate:q$,formatAuthor:H$,confirmDelete:d}}},bY=e=>(CC("data-v-653b2835"),e=e(),IC(),e),wY={key:0,class:""},_Y={key:1},SY=["src"],$Y={class:"mt-1"},kY={class:"fst-italic"},TY=bY(()=>R("i",{class:"bi-trash"},null,-1)),EY=[TY],CY={key:1,class:"button-message text-start mb-4 p-4"},IY={key:0},RY=yI('<div class="mb-4" data-v-653b2835><div class="mb-4" data-v-653b2835><p class="text-secondary" data-v-653b2835>Item out of stock:</p><img class="product-image" src="https://images.albertsons-media.com/is/image/ABS/960041097-ECOM?$ng-ecom-pdp-tn$&amp;defaultImage=Not_Available" data-v-653b2835><p class="p-4 d-inline" data-v-653b2835>Pepperidge Farm Goldfish Cheddar Cheese Crackers - 9-1 Oz</p></div><div class="mb-2" data-v-653b2835><p class="text-secondary" data-v-653b2835>Substitute with:</p><img class="product-image" src="https://images.albertsons-media.com/is/image/ABS/960049994?$ng-ecom-pdp-tn$&amp;defaultImage=Not_Available" data-v-653b2835><p class="p-4 d-inline" data-v-653b2835>Pepperidge Farm Goldfish Cheddar Cheese Crackers - 30 Oz</p></div></div>',1),OY={key:0,class:"btn-group d-flex",role:"group","aria-label":"..."},AY=["onClick"],PY={key:1},MY={class:"fst-italic"};function NY(e,t,r,n,i,a){return He(),Ye("div",null,[n.isChatButton?nr("",!0):(He(),Ye("div",{key:0,class:La(["text-start mb-2",{"text-start":n.isCustomer,"text-end":!n.isCustomer}])},[R("span",{class:La(["message fs-4 badge text-wrap",{"text-start":n.isCustomer,"text-end":!n.isCustomer,customer:n.isCustomer,agent:n.isAgent,"bg-secondary":n.isBot}])},[n.isMedia?nr("",!0):(He(),Ye("span",wY,Bt(n.content),1)),n.isMedia?(He(),Ye("span",_Y,[R("img",{src:n.imageUrl,style:{"max-height":"300px","max-width":"300px"},class:"img-fluid rounded"},null,8,SY)])):nr("",!0)],2),R("p",$Y,[R("small",null,[R("span",kY,Bt(n.author)+" - "+Bt(n.formatDate(n.dateCreated)),1),rt(R("button",{onClick:t[0]||(t[0]=s=>n.confirmDelete=!0),class:"btn btn-link"},EY,512),[[dt,!n.confirmDelete&&!n.isCustomer]]),rt(R("button",{onClick:t[1]||(t[1]=s=>e.$emit("removeMessage",n.mSid)),class:"btn btn-danger ms-2 me-2"},"Delete?",512),[[dt,n.confirmDelete]]),rt(R("button",{onClick:t[2]||(t[2]=s=>n.confirmDelete=!1),class:"btn btn-light"},"Cancel",512),[[dt,n.confirmDelete]])])])],2)),n.isChatButton?(He(),Ye("div",CY,[n.mAttributes.mType==="chatButton"?(He(),Ye("div",IY,[R("h5",null,Bt(n.mAttributes.question),1),RY,n.mAttributes.showButtons!==!1?(He(),Ye("div",OY,[(He(!0),Ye(Ht,null,wn(n.mAttributes.options,s=>(He(),Ye("button",{disabled:"",onClick:u=>e.answerQuestion(n.mAttributes.id,n.mAttributes.question,s.value,s.style),key:s.value,class:La(["border btn",[s.style]])},Bt(s.label),11,AY))),128))])):nr("",!0)])):nr("",!0),n.mAttributes.mType==="chatButtonResponse"?(He(),Ye("div",PY,[R("h5",null,[R("span",MY,Bt(n.mAttributes.title),1),Qe(" "+Bt(n.mAttributes.person)+" replied: ",1),R("button",{disabled:"",class:La(["btn",[n.mAttributes.style]])},Bt(n.mAttributes.answer),3)])])):nr("",!0)])):nr("",!0)])}const xY=Wn(mY,[["render",NY],["__scopeId","data-v-653b2835"]]),LY={class:"container"},jY={class:"row row-height mt-2"},UY={class:"col-3"},DY={class:"alert alert-primary"},FY=R("i",{class:"bi-pencil"},null,-1),BY=[FY],qY={class:"input-group"},HY=R("i",{class:"bi-pencil"},null,-1),WY=[HY],GY={key:1,class:"alert-heading"},zY=R("span",{class:"fst-italic"},"no name...",-1),VY=[zY],KY={key:0},JY={class:"alert alert-info text-center"},YY=R("h5",{class:"alert-heading"},"Not in Conversation",-1),QY=R("p",null,"You are not a participant in this conversation",-1),XY=R("hr",null,null,-1),ZY=R("i",{class:"bi-person-plus"},null,-1),eQ=Qe(" Join"),tQ=[ZY,eQ],rQ={class:"list-group mb-3"},nQ=R("li",{class:"list-group-item list-group-item-secondary"},[Qe("Chat Agents "),R("i",{class:"bi-people"})],-1),iQ=["onClick"],aQ=R("i",{class:"bi-trash"},null,-1),sQ=[aQ],oQ={class:"list-group-item"},uQ=R("i",{class:"bi-person-plus"},null,-1),lQ=[uQ],cQ={class:"input-group"},fQ=["value"],dQ=R("i",{class:"bi-person-plus"},null,-1),pQ=Qe(" Add"),hQ=[dQ,pQ],vQ={class:"list-group mb-3"},gQ=R("li",{class:"list-group-item list-group-item-secondary"},[Qe("Agent SMS "),R("i",{class:"bi-phone"})],-1),yQ=["onClick"],mQ=R("i",{class:"bi-trash"},null,-1),bQ=[mQ],wQ={class:"list-group-item"},_Q=R("i",{class:"bi-phone"},null,-1),SQ=[_Q],$Q={class:"input-group"},kQ=R("i",{class:"bi-phone"},null,-1),TQ=Qe(" Add"),EQ=[kQ,TQ],CQ={class:"list-group mb-3"},IQ=R("li",{class:"list-group-item list-group-item-success"},[Qe("End User Chat "),R("i",{class:"bi-person-workspace"})],-1),RQ=["onClick"],OQ=R("i",{class:"bi-trash"},null,-1),AQ=[OQ],PQ={class:"list-group-item text-center"},MQ={class:"input-group"},NQ=["value"],xQ=R("i",{class:"bi-input-cursor"},null,-1),LQ=Qe(" Inject"),jQ=[xQ,LQ],UQ={class:"list-group mb-3"},DQ=R("li",{class:"list-group-item list-group-item-success"},[Qe("End User SMS "),R("i",{class:"bi-phone"})],-1),FQ=["onClick"],BQ=R("i",{class:"bi-trash"},null,-1),qQ=[BQ],HQ={class:"list-group-item"},WQ=R("i",{class:"bi-phone"},null,-1),GQ=[WQ],zQ={class:"input-group"},VQ=R("i",{class:"bi-phone"},null,-1),KQ=Qe(" Add"),JQ=[VQ,KQ],YQ={class:"col-9 pb-5"},QQ={class:"rounded",style:{"min-height":"70vh","max-height":"70vh","overflow-y":"scroll"}},XQ={ref:"messagesDiv",class:"container-fluid pt-3 pb-3"},ZQ={key:0},eX={key:0,class:"alert alert-danger"},tX=R("i",{class:"bi-plug"},null,-1),rX=Qe(" Connect"),nX=[tX,rX],iX=R("h5",{class:"alert-heading"},"Not Connected",-1),aX=R("p",null,"You are not connected to this conversation!",-1),sX=Qe(" Trouble connecting? "),oX=Qe("Refresh Token"),uX={key:1},lX={class:"input-group input-group-lg"},cX=R("i",{class:"bi bi-send-fill"},null,-1),fX=[cX],dX={class:"mt-1 text-end"},pX=R("i",{class:"bi-image"},null,-1),hX=Qe(" Send Image "),vX=[pX,hX],gX={class:"mt-3"},yX={class:"text-end"},mX={__name:"Conversation",setup(e){Ja();const t=Ya(),r=F$(),n=B$(),i=D$();bv();const a=i.params.sid?i.params.sid:"Not Found",s=Ve(!1),u=Ve(""),o=Ve([]),c=Ve([]),d=Ka({details:{}}),y=Ve(!1),_=Ve(!1),b=Ve([]),T=Ve(null),x=Ve(""),N=Ve("");Ve(!1),Ve({});const D=async()=>{try{(await fetch("/conversations/conversation-change-name",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,friendlyName:u.value}})})).ok&&(s.value=!1,u.value="",le())}catch(E){console.log("changeConversationName error => ",E)}},H=async E=>{try{if((await fetch("/conversations/conversation-delete-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,participant:E}})})).ok){console.log("Success! Agent Removed from Conversation..."),y.value=!1;let P=null,U=null;le()}}catch($){console.log("removeFromConversation error => ",$)}},ve=async E=>{try{(await fetch("/conversations/conversation-delete-message",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,messageSid:E}})})).ok&&(console.log("Success! Message Removed from Conversation..."),await ft())}catch($){console.log("removeFromConversation error => ",$)}},ae=Ve(!1),Ae=Ve(""),Re=async E=>{try{let $=_a("chat","agent",E);(await fetch("/conversations/conversation-add-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,identity:E,attributes:$}})})).ok?(console.log("Success! Added Agent to conversation..."),Ae.value="",ae.value=!1,le()):console.log("Error! Unable to add Agent to conversation...")}catch($){console.log("addAgentToConversation error => ",$)}},Ie=Ve(!1),L=Ve(""),oe=Ve(!1),B=Ve(""),ke=async(E,$)=>{try{oe.value=!1;let q=_a("sms",E,$);const U=await fetch("/conversations/conversation-add-mobile-phone-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,mobile_number:L.value,attributes:q}})});U.ok?(console.log("Success! Added Mobile to conversation..."),L.value="",Ie.value=!1,le()):(console.log("Error! Unable to add Mobile to conversation..."),oe.value=!0,B.value="We are not able to add that phone number.",U.status==409&&(B.value="That phone number is in use in a different conversation."),Ie.value=!1,L.value="")}catch(q){console.log("addMobileToConversation error => ",q)}},Se=Ve(!1),se=Ve(""),ee=Ve(!1),ne=Ve(""),te=async(E,$)=>{try{ee.value=!1;let q=_a("sms",E,$);const U=await fetch("/conversations/conversation-add-mobile-phone-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,mobile_number:se.value,attributes:q}})});U.ok?(console.log("Success! Added Agent Mobile to conversation..."),se.value="",Se.value=!1,le()):(console.log("Error! Unable to add Agent Mobile to conversation..."),ee.value=!0,ne.value="We are not able to add that phone number.",U.status==409&&(ne.value="That phone number is in use in a different conversation."),Se.value=!1,se.value="")}catch(q){console.log("addAgentMobileToConversation error => ",q)}};Ve(!1),Ve(""),Ve(!1),Ve("");const me=async()=>{try{let E=`/conversations/conversation-details?sid=${a}`;const $=await fetch(E,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if($.ok){let q=await $.json();d.details=q}}catch(E){console.log("getConversationDetails error => ",E)}},A=Ve({}),Ne=async()=>{try{let E=`/conversations/conversation-participants?sid=${a}`;const $=await fetch(E,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if($.ok){let q=await $.json();console.log("getConversationParticipants response ==> ",q),o.value=q;for(let P=0;P<o.value.length;P++)typeof JSON.parse(o.value[P].attributes)=="object"?o.value[P].attributes=JSON.parse(o.value[P].attributes):o.value[P].attributes=JSON.parse(JSON.parse(o.value[P].attributes)),Object.keys(o.value[P].attributes).length===0&&o.value[P].attributes.address!==void 0&&(o.value[P].attributes.address==="whatsapp"?(console.log("whatsapp channel..."),o.value[P].attributes=JSON.parse(_a("whatsapp","enduser",o.value[P].messagingBinding.address))):o.value[P].attributes=JSON.parse(_a("sms","enduser",o.value[P].messagingBinding.address))),A.value[o.value[P].sid]=o.value[P].attributes,o.value[P].identity===t.agent.identity&&(N.value=o.value[P].sid,y.value=!0)}}catch(E){console.log("getConversationParticipants error => ",E)}},ft=async()=>{try{let E=`/conversations/conversation-messages?sid=${a}`;const $=await fetch(E,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if($.ok){let q=await $.json();c.value=q;for(let P=0;P<c.value.length;P++){Object.keys(c.value[P].attributes).length===0?c.value[P].attributes={attributes:"none"}:c.value[P].attributes=JSON.parse(c.value[P].attributes);let U=A.value[c.value[P].participantSid];U==null&&(U=JSON.parse(_a("bot","bot","Webhook"))),c.value[P].participantAttributes=U}}}catch(E){console.log("getConversationMessages error => ",E)}},ze=async()=>{try{let E=`/conversations/conversation-webhooks?sid=${a}`;const $=await fetch(E,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if($.ok){let q=await $.json();b.value=q;for(let P=0;P<b.value.length;P++)b.value[P].Name=r.webhooks.find(U=>U.data.flowSid===b.value[P].configuration.flow_sid).data.Name}}catch(E){console.log("getConversationWebhooks error => ",E)}},le=async()=>{await me(),await Ne(),await ft(),await ze()};let G=null,J=null;Ve(!0),Ve(""),Ve("");const k=async()=>{G=await new W$.Client(t.agent.accessToken),J=await G.getConversationBySid(a),_.value=!0,J.on("messageAdded",E=>{let $=A.value[E.participantSid];$==null&&($=JSON.parse(_a("bot","bot","Webhook"))),E.participantAttributes=$,c.value.push(E),T.value.scrollIntoView()}),J.on("tokenExpired",E=>{console.log("Token Expired!"),C()})},C=async()=>{console.log("in refreshToken..."),await t.getToken(),await k()},X=async()=>{try{let E=x.value;x.value="...";let $={mType:"agentChat",agentMessage:!0,agentIdentity:t.agent.identity};await J.prepareMessage().setBody(E).setAttributes($).build().send(),x.value="",console.log("Sent Message...")}catch(E){_.value=!1,console.log("sendMessage error => ",E)}},Z=Ve(!1),$e=Ve(null),De=async()=>{let E={mType:"agentChat",agentMessage:!0,agentIdentity:t.agent.identity};const $={contentType:$e.value.files[0].type,filename:$e.value.files[0].name,media:$e.value.files[0]};await J.prepareMessage().setAttributes(E).addMedia($).build().send(),Z.value=!1,$e.value=null};Ve(!1);const ue=Ve({}),Te=async()=>{try{let E=[],$=ue.value.Options.split(/\#/);for(let P=0;P<$.length;P++){let U=$[P].split(/\|/),_e={label:U[0],value:U[1],style:U[2]};E.push(_e)}let q={mType:"chatButton",id:ue.value.Id,question:ue.value.Question,options:E};await J.prepareMessage().setBody("<Chat Button>").setAttributes(q).build().send(),console.log("Injected Chat Button...")}catch(E){_.value=!1,console.log("injectChatButton error => ",E)}};return uo(()=>{le()}),(E,$)=>{const q=fr("router-link");return He(),Ye("div",LY,[R("div",jY,[R("div",UY,[R("div",DY,[rt(R("button",{type:"button",class:"btn btn-sm btn-link float-end",onClick:$[0]||($[0]=P=>s.value=!0)},BY,512),[[dt,!s.value]]),rt(R("div",qY,[rt(R("input",{type:"text","onUpdate:modelValue":$[1]||($[1]=P=>u.value=P),class:"form-control"},null,512),[[xs,u.value]]),R("button",{type:"button",class:"btn btn-sm btn-success",onClick:$[2]||($[2]=P=>D())},WY)],512),[[dt,s.value]]),d.details.friendlyName!==null?rt((He(),Ye("h4",{key:0,class:"alert-heading"},Bt(d.details.friendlyName),513)),[[dt,!s.value]]):nr("",!0),d.details.friendlyName===null?rt((He(),Ye("h5",GY,VY,512)),[[dt,!s.value]]):nr("",!0)]),y.value?nr("",!0):(He(),Ye("div",KY,[R("div",JY,[YY,QY,XY,R("button",{type:"button",class:"btn btn-sm btn-info",onClick:$[3]||($[3]=P=>Re(Ot(t).agent.identity))},tQ)])])),R("ul",rQ,[nQ,(He(!0),Ye(Ht,null,wn(o.value,P=>rt((He(),Ye("li",{class:"list-group-item",key:P.sid},[Qe(Bt(P.identity)+" \xA0 ",1),R("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:U=>H(P.sid)},sQ,8,iQ)])),[[dt,P.identity!=null&&P.attributes.chat&&P.attributes.agent]])),128)),R("li",oQ,[rt(R("span",null,"Add Agent",512),[[dt,!ae.value]]),rt(R("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:$[4]||($[4]=P=>ae.value=!0)},lQ,512),[[dt,!ae.value]]),rt(R("div",cQ,[rt(R("select",{class:"form-select","onUpdate:modelValue":$[5]||($[5]=P=>Ae.value=P)},[(He(!0),Ye(Ht,null,wn(Ot(t).agents,P=>(He(),Ye("option",{key:P,value:P},Bt(P),9,fQ))),128))],512),[[vc,Ae.value]]),R("button",{type:"button",class:"btn btn-sm btn-success",onClick:$[6]||($[6]=P=>Re(Ae.value))},hQ)],512),[[dt,ae.value]])])]),R("ul",vQ,[gQ,(He(!0),Ye(Ht,null,wn(o.value,P=>{var U;return rt((He(),Ye("li",{class:"list-group-item",key:P.sid},[Qe(Bt((U=P.messagingBinding)==null?void 0:U.address)+" ",1),R("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:_e=>H(P.sid)},bQ,8,yQ)])),[[dt,P.messagingBinding!=null&&P.attributes.agent]])}),128)),R("li",wQ,[rt(R("span",null,"Add Agent SMS",512),[[dt,!Se.value]]),rt(R("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:$[7]||($[7]=P=>Se.value=!0)},SQ,512),[[dt,!Se.value]]),rt(R("div",$Q,[rt(R("input",{type:"text","onUpdate:modelValue":$[8]||($[8]=P=>se.value=P),class:"form-control"},null,512),[[xs,se.value]]),R("button",{type:"button",class:"btn btn-sm btn-success",onClick:$[9]||($[9]=P=>te("agent","Agent"))},EQ)],512),[[dt,Se.value]]),rt(R("p",{class:"text-danger"},Bt(ne.value),513),[[dt,ee.value]])])]),R("ul",CQ,[IQ,(He(!0),Ye(Ht,null,wn(o.value,P=>rt((He(),Ye("li",{class:"list-group-item",key:P.sid},[Qe(Bt(Ot(H$)(P.identity))+" \xA0 ",1),R("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:U=>H(P.sid)},AQ,8,RQ)])),[[dt,P.identity!==null&&P.attributes.chat&&P.attributes.enduser]])),128)),R("li",PQ,[R("div",MQ,[rt(R("select",{class:"form-select","onUpdate:modelValue":$[10]||($[10]=P=>ue.value=P)},[(He(!0),Ye(Ht,null,wn(Ot(n).chatbuttons,P=>(He(),Ye("option",{key:P.data.Id,value:P.data},Bt(P.data.Label),9,NQ))),128))],512),[[vc,ue.value]]),R("button",{type:"button",class:"btn btn-sm btn-success",onClick:$[11]||($[11]=P=>Te())},jQ)])])]),R("ul",UQ,[DQ,(He(!0),Ye(Ht,null,wn(o.value,P=>{var U;return rt((He(),Ye("li",{class:"list-group-item",key:P.sid},[Qe(Bt((U=P.messagingBinding)==null?void 0:U.address)+" ",1),R("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:_e=>H(P.sid)},qQ,8,FQ)])),[[dt,P.messagingBinding!=null&&P.attributes.enduser&&P.attributes.sms]])}),128)),R("li",HQ,[rt(R("span",null,"Add SMS Participant",512),[[dt,!Ie.value]]),rt(R("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:$[12]||($[12]=P=>Ie.value=!0)},GQ,512),[[dt,!Ie.value]]),rt(R("div",zQ,[rt(R("input",{type:"text","onUpdate:modelValue":$[13]||($[13]=P=>L.value=P),class:"form-control"},null,512),[[xs,L.value]]),R("button",{type:"button",class:"btn btn-sm btn-success",onClick:$[14]||($[14]=P=>ke("enduser","End User"))},JQ)],512),[[dt,Ie.value]]),rt(R("p",{class:"text-danger"},Bt(B.value),513),[[dt,oe.value]])])])]),R("div",YQ,[R("div",QQ,[R("div",XQ,[(He(!0),Ye(Ht,null,wn(c.value,P=>(He(),cn(xY,{onRemoveMessage:$[15]||($[15]=U=>ve(U)),participant:P.participantAttributes,mAttributes:P.attributes,key:P.sid,mSid:P.sid,pSid:P.participantSid,dateCreated:P.dateCreated,author:P.author,content:P.body,media:P.media,cSid:d.details.sid},null,8,["participant","mAttributes","mSid","pSid","dateCreated","author","content","media","cSid"]))),128)),R("div",{class:"mt-5",ref_key:"bottomEl",ref:T},null,512)],512)]),y.value?(He(),Ye("div",ZQ,[_.value?nr("",!0):(He(),Ye("div",eX,[R("button",{type:"button",class:"btn btn-sm btn-danger float-end",onClick:$[16]||($[16]=P=>k())},nX),iX,aX,R("p",null,[sX,vt(q,{to:"/agent"},{default:tr(()=>[oX]),_:1})])])),_.value?(He(),Ye("div",uX,[R("form",{onSubmit:$[20]||($[20]=QI((...P)=>E.submitForm&&E.submitForm(...P),["prevent"]))},[R("div",lX,[rt(R("input",{onKeyup:$[17]||($[17]=ZI(P=>X(),["enter"])),type:"text",class:"form-control","onUpdate:modelValue":$[18]||($[18]=P=>x.value=P),"aria-describedby":"btnGroupAddon",placeholder:"Type a message..."},null,544),[[xs,x.value]]),R("button",{type:"button",class:"btn btn-primary",onClick:$[19]||($[19]=P=>X())},fX)])],32),rt(R("div",dX,[R("button",{onClick:$[21]||($[21]=P=>Z.value=!0),class:"btn btn-sm btn-link"},vX)],512),[[dt,!Z.value]]),rt(R("div",gX,[R("input",{ref_key:"file",ref:$e,onChange:$[22]||($[22]=P=>De()),class:"form-control form-control-sm",id:"formFileSm",type:"file"},null,544)],512),[[dt,Z.value]]),rt(R("div",yX,[R("button",{onClick:$[23]||($[23]=P=>Z.value=!1),class:"btn btn-sm btn-link"}," Cancel ")],512),[[dt,Z.value]])])):nr("",!0)])):nr("",!0)])])])}}},bX={name:"App",components:{Layout:lo,Conversation:mX}};function wX(e,t,r,n,i,a){const s=fr("Conversation"),u=fr("Layout");return He(),cn(u,null,{default:tr(()=>[vt(s)]),_:1})}const _X=Wn(bX,[["render",wX]]),SX=R("div",{class:"alert"},[R("h1",null,"Current Order"),R("p",null,"Order Number: #18127"),R("p",null,"Customer Name: Charlie")],-1),$X={class:"table table-striped mt-4 mb-5 fs-4"},kX=R("thead",null,[R("tr",null,[R("th",{class:"text-center"},"Photo"),R("th",{class:"text-center"},"Item"),R("th",{class:"text-center"},"Picked"),R("th",{class:"text-center"},"Action")])],-1),TX=R("tr",null,[R("td",{class:"text-center"},[R("img",{height:"50px",width:"auto",src:"https://images.albertsons-media.com/is/image/ABS/960109440?$ng-ecom-pdp-tn$&defaultImage=Not_Available"})]),R("td",{class:"text-center"},"USDA Choice Beef Top Sirloin Steak Boneless Value Pack - 3.5 Lb"),R("td",{class:"text-center"},[R("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault",checked:""})]),R("td",{class:"text-center"},[R("button",{class:"btn btn-primary disabled"},[R("i",{class:"bi-shuffle"}),Qe(" Substitute ")])])],-1),EX=R("tr",null,[R("td",{class:"text-center"},[R("img",{height:"50px",width:"auto",src:"https://images.albertsons-media.com/is/image/ABS/960327842-ECOM?$ng-ecom-pdp-tn$&defaultImage=Not_Available"})]),R("td",{class:"text-center"},"Starbucks Breakfast Blend 100% Arabica Medium Roast K Cup"),R("td",{class:"text-center"},[R("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault",checked:""})]),R("td",{class:"text-center"},[R("button",{class:"btn btn-primary disabled"},[R("i",{class:"bi-shuffle"}),Qe(" Substitute ")])])],-1),CX=R("tr",null,[R("td",{class:"text-center"},[R("img",{height:"50px",width:"auto",src:"https://images.albertsons-media.com/is/image/ABS/960050143-ECOM?$ng-ecom-pdp-tn$&defaultImage=Not_Available"})]),R("td",{class:"text-center"},"FAGE Total 0% Milkfat Plain Greek Yogurt - 32 Oz"),R("td",{class:"text-center"},[R("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault",checked:""})]),R("td",{class:"text-center"},[R("button",{class:"btn btn-primary disabled"},[R("i",{class:"bi-shuffle"}),Qe(" Substitute ")])])],-1),IX=R("tr",null,[R("td",{class:"text-center"},[R("img",{height:"50px",width:"auto",src:"https://images.albertsons-media.com/is/image/ABS/138350091-ECOM?$ng-ecom-pdp-tn$&defaultImage=Not_Available"})]),R("td",{class:"text-center"},"Lucerne Eggs Large Grade A Family Pack - 18 Count"),R("td",{class:"text-center"},[R("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault",checked:""})]),R("td",{class:"text-center"},[R("button",{class:"btn btn-primary disabled"},[R("i",{class:"bi-shuffle"}),Qe(" Substitute ")])])],-1),RX=R("tr",null,[R("td",{class:"text-center"},[R("img",{height:"50px",width:"auto",src:"https://images.albertsons-media.com/is/image/ABS/136010121-ECOM?$ng-ecom-pdp-tn$&defaultImage=Not_Available"})]),R("td",{class:"text-center"},"Lucerne Milk Whole 1 Gallon - 128 Fl. Oz."),R("td",{class:"text-center"},[R("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault",checked:""})]),R("td",{class:"text-center"},[R("button",{class:"btn btn-primary disabled"},[R("i",{class:"bi-shuffle"}),Qe(" Substitute ")])])],-1),OX=R("tr",null,[R("td",{class:"text-center"},[R("img",{height:"50px",width:"auto",src:"https://images.albertsons-media.com/is/image/ABS/184020020?$ng-ecom-pdp-tn$&defaultImage=Not_Available"})]),R("td",{class:"text-center"},"Honeycrisp Apple"),R("td",{class:"text-center"},[R("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault",checked:""})]),R("td",{class:"text-center"},[R("button",{class:"btn btn-primary disabled"},[R("i",{class:"bi-shuffle"}),Qe(" Substitute ")])])],-1),AX=R("td",{class:"text-center"},[R("img",{height:"50px",width:"auto",src:"https://images.albertsons-media.com/is/image/ABS/960041097-ECOM?$ng-ecom-pdp-tn$&defaultImage=Not_Available"})],-1),PX=R("td",{class:"text-center"},"Pepperidge Farm Goldfish Cheddar Cheese Crackers - 9-1 Oz",-1),MX=R("td",{class:"text-center"},[R("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault"})],-1),NX={class:"text-center"},xX=R("i",{class:"bi-shuffle"},null,-1),LX=Qe(" Substitute "),jX=[xX,LX],UX={__name:"CurrentOrder",setup(e){const t=bv(),r=Ya(),n=async()=>{let o={conversationType:"Support",createdBy:r.agent.identity};try{const d=await fetch("/conversations/conversation-create",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationName:"Order 18127",attributes:o}})});if(d.ok){console.log("Success! Created a new conversation...");const y=await d.json();return console.log(y),y.sid}else console.log("Error! Unable to create new conversation...")}catch(c){console.log("createNewConversation error => ",c)}},i=async o=>{let c={displayName:"Shopper",avatar:"avatar",sms:!1,chat:!0,whatsapp:!1,enduser:!1,agent:!0};try{(await fetch("/conversations/conversation-add-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:o,identity:r.agent.identity,attributes:c}})})).ok?console.log("Success! Added Agent to conversation..."):console.log("Error! Unable to add End User to conversation...")}catch(d){console.log("addEndUserToConversation error => ",d)}},a=async o=>{let c={displayName:"Charlie - Customer",avatar:"avatar",sms:!1,chat:!0,whatsapp:!1,enduser:!0,agent:!1};try{(await fetch("/conversations/conversation-add-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:o,identity:"Charlie",attributes:c}})})).ok?console.log("Success! Added End User to conversation..."):console.log("Error! Unable to add End User to conversation...")}catch(d){console.log("addEndUserToConversation error => ",d)}},s=async o=>{try{let c=`/conversations/sms-invite?conversationSid=${o}`;(await fetch(c,{method:"GET",headers:{"Content-type":"application/json"}})).ok?console.log("Sent SMS invite to customer..."):console.log("Error! Unable to send SMS invite...")}catch(c){console.log("addEndUserToConversation error => ",c)}},u=async()=>{console.log("Starting conversation...");const o=await n();await i(o),await a(o),await s(o),t.push({name:"conversation",params:{sid:o}})};return(o,c)=>(He(),Ye(Ht,null,[SX,R("table",$X,[kX,R("tbody",null,[TX,EX,CX,IX,RX,OX,R("tr",null,[AX,PX,MX,R("td",NX,[R("button",{class:"btn btn-primary",onClick:c[0]||(c[0]=d=>u())},jX)])])])])],64))}},DX={name:"App",components:{Layout:lo,CurrentOrder:UX}};function FX(e,t,r,n,i,a){const s=fr("CurrentOrder"),u=fr("Layout");return He(),cn(u,null,{default:tr(()=>[vt(s)]),_:1})}const BX=Wn(DX,[["render",FX]]),TE=cO({history:IR(),routes:[{name:"home",path:"/",component:iA},{name:"login",path:"/login",component:LA},{name:"agent",path:"/agent",component:cP},{name:"conversations",path:"/conversations",component:JP},{name:"conversation",path:"/conversation/:sid",component:_X},{name:"current-order",path:"/current-order",component:BX}]});TE.beforeEach(async(e,t)=>{if(Ja().lists.length===0&&e.name!=="home")return{name:"home"}});const ry=rR(dO);ry.use(aR());ry.use(TE);ry.mount("#app");
